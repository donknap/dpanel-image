"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[713],{20713:function(sl,en,Mt){Mt.d(en,{tk:function(){return W.tk},ZP:function(){return wf}});var I=Mt(87462),Ce=Mt(63366),we=Mt(62435),L=Mt(78120),W=Mt(75533);const Ti=1024;let Fe=0;class rt{constructor(e,n){this.from=e,this.to=n}}class Q{constructor(e={}){this.id=Fe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=me.match(e)),n=>{let r=e(n);return r===void 0?null:[this,r]}}}Q.closedBy=new Q({deserialize:s=>s.split(" ")}),Q.openedBy=new Q({deserialize:s=>s.split(" ")}),Q.group=new Q({deserialize:s=>s.split(" ")}),Q.isolate=new Q({deserialize:s=>{if(s&&s!="rtl"&&s!="ltr"&&s!="auto")throw new RangeError("Invalid value for isolate: "+s);return s||"auto"}}),Q.contextHash=new Q({perNode:!0}),Q.lookAhead=new Q({perNode:!0}),Q.mounted=new Q({perNode:!0});class He{constructor(e,n,r){this.tree=e,this.overlay=n,this.parser=r}static get(e){return e&&e.props&&e.props[Q.mounted.id]}}const We=Object.create(null);class me{constructor(e,n,r,l=0){this.name=e,this.props=n,this.id=r,this.flags=l}static define(e){let n=e.props&&e.props.length?Object.create(null):We,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),l=new me(e.name||"",n,e.id,r);if(e.props){for(let c of e.props)if(Array.isArray(c)||(c=c(l)),c){if(c[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[c[0].id]=c[1]}}return l}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(Q.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let r in e)for(let l of r.split(" "))n[l]=e[r];return r=>{for(let l=r.prop(Q.group),c=-1;c<(l?l.length:0);c++){let d=n[c<0?r.name:l[c]];if(d)return d}}}}me.none=new me("",Object.create(null),0,8);class Ee{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let r of this.types){let l=null;for(let c of e){let d=c(r);d&&(l||(l=Object.assign({},r.props)),l[d[0].id]=d[1])}n.push(l?new me(r.name,l,r.id,r.flags):r)}return new Ee(n)}}const Se=new WeakMap,Xe=new WeakMap;var oe;(function(s){s[s.ExcludeBuffers=1]="ExcludeBuffers",s[s.IncludeAnonymous=2]="IncludeAnonymous",s[s.IgnoreMounts=4]="IgnoreMounts",s[s.IgnoreOverlays=8]="IgnoreOverlays"})(oe||(oe={}));class De{constructor(e,n,r,l,c){if(this.type=e,this.children=n,this.positions=r,this.length=l,this.props=null,c&&c.length){this.props=Object.create(null);for(let[d,g]of c)this.props[typeof d=="number"?d:d.id]=g}}toString(){let e=He.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let r of this.children){let l=r.toString();l&&(n&&(n+=","),n+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new oi(this.topNode,e)}cursorAt(e,n=0,r=0){let l=Se.get(this)||this.topNode,c=new oi(l);return c.moveTo(e,n),Se.set(this,c._tree),c}get topNode(){return new Re(this,0,0,null)}resolve(e,n=0){let r=at(Se.get(this)||this.topNode,e,n,!1);return Se.set(this,r),r}resolveInner(e,n=0){let r=at(Xe.get(this)||this.topNode,e,n,!0);return Xe.set(this,r),r}resolveStack(e,n=0){return tn(this,e,n)}iterate(e){let{enter:n,leave:r,from:l=0,to:c=this.length}=e,d=e.mode||0,g=(d&oe.IncludeAnonymous)>0;for(let w=this.cursor(d|oe.IncludeAnonymous);;){let M=!1;if(w.from<=c&&w.to>=l&&(!g&&w.type.isAnonymous||n(w)!==!1)){if(w.firstChild())continue;M=!0}for(;M&&r&&(g||!w.type.isAnonymous)&&r(w),!w.nextSibling();){if(!w.parent())return;M=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:Me(me.none,this.children,this.positions,0,this.children.length,0,this.length,(n,r,l)=>new De(this.type,n,r,l,this.propValues),e.makeTree||((n,r,l)=>new De(me.none,n,r,l)))}static build(e){return mi(e)}}De.empty=new De(me.none,[],[],0);class lt{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new lt(this.buffer,this.index)}}class st{constructor(e,n,r){this.buffer=e,this.length=n,this.set=r}get type(){return me.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],r=this.buffer[e+3],l=this.set.types[n],c=l.name;if(/\W/.test(c)&&!l.isError&&(c=JSON.stringify(c)),e+=4,r==e)return c;let d=[];for(;e<r;)d.push(this.childString(e)),e=this.buffer[e+3];return c+"("+d.join(",")+")"}findChild(e,n,r,l,c){let{buffer:d}=this,g=-1;for(let w=e;w!=n&&!(pi(c,l,d[w+1],d[w+2])&&(g=w,r>0));w=d[w+3]);return g}slice(e,n,r){let l=this.buffer,c=new Uint16Array(n-e),d=0;for(let g=e,w=0;g<n;){c[w++]=l[g++],c[w++]=l[g++]-r;let M=c[w++]=l[g++]-r;c[w++]=l[g++]-e,d=Math.max(d,M)}return new st(c,d,this.set)}}function pi(s,e,n,r){switch(s){case-2:return n<e;case-1:return r>=e&&n<e;case 0:return n<e&&r>e;case 1:return n<=e&&r>e;case 2:return r>e;case 4:return!0}}function at(s,e,n,r){for(var l;s.from==s.to||(n<1?s.from>=e:s.from>e)||(n>-1?s.to<=e:s.to<e);){let d=!r&&s instanceof Re&&s.index<0?null:s.parent;if(!d)return s;s=d}let c=r?0:oe.IgnoreOverlays;if(r)for(let d=s,g=d.parent;g;d=g,g=d.parent)d instanceof Re&&d.index<0&&((l=g.enter(e,n,c))===null||l===void 0?void 0:l.from)!=d.from&&(s=g);for(;;){let d=s.enter(e,n,c);if(!d)return s;s=d}}class Ut{cursor(e=0){return new oi(this,e)}getChild(e,n=null,r=null){let l=ei(this,e,n,r);return l.length?l[0]:null}getChildren(e,n=null,r=null){return ei(this,e,n,r)}resolve(e,n=0){return at(this,e,n,!1)}resolveInner(e,n=0){return at(this,e,n,!0)}matchContext(e){return ht(this,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),r=this;for(;n;){let l=n.lastChild;if(!l||l.to!=n.to)break;l.type.isError&&l.from==l.to?(r=n,n=l.prevSibling):n=l}return r}get node(){return this}get next(){return this.parent}}class Re extends Ut{constructor(e,n,r,l){super(),this._tree=e,this.from=n,this.index=r,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,r,l,c=0){for(let d=this;;){for(let{children:g,positions:w}=d._tree,M=n>0?g.length:-1;e!=M;e+=n){let T=g[e],R=w[e]+d.from;if(pi(l,r,R,R+T.length)){if(T instanceof st){if(c&oe.ExcludeBuffers)continue;let H=T.findChild(0,T.buffer.length,n,r-R,l);if(H>-1)return new Oe(new Lt(d,T,e,R),null,H)}else if(c&oe.IncludeAnonymous||!T.type.isAnonymous||Ni(T)){let H;if(!(c&oe.IgnoreMounts)&&(H=He.get(T))&&!H.overlay)return new Re(H.tree,R,e,d);let U=new Re(T,R,e,d);return c&oe.IncludeAnonymous||!U.type.isAnonymous?U:U.nextChild(n<0?T.children.length-1:0,n,r,l)}}}if(c&oe.IncludeAnonymous||!d.type.isAnonymous||(d.index>=0?e=d.index+n:e=n<0?-1:d._parent._tree.children.length,d=d._parent,!d))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,r=0){let l;if(!(r&oe.IgnoreOverlays)&&(l=He.get(this._tree))&&l.overlay){let c=e-this.from;for(let{from:d,to:g}of l.overlay)if((n>0?d<=c:d<c)&&(n<0?g>=c:g>c))return new Re(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ei(s,e,n,r){let l=s.cursor(),c=[];if(!l.firstChild())return c;if(n!=null){for(let d=!1;!d;)if(d=l.type.is(n),!l.nextSibling())return c}for(;;){if(r!=null&&l.type.is(r))return c;if(l.type.is(e)&&c.push(l.node),!l.nextSibling())return r==null?c:[]}}function ht(s,e,n=e.length-1){for(let r=s.parent;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[n]&&e[n]!=r.name)return!1;n--}}return!0}class Lt{constructor(e,n,r,l){this.parent=e,this.buffer=n,this.index=r,this.start=l}}class Oe extends Ut{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,r){super(),this.context=e,this._parent=n,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,n,r){let{buffer:l}=this.context,c=l.findChild(this.index+4,l.buffer[this.index+3],e,n-this.context.start,r);return c<0?null:new Oe(this.context,this,c)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,r=0){if(r&oe.ExcludeBuffers)return null;let{buffer:l}=this.context,c=l.findChild(this.index+4,l.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return c<0?null:new Oe(this.context,this,c)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Oe(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new Oe(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:r}=this.context,l=this.index+4,c=r.buffer[this.index+3];if(c>l){let d=r.buffer[this.index+1];e.push(r.slice(l,c,d)),n.push(0)}return new De(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Ve(s){if(!s.length)return null;let e=0,n=s[0];for(let c=1;c<s.length;c++){let d=s[c];(d.from>n.from||d.to<n.to)&&(n=d,e=c)}let r=n instanceof Re&&n.index<0?null:n.parent,l=s.slice();return r?l[e]=r:l.splice(e,1),new vt(l,n)}class vt{constructor(e,n){this.heads=e,this.node=n}get next(){return Ve(this.heads)}}function tn(s,e,n){let r=s.resolveInner(e,n),l=null;for(let c=r instanceof Re?r:r.context.parent;c;c=c.parent)if(c.index<0){let d=c.parent;(l||(l=[r])).push(d.resolve(e,n)),c=d}else{let d=He.get(c.tree);if(d&&d.overlay&&d.overlay[0].from<=e&&d.overlay[d.overlay.length-1].to>=e){let g=new Re(d.tree,d.overlay[0].from+c.from,-1,c);(l||(l=[r])).push(at(g,e,n,!1))}}return l?Ve(l):r}class oi{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Re)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:r,buffer:l}=this.buffer;return this.type=n||l.set.types[l.buffer[e]],this.from=r+l.buffer[e+1],this.to=r+l.buffer[e+2],!0}yield(e){return e?e instanceof Re?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,r,this.mode));let{buffer:l}=this.buffer,c=l.findChild(this.index+4,l.buffer[this.index+3],e,n-this.buffer.start,r);return c<0?!1:(this.stack.push(this.index),this.yieldBuf(c))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,r=this.mode){return this.buffer?r&oe.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&oe.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&oe.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,r=this.stack.length-1;if(e<0){let l=r<0?0:this.stack[r]+4;if(this.index!=l)return this.yieldBuf(n.findChild(l,this.index,-1,0,4))}else{let l=n.buffer[this.index+3];if(l<(r<0?n.buffer.length:n.buffer[this.stack[r]+3]))return this.yieldBuf(l)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,r,{buffer:l}=this;if(l){if(e>0){if(this.index<l.buffer.buffer.length)return!1}else for(let c=0;c<this.index;c++)if(l.buffer.buffer[c+3]<this.index)return!1;({index:n,parent:r}=l)}else({index:n,_parent:r}=this._tree);for(;r;{index:n,_parent:r}=r)if(n>-1)for(let c=n+e,d=e<0?-1:r._tree.children.length;c!=d;c+=e){let g=r._tree.children[c];if(this.mode&oe.IncludeAnonymous||g instanceof st||!g.type.isAnonymous||Ni(g))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,r=0;if(e&&e.context==this.buffer)e:for(let l=this.index,c=this.stack.length;c>=0;){for(let d=e;d;d=d._parent)if(d.index==l){if(l==this.index)return d;n=d,r=c+1;break e}l=this.stack[--c]}for(let l=r;l<this.stack.length;l++)n=new Oe(this.buffer,n,this.stack[l]);return this.bufferNode=new Oe(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let r=0;;){let l=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(l=!0)}for(;l&&n&&n(this),l=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,l=!0}}}matchContext(e){if(!this.buffer)return ht(this.node,e);let{buffer:n}=this.buffer,{types:r}=n.set;for(let l=e.length-1,c=this.stack.length-1;l>=0;c--){if(c<0)return ht(this.node,e,l);let d=r[n.buffer[this.stack[c]]];if(!d.isAnonymous){if(e[l]&&e[l]!=d.name)return!1;l--}}return!0}}function Ni(s){return s.children.some(e=>e instanceof st||!e.type.isAnonymous||Ni(e))}function mi(s){var e;let{buffer:n,nodeSet:r,maxBufferLength:l=Ti,reused:c=[],minRepeatType:d=r.types.length}=s,g=Array.isArray(n)?new lt(n,n.length):n,w=r.types,M=0,T=0;function R(re,ve,te,Ke,ae,pe){let{id:fe,start:ue,end:_e,size:Ue}=g,Pt=T;for(;Ue<0;)if(g.next(),Ue==-1){let di=c[fe];te.push(di),Ke.push(ue-re);return}else if(Ue==-3){M=fe;return}else if(Ue==-4){T=fe;return}else throw new RangeError(`Unrecognized record size: ${Ue}`);let Qt=w[fe],xt,Zt,$n=ue-re;if(_e-ue<=l&&(Zt=Ae(g.pos-ve,ae))){let di=new Uint16Array(Zt.size-Zt.skip),ri=g.pos-Zt.size,Mi=di.length;for(;g.pos>ri;)Mi=Te(Zt.start,di,Mi);xt=new st(di,_e-Zt.start,r),$n=Zt.start-re}else{let di=g.pos-Ue;g.next();let ri=[],Mi=[],qn=fe>=d?fe:-1,Ts=0,nl=_e;for(;g.pos>di;)qn>=0&&g.id==qn&&g.size>=0?(g.end<=nl-l&&(X(ri,Mi,ue,Ts,g.end,nl,qn,Pt),Ts=ri.length,nl=g.end),g.next()):pe>2500?H(ue,di,ri,Mi):R(ue,di,ri,Mi,qn,pe+1);if(qn>=0&&Ts>0&&Ts<ri.length&&X(ri,Mi,ue,Ts,ue,nl,qn,Pt),ri.reverse(),Mi.reverse(),qn>-1&&Ts>0){let zh=U(Qt);xt=Me(Qt,ri,Mi,0,ri.length,0,_e-ue,zh,zh)}else xt=se(Qt,ri,Mi,_e-ue,Pt-_e)}te.push(xt),Ke.push($n)}function H(re,ve,te,Ke){let ae=[],pe=0,fe=-1;for(;g.pos>ve;){let{id:ue,start:_e,end:Ue,size:Pt}=g;if(Pt>4)g.next();else{if(fe>-1&&_e<fe)break;fe<0&&(fe=Ue-l),ae.push(ue,_e,Ue),pe++,g.next()}}if(pe){let ue=new Uint16Array(pe*4),_e=ae[ae.length-2];for(let Ue=ae.length-3,Pt=0;Ue>=0;Ue-=3)ue[Pt++]=ae[Ue],ue[Pt++]=ae[Ue+1]-_e,ue[Pt++]=ae[Ue+2]-_e,ue[Pt++]=Pt;te.push(new st(ue,ae[2]-_e,r)),Ke.push(_e-re)}}function U(re){return(ve,te,Ke)=>{let ae=0,pe=ve.length-1,fe,ue;if(pe>=0&&(fe=ve[pe])instanceof De){if(!pe&&fe.type==re&&fe.length==Ke)return fe;(ue=fe.prop(Q.lookAhead))&&(ae=te[pe]+fe.length+ue)}return se(re,ve,te,Ke,ae)}}function X(re,ve,te,Ke,ae,pe,fe,ue){let _e=[],Ue=[];for(;re.length>Ke;)_e.push(re.pop()),Ue.push(ve.pop()+te-ae);re.push(se(r.types[fe],_e,Ue,pe-ae,ue-pe)),ve.push(ae-te)}function se(re,ve,te,Ke,ae=0,pe){if(M){let fe=[Q.contextHash,M];pe=pe?[fe].concat(pe):[fe]}if(ae>25){let fe=[Q.lookAhead,ae];pe=pe?[fe].concat(pe):[fe]}return new De(re,ve,te,Ke,pe)}function Ae(re,ve){let te=g.fork(),Ke=0,ae=0,pe=0,fe=te.end-l,ue={size:0,start:0,skip:0};e:for(let _e=te.pos-re;te.pos>_e;){let Ue=te.size;if(te.id==ve&&Ue>=0){ue.size=Ke,ue.start=ae,ue.skip=pe,pe+=4,Ke+=4,te.next();continue}let Pt=te.pos-Ue;if(Ue<0||Pt<_e||te.start<fe)break;let Qt=te.id>=d?4:0,xt=te.start;for(te.next();te.pos>Pt;){if(te.size<0)if(te.size==-3)Qt+=4;else break e;else te.id>=d&&(Qt+=4);te.next()}ae=xt,Ke+=Ue,pe+=Qt}return(ve<0||Ke==re)&&(ue.size=Ke,ue.start=ae,ue.skip=pe),ue.size>4?ue:void 0}function Te(re,ve,te){let{id:Ke,start:ae,end:pe,size:fe}=g;if(g.next(),fe>=0&&Ke<d){let ue=te;if(fe>4){let _e=g.pos-(fe-4);for(;g.pos>_e;)te=Te(re,ve,te)}ve[--te]=ue,ve[--te]=pe-re,ve[--te]=ae-re,ve[--te]=Ke}else fe==-3?M=Ke:fe==-4&&(T=Ke);return te}let he=[],xe=[];for(;g.pos>0;)R(s.start||0,s.bufferStart||0,he,xe,-1,0);let qe=(e=s.length)!==null&&e!==void 0?e:he.length?xe[0]+he[0].length:0;return new De(w[s.topID],he.reverse(),xe.reverse(),qe)}const je=new WeakMap;function ke(s,e){if(!s.isAnonymous||e instanceof st||e.type!=s)return 1;let n=je.get(e);if(n==null){n=1;for(let r of e.children){if(r.type!=s||!(r instanceof De)){n=1;break}n+=ke(s,r)}je.set(e,n)}return n}function Me(s,e,n,r,l,c,d,g,w){let M=0;for(let X=r;X<l;X++)M+=ke(s,e[X]);let T=Math.ceil(M*1.5/8),R=[],H=[];function U(X,se,Ae,Te,he){for(let xe=Ae;xe<Te;){let qe=xe,re=se[xe],ve=ke(s,X[xe]);for(xe++;xe<Te;xe++){let te=ke(s,X[xe]);if(ve+te>=T)break;ve+=te}if(xe==qe+1){if(ve>T){let te=X[qe];U(te.children,te.positions,0,te.children.length,se[qe]+he);continue}R.push(X[qe])}else{let te=se[xe-1]+X[xe-1].length-re;R.push(Me(s,X,se,qe,xe,re,te,null,w))}H.push(re+he-c)}}return U(e,n,r,l,0),(g||w)(R,H,d)}class nn{constructor(){this.map=new WeakMap}setBuffer(e,n,r){let l=this.map.get(e);l||this.map.set(e,l=new Map),l.set(n,r)}getBuffer(e,n){let r=this.map.get(e);return r&&r.get(n)}set(e,n){e instanceof Oe?this.setBuffer(e.context.buffer,e.index,n):e instanceof Re&&this.map.set(e.tree,n)}get(e){return e instanceof Oe?this.getBuffer(e.context.buffer,e.index):e instanceof Re?this.map.get(e.tree):void 0}cursorSet(e,n){e.buffer?this.setBuffer(e.buffer.buffer,e.index,n):this.map.set(e.tree,n)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class ze{constructor(e,n,r,l,c=!1,d=!1){this.from=e,this.to=n,this.tree=r,this.offset=l,this.open=(c?1:0)|(d?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],r=!1){let l=[new ze(0,e.length,e,0,!1,r)];for(let c of n)c.to>e.length&&l.push(c);return l}static applyChanges(e,n,r=128){if(!n.length)return e;let l=[],c=1,d=e.length?e[0]:null;for(let g=0,w=0,M=0;;g++){let T=g<n.length?n[g]:null,R=T?T.fromA:1e9;if(R-w>=r)for(;d&&d.from<R;){let H=d;if(w>=H.from||R<=H.to||M){let U=Math.max(H.from,w)-M,X=Math.min(H.to,R)-M;H=U>=X?null:new ze(U,X,H.tree,H.offset+M,g>0,!!T)}if(H&&l.push(H),d.to>R)break;d=c<e.length?e[c++]:null}if(!T)break;w=T.toA,M=T.toA-T.toB}return l}}class Fi{startParse(e,n,r){return typeof e=="string"&&(e=new Di(e)),r=r?r.length?r.map(l=>new rt(l.from,l.to)):[new rt(0,0)]:[new rt(0,e.length)],this.createParse(e,n||[],r)}parse(e,n,r){let l=this.startParse(e,n,r);for(;;){let c=l.advance();if(c)return c}}}class Di{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}function kt(s){return(e,n,r,l)=>new zt(e,s,n,r,l)}class gi{constructor(e,n,r,l,c){this.parser=e,this.parse=n,this.overlay=r,this.target=l,this.from=c}}function Hi(s){if(!s.length||s.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(s))}class sn{constructor(e,n,r,l,c,d,g){this.parser=e,this.predicate=n,this.mounts=r,this.index=l,this.start=c,this.target=d,this.prev=g,this.depth=0,this.ranges=[]}}const Et=new Q({perNode:!0});class zt{constructor(e,n,r,l,c){this.nest=n,this.input=r,this.fragments=l,this.ranges=c,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let r=this.baseParse.advance();if(!r)return null;if(this.baseParse=null,this.baseTree=r,this.startInner(),this.stoppedAt!=null)for(let l of this.inner)l.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let r=this.baseTree;return this.stoppedAt!=null&&(r=new De(r.type,r.children,r.positions,r.length,r.propValues.concat([[Et,this.stoppedAt]]))),r}let e=this.inner[this.innerDone],n=e.parse.advance();if(n){this.innerDone++;let r=Object.assign(Object.create(null),e.target.props);r[Q.mounted.id]=new He(n,e.overlay,e.parser),e.target.props=r}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let n=this.innerDone;n<this.inner.length;n++)this.inner[n].from<e&&(e=Math.min(e,this.inner[n].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let n=this.innerDone;n<this.inner.length;n++)this.inner[n].parse.stopAt(e)}startInner(){let e=new Vi(this.fragments),n=null,r=null,l=new oi(new Re(this.baseTree,this.ranges[0].from,0,null),oe.IncludeAnonymous|oe.IgnoreMounts);e:for(let c,d;;){let g=!0,w;if(this.stoppedAt!=null&&l.from>=this.stoppedAt)g=!1;else if(e.hasNode(l)){if(n){let M=n.mounts.find(T=>T.frag.from<=l.from&&T.frag.to>=l.to&&T.mount.overlay);if(M)for(let T of M.mount.overlay){let R=T.from+M.pos,H=T.to+M.pos;R>=l.from&&H<=l.to&&!n.ranges.some(U=>U.from<H&&U.to>R)&&n.ranges.push({from:R,to:H})}}g=!1}else if(r&&(d=yi(r.ranges,l.from,l.to)))g=d!=2;else if(!l.type.isAnonymous&&(c=this.nest(l,this.input))&&(l.from<l.to||!c.overlay)){l.tree||rn(l);let M=e.findMounts(l.from,c.parser);if(typeof c.overlay=="function")n=new sn(c.parser,c.overlay,M,this.inner.length,l.from,l.tree,n);else{let T=Y(this.ranges,c.overlay||(l.from<l.to?[new rt(l.from,l.to)]:[]));T.length&&Hi(T),(T.length||!c.overlay)&&this.inner.push(new gi(c.parser,T.length?c.parser.startParse(this.input,mt(M,T),T):c.parser.startParse(""),c.overlay?c.overlay.map(R=>new rt(R.from-l.from,R.to-l.from)):null,l.tree,T.length?T[0].from:l.from)),c.overlay?T.length&&(r={ranges:T,depth:0,prev:r}):g=!1}}else n&&(w=n.predicate(l))&&(w===!0&&(w=new rt(l.from,l.to)),w.from<w.to&&n.ranges.push(w));if(g&&l.firstChild())n&&n.depth++,r&&r.depth++;else for(;!l.nextSibling();){if(!l.parent())break e;if(n&&!--n.depth){let M=Y(this.ranges,n.ranges);M.length&&(Hi(M),this.inner.splice(n.index,0,new gi(n.parser,n.parser.startParse(this.input,mt(n.mounts,M),M),n.ranges.map(T=>new rt(T.from-n.start,T.to-n.start)),n.target,M[0].from))),n=n.prev}r&&!--r.depth&&(r=r.prev)}}}}function yi(s,e,n){for(let r of s){if(r.from>=n)break;if(r.to>e)return r.from<=e&&r.to>=n?2:1}return 0}function Wi(s,e,n,r,l,c){if(e<n){let d=s.buffer[e+1];r.push(s.slice(e,n,d)),l.push(d-c)}}function rn(s){let{node:e}=s,n=[],r=e.context.buffer;do n.push(s.index),s.parent();while(!s.tree);let l=s.tree,c=l.children.indexOf(r),d=l.children[c],g=d.buffer,w=[c];function M(T,R,H,U,X,se){let Ae=n[se],Te=[],he=[];Wi(d,T,Ae,Te,he,U);let xe=g[Ae+1],qe=g[Ae+2];w.push(Te.length);let re=se?M(Ae+4,g[Ae+3],d.set.types[g[Ae]],xe,qe-xe,se-1):e.toTree();return Te.push(re),he.push(xe-U),Wi(d,g[Ae+3],R,Te,he,U),new De(H,Te,he,X)}l.children[c]=M(0,g.length,me.none,0,d.length,n.length-1);for(let T of w){let R=s.tree.children[T],H=s.tree.positions[T];s.yield(new Re(R,H+s.from,T,s._tree))}}class bi{constructor(e,n){this.offset=n,this.done=!1,this.cursor=e.cursor(oe.IncludeAnonymous|oe.IgnoreMounts)}moveTo(e){let{cursor:n}=this,r=e-this.offset;for(;!this.done&&n.from<r;)n.to>=e&&n.enter(r,1,oe.IgnoreOverlays|oe.ExcludeBuffers)||n.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let n=this.cursor.tree;;){if(n==e.tree)return!0;if(n.children.length&&n.positions[0]==0&&n.children[0]instanceof De)n=n.children[0];else break}return!1}}class Vi{constructor(e){var n;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let r=this.curFrag=e[0];this.curTo=(n=r.tree.prop(Et))!==null&&n!==void 0?n:r.to,this.inner=new bi(r.tree,-r.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let n=this.curFrag=this.fragments[this.fragI];this.curTo=(e=n.tree.prop(Et))!==null&&e!==void 0?e:n.to,this.inner=new bi(n.tree,-n.offset)}}findMounts(e,n){var r;let l=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let c=this.inner.cursor.node;c;c=c.parent){let d=(r=c.tree)===null||r===void 0?void 0:r.prop(Q.mounted);if(d&&d.parser==n)for(let g=this.fragI;g<this.fragments.length;g++){let w=this.fragments[g];if(w.from>=c.to)break;w.tree==this.curFrag.tree&&l.push({frag:w,pos:c.from-w.offset,mount:d})}}}return l}}function Y(s,e){let n=null,r=e;for(let l=1,c=0;l<s.length;l++){let d=s[l-1].to,g=s[l].from;for(;c<r.length;c++){let w=r[c];if(w.from>=g)break;w.to<=d||(n||(r=n=e.slice()),w.from<d?(n[c]=new rt(w.from,d),w.to>g&&n.splice(c+1,0,new rt(g,w.to))):w.to>g?n[c--]=new rt(g,w.to):n.splice(c--,1))}}return r}function Ds(s,e,n,r){let l=0,c=0,d=!1,g=!1,w=-1e9,M=[];for(;;){let T=l==s.length?1e9:d?s[l].to:s[l].from,R=c==e.length?1e9:g?e[c].to:e[c].from;if(d!=g){let H=Math.max(w,n),U=Math.min(T,R,r);H<U&&M.push(new rt(H,U))}if(w=Math.min(T,R),w==1e9)break;T==w&&(d?(d=!1,l++):d=!0),R==w&&(g?(g=!1,c++):g=!0)}return M}function mt(s,e){let n=[];for(let{pos:r,mount:l,frag:c}of s){let d=r+(l.overlay?l.overlay[0].from:0),g=d+l.tree.length,w=Math.max(c.from,d),M=Math.min(c.to,g);if(l.overlay){let T=l.overlay.map(H=>new rt(H.from+r,H.to+r)),R=Ds(e,T,w,M);for(let H=0,U=w;;H++){let X=H==R.length,se=X?M:R[H].from;if(se>U&&n.push(new ze(U,se,l.tree,-d,c.from>=U||c.openStart,c.to<=se||c.openEnd)),X)break;U=R[H].to}}else n.push(new ze(w,M,l.tree,-d,c.from>=d||c.openStart,c.to<=g||c.openEnd))}return n}let Tt=0;class Rt{constructor(e,n,r){this.set=e,this.base=n,this.modified=r,this.id=Tt++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let n=new Rt([],null,[]);if(n.set.push(n),e)for(let r of e.set)n.set.push(r);return n}static defineModifier(){let e=new qt;return n=>n.modified.indexOf(e)>-1?n:qt.get(n.base||n,n.modified.concat(e).sort((r,l)=>r.id-l.id))}}let $t=0;class qt{constructor(){this.instances=[],this.id=$t++}static get(e,n){if(!n.length)return e;let r=n[0].instances.find(g=>g.base==e&&on(n,g.modified));if(r)return r;let l=[],c=new Rt(l,e,n);for(let g of n)g.instances.push(c);let d=ln(n);for(let g of e.set)if(!g.modified.length)for(let w of d)l.push(qt.get(g,w));return c}}function on(s,e){return s.length==e.length&&s.every((n,r)=>n==e[r])}function ln(s){let e=[[]];for(let n=0;n<s.length;n++)for(let r=0,l=e.length;r<l;r++)e.push(e[r].concat(s[n]));return e.sort((n,r)=>r.length-n.length)}function an(s){let e=Object.create(null);for(let n in s){let r=s[n];Array.isArray(r)||(r=[r]);for(let l of n.split(" "))if(l){let c=[],d=2,g=l;for(let R=0;;){if(g=="..."&&R>0&&R+3==l.length){d=1;break}let H=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(g);if(!H)throw new RangeError("Invalid path: "+l);if(c.push(H[0]=="*"?"":H[0][0]=='"'?JSON.parse(H[0]):H[0]),R+=H[0].length,R==l.length)break;let U=l[R++];if(R==l.length&&U=="!"){d=0;break}if(U!="/")throw new RangeError("Invalid path: "+l);g=l.slice(R)}let w=c.length-1,M=c[w];if(!M)throw new RangeError("Invalid path: "+l);let T=new It(r,d,w>0?c.slice(0,w):null);e[M]=T.sort(e[M])}}return hn.add(e)}const hn=new Q;class It{constructor(e,n,r,l){this.tags=e,this.mode=n,this.context=r,this.next=l}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}It.empty=new It([],2,null);function cn(s,e){let n=Object.create(null);for(let c of s)if(!Array.isArray(c.tag))n[c.tag.id]=c.class;else for(let d of c.tag)n[d.id]=c.class;let{scope:r,all:l=null}=e||{};return{style:c=>{let d=l;for(let g of c)for(let w of g.set){let M=n[w.id];if(M){d=d?d+" "+M:M;break}}return d},scope:r}}function fn(s,e){let n=null;for(let r of s){let l=r.style(e);l&&(n=n?n+" "+l:l)}return n}function et(s,e,n,r=0,l=s.length){let c=new tt(r,Array.isArray(e)?e:[e],n);c.highlightRange(s.cursor(),r,l,"",c.highlighters),c.flush(l)}function ct(s,e,n,r,l,c=0,d=s.length){let g=c;function w(M,T){if(!(M<=g)){for(let R=s.slice(g,M),H=0;;){let U=R.indexOf(`
`,H),X=U<0?R.length:U;if(X>H&&r(R.slice(H,X),T),U<0)break;l(),H=U+1}g=M}}et(e,n,(M,T,R)=>{w(M,""),w(T,R)},c,d),w(d,"")}class tt{constructor(e,n,r){this.at=e,this.highlighters=n,this.span=r,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,r,l,c){let{type:d,from:g,to:w}=e;if(g>=r||w<=n)return;d.isTop&&(c=this.highlighters.filter(U=>!U.scope||U.scope(d)));let M=l,T=Gt(e)||It.empty,R=fn(c,T.tags);if(R&&(M&&(M+=" "),M+=R,T.mode==1&&(l+=(l?" ":"")+R)),this.startSpan(Math.max(n,g),M),T.opaque)return;let H=e.tree&&e.tree.prop(Q.mounted);if(H&&H.overlay){let U=e.node.enter(H.overlay[0].from+g,1),X=this.highlighters.filter(Ae=>!Ae.scope||Ae.scope(H.tree.type)),se=e.firstChild();for(let Ae=0,Te=g;;Ae++){let he=Ae<H.overlay.length?H.overlay[Ae]:null,xe=he?he.from+g:w,qe=Math.max(n,Te),re=Math.min(r,xe);if(qe<re&&se)for(;e.from<re&&(this.highlightRange(e,qe,re,l,c),this.startSpan(Math.min(re,e.to),M),!(e.to>=xe||!e.nextSibling())););if(!he||xe>r)break;Te=he.to+g,Te>n&&(this.highlightRange(U.cursor(),Math.max(n,he.from+g),Math.min(r,Te),"",X),this.startSpan(Math.min(r,Te),M))}se&&e.parent()}else if(e.firstChild()){H&&(l="");do if(!(e.to<=n)){if(e.from>=r)break;this.highlightRange(e,n,r,l,c),this.startSpan(Math.min(r,e.to),M)}while(e.nextSibling());e.parent()}}}function Gt(s){let e=s.type.prop(hn);for(;e&&e.context&&!s.matchContext(e.context);)e=e.next;return e||null}const _=Rt.define,it=_(),ge=_(),wi=_(ge),xi=_(ge),Je=_(),St=_(Je),un=_(Je),gt=_(),Nt=_(gt),Ct=_(),de=_(),Ie=_(),ft=_(Ie),Kt=_(),z={comment:it,lineComment:_(it),blockComment:_(it),docComment:_(it),name:ge,variableName:_(ge),typeName:wi,tagName:_(wi),propertyName:xi,attributeName:_(xi),className:_(ge),labelName:_(ge),namespace:_(ge),macroName:_(ge),literal:Je,string:St,docString:_(St),character:_(St),attributeValue:_(St),number:un,integer:_(un),float:_(un),bool:_(Je),regexp:_(Je),escape:_(Je),color:_(Je),url:_(Je),keyword:Ct,self:_(Ct),null:_(Ct),atom:_(Ct),unit:_(Ct),modifier:_(Ct),operatorKeyword:_(Ct),controlKeyword:_(Ct),definitionKeyword:_(Ct),moduleKeyword:_(Ct),operator:de,derefOperator:_(de),arithmeticOperator:_(de),logicOperator:_(de),bitwiseOperator:_(de),compareOperator:_(de),updateOperator:_(de),definitionOperator:_(de),typeOperator:_(de),controlOperator:_(de),punctuation:Ie,separator:_(Ie),bracket:ft,angleBracket:_(ft),squareBracket:_(ft),paren:_(ft),brace:_(ft),content:gt,heading:Nt,heading1:_(Nt),heading2:_(Nt),heading3:_(Nt),heading4:_(Nt),heading5:_(Nt),heading6:_(Nt),contentSeparator:_(gt),list:_(gt),quote:_(gt),emphasis:_(gt),strong:_(gt),link:_(gt),monospace:_(gt),strikethrough:_(gt),inserted:_(),deleted:_(),changed:_(),invalid:_(),meta:Kt,documentMeta:_(Kt),annotation:_(Kt),processingInstruction:_(Kt),definition:Rt.defineModifier(),constant:Rt.defineModifier(),function:Rt.defineModifier(),standard:Rt.defineModifier(),local:Rt.defineModifier(),special:Rt.defineModifier()},Kn=cn([{tag:z.link,class:"tok-link"},{tag:z.heading,class:"tok-heading"},{tag:z.emphasis,class:"tok-emphasis"},{tag:z.strong,class:"tok-strong"},{tag:z.keyword,class:"tok-keyword"},{tag:z.atom,class:"tok-atom"},{tag:z.bool,class:"tok-bool"},{tag:z.url,class:"tok-url"},{tag:z.labelName,class:"tok-labelName"},{tag:z.inserted,class:"tok-inserted"},{tag:z.deleted,class:"tok-deleted"},{tag:z.literal,class:"tok-literal"},{tag:z.string,class:"tok-string"},{tag:z.number,class:"tok-number"},{tag:[z.regexp,z.escape,z.special(z.string)],class:"tok-string2"},{tag:z.variableName,class:"tok-variableName"},{tag:z.local(z.variableName),class:"tok-variableName tok-local"},{tag:z.definition(z.variableName),class:"tok-variableName tok-definition"},{tag:z.special(z.variableName),class:"tok-variableName2"},{tag:z.definition(z.propertyName),class:"tok-propertyName tok-definition"},{tag:z.typeName,class:"tok-typeName"},{tag:z.namespace,class:"tok-namespace"},{tag:z.className,class:"tok-className"},{tag:z.macroName,class:"tok-macroName"},{tag:z.propertyName,class:"tok-propertyName"},{tag:z.operator,class:"tok-operator"},{tag:z.comment,class:"tok-comment"},{tag:z.meta,class:"tok-meta"},{tag:z.invalid,class:"tok-invalid"},{tag:z.punctuation,class:"tok-punctuation"}]);var ot=Mt(28699),Oi;const Qe=new Q;function ji(s){return Facet.define({combine:s?e=>e.concat(s):void 0})}const Un=new Q;class $e{constructor(e,n,r=[],l=""){this.data=e,this.name=l,L.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(L.yy.prototype,"tree",{get(){return Ye(this)}}),this.parser=n,this.extension=[A.of(this),L.yy.languageData.of((c,d,g)=>{let w=Bi(c,d,g),M=w.type.prop(Qe);if(!M)return[];let T=c.facet(M),R=w.type.prop(Un);if(R){let H=w.resolve(d-w.from,g);for(let U of R)if(U.test(H,c)){let X=c.facet(U.facet);return U.type=="replace"?X:X.concat(T)}}return T})].concat(r)}isActiveAt(e,n,r=-1){return Bi(e,n,r).type.prop(Qe)==this.data}findRegions(e){let n=e.facet(A);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],l=(c,d)=>{if(c.prop(Qe)==this.data){r.push({from:d,to:d+c.length});return}let g=c.prop(Q.mounted);if(g){if(g.tree.prop(Qe)==this.data){if(g.overlay)for(let w of g.overlay)r.push({from:w.from+d,to:w.to+d});else r.push({from:d,to:d+c.length});return}else if(g.overlay){let w=r.length;if(l(g.tree,g.overlay[0].from+d),r.length>w)return}}for(let w=0;w<c.children.length;w++){let M=c.children[w];M instanceof De&&l(M,c.positions[w]+d)}};return l(Ye(e),0),r}get allowsNesting(){return!0}}$e.setState=L.Py.define();function Bi(s,e,n){let r=s.facet(A),l=Ye(s).topNode;if(!r||r.allowsNesting)for(let c=l;c;c=c.enter(e,n,oe.ExcludeBuffers))c.type.isTop&&(l=c);return l}class ye extends null{constructor(e,n,r){super(e,n,[],r),this.parser=n}static define(e){let n=ji(e.languageData);return new ye(n,e.parser.configure({props:[Qe.add(r=>r.isTop?n:void 0)]}),e.name)}configure(e,n){return new ye(this.data,this.parser.configure(e),n||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ye(s){let e=s.field($e.state,!1);return e?e.tree:De.empty}function dn(s,e,n=50){var r;let l=(r=s.field($e.state,!1))===null||r===void 0?void 0:r.context;if(!l)return null;let c=l.viewport;l.updateViewport({from:0,to:e});let d=l.isDone(e)||l.work(n,e)?l.tree:null;return l.updateViewport(c),d}function pn(s,e=s.doc.length){var n;return((n=s.field($e.state,!1))===null||n===void 0?void 0:n.context.isDone(e))||!1}function Pi(s,e=s.viewport.to,n=100){let r=dn(s.state,e,n);return r!=Ye(s.state)&&s.dispatch({}),!!r}function mn(s){var e;return((e=s.plugin(C))===null||e===void 0?void 0:e.isWorking())||!1}class Gn{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let r=this.cursorPos-this.string.length;return e<r||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-r,n-r)}}let vi=null;class D{constructor(e,n,r=[],l,c,d,g,w){this.parser=e,this.state=n,this.fragments=r,this.tree=l,this.treeLen=c,this.viewport=d,this.skipped=g,this.scheduleOn=w,this.parse=null,this.tempSkipped=[]}static create(e,n,r){return new D(e,n,[],De.empty,0,r,[],null)}startParse(){return this.parser.startParse(new Gn(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=De.empty&&this.isDone(n!=null?n:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let l=Date.now()+e;e=()=>Date.now()>l}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let l=this.parse.advance();if(l)if(this.fragments=this.withoutTempSkipped(ze.addTree(l,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=l,this.parse=null,this.treeLen<(n!=null?n:this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(ze.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=vi;vi=this;try{return e()}finally{vi=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=u(e,n.from,n.to);return e}changes(e,n){let{fragments:r,tree:l,treeLen:c,viewport:d,skipped:g}=this;if(this.takeTree(),!e.empty){let w=[];if(e.iterChangedRanges((M,T,R,H)=>w.push({fromA:M,toA:T,fromB:R,toB:H})),r=ze.applyChanges(r,w),l=De.empty,c=0,d={from:e.mapPos(d.from,-1),to:e.mapPos(d.to,1)},this.skipped.length){g=[];for(let M of this.skipped){let T=e.mapPos(M.from,1),R=e.mapPos(M.to,-1);T<R&&g.push({from:T,to:R})}}}return new D(this.parser,n,r,l,c,d,g,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:l,to:c}=this.skipped[r];l<e.to&&c>e.from&&(this.fragments=u(this.fragments,l,c),this.skipped.splice(r--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends Fi{createParse(n,r,l){let c=l[0].from,d=l[l.length-1].to;return{parsedPos:c,advance(){let w=vi;if(w){for(let M of l)w.tempSkipped.push(M);e&&(w.scheduleOn=w.scheduleOn?Promise.all([w.scheduleOn,e]):e)}return this.parsedPos=d,new De(me.none,[],[],d-c)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return vi}}function u(s,e,n){return ze.applyChanges(s,[{fromA:e,toA:n,fromB:e,toB:n}])}class p{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,r)||n.takeTree(),new p(n)}static init(e){let n=Math.min(3e3,e.doc.length),r=D.create(e.facet(A).parser,e,{from:0,to:n});return r.work(20,n)||r.takeTree(),new p(r)}}$e.state=L.QQ.define({create:p.init,update(s,e){for(let n of e.effects)if(n.is($e.setState))return n.value;return e.startState.facet(A)!=e.state.facet(A)?p.init(e.state):s.apply(e)}});let b=s=>{let e=setTimeout(()=>s(),500);return()=>clearTimeout(e)};typeof requestIdleCallback!="undefined"&&(b=s=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(s,{timeout:500-100})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const v=typeof navigator!="undefined"&&(!((Oi=navigator.scheduling)===null||Oi===void 0)&&Oi.isInputPending)?()=>navigator.scheduling.isInputPending():null,C=W.lg.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field($e.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field($e.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=b(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:l}}=this.view,c=r.field($e.state);if(c.tree==c.context.tree&&c.context.isDone(l+1e5))return;let d=Date.now()+Math.min(this.chunkBudget,100,e&&!v?Math.max(25,e.timeRemaining()-5):1e9),g=c.context.treeLen<l&&r.doc.length>l+1e3,w=c.context.work(()=>v&&v()||Date.now()>d,l+(g?0:1e5));this.chunkBudget-=Date.now()-n,(w||this.chunkBudget<=0)&&(c.context.takeTree(),this.view.dispatch({effects:$e.setState.of(new p(c.context))})),this.chunkBudget>0&&!(w&&!g)&&this.scheduleWork(),this.checkAsyncSchedule(c.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>(0,W.OO)(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),A=L.r$.define({combine(s){return s.length?s[0]:null},enables:s=>[$e.state,C,W.tk.contentAttributes.compute([s],e=>{let n=e.facet(s);return n&&n.name?{"data-language":n.name}:{}})]});class B{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}class E{constructor(e,n,r,l,c,d=void 0){this.name=e,this.alias=n,this.extensions=r,this.filename=l,this.loadFunc=c,this.support=d,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:n,support:r}=e;if(!n){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");n=()=>Promise.resolve(r)}return new E(e.name,(e.alias||[]).concat(e.name).map(l=>l.toLowerCase()),e.extensions||[],e.filename,n,r)}static matchFilename(e,n){for(let l of e)if(l.filename&&l.filename.test(n))return l;let r=/\.([^.]+)$/.exec(n);if(r){for(let l of e)if(l.extensions.indexOf(r[1])>-1)return l}return null}static matchLanguageName(e,n,r=!0){n=n.toLowerCase();for(let l of e)if(l.alias.some(c=>c==n))return l;if(r)for(let l of e)for(let c of l.alias){let d=n.indexOf(c);if(d>-1&&(c.length>2||!/\w/.test(n[d-1])&&!/\w/.test(n[d+c.length])))return l}return null}}const j=L.r$.define(),K=L.r$.define({combine:s=>{if(!s.length)return"  ";let e=s[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(s[0]));return e}});function G(s){let e=s.facet(K);return e.charCodeAt(0)==9?s.tabSize*e.length:e.length}function Z(s,e){let n="",r=s.tabSize,l=s.facet(K)[0];if(l=="	"){for(;e>=r;)n+="	",e-=r;l=" "}for(let c=0;c<e;c++)n+=l;return n}function J(s,e){s instanceof L.yy&&(s=new Ne(s));for(let r of s.state.facet(j)){let l=r(s,e);if(l!==void 0)return l}let n=Ye(s.state);return n.length>=e?gn(s,n,e):null}function Be(s,e,n){let r=Object.create(null),l=new Ne(s,{overrideIndentation:d=>{var g;return(g=r[d])!==null&&g!==void 0?g:-1}}),c=[];for(let d=e;d<=n;){let g=s.doc.lineAt(d);d=g.to+1;let w=J(l,g.from);if(w==null)continue;/\S/.test(g.text)||(w=0);let M=/^\s*/.exec(g.text)[0],T=Z(s,w);M!=T&&(r[g.from]=w,c.push({from:g.from,to:g.from+M.length,insert:T}))}return s.changes(c)}class Ne{constructor(e,n={}){this.state=e,this.options=n,this.unit=G(e)}lineAt(e,n=1){let r=this.state.doc.lineAt(e),{simulateBreak:l,simulateDoubleBreak:c}=this.options;return l!=null&&l>=r.from&&l<=r.to?c&&l==e?{text:"",from:e}:(n<0?l<e:l<=e)?{text:r.text.slice(l-r.from),from:l}:{text:r.text.slice(0,l-r.from),from:r.from}:r}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:l}=this.lineAt(e,n);return r.slice(e-l,Math.min(r.length,e+100-l))}column(e,n=1){let{text:r,from:l}=this.lineAt(e,n),c=this.countColumn(r,e-l),d=this.options.overrideIndentation?this.options.overrideIndentation(l):-1;return d>-1&&(c+=d-this.countColumn(r,r.search(/\S|$/))),c}countColumn(e,n=e.length){return(0,L.IS)(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:r,from:l}=this.lineAt(e,n),c=this.options.overrideIndentation;if(c){let d=c(l);if(d>-1)return d}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Ge=new Q;function gn(s,e,n){let r=e.resolveStack(n),l=r.node.enterUnfinishedNodesBefore(n);if(l!=r.node){let c=[];for(let d=l;d!=r.node;d=d.parent)c.push(d);for(let d=c.length-1;d>=0;d--)r={node:c[d],next:r}}return zi(r,s,n)}function zi(s,e,n){for(let r=s;r;r=r.next){let l=Os(r.node);if(l)return l($i.create(e,n,r))}return 0}function ut(s){return s.pos==s.options.simulateBreak&&s.options.simulateDoubleBreak}function Os(s){let e=s.type.prop(Ge);if(e)return e;let n=s.firstChild,r;if(n&&(r=n.type.prop(Q.closedBy))){let l=s.lastChild,c=l&&r.indexOf(l.name)>-1;return d=>Bs(d,!0,1,void 0,c&&!ut(d)?l.from:void 0)}return s.parent==null?Or:null}function Or(){return 0}class $i extends Ne{constructor(e,n,r){super(e.state,e.options),this.base=e,this.pos=n,this.context=r}get node(){return this.context.node}static create(e,n,r){return new $i(e,n,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(n.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(yn(r,e))break;n=this.state.doc.lineAt(r.from)}return this.lineIndent(n.from)}continue(){return zi(this.context.next,this.base,this.pos)}}function yn(s,e){for(let n=e;n;n=n.parent)if(s==n)return!0;return!1}function Br(s){let e=s.node,n=e.childAfter(e.from),r=e.lastChild;if(!n)return null;let l=s.options.simulateBreak,c=s.state.doc.lineAt(n.from),d=l==null||l<=c.from?c.to:Math.min(c.to,l);for(let g=n.to;;){let w=e.childAfter(g);if(!w||w==r)return null;if(!w.type.isSkipped)return w.from<d?n:null;g=w.to}}function Pr({closing:s,align:e=!0,units:n=1}){return r=>Bs(r,e,n,s)}function Bs(s,e,n,r,l){let c=s.textAfter,d=c.match(/^\s*/)[0].length,g=r&&c.slice(d,d+r.length)==r||l==s.pos+d,w=e?Br(s):null;return w?g?s.column(w.from):s.column(w.to):s.baseIndent+(g?0:s.unit*n)}const rl=s=>s.baseIndent;function ol({except:s,units:e=1}={}){return n=>{let r=s&&s.test(n.textAfter);return n.baseIndent+(r?0:e*n.unit)}}const Lr=200;function bn(){return L.yy.transactionFilter.of(s=>{if(!s.docChanged||!s.isUserEvent("input.type")&&!s.isUserEvent("input.complete"))return s;let e=s.startState.languageDataAt("indentOnInput",s.startState.selection.main.head);if(!e.length)return s;let n=s.newDoc,{head:r}=s.newSelection.main,l=n.lineAt(r);if(r>l.from+Lr)return s;let c=n.sliceString(l.from,r);if(!e.some(M=>M.test(c)))return s;let{state:d}=s,g=-1,w=[];for(let{head:M}of d.selection.ranges){let T=d.doc.lineAt(M);if(T.from==g)continue;g=T.from;let R=J(d,T.from);if(R==null)continue;let H=/^\s*/.exec(T.text)[0],U=Z(d,R);H!=U&&w.push({from:T.from,to:T.from+H.length,insert:U})}return w.length?[s,{changes:w,sequential:!0}]:s})}const Ft=L.r$.define(),_n=new Q;function ll(s){let e=s.firstChild,n=s.lastChild;return e&&e.to<n.from?{from:e.to,to:n.type.isError?s.to:n.from}:null}function al(s,e,n){let r=Ye(s);if(r.length<n)return null;let l=r.resolveStack(n,1),c=null;for(let d=l;d;d=d.next){let g=d.node;if(g.to<=n||g.from>n)continue;if(c&&g.from<e)break;let w=g.type.prop(_n);if(w&&(g.to<r.length-50||r.length==s.doc.length||!hl(g))){let M=w(g,s);M&&M.from<=n&&M.from>=e&&M.to>n&&(c=M)}}return c}function hl(s){let e=s.lastChild;return e&&e.to==s.to&&e.type.isError}function qi(s,e,n){for(let r of s.facet(Ft)){let l=r(s,e,n);if(l)return l}return al(s,e,n)}function Ps(s,e){let n=e.mapPos(s.from,1),r=e.mapPos(s.to,-1);return n>=r?void 0:{from:n,to:r}}const wn=L.Py.define({map:Ps}),Li=L.Py.define({map:Ps});function Ls(s){let e=[];for(let{head:n}of s.state.selection.ranges)e.some(r=>r.from<=n&&r.to>=n)||e.push(s.lineBlockAt(n));return e}const ki=L.QQ.define({create(){return W.p.none},update(s,e){s=s.map(e.changes);for(let n of e.effects)if(n.is(wn)&&!cl(s,n.value.from,n.value.to)){let{preparePlaceholder:r}=e.state.facet(Is),l=r?W.p.replace({widget:new Wr(r(e.state,n.value))}):Hr;s=s.update({add:[l.range(n.value.from,n.value.to)]})}else n.is(Li)&&(s=s.update({filter:(r,l)=>n.value.from!=r||n.value.to!=l,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let n=!1,{head:r}=e.selection.main;s.between(r,r,(l,c)=>{l<r&&c>r&&(n=!0)}),n&&(s=s.update({filterFrom:r,filterTo:r,filter:(l,c)=>c<=r||l>=r}))}return s},provide:s=>W.tk.decorations.from(s),toJSON(s,e){let n=[];return s.between(0,e.doc.length,(r,l)=>{n.push(r,l)}),n},fromJSON(s){if(!Array.isArray(s)||s.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<s.length;){let r=s[n++],l=s[n++];if(typeof r!="number"||typeof l!="number")throw new RangeError("Invalid JSON for fold state");e.push(Hr.range(r,l))}return W.p.set(e,!0)}});function ka(s){return s.field(ki,!1)||RangeSet.empty}function xn(s,e,n){var r;let l=null;return(r=s.field(ki,!1))===null||r===void 0||r.between(e,n,(c,d)=>{(!l||l.from>c)&&(l={from:c,to:d})}),l}function cl(s,e,n){let r=!1;return s.between(e,e,(l,c)=>{l==e&&c==n&&(r=!0)}),r}function Es(s,e){return s.field(ki,!1)?e:e.concat(L.Py.appendConfig.of(Fr()))}const fl=s=>{for(let e of Ls(s)){let n=qi(s.state,e.from,e.to);if(n)return s.dispatch({effects:Es(s.state,[wn.of(n),Ki(s,n)])}),!0}return!1},ul=s=>{if(!s.state.field(ki,!1))return!1;let e=[];for(let n of Ls(s)){let r=xn(s.state,n.from,n.to);r&&e.push(Li.of(r),Ki(s,r,!1))}return e.length&&s.dispatch({effects:e}),e.length>0};function Ki(s,e,n=!0){let r=s.state.doc.lineAt(e.from).number,l=s.state.doc.lineAt(e.to).number;return W.tk.announce.of(`${s.state.phrase(n?"Folded lines":"Unfolded lines")} ${r} ${s.state.phrase("to")} ${l}.`)}const Er=s=>{let{state:e}=s,n=[];for(let r=0;r<e.doc.length;){let l=s.lineBlockAt(r),c=qi(e,l.from,l.to);c&&n.push(wn.of(c)),r=(c?s.lineBlockAt(c.to):l).to+1}return n.length&&s.dispatch({effects:Es(s.state,n)}),!!n.length},Rr=s=>{let e=s.state.field(ki,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,s.state.doc.length,(r,l)=>{n.push(Li.of({from:r,to:l}))}),s.dispatch({effects:n}),!0};function Rs(s,e){for(let n=e;;){let r=qi(s.state,n.from,n.to);if(r&&r.to>e.from)return r;if(!n.from)return null;n=s.lineBlockAt(n.from-1)}}const dl=s=>{let e=[];for(let n of Ls(s)){let r=xn(s.state,n.from,n.to);if(r)e.push(Li.of(r),Ki(s,r,!1));else{let l=Rs(s,n);l&&e.push(wn.of(l),Ki(s,l))}}return e.length>0&&s.dispatch({effects:Es(s.state,e)}),!!e.length},Ir=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:fl},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ul},{key:"Ctrl-Alt-[",run:Er},{key:"Ctrl-Alt-]",run:Rr}],Nr={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Is=L.r$.define({combine(s){return(0,L.BO)(s,Nr)}});function Fr(s){let e=[ki,Fs];return s&&e.push(Is.of(s)),e}function Xn(s,e){let{state:n}=s,r=n.facet(Is),l=d=>{let g=s.lineBlockAt(s.posAtDOM(d.target)),w=xn(s.state,g.from,g.to);w&&s.dispatch({effects:Li.of(w)}),d.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(s,l,e);let c=document.createElement("span");return c.textContent=r.placeholderText,c.setAttribute("aria-label",n.phrase("folded code")),c.title=n.phrase("unfold"),c.className="cm-foldPlaceholder",c.onclick=l,c}const Hr=W.p.replace({widget:new class extends W.l9{toDOM(s){return Xn(s,null)}}});class Wr extends W.l9{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Xn(e,this.value)}}const pl={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Ns extends W.SJ{constructor(e,n){super(),this.config=e,this.open=n}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let n=document.createElement("span");return n.textContent=this.open?this.config.openText:this.config.closedText,n.title=e.state.phrase(this.open?"Fold line":"Unfold line"),n}}function Yn(s={}){let e=Object.assign(Object.assign({},pl),s),n=new Ns(e,!0),r=new Ns(e,!1),l=W.lg.fromClass(class{constructor(d){this.from=d.viewport.from,this.markers=this.buildMarkers(d)}update(d){(d.docChanged||d.viewportChanged||d.startState.facet(A)!=d.state.facet(A)||d.startState.field(ki,!1)!=d.state.field(ki,!1)||Ye(d.startState)!=Ye(d.state)||e.foldingChanged(d))&&(this.markers=this.buildMarkers(d.view))}buildMarkers(d){let g=new L.f_;for(let w of d.viewportLineBlocks){let M=xn(d.state,w.from,w.to)?r:qi(d.state,w.from,w.to)?n:null;M&&g.add(w.from,w.from,M)}return g.finish()}}),{domEventHandlers:c}=e;return[l,(0,W.v5)({class:"cm-foldGutter",markers(d){var g;return((g=d.plugin(l))===null||g===void 0?void 0:g.markers)||L.Xs.empty},initialSpacer(){return new Ns(e,!1)},domEventHandlers:Object.assign(Object.assign({},c),{click:(d,g,w)=>{if(c.click&&c.click(d,g,w))return!0;let M=xn(d.state,g.from,g.to);if(M)return d.dispatch({effects:Li.of(M)}),!0;let T=qi(d.state,g.from,g.to);return T?(d.dispatch({effects:wn.of(T)}),!0):!1}})}),Fr()]}const Fs=W.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class vn{constructor(e,n){this.specs=e;let r;function l(g){let w=ot.V.newName();return(r||(r=Object.create(null)))["."+w]=g,w}const c=typeof n.all=="string"?n.all:n.all?l(n.all):void 0,d=n.scope;this.scope=d instanceof $e?g=>g.prop(Qe)==d.data:d?g=>g==d:void 0,this.style=cn(e.map(g=>({tag:g.tag,class:g.class||l(Object.assign({},g,{tag:null}))})),{all:c}).style,this.module=r?new ot.V(r):null,this.themeType=n.themeType}static define(e,n){return new vn(e,n||{})}}const Jn=L.r$.define(),Vr=L.r$.define({combine(s){return s.length?[s[0]]:null}});function kn(s){let e=s.facet(Jn);return e.length?e:s.facet(Vr)}function jr(s,e){let n=[Zn],r;return s instanceof vn&&(s.module&&n.push(W.tk.styleModule.of(s.module)),r=s.themeType),e!=null&&e.fallback?n.push(Vr.of(s)):r?n.push(Jn.computeN([W.tk.darkTheme],l=>l.facet(W.tk.darkTheme)==(r=="dark")?[s]:[])):n.push(Jn.of(s)),n}function ml(s,e,n){let r=kn(s),l=null;if(r){for(let c of r)if(!c.scope||n&&c.scope(n)){let d=c.style(e);d&&(l=l?l+" "+d:d)}}return l}class Qn{constructor(e){this.markCache=Object.create(null),this.tree=Ye(e.state),this.decorations=this.buildDeco(e,kn(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=Ye(e.state),r=kn(e.state),l=r!=kn(e.startState),{viewport:c}=e.view,d=e.changes.mapPos(this.decoratedTo,1);n.length<c.to&&!l&&n.type==this.tree.type&&d>=c.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=d):(n!=this.tree||e.viewportChanged||l)&&(this.tree=n,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=c.to)}buildDeco(e,n){if(!n||!this.tree.length)return W.p.none;let r=new L.f_;for(let{from:l,to:c}of e.visibleRanges)et(this.tree,n,(d,g,w)=>{r.add(d,g,this.markCache[w]||(this.markCache[w]=W.p.mark({class:w})))},l,c);return r.finish()}}const Zn=L.Wl.high(W.lg.fromClass(Qn,{decorations:s=>s.decorations})),gl=vn.define([{tag:z.meta,color:"#404740"},{tag:z.link,textDecoration:"underline"},{tag:z.heading,textDecoration:"underline",fontWeight:"bold"},{tag:z.emphasis,fontStyle:"italic"},{tag:z.strong,fontWeight:"bold"},{tag:z.strikethrough,textDecoration:"line-through"},{tag:z.keyword,color:"#708"},{tag:[z.atom,z.bool,z.url,z.contentSeparator,z.labelName],color:"#219"},{tag:[z.literal,z.inserted],color:"#164"},{tag:[z.string,z.deleted],color:"#a11"},{tag:[z.regexp,z.escape,z.special(z.string)],color:"#e40"},{tag:z.definition(z.variableName),color:"#00f"},{tag:z.local(z.variableName),color:"#30a"},{tag:[z.typeName,z.namespace],color:"#085"},{tag:z.className,color:"#167"},{tag:[z.special(z.variableName),z.macroName],color:"#256"},{tag:z.definition(z.propertyName),color:"#00c"},{tag:z.comment,color:"#940"},{tag:z.invalid,color:"#f00"}]),yl=W.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),zr=1e4,$r="()[]{}",qr=L.r$.define({combine(s){return(0,L.BO)(s,{afterCursor:!0,brackets:$r,maxScanDistance:zr,renderMatch:Xt})}}),bl=W.p.mark({class:"cm-matchingBracket"}),_t=W.p.mark({class:"cm-nonmatchingBracket"});function Xt(s){let e=[],n=s.matched?bl:_t;return e.push(n.range(s.start.from,s.start.to)),s.end&&e.push(n.range(s.end.from,s.end.to)),e}const xl=[L.QQ.define({create(){return W.p.none},update(s,e){if(!e.docChanged&&!e.selection)return s;let n=[],r=e.state.facet(qr);for(let l of e.state.selection.ranges){if(!l.empty)continue;let c=ti(e.state,l.head,-1,r)||l.head>0&&ti(e.state,l.head-1,1,r)||r.afterCursor&&(ti(e.state,l.head,1,r)||l.head<e.state.doc.length&&ti(e.state,l.head+1,-1,r));c&&(n=n.concat(r.renderMatch(c,e.state)))}return W.p.set(n,!0)},provide:s=>W.tk.decorations.from(s)}),yl];function Kr(s={}){return[qr.of(s),xl]}const Ur=new Q;function es(s,e,n){let r=s.prop(e<0?Q.openedBy:Q.closedBy);if(r)return r;if(s.name.length==1){let l=n.indexOf(s.name);if(l>-1&&l%2==(e<0?1:0))return[n[l+e]]}return null}function ts(s){let e=s.type.prop(Ur);return e?e(s.node):s}function ti(s,e,n,r={}){let l=r.maxScanDistance||zr,c=r.brackets||$r,d=Ye(s),g=d.resolveInner(e,n);for(let w=g;w;w=w.parent){let M=es(w.type,n,c);if(M&&w.from<w.to){let T=ts(w);if(T&&(n>0?e>=T.from&&e<T.to:e>T.from&&e<=T.to))return Gr(s,e,n,w,T,M,c)}}return vl(s,e,n,d,g.type,l,c)}function Gr(s,e,n,r,l,c,d){let g=r.parent,w={from:l.from,to:l.to},M=0,T=g==null?void 0:g.cursor();if(T&&(n<0?T.childBefore(r.from):T.childAfter(r.to)))do if(n<0?T.to<=r.from:T.from>=r.to){if(M==0&&c.indexOf(T.type.name)>-1&&T.from<T.to){let R=ts(T);return{start:w,end:R?{from:R.from,to:R.to}:void 0,matched:!0}}else if(es(T.type,n,d))M++;else if(es(T.type,-n,d)){if(M==0){let R=ts(T);return{start:w,end:R&&R.from<R.to?{from:R.from,to:R.to}:void 0,matched:!1}}M--}}while(n<0?T.prevSibling():T.nextSibling());return{start:w,matched:!1}}function vl(s,e,n,r,l,c,d){let g=n<0?s.sliceDoc(e-1,e):s.sliceDoc(e,e+1),w=d.indexOf(g);if(w<0||w%2==0!=n>0)return null;let M={from:n<0?e-1:e,to:n>0?e+1:e},T=s.doc.iterRange(e,n>0?s.doc.length:0),R=0;for(let H=0;!T.next().done&&H<=c;){let U=T.value;n<0&&(H+=U.length);let X=e+H*n;for(let se=n>0?0:U.length-1,Ae=n>0?U.length:-1;se!=Ae;se+=n){let Te=d.indexOf(U[se]);if(!(Te<0||r.resolveInner(X+se,1).type!=l))if(Te%2==0==n>0)R++;else{if(R==1)return{start:M,end:{from:X+se,to:X+se+1},matched:Te>>1==w>>1};R--}}n>0&&(H+=U.length)}return T.done?{start:M,matched:!1}:null}function Hs(s,e,n,r=0,l=0){e==null&&(e=s.search(/[^\s\u00a0]/),e==-1&&(e=s.length));let c=l;for(let d=r;d<e;d++)s.charCodeAt(d)==9?c+=n-c%n:c++;return c}class Ws{constructor(e,n,r,l){this.string=e,this.tabSize=n,this.indentUnit=r,this.overrideIndent=l,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),r;if(typeof e=="string"?r=n==e:r=n&&(e instanceof RegExp?e.test(n):e(n)),r)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Hs(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:Hs(this.string,null,this.tabSize)}match(e,n,r){if(typeof e=="string"){let l=d=>r?d.toLowerCase():d,c=this.string.substr(this.pos,e.length);return l(c)==l(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let l=this.string.slice(this.pos).match(e);return l&&l.index>0?null:(l&&n!==!1&&(this.pos+=l[0].length),l)}}current(){return this.string.slice(this.start,this.pos)}}function _r(s){return{name:s.name||"",token:s.token,blankLine:s.blankLine||(()=>{}),startState:s.startState||(()=>!0),copyState:s.copyState||Xr,indent:s.indent||(()=>null),languageData:s.languageData||{},tokenTable:s.tokenTable||ns}}function Xr(s){if(typeof s!="object")return s;let e={};for(let n in s){let r=s[n];e[n]=r instanceof Array?r.slice():r}return e}const Yr=new WeakMap;class Jr extends null{constructor(e){let n=ji(e.languageData),r=_r(e),l,c=new class extends Parser{createParse(d,g,w){return new Vs(l,d,g,w)}};super(n,c,[j.of((d,g)=>this.getIndent(d,g))],e.name),this.topNode=yt(n),l=this,this.streamParser=r,this.stateAfter=new NodeProp({perNode:!0}),this.tokenTable=e.tokenTable?new qs(r.tokenTable):ii}static define(e){return new Jr(e)}getIndent(e,n){let r=Ye(e.state),l=r.resolve(n);for(;l&&l.type!=this.topNode;)l=l.parent;if(!l)return null;let c,{overrideIndentation:d}=e.options;d&&(c=Yr.get(e.state),c!=null&&c<n-1e4&&(c=void 0));let g=is(this,r,0,l.from,c!=null?c:n),w,M;if(g?(M=g.state,w=g.pos+1):(M=this.streamParser.startState(e.unit),w=0),n-w>1e4)return null;for(;w<n;){let R=e.state.doc.lineAt(w),H=Math.min(n,R.to);if(R.length){let U=d?d(R.from):-1,X=new Ws(R.text,e.state.tabSize,e.unit,U<0?void 0:U);for(;X.pos<H-R.from;)js(this.streamParser.token,X,M)}else this.streamParser.blankLine(M,e.unit);if(H==n)break;w=R.to+1}let T=e.lineAt(n);return d&&c==null&&Yr.set(e.state,T.from),this.streamParser.indent(M,/^\s*(.*)/.exec(T.text)[1],e)}get allowsNesting(){return!1}}function is(s,e,n,r,l){let c=n>=r&&n+e.length<=l&&e.prop(s.stateAfter);if(c)return{state:s.streamParser.copyState(c),pos:n+e.length};for(let d=e.children.length-1;d>=0;d--){let g=e.children[d],w=n+e.positions[d],M=g instanceof Tree&&w<l&&is(s,g,w,r,l);if(M)return M}return null}function Qr(s,e,n,r,l){if(l&&n<=0&&r>=e.length)return e;!l&&e.type==s.topNode&&(l=!0);for(let c=e.children.length-1;c>=0;c--){let d=e.positions[c],g=e.children[c],w;if(d<r&&g instanceof Tree){if(!(w=Qr(s,g,n-d,r-d,l)))break;return l?new Tree(e.type,e.children.slice(0,c).concat(w),e.positions.slice(0,c+1),d+w.length):w}}return null}function kl(s,e,n,r){for(let l of e){let c=l.from+(l.openStart?25:0),d=l.to-(l.openEnd?25:0),g=c<=n&&d>n&&is(s,l.tree,0-l.offset,n,d),w;if(g&&(w=Qr(s,l.tree,n+l.offset,g.pos+l.offset,!1)))return{state:g.state,tree:w}}return{state:s.streamParser.startState(r?G(r):4),tree:Tree.empty}}class Vs{constructor(e,n,r,l){this.lang=e,this.input=n,this.fragments=r,this.ranges=l,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=l[l.length-1].to;let c=D.get(),d=l[0].from,{state:g,tree:w}=kl(e,r,d,c==null?void 0:c.state);this.state=g,this.parsedPos=this.chunkStart=d+w.length;for(let M=0;M<w.children.length;M++)this.chunks.push(w.children[M]),this.chunkPos.push(w.positions[M]);c&&this.parsedPos<c.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(G(c.state)),c.skipUntilInView(this.parsedPos,c.viewport.from),this.parsedPos=c.viewport.from),this.moveRangeIndex()}advance(){let e=D.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(n,this.chunkStart+2048);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let r=n.indexOf(`
`);r>-1&&(n=n.slice(0,r))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),r=e+n.length;for(let l=this.rangeIndex;;){let c=this.ranges[l].to;if(c>=r||(n=n.slice(0,c-(r-n.length)),l++,l==this.ranges.length))break;let d=this.ranges[l].from,g=this.lineAfter(d);n+=g,r=d+g.length}return{line:n,end:r}}skipGapsTo(e,n,r){for(;;){let l=this.ranges[this.rangeIndex].to,c=e+n;if(r>0?l>c:l>=c)break;let d=this.ranges[++this.rangeIndex].from;n+=d-l}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,r,l,c){if(this.ranges.length>1){c=this.skipGapsTo(n,c,1),n+=c;let d=this.chunk.length;c=this.skipGapsTo(r,c,-1),r+=c,l+=this.chunk.length-d}return this.chunk.push(e,n,r,l),c}parseLine(e){let{line:n,end:r}=this.nextLine(),l=0,{streamParser:c}=this.lang,d=new Ws(n,e?e.state.tabSize:4,e?G(e.state):2);if(d.eol())c.blankLine(this.state,d.indentUnit);else for(;!d.eol();){let g=js(c.token,d,this.state);if(g&&(l=this.emitToken(this.lang.tokenTable.resolve(g),this.parsedPos+d.start,this.parsedPos+d.pos,4,l)),d.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Zr,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Tree(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function js(s,e,n){e.start=e.pos;for(let r=0;r<10;r++){let l=s(e,n);if(e.pos>e.start)return l}throw new Error("Stream parser failed to advance stream.")}const ns=Object.create(null),Ui=[me.none],Zr=new Ee(Ui),eo=[],zs=Object.create(null),$s=Object.create(null);for(let[s,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])$s[s]=Sn(ns,e);class qs{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),$s)}resolve(e){return e?this.table[e]||(this.table[e]=Sn(this.extra,e)):0}}const ii=new qs(ns);function Pe(s,e){eo.indexOf(s)>-1||(eo.push(s),console.warn(e))}function Sn(s,e){let n=[];for(let g of e.split(" ")){let w=[];for(let M of g.split(".")){let T=s[M]||z[M];T?typeof T=="function"?w.length?w=w.map(T):Pe(M,`Modifier ${M} used at start of tag`):w.length?Pe(M,`Tag ${M} used as modifier`):w=Array.isArray(T)?T:[T]:Pe(M,`Unknown highlighting tag ${M}`)}for(let M of w)n.push(M)}if(!n.length)return 0;let r=e.replace(/ /g,"_"),l=r+" "+n.map(g=>g.id),c=zs[l];if(c)return c.id;let d=zs[l]=me.define({id:Ui.length,name:r,props:[an({[r]:n})]});return Ui.push(d),d.id}function yt(s){let e=NodeType.define({id:Ui.length,name:"Document",props:[Qe.add(()=>s)],top:!0});return Ui.push(e),e}function Ks(s){return s.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(s)}function Dt(s){for(let e=s.iter();!e.next().done;)if(Ks(e.value))return!0;return!1}function dt(s){let e=!1;return s.iterChanges((n,r,l,c,d)=>{!e&&Dt(d)&&(e=!0)}),e}const Us=L.r$.define({combine:s=>s.some(e=>e)});function Sl(s={}){let e=[Cl];return s.alwaysIsolate&&e.push(Us.of(!0)),e}const Cl=W.lg.fromClass(class{constructor(s){this.always=s.state.facet(Us)||s.textDirection!=W.Nm.LTR||s.state.facet(W.tk.perLineTextDirection),this.hasRTL=!this.always&&Dt(s.state.doc),this.tree=Ye(s.state),this.decorations=this.always||this.hasRTL?ss(s,this.tree,this.always):W.p.none}update(s){let e=s.state.facet(Us)||s.view.textDirection!=W.Nm.LTR||s.state.facet(W.tk.perLineTextDirection);if(!e&&!this.hasRTL&&dt(s.changes)&&(this.hasRTL=!0),!e&&!this.hasRTL)return;let n=Ye(s.state);(e!=this.always||n!=this.tree||s.docChanged||s.viewportChanged)&&(this.tree=n,this.always=e,this.decorations=ss(s.view,n,e))}},{provide:s=>{function e(n){var r,l;return(l=(r=n.plugin(s))===null||r===void 0?void 0:r.decorations)!==null&&l!==void 0?l:W.p.none}return[W.tk.outerDecorations.of(e),L.Wl.lowest(W.tk.bidiIsolatedRanges.of(e))]}});function ss(s,e,n){let r=new L.f_,l=s.visibleRanges;n||(l=Al(l,s.state.doc));for(let{from:c,to:d}of l)e.iterate({enter:g=>{let w=g.type.prop(Q.isolate);w&&r.add(g.from,g.to,Ml[w])},from:c,to:d});return r.finish()}function Al(s,e){let n=e.iter(),r=0,l=[],c=null;for(let{from:d,to:g}of s)for(d!=r&&(r<d&&n.next(d-r),r=d);;){let w=r,M=r+n.value.length;if(!n.lineBreak&&Ks(n.value)&&(c&&c.to>w-10?c.to=Math.min(g,M):l.push(c={from:w,to:Math.min(g,M)})),r>=g)break;r=M,n.next()}return l}const Ml={rtl:W.p.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:W.Nm.RTL}),ltr:W.p.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:W.Nm.LTR}),auto:W.p.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})},Tl=s=>{let{state:e}=s,n=e.doc.lineAt(e.selection.main.from),r=Ys(s.state,n.from);return r.line?_s(s):r.block?os(s):!1};function Gs(s,e){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let l=s(e,n);return l?(r(n.update(l)),!0):!1}}const _s=Gs(Js,0),Sa=null,Dl=null,rs=Gs(An,0),Ca=null,Xs=null,os=Gs((s,e)=>An(s,e,Cn(e)),0);function Ys(s,e){let n=s.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const Gi=50;function Ol(s,{open:e,close:n},r,l){let c=s.sliceDoc(r-Gi,r),d=s.sliceDoc(l,l+Gi),g=/\s*$/.exec(c)[0].length,w=/^\s*/.exec(d)[0].length,M=c.length-g;if(c.slice(M-e.length,M)==e&&d.slice(w,w+n.length)==n)return{open:{pos:r-g,margin:g&&1},close:{pos:l+w,margin:w&&1}};let T,R;l-r<=2*Gi?T=R=s.sliceDoc(r,l):(T=s.sliceDoc(r,r+Gi),R=s.sliceDoc(l-Gi,l));let H=/^\s*/.exec(T)[0].length,U=/\s*$/.exec(R)[0].length,X=R.length-U-n.length;return T.slice(H,H+e.length)==e&&R.slice(X,X+n.length)==n?{open:{pos:r+H+e.length,margin:/\s/.test(T.charAt(H+e.length))?1:0},close:{pos:l-U-n.length,margin:/\s/.test(R.charAt(X-1))?1:0}}:null}function Cn(s){let e=[];for(let n of s.selection.ranges){let r=s.doc.lineAt(n.from),l=n.to<=r.to?r:s.doc.lineAt(n.to),c=e.length-1;c>=0&&e[c].to>r.from?e[c].to=l.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:l.to})}return e}function An(s,e,n=e.selection.ranges){let r=n.map(c=>Ys(e,c.from).block);if(!r.every(c=>c))return null;let l=n.map((c,d)=>Ol(e,r[d],c.from,c.to));if(s!=2&&!l.every(c=>c))return{changes:e.changes(n.map((c,d)=>l[d]?[]:[{from:c.from,insert:r[d].open+" "},{from:c.to,insert:" "+r[d].close}]))};if(s!=1&&l.some(c=>c)){let c=[];for(let d=0,g;d<l.length;d++)if(g=l[d]){let w=r[d],{open:M,close:T}=g;c.push({from:M.pos-w.open.length,to:M.pos+M.margin},{from:T.pos-T.margin,to:T.pos+w.close.length})}return{changes:c}}return null}function Js(s,e,n=e.selection.ranges){let r=[],l=-1;for(let{from:c,to:d}of n){let g=r.length,w=1e9,M=Ys(e,c).line;if(M){for(let T=c;T<=d;){let R=e.doc.lineAt(T);if(R.from>l&&(c==d||d>R.from)){l=R.from;let H=/^\s*/.exec(R.text)[0].length,U=H==R.length,X=R.text.slice(H,H+M.length)==M?H:-1;H<R.text.length&&H<w&&(w=H),r.push({line:R,comment:X,token:M,indent:H,empty:U,single:!1})}T=R.to+1}if(w<1e9)for(let T=g;T<r.length;T++)r[T].indent<r[T].line.text.length&&(r[T].indent=w);r.length==g+1&&(r[g].single=!0)}}if(s!=2&&r.some(c=>c.comment<0&&(!c.empty||c.single))){let c=[];for(let{line:g,token:w,indent:M,empty:T,single:R}of r)(R||!T)&&c.push({from:g.from+M,insert:w+" "});let d=e.changes(c);return{changes:d,selection:e.selection.map(d,1)}}else if(s!=1&&r.some(c=>c.comment>=0)){let c=[];for(let{line:d,comment:g,token:w}of r)if(g>=0){let M=d.from+g,T=M+w.length;d.text[T-d.from]==" "&&T++,c.push({from:M,to:T})}return{changes:c}}return null}const Mn=L.q6.define(),to=L.q6.define(),io=L.r$.define(),Qs=L.r$.define({combine(s){return(0,L.BO)(s,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(r,l)=>e(r,l)||n(r,l)})}}),Tn=L.QQ.define({create(){return ni.empty},update(s,e){let n=e.state.facet(Qs),r=e.annotation(Mn);if(r){let w=Ot.fromTransaction(e,r.selection),M=r.side,T=M==0?s.undone:s.done;return w?T=cs(T,T.length,n.minDepth,w):T=be(T,e.startState.selection),new ni(M==0?r.rest:T,M==0?T:r.rest)}let l=e.annotation(to);if((l=="full"||l=="before")&&(s=s.isolate()),e.annotation(L.YW.addToHistory)===!1)return e.changes.empty?s:s.addMapping(e.changes.desc);let c=Ot.fromTransaction(e),d=e.annotation(L.YW.time),g=e.annotation(L.YW.userEvent);return c?s=s.addChanges(c,d,g,n,e):e.selection&&(s=s.addSelection(e.startState.selection,d,g,n.newGroupDelay)),(l=="full"||l=="after")&&(s=s.isolate()),s},toJSON(s){return{done:s.done.map(e=>e.toJSON()),undone:s.undone.map(e=>e.toJSON())}},fromJSON(s){return new ni(s.done.map(Ot.fromJSON),s.undone.map(Ot.fromJSON))}});function Bl(s={}){return[Tn,Qs.of(s),W.tk.domEventHandlers({beforeinput(e,n){let r=e.inputType=="historyUndo"?no:e.inputType=="historyRedo"?hs:null;return r?(e.preventDefault(),r(n)):!1}})]}const ls=null;function as(s,e){return function({state:n,dispatch:r}){if(!e&&n.readOnly)return!1;let l=n.field(Tn,!1);if(!l)return!1;let c=l.pop(s,n,e);return c?(r(c),!0):!1}}const no=as(0,!1),hs=as(1,!1),so=as(0,!0),Pl=as(1,!0);function Ll(s){return function(e){let n=e.field(Tn,!1);if(!n)return 0;let r=s==0?n.done:n.undone;return r.length-(r.length&&!r[0].changes?1:0)}}const Aa=null,Ma=null;class Ot{constructor(e,n,r,l,c){this.changes=e,this.effects=n,this.mapped=r,this.startSelection=l,this.selectionsAfter=c}setSelAfter(e){return new Ot(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(l=>l.toJSON())}}static fromJSON(e){return new Ot(e.changes&&L.as.fromJSON(e.changes),[],e.mapped&&L.n0.fromJSON(e.mapped),e.startSelection&&L.jT.fromJSON(e.startSelection),e.selectionsAfter.map(L.jT.fromJSON))}static fromTransaction(e,n){let r=Ht;for(let l of e.startState.facet(io)){let c=l(e);c.length&&(r=r.concat(c))}return!r.length&&e.changes.empty?null:new Ot(e.changes.invert(e.startState.doc),r,void 0,n||e.startState.selection,Ht)}static selection(e){return new Ot(void 0,Ht,void 0,void 0,e)}}function cs(s,e,n,r){let l=e+1>n+20?e-n-1:0,c=s.slice(l,e);return c.push(r),c}function El(s,e){let n=[],r=!1;return s.iterChangedRanges((l,c)=>n.push(l,c)),e.iterChangedRanges((l,c,d,g)=>{for(let w=0;w<n.length;){let M=n[w++],T=n[w++];g>=M&&d<=T&&(r=!0)}}),r}function Zs(s,e){return s.ranges.length==e.ranges.length&&s.ranges.filter((n,r)=>n.empty!=e.ranges[r].empty).length===0}function ro(s,e){return s.length?e.length?s.concat(e):s:e}const Ht=[],Rl=200;function be(s,e){if(s.length){let n=s[s.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-Rl));return r.length&&r[r.length-1].eq(e)?s:(r.push(e),cs(s,s.length-1,1e9,n.setSelAfter(r)))}else return[Ot.selection([e])]}function Il(s){let e=s[s.length-1],n=s.slice();return n[s.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function fs(s,e){if(!s.length)return s;let n=s.length,r=Ht;for(;n;){let l=us(s[n-1],e,r);if(l.changes&&!l.changes.empty||l.effects.length){let c=s.slice(0,n);return c[n-1]=l,c}else e=l.mapped,n--,r=l.selectionsAfter}return r.length?[Ot.selection(r)]:Ht}function us(s,e,n){let r=ro(s.selectionsAfter.length?s.selectionsAfter.map(g=>g.map(e)):Ht,n);if(!s.changes)return Ot.selection(r);let l=s.changes.map(e),c=e.mapDesc(s.changes,!0),d=s.mapped?s.mapped.composeDesc(c):c;return new Ot(l,L.Py.mapEffects(s.effects,e),d,s.startSelection.map(c),r)}const oo=/^(input\.type|delete)($|\.)/;class ni{constructor(e,n,r=0,l=void 0){this.done=e,this.undone=n,this.prevTime=r,this.prevUserEvent=l}isolate(){return this.prevTime?new ni(this.done,this.undone):this}addChanges(e,n,r,l,c){let d=this.done,g=d[d.length-1];return g&&g.changes&&!g.changes.empty&&e.changes&&(!r||oo.test(r))&&(!g.selectionsAfter.length&&n-this.prevTime<l.newGroupDelay&&l.joinToEvent(c,El(g.changes,e.changes))||r=="input.type.compose")?d=cs(d,d.length-1,l.minDepth,new Ot(e.changes.compose(g.changes),ro(e.effects,g.effects),g.mapped,g.startSelection,Ht)):d=cs(d,d.length,l.minDepth,e),new ni(d,Ht,n,r)}addSelection(e,n,r,l){let c=this.done.length?this.done[this.done.length-1].selectionsAfter:Ht;return c.length>0&&n-this.prevTime<l&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&Zs(c[c.length-1],e)?this:new ni(be(this.done,e),this.undone,n,r)}addMapping(e){return new ni(fs(this.done,e),fs(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,r){let l=e==0?this.done:this.undone;if(l.length==0)return null;let c=l[l.length-1],d=c.selectionsAfter[0]||n.selection;if(r&&c.selectionsAfter.length)return n.update({selection:c.selectionsAfter[c.selectionsAfter.length-1],annotations:Mn.of({side:e,rest:Il(l),selection:d}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(c.changes){let g=l.length==1?Ht:l.slice(0,l.length-1);return c.mapped&&(g=fs(g,c.mapped)),n.update({changes:c.changes,selection:c.startSelection,effects:c.effects,annotations:Mn.of({side:e,rest:g,selection:d}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}ni.empty=new ni(Ht,Ht);const Nl=[{key:"Mod-z",run:no,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:hs,preventDefault:!0},{linux:"Ctrl-Shift-z",run:hs,preventDefault:!0},{key:"Mod-u",run:so,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Pl,preventDefault:!0}];function li(s,e){return L.jT.create(s.ranges.map(e),s.mainIndex)}function si(s,e){return s.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Wt({state:s,dispatch:e},n){let r=li(s.selection,n);return r.eq(s.selection,!0)?!1:(e(si(s,r)),!0)}function _i(s,e){return L.jT.cursor(e?s.to:s.from)}function Dn(s,e){return Wt(s,n=>n.empty?s.moveByChar(n,e):_i(n,e))}function bt(s){return s.textDirectionAt(s.state.selection.main.head)==W.Nm.LTR}const ai=s=>Dn(s,!bt(s)),lo=s=>Dn(s,bt(s)),Ta=s=>Dn(s,!0),Fl=s=>Dn(s,!1);function Si(s,e){return Wt(s,n=>n.empty?s.moveByGroup(n,e):_i(n,e))}const ao=s=>Si(s,!bt(s)),ho=s=>Si(s,bt(s)),Da=s=>Si(s,!0),Oa=s=>Si(s,!1),co=typeof Intl!="undefined"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function On(s,e,n){let r=s.state.charCategorizer(e.from),l=CharCategory.Space,c=e.from,d=0,g=!1,w=!1,M=!1,T=H=>{if(g)return!1;c+=n?H.length:-H.length;let U=r(H),X;if(U==CharCategory.Word&&H.charCodeAt(0)<128&&/[\W_]/.test(H)&&(U=-1),l==CharCategory.Space&&(l=U),l!=U)return!1;if(l==CharCategory.Word)if(H.toLowerCase()==H){if(!n&&w)return!1;M=!0}else if(M){if(n)return!1;g=!0}else{if(w&&n&&r(X=s.state.sliceDoc(c,c+1))==CharCategory.Word&&X.toLowerCase()==X)return!1;w=!0}return d++,!0},R=s.moveByChar(e,n,H=>(T(H),T));if(co&&l==CharCategory.Word&&R.from==e.from+d*(n?1:-1)){let H=Math.min(e.head,R.head),U=Math.max(e.head,R.head),X=s.state.sliceDoc(H,U);if(X.length>1&&/[\u4E00-\uffff]/.test(X)){let se=Array.from(co.segment(X));if(se.length>1)return n?EditorSelection.cursor(e.head+se[1].index,-1):EditorSelection.cursor(R.head+se[se.length-1].index,1)}}return R}function er(s,e){return Wt(s,n=>n.empty?On(s,n,e):_i(n,e))}const Hl=s=>er(s,!0),Bn=s=>er(s,!1);function Wl(s,e,n){if(e.type.prop(n))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(s.sliceDoc(e.from,e.to)))||e.firstChild}function tr(s,e,n){let r=Ye(s).resolveInner(e.head),l=n?Q.closedBy:Q.openedBy;for(let w=e.head;;){let M=n?r.childAfter(w):r.childBefore(w);if(!M)break;Wl(s,M,l)?r=M:w=n?M.to:M.from}let c=r.type.prop(l),d,g;return c&&(d=n?ti(s,r.from,1):ti(s,r.to,-1))&&d.matched?g=n?d.end.to:d.end.from:g=n?r.to:r.from,L.jT.cursor(g,n?-1:1)}const fo=s=>Wt(s,e=>tr(s.state,e,!bt(s))),Vl=s=>Wt(s,e=>tr(s.state,e,bt(s)));function ir(s,e){return Wt(s,n=>{if(!n.empty)return _i(n,e);let r=s.moveVertically(n,e);return r.head!=n.head?r:s.moveToLineBoundary(n,e)})}const uo=s=>ir(s,!1),ds=s=>ir(s,!0);function po(s){let e=s.scrollDOM.clientHeight<s.scrollDOM.scrollHeight-2,n=0,r=0,l;if(e){for(let c of s.state.facet(W.tk.scrollMargins)){let d=c(s);d!=null&&d.top&&(n=Math.max(d==null?void 0:d.top,n)),d!=null&&d.bottom&&(r=Math.max(d==null?void 0:d.bottom,r))}l=s.scrollDOM.clientHeight-n-r}else l=(s.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:e,height:Math.max(s.defaultLineHeight,l-5)}}function nr(s,e){let n=po(s),{state:r}=s,l=li(r.selection,d=>d.empty?s.moveVertically(d,e,n.height):_i(d,e));if(l.eq(r.selection))return!1;let c;if(n.selfScroll){let d=s.coordsAtPos(r.selection.main.head),g=s.scrollDOM.getBoundingClientRect(),w=g.top+n.marginTop,M=g.bottom-n.marginBottom;d&&d.top>w&&d.bottom<M&&(c=W.tk.scrollIntoView(l.main.head,{y:"start",yMargin:d.top-w}))}return s.dispatch(si(r,l),{effects:c}),!0}const Xi=s=>nr(s,!1),sr=s=>nr(s,!0);function Ci(s,e,n){let r=s.lineBlockAt(e.head),l=s.moveToLineBoundary(e,n);if(l.head==e.head&&l.head!=(n?r.to:r.from)&&(l=s.moveToLineBoundary(e,n,!1)),!n&&l.head==r.from&&r.length){let c=/^\s*/.exec(s.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;c&&e.head!=r.from+c&&(l=L.jT.cursor(r.from+c))}return l}const mo=s=>Wt(s,e=>Ci(s,e,!0)),jl=s=>Wt(s,e=>Ci(s,e,!1)),rr=s=>Wt(s,e=>Ci(s,e,!bt(s))),or=s=>Wt(s,e=>Ci(s,e,bt(s))),zl=s=>Wt(s,e=>L.jT.cursor(s.lineBlockAt(e.head).from,1)),$l=s=>Wt(s,e=>L.jT.cursor(s.lineBlockAt(e.head).to,-1));function ps(s,e,n){let r=!1,l=li(s.selection,c=>{let d=ti(s,c.head,-1)||ti(s,c.head,1)||c.head>0&&ti(s,c.head-1,1)||c.head<s.doc.length&&ti(s,c.head+1,-1);if(!d||!d.end)return c;r=!0;let g=d.start.from==c.head?d.end.to:d.end.from;return n?L.jT.range(c.anchor,g):L.jT.cursor(g)});return r?(e(si(s,l)),!0):!1}const ql=({state:s,dispatch:e})=>ps(s,e,!1),lr=({state:s,dispatch:e})=>ps(s,e,!0);function Vt(s,e){let n=li(s.state.selection,r=>{let l=e(r);return L.jT.range(r.anchor,l.head,l.goalColumn,l.bidiLevel||void 0)});return n.eq(s.state.selection)?!1:(s.dispatch(si(s.state,n)),!0)}function Pn(s,e){return Vt(s,n=>s.moveByChar(n,e))}const go=s=>Pn(s,!bt(s)),yo=s=>Pn(s,bt(s)),Ba=s=>Pn(s,!0),Pa=s=>Pn(s,!1);function ms(s,e){return Vt(s,n=>s.moveByGroup(n,e))}const bo=s=>ms(s,!bt(s)),La=s=>ms(s,bt(s)),Ea=s=>ms(s,!0),Ra=s=>ms(s,!1);function wo(s,e){return Vt(s,n=>On(s,n,e))}const Ia=s=>wo(s,!0),Na=s=>wo(s,!1),ar=s=>Vt(s,e=>tr(s.state,e,!bt(s))),Kl=s=>Vt(s,e=>tr(s.state,e,bt(s)));function xo(s,e){return Vt(s,n=>s.moveVertically(n,e))}const hr=s=>xo(s,!1),vo=s=>xo(s,!0);function ko(s,e){return Vt(s,n=>s.moveVertically(n,e,po(s).height))}const So=s=>ko(s,!1),Co=s=>ko(s,!0),Ul=s=>Vt(s,e=>Ci(s,e,!0)),Ln=s=>Vt(s,e=>Ci(s,e,!1)),Ao=s=>Vt(s,e=>Ci(s,e,!bt(s))),Fa=s=>Vt(s,e=>Ci(s,e,bt(s))),Gl=s=>Vt(s,e=>L.jT.cursor(s.lineBlockAt(e.head).from)),gs=s=>Vt(s,e=>L.jT.cursor(s.lineBlockAt(e.head).to)),cr=({state:s,dispatch:e})=>(e(si(s,{anchor:0})),!0),En=({state:s,dispatch:e})=>(e(si(s,{anchor:s.doc.length})),!0),Mo=({state:s,dispatch:e})=>(e(si(s,{anchor:s.selection.main.anchor,head:0})),!0),To=({state:s,dispatch:e})=>(e(si(s,{anchor:s.selection.main.anchor,head:s.doc.length})),!0),fr=({state:s,dispatch:e})=>(e(s.update({selection:{anchor:0,head:s.doc.length},userEvent:"select"})),!0),Rn=({state:s,dispatch:e})=>{let n=In(s).map(({from:r,to:l})=>L.jT.range(r,Math.min(l+1,s.doc.length)));return e(s.update({selection:L.jT.create(n),userEvent:"select"})),!0},ys=({state:s,dispatch:e})=>{let n=li(s.selection,r=>{var l;let c=Ye(s).resolveStack(r.from,1);for(let d=c;d;d=d.next){let{node:g}=d;if((g.from<r.from&&g.to>=r.to||g.to>r.to&&g.from<=r.from)&&(!((l=g.parent)===null||l===void 0)&&l.parent))return L.jT.range(g.to,g.from)}return r});return e(si(s,n)),!0},_l=({state:s,dispatch:e})=>{let n=s.selection,r=null;return n.ranges.length>1?r=L.jT.create([n.main]):n.main.empty||(r=L.jT.create([L.jT.cursor(n.main.head)])),r?(e(si(s,r)),!0):!1};function Yi(s,e){if(s.state.readOnly)return!1;let n="delete.selection",{state:r}=s,l=r.changeByRange(c=>{let{from:d,to:g}=c;if(d==g){let w=e(c);w<d?(n="delete.backward",w=Ei(s,w,!1)):w>d&&(n="delete.forward",w=Ei(s,w,!0)),d=Math.min(d,w),g=Math.max(g,w)}else d=Ei(s,d,!1),g=Ei(s,g,!0);return d==g?{range:c}:{changes:{from:d,to:g},range:L.jT.cursor(d,d<c.head?-1:1)}});return l.changes.empty?!1:(s.dispatch(r.update(l,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?W.tk.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Ei(s,e,n){if(s instanceof W.tk)for(let r of s.state.facet(W.tk.atomicRanges).map(l=>l(s)))r.between(e,e,(l,c)=>{l<e&&c>e&&(e=n?c:l)});return e}const Do=(s,e)=>Yi(s,n=>{let r=n.from,{state:l}=s,c=l.doc.lineAt(r),d,g;if(!e&&r>c.from&&r<c.from+200&&!/[^ \t]/.test(d=c.text.slice(0,r-c.from))){if(d[d.length-1]=="	")return r-1;let w=(0,L.IS)(d,l.tabSize),M=w%G(l)||G(l);for(let T=0;T<M&&d[d.length-1-T]==" ";T++)r--;g=r}else g=(0,L.cp)(c.text,r-c.from,e,e)+c.from,g==r&&c.number!=(e?l.doc.lines:1)?g+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(c.text.slice(g-c.from,r-c.from))&&(g=(0,L.cp)(c.text,g-c.from,!1,!1)+c.from);return g}),ur=s=>Do(s,!1),Oo=s=>Do(s,!0),Bo=(s,e)=>Yi(s,n=>{let r=n.head,{state:l}=s,c=l.doc.lineAt(r),d=l.charCategorizer(r);for(let g=null;;){if(r==(e?c.to:c.from)){r==n.head&&c.number!=(e?l.doc.lines:1)&&(r+=e?1:-1);break}let w=(0,L.cp)(c.text,r-c.from,e)+c.from,M=c.text.slice(Math.min(r,w)-c.from,Math.max(r,w)-c.from),T=d(M);if(g!=null&&T!=g)break;(M!=" "||r!=n.head)&&(g=T),r=w}return r}),Xl=s=>Bo(s,!1),Yl=s=>Bo(s,!0),Ha=s=>Yi(s,e=>{let n=s.lineBlockAt(e.head).to;return e.head<n?n:Math.min(s.state.doc.length,e.head+1)}),$h=s=>Yi(s,e=>{let n=s.lineBlockAt(e.head).from;return e.head>n?n:Math.max(0,e.head-1)}),dr=s=>Yi(s,e=>{let n=s.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),Wa=s=>Yi(s,e=>{let n=s.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(s.state.doc.length,e.head+1)}),Va=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let n=[];for(let r=0,l="",c=s.doc.iter();;){if(c.next(),c.lineBreak||c.done){let d=l.search(/\s+$/);if(d>-1&&n.push({from:r-(l.length-d),to:r}),c.done)break;l=""}else l=c.value;r+=c.value.length}return n.length?(e(s.update({changes:n,userEvent:"delete"})),!0):!1},Po=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let n=s.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:L.xv.of(["",""])},range:L.jT.cursor(r.from)}));return e(s.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},bs=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let n=s.changeByRange(r=>{if(!r.empty||r.from==0||r.from==s.doc.length)return{range:r};let l=r.from,c=s.doc.lineAt(l),d=l==c.from?l-1:(0,L.cp)(c.text,l-c.from,!1)+c.from,g=l==c.to?l+1:(0,L.cp)(c.text,l-c.from,!0)+c.from;return{changes:{from:d,to:g,insert:s.doc.slice(l,g).append(s.doc.slice(d,l))},range:L.jT.cursor(g)}});return n.changes.empty?!1:(e(s.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function In(s){let e=[],n=-1;for(let r of s.selection.ranges){let l=s.doc.lineAt(r.from),c=s.doc.lineAt(r.to);if(!r.empty&&r.to==c.from&&(c=s.doc.lineAt(r.to-1)),n>=l.number){let d=e[e.length-1];d.to=c.to,d.ranges.push(r)}else e.push({from:l.from,to:c.to,ranges:[r]});n=c.number+1}return e}function ws(s,e,n){if(s.readOnly)return!1;let r=[],l=[];for(let c of In(s)){if(n?c.to==s.doc.length:c.from==0)continue;let d=s.doc.lineAt(n?c.to+1:c.from-1),g=d.length+1;if(n){r.push({from:c.to,to:d.to},{from:c.from,insert:d.text+s.lineBreak});for(let w of c.ranges)l.push(L.jT.range(Math.min(s.doc.length,w.anchor+g),Math.min(s.doc.length,w.head+g)))}else{r.push({from:d.from,to:c.from},{from:c.to,insert:s.lineBreak+d.text});for(let w of c.ranges)l.push(L.jT.range(w.anchor-g,w.head-g))}}return r.length?(e(s.update({changes:r,scrollIntoView:!0,selection:L.jT.create(l,s.selection.mainIndex),userEvent:"move.line"})),!0):!1}const hi=({state:s,dispatch:e})=>ws(s,e,!1),xs=({state:s,dispatch:e})=>ws(s,e,!0);function Lo(s,e,n){if(s.readOnly)return!1;let r=[];for(let l of In(s))n?r.push({from:l.from,insert:s.doc.slice(l.from,l.to)+s.lineBreak}):r.push({from:l.to,insert:s.lineBreak+s.doc.slice(l.from,l.to)});return e(s.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Nn=({state:s,dispatch:e})=>Lo(s,e,!1),Jl=({state:s,dispatch:e})=>Lo(s,e,!0),pr=s=>{if(s.state.readOnly)return!1;let{state:e}=s,n=e.changes(In(e).map(({from:l,to:c})=>(l>0?l--:c<e.doc.length&&c++,{from:l,to:c}))),r=li(e.selection,l=>s.moveVertically(l,!0)).map(n);return s.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0},Ql=({state:s,dispatch:e})=>(e(s.update(s.replaceSelection(s.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function Zl(s,e){if(/\(\)|\[\]|\{\}/.test(s.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Ye(s).resolveInner(e),r=n.childBefore(e),l=n.childAfter(e),c;return r&&l&&r.to<=e&&l.from>=e&&(c=r.type.prop(Q.closedBy))&&c.indexOf(l.name)>-1&&s.doc.lineAt(r.to).from==s.doc.lineAt(l.from).from&&!/\S/.test(s.sliceDoc(r.to,l.from))?{from:r.to,to:l.from}:null}const Eo=Ro(!1),mr=Ro(!0);function Ro(s){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(l=>{let{from:c,to:d}=l,g=e.doc.lineAt(c),w=!s&&c==d&&Zl(e,c);s&&(c=d=(d<=g.to?g:e.doc.lineAt(d)).to);let M=new Ne(e,{simulateBreak:c,simulateDoubleBreak:!!w}),T=J(M,c);for(T==null&&(T=(0,L.IS)(/^\s*/.exec(e.doc.lineAt(c).text)[0],e.tabSize));d<g.to&&/\s/.test(g.text[d-g.from]);)d++;w?{from:c,to:d}=w:c>g.from&&c<g.from+100&&!/\S/.test(g.text.slice(0,c))&&(c=g.from);let R=["",Z(e,T)];return w&&R.push(Z(e,M.lineIndent(g.from,-1))),{changes:{from:c,to:d,insert:L.xv.of(R)},range:L.jT.cursor(c+1+R[1].length)}});return n(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function vs(s,e){let n=-1;return s.changeByRange(r=>{let l=[];for(let d=r.from;d<=r.to;){let g=s.doc.lineAt(d);g.number>n&&(r.empty||r.to>g.from)&&(e(g,l,r),n=g.number),d=g.to+1}let c=s.changes(l);return{changes:l,range:L.jT.range(c.mapPos(r.anchor,1),c.mapPos(r.head,1))}})}const Io=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let n=Object.create(null),r=new Ne(s,{overrideIndentation:c=>{let d=n[c];return d==null?-1:d}}),l=vs(s,(c,d,g)=>{let w=J(r,c.from);if(w==null)return;/\S/.test(c.text)||(w=0);let M=/^\s*/.exec(c.text)[0],T=Z(s,w);(M!=T||g.from<c.from+M.length)&&(n[c.from]=w,d.push({from:c.from,to:c.from+M.length,insert:T}))});return l.changes.empty||e(s.update(l,{userEvent:"indent"})),!0},gr=({state:s,dispatch:e})=>s.readOnly?!1:(e(s.update(vs(s,(n,r)=>{r.push({from:n.from,insert:s.facet(K)})}),{userEvent:"input.indent"})),!0),No=({state:s,dispatch:e})=>s.readOnly?!1:(e(s.update(vs(s,(n,r)=>{let l=/^\s*/.exec(n.text)[0];if(!l)return;let c=(0,L.IS)(l,s.tabSize),d=0,g=Z(s,Math.max(0,c-G(s)));for(;d<l.length&&d<g.length&&l.charCodeAt(d)==g.charCodeAt(d);)d++;r.push({from:n.from+d,to:n.from+l.length,insert:g.slice(d)})}),{userEvent:"delete.dedent"})),!0),Fn=({state:s,dispatch:e})=>s.selection.ranges.some(n=>!n.empty)?gr({state:s,dispatch:e}):(e(s.update(s.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),yr=[{key:"Ctrl-b",run:ai,shift:go,preventDefault:!0},{key:"Ctrl-f",run:lo,shift:yo},{key:"Ctrl-p",run:uo,shift:hr},{key:"Ctrl-n",run:ds,shift:vo},{key:"Ctrl-a",run:zl,shift:Gl},{key:"Ctrl-e",run:$l,shift:gs},{key:"Ctrl-d",run:Oo},{key:"Ctrl-h",run:ur},{key:"Ctrl-k",run:Ha},{key:"Ctrl-Alt-h",run:Xl},{key:"Ctrl-o",run:Po},{key:"Ctrl-t",run:bs},{key:"Ctrl-v",run:sr}],br=[{key:"ArrowLeft",run:ai,shift:go,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ao,shift:bo,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:rr,shift:Ao,preventDefault:!0},{key:"ArrowRight",run:lo,shift:yo,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ho,shift:La,preventDefault:!0},{mac:"Cmd-ArrowRight",run:or,shift:Fa,preventDefault:!0},{key:"ArrowUp",run:uo,shift:hr,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cr,shift:Mo},{mac:"Ctrl-ArrowUp",run:Xi,shift:So},{key:"ArrowDown",run:ds,shift:vo,preventDefault:!0},{mac:"Cmd-ArrowDown",run:En,shift:To},{mac:"Ctrl-ArrowDown",run:sr,shift:Co},{key:"PageUp",run:Xi,shift:So},{key:"PageDown",run:sr,shift:Co},{key:"Home",run:jl,shift:Ln,preventDefault:!0},{key:"Mod-Home",run:cr,shift:Mo},{key:"End",run:mo,shift:Ul,preventDefault:!0},{key:"Mod-End",run:En,shift:To},{key:"Enter",run:Eo},{key:"Mod-a",run:fr},{key:"Backspace",run:ur,shift:ur},{key:"Delete",run:Oo},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Xl},{key:"Mod-Delete",mac:"Alt-Delete",run:Yl},{mac:"Mod-Backspace",run:dr},{mac:"Mod-Delete",run:Wa}].concat(yr.map(s=>({mac:s.key,run:s.run,shift:s.shift}))),ea=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:fo,shift:ar},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Vl,shift:Kl},{key:"Alt-ArrowUp",run:hi},{key:"Shift-Alt-ArrowUp",run:Nn},{key:"Alt-ArrowDown",run:xs},{key:"Shift-Alt-ArrowDown",run:Jl},{key:"Escape",run:_l},{key:"Mod-Enter",run:mr},{key:"Alt-l",mac:"Ctrl-l",run:Rn},{key:"Mod-i",run:ys,preventDefault:!0},{key:"Mod-[",run:No},{key:"Mod-]",run:gr},{key:"Mod-Alt-\\",run:Io},{key:"Shift-Mod-k",run:pr},{key:"Shift-Mod-\\",run:ql},{key:"Mod-/",run:Tl},{key:"Alt-A",run:rs}].concat(br),ta={key:"Tab",run:gr,shift:No};function Le(){var s=arguments[0];typeof s=="string"&&(s=document.createElement(s));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var l=n[r];typeof l=="string"?s.setAttribute(r,l):l!=null&&(s[r]=l)}e++}for(;e<arguments.length;e++)Fo(s,arguments[e]);return s}function Fo(s,e){if(typeof e=="string")s.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)s.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)Fo(s,e[n]);else throw new RangeError("Unsupported child node: "+e)}const Ho=typeof String.prototype.normalize=="function"?s=>s.normalize("NFKD"):s=>s;class Ji{constructor(e,n,r=0,l=e.length,c,d){this.test=d,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,l),this.bufferStart=r,this.normalize=c?g=>c(Ho(g)):Ho,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,L.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=(0,L.bg)(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=(0,L.nZ)(e);let l=this.normalize(n);for(let c=0,d=r;;c++){let g=l.charCodeAt(c),w=this.match(g,d,this.bufferPos+this.bufferStart);if(c==l.length-1){if(w)return this.value=w,this;break}d==r&&c<n.length&&n.charCodeAt(c)==g&&d++}}}match(e,n,r){let l=null;for(let c=0;c<this.matches.length;c+=2){let d=this.matches[c],g=!1;this.query.charCodeAt(d)==e&&(d==this.query.length-1?l={from:this.matches[c+1],to:r}:(this.matches[c]++,g=!0)),g||(this.matches.splice(c,2),c-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?l={from:n,to:r}:this.matches.push(1,n)),l&&this.test&&!this.test(l.from,l.to,this.buffer,this.bufferStart)&&(l=null),l}}typeof Symbol!="undefined"&&(Ji.prototype[Symbol.iterator]=function(){return this});const wr={from:-1,to:-1,match:/.*/.exec("")},xr="gm"+(/x/.unicode==null?"":"u");class vr{constructor(e,n,r,l=0,c=e.length){if(this.text=e,this.to=c,this.curLine="",this.done=!1,this.value=wr,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new Wo(e,n,r,l,c);this.re=new RegExp(n,xr+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let d=e.lineAt(l);this.curLineStart=d.from,this.matchPos=Sr(e,l),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let r=this.curLineStart+n.index,l=r+n[0].length;if(this.matchPos=Sr(this.text,l+(r==l?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<l||r>this.value.to)&&(!this.test||this.test(r,l,n)))return this.value={from:r,to:l,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const kr=new WeakMap;class Hn{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,r){let l=kr.get(e);if(!l||l.from>=r||l.to<=n){let g=new Hn(n,e.sliceString(n,r));return kr.set(e,g),g}if(l.from==n&&l.to==r)return l;let{text:c,from:d}=l;return d>n&&(c=e.sliceString(n,d)+c,d=n),l.to<r&&(c+=e.sliceString(l.to,r)),kr.set(e,new Hn(d,c)),new Hn(n,c.slice(n-d,r-d))}}class Wo{constructor(e,n,r,l,c){this.text=e,this.to=c,this.done=!1,this.value=wr,this.matchPos=Sr(e,l),this.re=new RegExp(n,xr+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=Hn.get(e,l,this.chunkEnd(l+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let r=this.flat.from+n.index,l=r+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,l,n)))return this.value={from:r,to:l,match:n},this.matchPos=Sr(this.text,l+(r==l?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Hn.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(vr.prototype[Symbol.iterator]=Wo.prototype[Symbol.iterator]=function(){return this});function ja(s){try{return new RegExp(s,xr),!0}catch(e){return!1}}function Sr(s,e){if(e>=s.length)return e;let n=s.lineAt(e),r;for(;e<n.to&&(r=n.text.charCodeAt(e-n.from))>=56320&&r<57344;)e++;return e}function h(s){let e=String(s.state.doc.lineAt(s.state.selection.main.head).number),n=Le("input",{class:"cm-textfield",name:"line",value:e}),r=Le("form",{class:"cm-gotoLine",onkeydown:c=>{c.keyCode==27?(c.preventDefault(),s.dispatch({effects:t.of(!1)}),s.focus()):c.keyCode==13&&(c.preventDefault(),l())},onsubmit:c=>{c.preventDefault(),l()}},Le("label",s.state.phrase("Go to line"),": ",n)," ",Le("button",{class:"cm-button",type:"submit"},s.state.phrase("go")));function l(){let c=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!c)return;let{state:d}=s,g=d.doc.lineAt(d.selection.main.head),[,w,M,T,R]=c,H=T?+T.slice(1):0,U=M?+M:g.number;if(M&&R){let Ae=U/100;w&&(Ae=Ae*(w=="-"?-1:1)+g.number/d.doc.lines),U=Math.round(d.doc.lines*Ae)}else M&&w&&(U=U*(w=="-"?-1:1)+g.number);let X=d.doc.line(Math.max(1,Math.min(d.doc.lines,U))),se=L.jT.cursor(X.from+Math.max(0,Math.min(H,X.length)));s.dispatch({effects:[t.of(!1),W.tk.scrollIntoView(se.from,{y:"center"})],selection:se}),s.focus()}return{dom:r}}const t=L.Py.define(),i=L.QQ.define({create(){return!0},update(s,e){for(let n of e.effects)n.is(t)&&(s=n.value);return s},provide:s=>W.mH.from(s,e=>e?h:null)}),o=s=>{let e=(0,W.Sd)(s,h);if(!e){let n=[t.of(!0)];s.state.field(i,!1)==null&&n.push(L.Py.appendConfig.of([i,a])),s.dispatch({effects:n}),e=(0,W.Sd)(s,h)}return e&&e.dom.querySelector("input").select(),!0},a=W.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),f={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},m=L.r$.define({combine(s){return(0,L.BO)(s,f,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function y(s){let e=[N,P];return s&&e.push(m.of(s)),e}const x=W.p.mark({class:"cm-selectionMatch"}),S=W.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function k(s,e,n,r){return(n==0||s(e.sliceDoc(n-1,n))!=L.D0.Word)&&(r==e.doc.length||s(e.sliceDoc(r,r+1))!=L.D0.Word)}function O(s,e,n,r){return s(e.sliceDoc(n,n+1))==L.D0.Word&&s(e.sliceDoc(r-1,r))==L.D0.Word}const P=W.lg.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.selectionSet||s.docChanged||s.viewportChanged)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=s.state.facet(m),{state:n}=s,r=n.selection;if(r.ranges.length>1)return W.p.none;let l=r.main,c,d=null;if(l.empty){if(!e.highlightWordAroundCursor)return W.p.none;let w=n.wordAt(l.head);if(!w)return W.p.none;d=n.charCategorizer(l.head),c=n.sliceDoc(w.from,w.to)}else{let w=l.to-l.from;if(w<e.minSelectionLength||w>200)return W.p.none;if(e.wholeWords){if(c=n.sliceDoc(l.from,l.to),d=n.charCategorizer(l.head),!(k(d,n,l.from,l.to)&&O(d,n,l.from,l.to)))return W.p.none}else if(c=n.sliceDoc(l.from,l.to),!c)return W.p.none}let g=[];for(let w of s.visibleRanges){let M=new Ji(n.doc,c,w.from,w.to);for(;!M.next().done;){let{from:T,to:R}=M.value;if((!d||k(d,n,T,R))&&(l.empty&&T<=l.from&&R>=l.to?g.push(S.range(T,R)):(T>=l.to||R<=l.from)&&g.push(x.range(T,R)),g.length>e.maxMatches))return W.p.none}}return W.p.set(g)}},{decorations:s=>s.decorations}),N=W.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),F=({state:s,dispatch:e})=>{let{selection:n}=s,r=L.jT.create(n.ranges.map(l=>s.wordAt(l.head)||L.jT.cursor(l.head)),n.mainIndex);return r.eq(n)?!1:(e(s.update({selection:r})),!0)};function $(s,e){let{main:n,ranges:r}=s.selection,l=s.wordAt(n.head),c=l&&l.from==n.from&&l.to==n.to;for(let d=!1,g=new Ji(s.doc,e,r[r.length-1].to);;)if(g.next(),g.done){if(d)return null;g=new Ji(s.doc,e,0,Math.max(0,r[r.length-1].from-1)),d=!0}else{if(d&&r.some(w=>w.from==g.value.from))continue;if(c){let w=s.wordAt(g.value.from);if(!w||w.from!=g.value.from||w.to!=g.value.to)continue}return g.value}}const V=({state:s,dispatch:e})=>{let{ranges:n}=s.selection;if(n.some(c=>c.from===c.to))return F({state:s,dispatch:e});let r=s.sliceDoc(n[0].from,n[0].to);if(s.selection.ranges.some(c=>s.sliceDoc(c.from,c.to)!=r))return!1;let l=$(s,r);return l?(e(s.update({selection:s.selection.addRange(L.jT.range(l.from,l.to),!1),effects:W.tk.scrollIntoView(l.to)})),!0):!1},q=L.r$.define({combine(s){return(0,L.BO)(s,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Xh(e),scrollToMatch:e=>W.tk.scrollIntoView(e)})}});function ie(s){return s?[q.of(s),sa]:sa}class le{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ja(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new ks(this):new nt(this)}getCursor(e,n=0,r){let l=e.doc?e:L.yy.create({doc:e});return r==null&&(r=l.doc.length),this.regexp?Ze(this,l,n,r):ne(this,l,n,r)}}class ee{constructor(e){this.spec=e}}function ne(s,e,n,r){return new Ji(e.doc,s.unquoted,n,r,s.caseSensitive?void 0:l=>l.toLowerCase(),s.wholeWord?ce(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function ce(s,e){return(n,r,l,c)=>((c>n||c+l.length<r)&&(c=Math.max(0,n-2),l=s.sliceString(c,Math.min(s.length,r+2))),(e(Yt(l,n-c))!=L.D0.Word||e(Ri(l,n-c))!=L.D0.Word)&&(e(Ri(l,r-c))!=L.D0.Word||e(Yt(l,r-c))!=L.D0.Word))}class nt extends ee{constructor(e){super(e)}nextMatch(e,n,r){let l=ne(this.spec,e,r,e.doc.length).nextOverlapping();return l.done&&(l=ne(this.spec,e,0,n).nextOverlapping()),l.done?null:l.value}prevMatchInRange(e,n,r){for(let l=r;;){let c=Math.max(n,l-1e4-this.spec.unquoted.length),d=ne(this.spec,e,c,l),g=null;for(;!d.nextOverlapping().done;)g=d.value;if(g)return g;if(c==n)return null;l-=1e4}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let r=ne(this.spec,e,0,e.doc.length),l=[];for(;!r.next().done;){if(l.length>=n)return null;l.push(r.value)}return l}highlight(e,n,r,l){let c=ne(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!c.next().done;)l(c.value.from,c.value.to)}}function Ze(s,e,n,r){return new vr(e.doc,s.search,{ignoreCase:!s.caseSensitive,test:s.wholeWord?Vo(e.charCategorizer(e.selection.main.head)):void 0},n,r)}function Yt(s,e){return s.slice((0,L.cp)(s,e,!1),e)}function Ri(s,e){return s.slice(e,(0,L.cp)(s,e))}function Vo(s){return(e,n,r)=>!r[0].length||(s(Yt(r.input,r.index))!=L.D0.Word||s(Ri(r.input,r.index))!=L.D0.Word)&&(s(Ri(r.input,r.index+r[0].length))!=L.D0.Word||s(Yt(r.input,r.index+r[0].length))!=L.D0.Word)}class ks extends ee{nextMatch(e,n,r){let l=Ze(this.spec,e,r,e.doc.length).next();return l.done&&(l=Ze(this.spec,e,0,n).next()),l.done?null:l.value}prevMatchInRange(e,n,r){for(let l=1;;l++){let c=Math.max(n,r-l*1e4),d=Ze(this.spec,e,c,r),g=null;for(;!d.next().done;)g=d.value;if(g&&(c==n||g.from>c+10))return g;if(c==n)return null}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,r)=>r=="$"?"$":r=="&"?e.match[0]:r!="0"&&+r<e.match.length?e.match[r]:n)}matchAll(e,n){let r=Ze(this.spec,e,0,e.doc.length),l=[];for(;!r.next().done;){if(l.length>=n)return null;l.push(r.value)}return l}highlight(e,n,r,l){let c=Ze(this.spec,e,Math.max(0,n-250),Math.min(r+250,e.doc.length));for(;!c.next().done;)l(c.value.from,c.value.to)}}const Ai=L.Py.define(),ci=L.Py.define(),pt=L.QQ.define({create(s){return new Ii($o(s).create(),null)},update(s,e){for(let n of e.effects)n.is(Ai)?s=new Ii(n.value.create(),s.panel):n.is(ci)&&(s=new Ii(s.query,n.value?ia:null));return s},provide:s=>W.mH.from(s,e=>e.panel)});function Wn(s){let e=s.field(pt,!1);return e?e.query.spec:$o(s)}function Qi(s){var e;return((e=s.field(pt,!1))===null||e===void 0?void 0:e.panel)!=null}class Ii{constructor(e,n){this.query=e,this.panel=n}}const fi=W.p.mark({class:"cm-searchMatch"}),ui=W.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),qh=W.lg.fromClass(class{constructor(s){this.view=s,this.decorations=this.highlight(s.state.field(pt))}update(s){let e=s.state.field(pt);(e!=s.startState.field(pt)||s.docChanged||s.selectionSet||s.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:s,panel:e}){if(!e||!s.spec.valid)return W.p.none;let{view:n}=this,r=new L.f_;for(let l=0,c=n.visibleRanges,d=c.length;l<d;l++){let{from:g,to:w}=c[l];for(;l<d-1&&w>c[l+1].from-2*250;)w=c[++l].to;s.highlight(n.state,g,w,(M,T)=>{let R=n.state.selection.ranges.some(H=>H.from==M&&H.to==T);r.add(M,T,R?ui:fi)})}return r.finish()}},{decorations:s=>s.decorations});function Cr(s){return e=>{let n=e.state.field(pt,!1);return n&&n.query.spec.valid?s(e,n):Ka(e)}}const jo=Cr((s,{query:e})=>{let{to:n}=s.state.selection.main,r=e.nextMatch(s.state,n,n);if(!r)return!1;let l=L.jT.single(r.from,r.to),c=s.state.facet(q);return s.dispatch({selection:l,effects:[na(s,r),c.scrollToMatch(l.main,s)],userEvent:"select.search"}),qa(s),!0}),zo=Cr((s,{query:e})=>{let{state:n}=s,{from:r}=n.selection.main,l=e.prevMatch(n,r,r);if(!l)return!1;let c=L.jT.single(l.from,l.to),d=s.state.facet(q);return s.dispatch({selection:c,effects:[na(s,l),d.scrollToMatch(c.main,s)],userEvent:"select.search"}),qa(s),!0}),Kh=Cr((s,{query:e})=>{let n=e.matchAll(s.state,1e3);return!n||!n.length?!1:(s.dispatch({selection:L.jT.create(n.map(r=>L.jT.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),Uh=({state:s,dispatch:e})=>{let n=s.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:r,to:l}=n.main,c=[],d=0;for(let g=new Ji(s.doc,s.sliceDoc(r,l));!g.next().done;){if(c.length>1e3)return!1;g.value.from==r&&(d=c.length),c.push(L.jT.range(g.value.from,g.value.to))}return e(s.update({selection:L.jT.create(c,d),userEvent:"select.search.matches"})),!0},za=Cr((s,{query:e})=>{let{state:n}=s,{from:r,to:l}=n.selection.main;if(n.readOnly)return!1;let c=e.nextMatch(n,r,r);if(!c)return!1;let d=[],g,w,M=[];if(c.from==r&&c.to==l&&(w=n.toText(e.getReplacement(c)),d.push({from:c.from,to:c.to,insert:w}),c=e.nextMatch(n,c.from,c.to),M.push(W.tk.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(r).number)+"."))),c){let T=d.length==0||d[0].from>=c.to?0:c.to-c.from-w.length;g=L.jT.single(c.from-T,c.to-T),M.push(na(s,c)),M.push(n.facet(q).scrollToMatch(g.main,s))}return s.dispatch({changes:d,selection:g,effects:M,userEvent:"input.replace"}),!0}),Gh=Cr((s,{query:e})=>{if(s.state.readOnly)return!1;let n=e.matchAll(s.state,1e9).map(l=>{let{from:c,to:d}=l;return{from:c,to:d,insert:e.getReplacement(l)}});if(!n.length)return!1;let r=s.state.phrase("replaced $ matches",n.length)+".";return s.dispatch({changes:n,effects:W.tk.announce.of(r),userEvent:"input.replace.all"}),!0});function ia(s){return s.state.facet(q).createPanel(s)}function $o(s,e){var n,r,l,c,d;let g=s.selection.main,w=g.empty||g.to>g.from+100?"":s.sliceDoc(g.from,g.to);if(e&&!w)return e;let M=s.facet(q);return new le({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:M.literal)?w:w.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:M.caseSensitive,literal:(l=e==null?void 0:e.literal)!==null&&l!==void 0?l:M.literal,regexp:(c=e==null?void 0:e.regexp)!==null&&c!==void 0?c:M.regexp,wholeWord:(d=e==null?void 0:e.wholeWord)!==null&&d!==void 0?d:M.wholeWord})}function $a(s){let e=(0,W.Sd)(s,ia);return e&&e.dom.querySelector("[main-field]")}function qa(s){let e=$a(s);e&&e==s.root.activeElement&&e.select()}const Ka=s=>{let e=s.state.field(pt,!1);if(e&&e.panel){let n=$a(s);if(n&&n!=s.root.activeElement){let r=$o(s.state,e.query.spec);r.valid&&s.dispatch({effects:Ai.of(r)}),n.focus(),n.select()}}else s.dispatch({effects:[ci.of(!0),e?Ai.of($o(s.state,e.query.spec)):L.Py.appendConfig.of(sa)]});return!0},Ua=s=>{let e=s.state.field(pt,!1);if(!e||!e.panel)return!1;let n=(0,W.Sd)(s,ia);return n&&n.dom.contains(s.root.activeElement)&&s.focus(),s.dispatch({effects:ci.of(!1)}),!0},_h=[{key:"Mod-f",run:Ka,scope:"editor search-panel"},{key:"F3",run:jo,shift:zo,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:jo,shift:zo,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Ua,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Uh},{key:"Mod-Alt-g",run:o},{key:"Mod-d",run:V,preventDefault:!0}];class Xh{constructor(e){this.view=e;let n=this.query=e.state.field(pt).query.spec;this.commit=this.commit.bind(this),this.searchField=Le("input",{value:n.search,placeholder:Jt(e,"Find"),"aria-label":Jt(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Le("input",{value:n.replace,placeholder:Jt(e,"Replace"),"aria-label":Jt(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Le("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=Le("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=Le("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function r(l,c,d){return Le("button",{class:"cm-button",name:l,onclick:c,type:"button"},d)}this.dom=Le("div",{onkeydown:l=>this.keydown(l),class:"cm-search"},[this.searchField,r("next",()=>jo(e),[Jt(e,"next")]),r("prev",()=>zo(e),[Jt(e,"previous")]),r("select",()=>Kh(e),[Jt(e,"all")]),Le("label",null,[this.caseField,Jt(e,"match case")]),Le("label",null,[this.reField,Jt(e,"regexp")]),Le("label",null,[this.wordField,Jt(e,"by word")]),...e.state.readOnly?[]:[Le("br"),this.replaceField,r("replace",()=>za(e),[Jt(e,"replace")]),r("replaceAll",()=>Gh(e),[Jt(e,"replace all")])],Le("button",{name:"close",onclick:()=>Ua(e),"aria-label":Jt(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new le({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ai.of(e)}))}keydown(e){(0,W.$1)(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?zo:jo)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),za(this.view))}update(e){for(let n of e.transactions)for(let r of n.effects)r.is(Ai)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(q).top}}function Jt(s,e){return s.state.phrase(e)}const qo=30,Ko=/[\s\.,:;?!]/;function na(s,{from:e,to:n}){let r=s.state.doc.lineAt(e),l=s.state.doc.lineAt(n).to,c=Math.max(r.from,e-qo),d=Math.min(l,n+qo),g=s.state.sliceDoc(c,d);if(c!=r.from){for(let w=0;w<qo;w++)if(!Ko.test(g[w+1])&&Ko.test(g[w])){g=g.slice(w);break}}if(d!=l){for(let w=g.length-1;w>g.length-qo;w--)if(!Ko.test(g[w-1])&&Ko.test(g[w])){g=g.slice(0,w);break}}return W.tk.announce.of(`${s.state.phrase("current match")}. ${g} ${s.state.phrase("on line")} ${r.number}.`)}const Yh=W.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),sa=[pt,L.Wl.low(qh),Yh];class Ga{constructor(e,n,r){this.state=e,this.pos=n,this.explicit=r,this.abortListeners=[]}tokenBefore(e){let n=Ye(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),r=Math.max(n.from,this.pos-250),l=n.text.slice(r-n.from,this.pos-n.from),c=l.search(Ya(e,!1));return c<0?null:{from:r+c,to:this.pos,text:l.slice(c)}}get aborted(){return this.abortListeners==null}addEventListener(e,n){e=="abort"&&this.abortListeners&&this.abortListeners.push(n)}}function _a(s){let e=Object.keys(s).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Jh(s){let e=Object.create(null),n=Object.create(null);for(let{label:l}of s){e[l[0]]=!0;for(let c=1;c<l.length;c++)n[l[c]]=!0}let r=_a(e)+_a(n)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function Qh(s){let e=s.map(l=>typeof l=="string"?{label:l}:l),[n,r]=e.every(l=>/^\w+$/.test(l.label))?[/\w*$/,/\w+$/]:Jh(e);return l=>{let c=l.matchBefore(r);return c||l.explicit?{from:c?c.from:l.pos,options:e,validFor:n}:null}}function xf(s,e){return n=>{for(let r=syntaxTree(n.state).resolveInner(n.pos,-1);r;r=r.parent){if(s.indexOf(r.name)>-1)return e(n);if(r.type.isTop)break}return null}}function vf(s,e){return n=>{for(let r=syntaxTree(n.state).resolveInner(n.pos,-1);r;r=r.parent){if(s.indexOf(r.name)>-1)return null;if(r.type.isTop)break}return e(n)}}class Xa{constructor(e,n,r,l){this.completion=e,this.source=n,this.match=r,this.score=l}}function Zi(s){return s.selection.main.from}function Ya(s,e){var n;let{source:r}=s,l=e&&r[0]!="^",c=r[r.length-1]!="$";return!l&&!c?s:new RegExp(`${l?"^":""}(?:${r})${c?"$":""}`,(n=s.flags)!==null&&n!==void 0?n:s.ignoreCase?"i":"")}const Ja=L.q6.define();function Zh(s,e,n,r){let{main:l}=s.selection,c=n-l.from,d=r-l.from;return Object.assign(Object.assign({},s.changeByRange(g=>g!=l&&n!=r&&s.sliceDoc(g.from+c,g.from+d)!=s.sliceDoc(n,r)?{range:g}:{changes:{from:g.from+c,to:r==l.from?g.to:g.from+d,insert:e},range:L.jT.cursor(g.from+c+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const Qa=new WeakMap;function ec(s){if(!Array.isArray(s))return s;let e=Qa.get(s);return e||Qa.set(s,e=Qh(s)),e}const Uo=L.Py.define(),Ar=L.Py.define();class tc{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let r=(0,L.gm)(e,n),l=(0,L.nZ)(r);this.chars.push(r);let c=e.slice(n,n+l),d=c.toUpperCase();this.folded.push((0,L.gm)(d==c?c.toLowerCase():d,0)),n+=l}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:r,any:l,precise:c,byWord:d}=this;if(n.length==1){let he=(0,L.gm)(e,0),xe=(0,L.nZ)(he),qe=xe==e.length?0:-100;if(he!=n[0])if(he==r[0])qe+=-200;else return null;return this.ret(qe,[0,xe])}let g=e.indexOf(this.pattern);if(g==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let w=n.length,M=0;if(g<0){for(let he=0,xe=Math.min(e.length,200);he<xe&&M<w;){let qe=(0,L.gm)(e,he);(qe==n[M]||qe==r[M])&&(l[M++]=he),he+=(0,L.nZ)(qe)}if(M<w)return null}let T=0,R=0,H=!1,U=0,X=-1,se=-1,Ae=/[a-z]/.test(e),Te=!0;for(let he=0,xe=Math.min(e.length,200),qe=0;he<xe&&R<w;){let re=(0,L.gm)(e,he);g<0&&(T<w&&re==n[T]&&(c[T++]=he),U<w&&(re==n[U]||re==r[U]?(U==0&&(X=he),se=he+1,U++):U=0));let ve,te=re<255?re>=48&&re<=57||re>=97&&re<=122?2:re>=65&&re<=90?1:0:(ve=(0,L.bg)(re))!=ve.toLowerCase()?1:ve!=ve.toUpperCase()?2:0;(!he||te==1&&Ae||qe==0&&te!=0)&&(n[R]==re||r[R]==re&&(H=!0)?d[R++]=he:d.length&&(Te=!1)),qe=te,he+=(0,L.nZ)(re)}return R==w&&d[0]==0&&Te?this.result(-100+(H?-200:0),d,e):U==w&&X==0?this.ret(-200-e.length+(se==e.length?0:-100),[0,se]):g>-1?this.ret(-700-e.length,[g,g+this.pattern.length]):U==w?this.ret(-200+-700-e.length,[X,se]):R==w?this.result(-100+(H?-200:0)+-700+(Te?0:-1100),d,e):n.length==2?null:this.result((l[0]?-700:0)+-200+-1100,l,e)}result(e,n,r){let l=[],c=0;for(let d of n){let g=d+(this.astral?(0,L.nZ)((0,L.gm)(r,d)):1);c&&l[c-1]==d?l[c-1]=g:(l[c++]=d,l[c++]=g)}return this.ret(e-r.length,l)}}class ic{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),r=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,n.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const At=L.r$.define({combine(s){return(0,L.BO)(s,{activateOnTyping:!0,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:nc,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>r=>Za(e(r),n(r)),optionClass:(e,n)=>r=>Za(e(r),n(r)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function Za(s,e){return s?e?s+" "+e:s:e}function nc(s,e,n,r,l,c){let d=s.textDirection==W.Nm.RTL,g=d,w=!1,M="top",T,R,H=e.left-l.left,U=l.right-e.right,X=r.right-r.left,se=r.bottom-r.top;if(g&&H<Math.min(X,U)?g=!1:!g&&U<Math.min(X,H)&&(g=!0),X<=(g?H:U))T=Math.max(l.top,Math.min(n.top,l.bottom-se))-e.top,R=Math.min(400,g?H:U);else{w=!0,R=Math.min(400,(d?e.right:l.right-e.left)-30);let he=l.bottom-e.bottom;he>=se||he>e.top?T=n.bottom-e.top:(M="bottom",T=e.bottom-n.top)}let Ae=(e.bottom-e.top)/c.offsetHeight,Te=(e.right-e.left)/c.offsetWidth;return{style:`${M}: ${T/Ae}px; max-width: ${R/Te}px`,class:"cm-completionInfo-"+(w?d?"left-narrow":"right-narrow":g?"left":"right")}}function sc(s){let e=s.addToOptions.slice();return s.icons&&e.push({render(n){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),n.type&&r.classList.add(...n.type.split(/\s+/g).map(l=>"cm-completionIcon-"+l)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(n,r,l,c){let d=document.createElement("span");d.className="cm-completionLabel";let g=n.displayLabel||n.label,w=0;for(let M=0;M<c.length;){let T=c[M++],R=c[M++];T>w&&d.appendChild(document.createTextNode(g.slice(w,T)));let H=d.appendChild(document.createElement("span"));H.appendChild(document.createTextNode(g.slice(T,R))),H.className="cm-completionMatchedText",w=R}return w<g.length&&d.appendChild(document.createTextNode(g.slice(w))),d},position:50},{render(n){if(!n.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=n.detail,r},position:80}),e.sort((n,r)=>n.position-r.position).map(n=>n.render)}function ra(s,e,n){if(s<=n)return{from:0,to:s};if(e<0&&(e=0),e<=s>>1){let l=Math.floor(e/n);return{from:l*n,to:(l+1)*n}}let r=Math.floor((s-e)/n);return{from:s-(r+1)*n,to:s-r*n}}class rc{constructor(e,n,r){this.view=e,this.stateField=n,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:w=>this.placeInfo(w),key:this},this.space=null,this.currentClass="";let l=e.state.field(n),{options:c,selected:d}=l.open,g=e.state.facet(At);this.optionContent=sc(g),this.optionClass=g.optionClass,this.tooltipClass=g.tooltipClass,this.range=ra(c.length,d,g.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",w=>{let{options:M}=e.state.field(n).open;for(let T=w.target,R;T&&T!=this.dom;T=T.parentNode)if(T.nodeName=="LI"&&(R=/-(\d+)$/.exec(T.id))&&+R[1]<M.length){this.applyCompletion(e,M[+R[1]]),w.preventDefault();return}}),this.dom.addEventListener("focusout",w=>{let M=e.state.field(this.stateField,!1);M&&M.tooltip&&e.state.facet(At).closeOnBlur&&w.relatedTarget!=e.contentDOM&&e.dispatch({effects:Ar.of(null)})}),this.showOptions(c,l.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let r=e.state.field(this.stateField),l=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=l){let{options:c,selected:d,disabled:g}=r.open;(!l.open||l.open.options!=c)&&(this.range=ra(c.length,d,e.state.facet(At).maxRenderedOptions),this.showOptions(c,r.id)),this.updateSel(),g!=((n=l.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!g)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of n.split(" "))r&&this.dom.classList.add(r);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=ra(n.options.length,n.selected,this.view.state.facet(At).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:r}=n.options[n.selected],{info:l}=r;if(!l)return;let c=typeof l=="string"?document.createTextNode(l):l(r);if(!c)return;"then"in c?c.then(d=>{d&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(d,r)}).catch(d=>(0,W.OO)(this.view.state,d,"completion info")):this.addInfoPane(c,r)}}addInfoPane(e,n){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:l,destroy:c}=e;r.appendChild(l),this.infoDestroy=c||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let r=this.list.firstChild,l=this.range.from;r;r=r.nextSibling,l++)r.nodeName!="LI"||!r.id?l--:l==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),n=r):r.hasAttribute("aria-selected")&&r.removeAttribute("aria-selected");return n&&lc(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),l=e.getBoundingClientRect(),c=this.space;if(!c){let d=this.dom.ownerDocument.defaultView||window;c={left:0,top:0,right:d.innerWidth,bottom:d.innerHeight}}return l.top>Math.min(c.bottom,n.bottom)-10||l.bottom<Math.max(c.top,n.top)+10?null:this.view.state.facet(At).positionInfo(this.view,n,l,r,c,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,r){const l=document.createElement("ul");l.id=n,l.setAttribute("role","listbox"),l.setAttribute("aria-expanded","true"),l.setAttribute("aria-label",this.view.state.phrase("Completions"));let c=null;for(let d=r.from;d<r.to;d++){let{completion:g,match:w}=e[d],{section:M}=g;if(M){let H=typeof M=="string"?M:M.name;if(H!=c&&(d>r.from||r.from==0))if(c=H,typeof M!="string"&&M.header)l.appendChild(M.header(M));else{let U=l.appendChild(document.createElement("completion-section"));U.textContent=H}}const T=l.appendChild(document.createElement("li"));T.id=n+"-"+d,T.setAttribute("role","option");let R=this.optionClass(g);R&&(T.className=R);for(let H of this.optionContent){let U=H(g,this.view.state,this.view,w);U&&T.appendChild(U)}}return r.from&&l.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&l.classList.add("cm-completionListIncompleteBottom"),l}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function oc(s,e){return n=>new rc(n,s,e)}function lc(s,e){let n=s.getBoundingClientRect(),r=e.getBoundingClientRect(),l=n.height/s.offsetHeight;r.top<n.top?s.scrollTop-=(n.top-r.top)/l:r.bottom>n.bottom&&(s.scrollTop+=(r.bottom-n.bottom)/l)}function eh(s){return(s.boost||0)*100+(s.apply?10:0)+(s.info?5:0)+(s.type?1:0)}function ac(s,e){let n=[],r=null,l=M=>{n.push(M);let{section:T}=M.completion;if(T){r||(r=[]);let R=typeof T=="string"?T:T.name;r.some(H=>H.name==R)||r.push(typeof T=="string"?{name:R}:T)}},c=e.facet(At);for(let M of s)if(M.hasResult()){let T=M.result.getMatch;if(M.result.filter===!1)for(let R of M.result.options)l(new Xa(R,M.source,T?T(R):[],1e9-n.length));else{let R=e.sliceDoc(M.from,M.to),H,U=c.filterStrict?new ic(R):new tc(R);for(let X of M.result.options)if(H=U.match(X.label)){let se=X.displayLabel?T?T(X,H.matched):[]:H.matched;l(new Xa(X,M.source,se,H.score+(X.boost||0)))}}}if(r){let M=Object.create(null),T=0,R=(H,U)=>{var X,se;return((X=H.rank)!==null&&X!==void 0?X:1e9)-((se=U.rank)!==null&&se!==void 0?se:1e9)||(H.name<U.name?-1:1)};for(let H of r.sort(R))T-=1e5,M[H.name]=T;for(let H of n){let{section:U}=H.completion;U&&(H.score+=M[typeof U=="string"?U:U.name])}}let d=[],g=null,w=c.compareCompletions;for(let M of n.sort((T,R)=>R.score-T.score||w(T.completion,R.completion))){let T=M.completion;!g||g.label!=T.label||g.detail!=T.detail||g.type!=null&&T.type!=null&&g.type!=T.type||g.apply!=T.apply||g.boost!=T.boost?d.push(M):eh(M.completion)>eh(g)&&(d[d.length-1]=M),g=M.completion}return d}class Ss{constructor(e,n,r,l,c,d){this.options=e,this.attrs=n,this.tooltip=r,this.timestamp=l,this.selected=c,this.disabled=d}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Ss(this.options,th(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,r,l,c){let d=ac(e,n);if(!d.length)return l&&e.some(w=>w.state==1)?new Ss(l.options,l.attrs,l.tooltip,l.timestamp,l.selected,!0):null;let g=n.facet(At).selectOnOpen?0:-1;if(l&&l.selected!=g&&l.selected!=-1){let w=l.options[l.selected].completion;for(let M=0;M<d.length;M++)if(d[M].completion==w){g=M;break}}return new Ss(d,th(r,g),{pos:e.reduce((w,M)=>M.hasResult()?Math.min(w,M.from):w,1e8),create:dc,above:c.aboveCursor},l?l.timestamp:Date.now(),g,!1)}map(e){return new Ss(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Go{constructor(e,n,r){this.active=e,this.id=n,this.open=r}static start(){return new Go(fc,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,r=n.facet(At),c=(r.override||n.languageDataAt("autocomplete",Zi(n)).map(ec)).map(g=>(this.active.find(M=>M.source==g)||new jt(g,this.active.some(M=>M.state!=0)?1:0)).update(e,r));c.length==this.active.length&&c.every((g,w)=>g==this.active[w])&&(c=this.active);let d=this.open;d&&e.docChanged&&(d=d.map(e.changes)),e.selection||c.some(g=>g.hasResult()&&e.changes.touchesRange(g.from,g.to))||!hc(c,this.active)?d=Ss.build(c,n,this.id,d,r):d&&d.disabled&&!c.some(g=>g.state==1)&&(d=null),!d&&c.every(g=>g.state!=1)&&c.some(g=>g.hasResult())&&(c=c.map(g=>g.hasResult()?new jt(g.source,0):g));for(let g of e.effects)g.is(la)&&(d=d&&d.setSelected(g.value,this.id));return c==this.active&&d==this.open?this:new Go(c,this.id,d)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:cc}}function hc(s,e){if(s==e)return!0;for(let n=0,r=0;;){for(;n<s.length&&!s[n].hasResult;)n++;for(;r<e.length&&!e[r].hasResult;)r++;let l=n==s.length,c=r==e.length;if(l||c)return l==c;if(s[n++].result!=e[r++].result)return!1}}const cc={"aria-autocomplete":"list"};function th(s,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":s};return e>-1&&(n["aria-activedescendant"]=s+"-"+e),n}const fc=[];function oa(s){return s.isUserEvent("input.type")?"input":s.isUserEvent("delete.backward")?"delete":null}class jt{constructor(e,n,r=-1){this.source=e,this.state=n,this.explicitPos=r}hasResult(){return!1}update(e,n){let r=oa(e),l=this;r?l=l.handleUserEvent(e,r,n):e.docChanged?l=l.handleChange(e):e.selection&&l.state!=0&&(l=new jt(l.source,0));for(let c of e.effects)if(c.is(Uo))l=new jt(l.source,1,c.value?Zi(e.state):-1);else if(c.is(Ar))l=new jt(l.source,0);else if(c.is(ih))for(let d of c.value)d.source==l.source&&(l=d);return l}handleUserEvent(e,n,r){return n=="delete"||!r.activateOnTyping?this.map(e.changes):new jt(this.source,1)}handleChange(e){return e.changes.touchesRange(Zi(e.startState))?new jt(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new jt(this.source,this.state,e.mapPos(this.explicitPos))}}class Cs extends jt{constructor(e,n,r,l,c){super(e,2,n),this.result=r,this.from=l,this.to=c}hasResult(){return!0}handleUserEvent(e,n,r){var l;let c=this.result;c.map&&!e.changes.empty&&(c=c.map(c,e.changes));let d=e.changes.mapPos(this.from),g=e.changes.mapPos(this.to,1),w=Zi(e.state);if((this.explicitPos<0?w<=d:w<this.from)||w>g||!c||n=="delete"&&Zi(e.startState)==this.from)return new jt(this.source,n=="input"&&r.activateOnTyping?1:0);let M=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return uc(c.validFor,e.state,d,g)?new Cs(this.source,M,c,d,g):c.update&&(c=c.update(c,d,g,new Ga(e.state,w,M>=0)))?new Cs(this.source,M,c,c.from,(l=c.to)!==null&&l!==void 0?l:Zi(e.state)):new jt(this.source,1,M)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new jt(this.source,0):this.map(e.changes)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Cs(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new jt(this.source,0)}}function uc(s,e,n,r){if(!s)return!1;let l=e.sliceDoc(n,r);return typeof s=="function"?s(l,n,r,e):Ya(s,!0).test(l)}const ih=L.Py.define({map(s,e){return s.map(n=>n.map(e))}}),la=L.Py.define(),wt=L.QQ.define({create(){return Go.start()},update(s,e){return s.update(e)},provide:s=>[W.hJ.from(s,e=>e.tooltip),W.tk.contentAttributes.from(s,e=>e.attrs)]});function aa(s,e){const n=e.completion.apply||e.completion.label;let r=s.state.field(wt).active.find(l=>l.source==e.source);return r instanceof Cs?(typeof n=="string"?s.dispatch(Object.assign(Object.assign({},Zh(s.state,n,r.from,r.to)),{annotations:Ja.of(e.completion)})):n(s,e.completion,r.from,r.to),!0):!1}const dc=oc(wt,aa);function _o(s,e="option"){return n=>{let r=n.state.field(wt,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<n.state.facet(At).interactionDelay)return!1;let l=1,c;e=="page"&&(c=(0,W.gB)(n,r.open.tooltip))&&(l=Math.max(2,Math.floor(c.dom.offsetHeight/c.dom.querySelector("li").offsetHeight)-1));let{length:d}=r.open.options,g=r.open.selected>-1?r.open.selected+l*(s?1:-1):s?0:d-1;return g<0?g=e=="page"?0:d-1:g>=d&&(g=e=="page"?d-1:0),n.dispatch({effects:la.of(g)}),!0}}const pc=s=>{let e=s.state.field(wt,!1);return s.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<s.state.facet(At).interactionDelay?!1:aa(s,e.open.options[e.open.selected])},mc=s=>s.state.field(wt,!1)?(s.dispatch({effects:Uo.of(!0)}),!0):!1,gc=s=>{let e=s.state.field(wt,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(s.dispatch({effects:Ar.of(null)}),!0)};class yc{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const bc=50,wc=1e3,xc=W.lg.fromClass(class{constructor(s){this.view=s,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of s.state.field(wt).active)e.state==1&&this.startQuery(e)}update(s){let e=s.state.field(wt);if(!s.selectionSet&&!s.docChanged&&s.startState.field(wt)==e)return;let n=s.transactions.some(l=>(l.selection||l.docChanged)&&!oa(l));for(let l=0;l<this.running.length;l++){let c=this.running[l];if(n||c.updates.length+s.transactions.length>bc&&Date.now()-c.time>wc){for(let d of c.context.abortListeners)try{d()}catch(g){(0,W.OO)(this.view.state,g)}c.context.abortListeners=null,this.running.splice(l--,1)}else c.updates.push(...s.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),s.transactions.some(l=>l.effects.some(c=>c.is(Uo)))&&(this.pendingStart=!0);let r=this.pendingStart?50:s.state.facet(At).activateOnTypingDelay;if(this.debounceUpdate=e.active.some(l=>l.state==1&&!this.running.some(c=>c.active.source==l.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let l of s.transactions)oa(l)=="input"?this.composing=2:this.composing==2&&l.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:s}=this.view,e=s.field(wt);for(let n of e.active)n.state==1&&!this.running.some(r=>r.active.source==n.source)&&this.startQuery(n)}startQuery(s){let{state:e}=this.view,n=Zi(e),r=new Ga(e,n,s.explicitPos==n),l=new yc(s,r);this.running.push(l),Promise.resolve(s.source(r)).then(c=>{l.context.aborted||(l.done=c||null,this.scheduleAccept())},c=>{this.view.dispatch({effects:Ar.of(null)}),(0,W.OO)(this.view.state,c)})}scheduleAccept(){this.running.every(s=>s.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(At).updateSyncTime))}accept(){var s;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(At);for(let r=0;r<this.running.length;r++){let l=this.running[r];if(l.done===void 0)continue;if(this.running.splice(r--,1),l.done){let d=new Cs(l.active.source,l.active.explicitPos,l.done,l.done.from,(s=l.done.to)!==null&&s!==void 0?s:Zi(l.updates.length?l.updates[0].startState:this.view.state));for(let g of l.updates)d=d.update(g,n);if(d.hasResult()){e.push(d);continue}}let c=this.view.state.field(wt).active.find(d=>d.source==l.active.source);if(c&&c.state==1)if(l.done==null){let d=new jt(l.active.source,0);for(let g of l.updates)d=d.update(g,n);d.state!=1&&e.push(d)}else this.startQuery(c)}e.length&&this.view.dispatch({effects:ih.of(e)})}},{eventHandlers:{blur(s){let e=this.view.state.field(wt,!1);if(e&&e.tooltip&&this.view.state.facet(At).closeOnBlur){let n=e.open&&(0,W.gB)(this.view,e.open.tooltip);(!n||!n.dom.contains(s.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Ar.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Uo.of(!1)}),20),this.composing=0}}}),vc=typeof navigator=="object"&&/Win/.test(navigator.platform),kc=L.Wl.highest(W.tk.domEventHandlers({keydown(s,e){let n=e.state.field(wt,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||s.key.length>1||s.ctrlKey&&!(vc&&s.altKey)||s.metaKey)return!1;let r=n.open.options[n.open.selected],l=n.active.find(d=>d.source==r.source),c=r.completion.commitCharacters||l.result.commitCharacters;return c&&c.indexOf(s.key)>-1&&aa(e,r),!1}})),nh=W.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Sc{constructor(e,n,r,l){this.field=e,this.line=n,this.from=r,this.to=l}}class ha{constructor(e,n,r){this.field=e,this.from=n,this.to=r}map(e){let n=e.mapPos(this.from,-1,MapMode.TrackDel),r=e.mapPos(this.to,1,MapMode.TrackDel);return n==null||r==null?null:new ha(this.field,n,r)}}class ca{constructor(e,n){this.lines=e,this.fieldPositions=n}instantiate(e,n){let r=[],l=[n],c=e.doc.lineAt(n),d=/^\s*/.exec(c.text)[0];for(let w of this.lines){if(r.length){let M=d,T=/^\t*/.exec(w)[0].length;for(let R=0;R<T;R++)M+=e.facet(indentUnit);l.push(n+M.length-T),w=M+w.slice(T)}r.push(w),n+=w.length+1}let g=this.fieldPositions.map(w=>new ha(w.field,l[w.line]+w.from,l[w.line]+w.to));return{text:r,ranges:g}}static parse(e){let n=[],r=[],l=[],c;for(let d of e.split(/\r\n?|\n/)){for(;c=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(d);){let g=c[1]?+c[1]:null,w=c[2]||c[3]||"",M=-1;for(let T=0;T<n.length;T++)(g!=null?n[T].seq==g:w&&n[T].name==w)&&(M=T);if(M<0){let T=0;for(;T<n.length&&(g==null||n[T].seq!=null&&n[T].seq<g);)T++;n.splice(T,0,{seq:g,name:w}),M=T;for(let R of l)R.field>=M&&R.field++}l.push(new Sc(M,r.length,c.index,c.index+w.length)),d=d.slice(0,c.index)+w+d.slice(c.index+c[0].length)}for(let g;g=/\\([{}])/.exec(d);){d=d.slice(0,g.index)+g[1]+d.slice(g.index+g[0].length);for(let w of l)w.line==r.length&&w.from>g.index&&(w.from--,w.to--)}r.push(d)}return new ca(r,l)}}let Cc=W.p.widget({widget:new class extends W.l9{toDOM(){let s=document.createElement("span");return s.className="cm-snippetFieldPosition",s}ignoreEvent(){return!1}}}),Ac=W.p.mark({class:"cm-snippetField"});class As{constructor(e,n){this.ranges=e,this.active=n,this.deco=W.p.set(e.map(r=>(r.from==r.to?Cc:Ac).range(r.from,r.to)))}map(e){let n=[];for(let r of this.ranges){let l=r.map(e);if(!l)return null;n.push(l)}return new As(n,this.active)}selectionInsideField(e){return e.ranges.every(n=>this.ranges.some(r=>r.field==this.active&&r.from<=n.from&&r.to>=n.to))}}const Mr=L.Py.define({map(s,e){return s&&s.map(e)}}),Mc=L.Py.define(),Vn=L.QQ.define({create(){return null},update(s,e){for(let n of e.effects){if(n.is(Mr))return n.value;if(n.is(Mc)&&s)return new As(s.ranges,n.value)}return s&&e.docChanged&&(s=s.map(e.changes)),s&&e.selection&&!s.selectionInsideField(e.selection)&&(s=null),s},provide:s=>W.tk.decorations.from(s,e=>e?e.deco:W.p.none)});function fa(s,e){return L.jT.create(s.filter(n=>n.field==e).map(n=>L.jT.range(n.from,n.to)))}function Tc(s){let e=ca.parse(s);return(n,r,l,c)=>{let{text:d,ranges:g}=e.instantiate(n.state,l),w={changes:{from:l,to:c,insert:Text.of(d)},scrollIntoView:!0,annotations:r?[Ja.of(r),Transaction.userEvent.of("input.complete")]:void 0};if(g.length&&(w.selection=fa(g,0)),g.some(M=>M.field>0)){let M=new As(g,0),T=w.effects=[Mr.of(M)];n.state.field(Vn,!1)===void 0&&T.push(StateEffect.appendConfig.of([Vn,Lc,Ec,nh]))}n.dispatch(n.state.update(w))}}function sh(s){return({state:e,dispatch:n})=>{let r=e.field(Vn,!1);if(!r||s<0&&r.active==0)return!1;let l=r.active+s,c=s>0&&!r.ranges.some(d=>d.field==l+s);return n(e.update({selection:fa(r.ranges,l),effects:Mr.of(c?null:new As(r.ranges,l)),scrollIntoView:!0})),!0}}const Dc=({state:s,dispatch:e})=>s.field(Vn,!1)?(e(s.update({effects:Mr.of(null)})),!0):!1,Oc=sh(1),Bc=sh(-1);function kf(s){let e=s.field(Vn,!1);return!!(e&&e.ranges.some(n=>n.field==e.active+1))}function Sf(s){let e=s.field(Vn,!1);return!!(e&&e.active>0)}const Pc=[{key:"Tab",run:Oc,shift:Bc},{key:"Escape",run:Dc}],rh=L.r$.define({combine(s){return s.length?s[0]:Pc}}),Lc=L.Wl.highest(W.$f.compute([rh],s=>s.facet(rh)));function Cf(s,e){return Object.assign(Object.assign({},e),{apply:Tc(s)})}const Ec=W.tk.domEventHandlers({mousedown(s,e){let n=e.state.field(Vn,!1),r;if(!n||(r=e.posAtCoords({x:s.clientX,y:s.clientY}))==null)return!1;let l=n.ranges.find(c=>c.from<=r&&c.to>=r);return!l||l.field==n.active?!1:(e.dispatch({selection:fa(n.ranges,l.field),effects:Mr.of(n.ranges.some(c=>c.field>l.field)?new As(n.ranges,l.field):null),scrollIntoView:!0}),!0)}});function Rc(s){let e=s.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${e}]+`,"ug")}catch(n){return new RegExp(`[w${e}]`,"g")}}function oh(s,e){return new RegExp(e(s.source),s.unicode?"u":"")}const lh=null;function Ic(s){return lh[s]||(lh[s]=new WeakMap)}function ah(s,e,n,r,l){for(let c=s.iterLines(),d=0;!c.next().done;){let{value:g}=c,w;for(e.lastIndex=0;w=e.exec(g);)if(!r[w[0]]&&d+w.index!=l&&(n.push({type:"text",label:w[0]}),r[w[0]]=!0,n.length>=2e3))return;d+=g.length+1}}function hh(s,e,n,r,l){let c=s.length>=1e3,d=c&&e.get(s);if(d)return d;let g=[],w=Object.create(null);if(s.children){let M=0;for(let T of s.children){if(T.length>=1e3)for(let R of hh(T,e,n,r-M,l-M))w[R.label]||(w[R.label]=!0,g.push(R));else ah(T,n,g,w,l-M);M+=T.length+1}}else ah(s,n,g,w,l);return c&&g.length<2e3&&e.set(s,g),g}const Af=s=>{let e=s.state.languageDataAt("wordChars",s.pos).join(""),n=Rc(e),r=s.matchBefore(oh(n,d=>d+"$"));if(!r&&!s.explicit)return null;let l=r?r.from:s.pos,c=hh(s.state.doc,Ic(e),n,5e4,l);return{from:l,options:c,validFor:oh(n,d=>"^"+d)}},Tr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},jn=L.Py.define({map(s,e){let n=e.mapPos(s,-1,L.gc.TrackAfter);return n==null?void 0:n}}),ua=new class extends L.uU{};ua.startSide=1,ua.endSide=-1;const ch=L.QQ.define({create(){return L.Xs.empty},update(s,e){if(s=s.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);s=s.update({filter:r=>r>=n.from&&r<=n.to})}for(let n of e.effects)n.is(jn)&&(s=s.update({add:[ua.range(n.value,n.value+1)]}));return s}});function Nc(){return[Hc,ch]}const da="()[]{}<>";function fh(s){for(let e=0;e<da.length;e+=2)if(da.charCodeAt(e)==s)return da.charAt(e+1);return(0,L.bg)(s<128?s:s+1)}function uh(s,e){return s.languageDataAt("closeBrackets",e)[0]||Tr}const Fc=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Hc=W.tk.inputHandler.of((s,e,n,r)=>{if((Fc?s.composing:s.compositionStarted)||s.state.readOnly)return!1;let l=s.state.selection.main;if(r.length>2||r.length==2&&(0,L.nZ)((0,L.gm)(r,0))==1||e!=l.from||n!=l.to)return!1;let c=Vc(s.state,r);return c?(s.dispatch(c),!0):!1}),Wc=[{key:"Backspace",run:({state:s,dispatch:e})=>{if(s.readOnly)return!1;let r=uh(s,s.selection.main.head).brackets||Tr.brackets,l=null,c=s.changeByRange(d=>{if(d.empty){let g=jc(s.doc,d.head);for(let w of r)if(w==g&&Xo(s.doc,d.head)==fh((0,L.gm)(w,0)))return{changes:{from:d.head-w.length,to:d.head+w.length},range:L.jT.cursor(d.head-w.length)}}return{range:l=d}});return l||e(s.update(c,{scrollIntoView:!0,userEvent:"delete.backward"})),!l}}];function Vc(s,e){let n=uh(s,s.selection.main.head),r=n.brackets||Tr.brackets;for(let l of r){let c=fh((0,L.gm)(l,0));if(e==l)return c==l?qc(s,l,r.indexOf(l+l+l)>-1,n):zc(s,l,c,n.before||Tr.before);if(e==c&&dh(s,s.selection.main.from))return $c(s,l,c)}return null}function dh(s,e){let n=!1;return s.field(ch).between(0,s.doc.length,r=>{r==e&&(n=!0)}),n}function Xo(s,e){let n=s.sliceString(e,e+2);return n.slice(0,(0,L.nZ)((0,L.gm)(n,0)))}function jc(s,e){let n=s.sliceString(e-2,e);return(0,L.nZ)((0,L.gm)(n,0))==n.length?n:n.slice(1)}function zc(s,e,n,r){let l=null,c=s.changeByRange(d=>{if(!d.empty)return{changes:[{insert:e,from:d.from},{insert:n,from:d.to}],effects:jn.of(d.to+e.length),range:L.jT.range(d.anchor+e.length,d.head+e.length)};let g=Xo(s.doc,d.head);return!g||/\s/.test(g)||r.indexOf(g)>-1?{changes:{insert:e+n,from:d.head},effects:jn.of(d.head+e.length),range:L.jT.cursor(d.head+e.length)}:{range:l=d}});return l?null:s.update(c,{scrollIntoView:!0,userEvent:"input.type"})}function $c(s,e,n){let r=null,l=s.changeByRange(c=>c.empty&&Xo(s.doc,c.head)==n?{changes:{from:c.head,to:c.head+n.length,insert:n},range:L.jT.cursor(c.head+n.length)}:r={range:c});return r?null:s.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function qc(s,e,n,r){let l=r.stringPrefixes||Tr.stringPrefixes,c=null,d=s.changeByRange(g=>{if(!g.empty)return{changes:[{insert:e,from:g.from},{insert:e,from:g.to}],effects:jn.of(g.to+e.length),range:L.jT.range(g.anchor+e.length,g.head+e.length)};let w=g.head,M=Xo(s.doc,w),T;if(M==e){if(ph(s,w))return{changes:{insert:e+e,from:w},effects:jn.of(w+e.length),range:L.jT.cursor(w+e.length)};if(dh(s,w)){let H=n&&s.sliceDoc(w,w+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:w,to:w+H.length,insert:H},range:L.jT.cursor(w+H.length)}}}else{if(n&&s.sliceDoc(w-2*e.length,w)==e+e&&(T=mh(s,w-2*e.length,l))>-1&&ph(s,T))return{changes:{insert:e+e+e+e,from:w},effects:jn.of(w+e.length),range:L.jT.cursor(w+e.length)};if(s.charCategorizer(w)(M)!=L.D0.Word&&mh(s,w,l)>-1&&!Kc(s,w,e,l))return{changes:{insert:e+e,from:w},effects:jn.of(w+e.length),range:L.jT.cursor(w+e.length)}}return{range:c=g}});return c?null:s.update(d,{scrollIntoView:!0,userEvent:"input.type"})}function ph(s,e){let n=Ye(s).resolveInner(e+1);return n.parent&&n.from==e}function Kc(s,e,n,r){let l=Ye(s).resolveInner(e,-1),c=r.reduce((d,g)=>Math.max(d,g.length),0);for(let d=0;d<5;d++){let g=s.sliceDoc(l.from,Math.min(l.to,l.from+n.length+c)),w=g.indexOf(n);if(!w||w>-1&&r.indexOf(g.slice(0,w))>-1){let T=l.firstChild;for(;T&&T.from==l.from&&T.to-T.from>n.length+w;){if(s.sliceDoc(T.to-n.length,T.to)==n)return!1;T=T.firstChild}return!0}let M=l.to==e&&l.parent;if(!M)break;l=M}return!1}function mh(s,e,n){let r=s.charCategorizer(e);if(r(s.sliceDoc(e-1,e))!=L.D0.Word)return e;for(let l of n){let c=e-l.length;if(s.sliceDoc(c,e)==l&&r(s.sliceDoc(c-1,c))!=L.D0.Word)return c}return-1}function Uc(s={}){return[kc,wt,At.of(s),xc,Gc,nh]}const gh=[{key:"Ctrl-Space",run:mc},{key:"Escape",run:gc},{key:"ArrowDown",run:_o(!0)},{key:"ArrowUp",run:_o(!1)},{key:"PageDown",run:_o(!0,"page")},{key:"PageUp",run:_o(!1,"page")},{key:"Enter",run:pc}],Gc=L.Wl.highest(W.$f.computeN([At],s=>s.facet(At).defaultKeymap?[gh]:[]));function Tf(s){let e=s.field(wt,!1);return e&&e.active.some(n=>n.state==1)?"pending":e&&e.active.some(n=>n.state!=0)?"active":null}const yh=new WeakMap;function Df(s){var e;let n=(e=s.field(wt,!1))===null||e===void 0?void 0:e.open;if(!n||n.disabled)return[];let r=yh.get(n.options);return r||yh.set(n.options,r=n.options.map(l=>l.completion)),r}function Of(s){var e;let n=(e=s.field(wt,!1))===null||e===void 0?void 0:e.open;return n&&!n.disabled&&n.selected>=0?n.options[n.selected].completion:null}function Bf(s){var e;let n=(e=s.field(wt,!1))===null||e===void 0?void 0:e.open;return n&&!n.disabled&&n.selected>=0?n.selected:null}function Pf(s){return la.of(s)}class _c{constructor(e,n,r){this.from=e,this.to=n,this.diagnostic=r}}class zn{constructor(e,n,r){this.diagnostics=e,this.panel=n,this.selected=r}static init(e,n,r){let l=e,c=r.facet(ma).markerFilter;c&&(l=c(l,r));let d=W.p.set(l.map(g=>g.from==g.to||g.from==g.to-1&&r.doc.lineAt(g.from).to==g.from?W.p.widget({widget:new ef(g),diagnostic:g}).range(g.from):W.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+g.severity+(g.markClass?" "+g.markClass:"")},diagnostic:g,inclusive:!0}).range(g.from,g.to)),!0);return new zn(d,n,Ms(d))}}function Ms(s,e=null,n=0){let r=null;return s.between(n,1e9,(l,c,{spec:d})=>{if(!(e&&d.diagnostic!=e))return r=new _c(l,c,d.diagnostic),!1}),r}function bh(s,e){let n=s.startState.doc.lineAt(e.pos);return!!(s.effects.some(r=>r.is(Yo))||s.changes.touchesRange(n.from,n.to))}function wh(s,e){return s.field(Bt,!1)?e:e.concat(L.Py.appendConfig.of(Bh))}function Lf(s,e){return{effects:wh(s,[Yo.of(e)])}}const Yo=L.Py.define(),pa=L.Py.define(),xh=L.Py.define(),Bt=L.QQ.define({create(){return new zn(W.p.none,null,null)},update(s,e){if(e.docChanged){let n=s.diagnostics.map(e.changes),r=null;if(s.selected){let l=e.changes.mapPos(s.selected.from,1);r=Ms(n,s.selected.diagnostic,l)||Ms(n,null,l)}s=new zn(n,s.panel,r)}for(let n of e.effects)n.is(Yo)?s=zn.init(n.value,s.panel,e.state):n.is(pa)?s=new zn(s.diagnostics,n.value?Jo.open:null,s.selected):n.is(xh)&&(s=new zn(s.diagnostics,s.panel,n.value));return s},provide:s=>[W.mH.from(s,e=>e.panel),W.tk.decorations.from(s,e=>e.diagnostics)]});function Ef(s){let e=s.field(Bt,!1);return e?e.diagnostics.size:0}const Xc=W.p.mark({class:"cm-lintRange cm-lintRange-active",inclusive:!0});function Yc(s,e,n){let{diagnostics:r}=s.state.field(Bt),l=[],c=2e8,d=0;r.between(e-(n<0?1:0),e+(n>0?1:0),(w,M,{spec:T})=>{e>=w&&e<=M&&(w==M||(e>w||n>0)&&(e<M||n<0))&&(l.push(T.diagnostic),c=Math.min(w,c),d=Math.max(M,d))});let g=s.state.facet(ma).tooltipFilter;return g&&(l=g(l,s.state)),l.length?{pos:c,end:d,above:s.state.doc.lineAt(c).to<d,create(){return{dom:vh(s,l)}}}:null}function vh(s,e){return Le("ul",{class:"cm-tooltip-lint"},e.map(n=>Ah(s,n,!1)))}const Jc=s=>{let e=s.state.field(Bt,!1);(!e||!e.panel)&&s.dispatch({effects:wh(s.state,[pa.of(!0)])});let n=(0,W.Sd)(s,Jo.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},kh=s=>{let e=s.state.field(Bt,!1);return!e||!e.panel?!1:(s.dispatch({effects:pa.of(!1)}),!0)},Qc=s=>{let e=s.state.field(Bt,!1);if(!e)return!1;let n=s.state.selection.main,r=e.diagnostics.iter(n.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==n.from&&r.to==n.to)?!1:(s.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},Rf=s=>{let{state:e}=s,n=e.field(Bt,!1);if(!n)return!1;let r=e.selection.main,l,c,d,g;return n.diagnostics.between(0,e.doc.length,(w,M)=>{M<r.to&&(l==null||l<w)&&(l=w,c=M),(d==null||w>d)&&(d=w,g=M)}),d==null||l==null&&d==r.from?!1:(s.dispatch({selection:{anchor:l!=null?l:d,head:c!=null?c:g},scrollIntoView:!0}),!0)},Zc=[{key:"Mod-Shift-m",run:Jc,preventDefault:!0},{key:"F8",run:Qc}],Sh=null,ma=L.r$.define({combine(s){return Object.assign({sources:s.map(e=>e.source).filter(e=>e!=null)},(0,L.BO)(s.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,n)=>e?n?r=>e(r)||n(r):e:n}))}});function If(s,e={}){return[ma.of({source:s,config:e}),Sh,Bh]}function Nf(s){let e=s.plugin(Sh);e&&e.force()}function Ch(s){let e=[];if(s)e:for(let{name:n}of s){for(let r=0;r<n.length;r++){let l=n[r];if(/[a-zA-Z]/.test(l)&&!e.some(c=>c.toLowerCase()==l.toLowerCase())){e.push(l);continue e}}e.push("")}return e}function Ah(s,e,n){var r;let l=n?Ch(e.actions):[];return Le("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Le("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(r=e.actions)===null||r===void 0?void 0:r.map((c,d)=>{let g=!1,w=H=>{if(H.preventDefault(),g)return;g=!0;let U=Ms(s.state.field(Bt).diagnostics,e);U&&c.apply(s,U.from,U.to)},{name:M}=c,T=l[d]?M.indexOf(l[d]):-1,R=T<0?M:[M.slice(0,T),Le("u",M.slice(T,T+1)),M.slice(T+1)];return Le("button",{type:"button",class:"cm-diagnosticAction",onclick:w,onmousedown:w,"aria-label":` Action: ${M}${T<0?"":` (access key "${l[d]})"`}.`},R)}),e.source&&Le("div",{class:"cm-diagnosticSource"},e.source))}class ef extends W.l9{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Le("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Mh{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Ah(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Jo{constructor(e){this.view=e,this.items=[];let n=l=>{if(l.keyCode==27)kh(this.view),this.view.focus();else if(l.keyCode==38||l.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(l.keyCode==40||l.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(l.keyCode==36)this.moveSelection(0);else if(l.keyCode==35)this.moveSelection(this.items.length-1);else if(l.keyCode==13)this.view.focus();else if(l.keyCode>=65&&l.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:c}=this.items[this.selectedIndex],d=Ch(c.actions);for(let g=0;g<d.length;g++)if(d[g].toUpperCase().charCodeAt(0)==l.keyCode){let w=Ms(this.view.state.field(Bt).diagnostics,c);w&&c.actions[g].apply(e,w.from,w.to)}}else return;l.preventDefault()},r=l=>{for(let c=0;c<this.items.length;c++)this.items[c].dom.contains(l.target)&&this.moveSelection(c)};this.list=Le("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:r}),this.dom=Le("div",{class:"cm-panel-lint"},this.list,Le("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>kh(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(Bt).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(Bt),r=0,l=!1,c=null;for(e.between(0,this.view.state.doc.length,(d,g,{spec:w})=>{let M=-1,T;for(let R=r;R<this.items.length;R++)if(this.items[R].diagnostic==w.diagnostic){M=R;break}M<0?(T=new Mh(this.view,w.diagnostic),this.items.splice(r,0,T),l=!0):(T=this.items[M],M>r&&(this.items.splice(r,M-r),l=!0)),n&&T.diagnostic==n.diagnostic?T.dom.hasAttribute("aria-selected")||(T.dom.setAttribute("aria-selected","true"),c=T):T.dom.hasAttribute("aria-selected")&&T.dom.removeAttribute("aria-selected"),r++});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)l=!0,this.items.pop();this.items.length==0&&(this.items.push(new Mh(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),l=!0),c?(this.list.setAttribute("aria-activedescendant",c.id),this.view.requestMeasure({key:this,read:()=>({sel:c.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:d,panel:g})=>{let w=g.height/this.list.offsetHeight;d.top<g.top?this.list.scrollTop-=(g.top-d.top)/w:d.bottom>g.bottom&&(this.list.scrollTop+=(d.bottom-g.bottom)/w)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),l&&this.sync()}sync(){let e=this.list.firstChild;function n(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)n();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(Bt),r=Ms(n.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:xh.of(r)})}static open(e){return new Jo(e)}}function Qo(s,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(s)}</svg>')`}function Zo(s){return Qo(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${s}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const tf=W.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Zo("#d11")},".cm-lintRange-warning":{backgroundImage:Zo("orange")},".cm-lintRange-info":{backgroundImage:Zo("#999")},".cm-lintRange-hint":{backgroundImage:Zo("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Th(s){return s=="error"?4:s=="warning"?3:s=="info"?2:1}class nf extends W.SJ{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce((n,r)=>Th(n)<Th(r.severity)?r.severity:n,"hint")}toDOM(e){let n=document.createElement("div");n.className="cm-lint-marker cm-lint-marker-"+this.severity;let r=this.diagnostics,l=e.state.facet(el).tooltipFilter;return l&&(r=l(r,e.state)),r.length&&(n.onmouseover=()=>rf(e,n,r)),n}}function sf(s,e){let n=r=>{let l=e.getBoundingClientRect();if(!(r.clientX>l.left-10&&r.clientX<l.right+10&&r.clientY>l.top-10&&r.clientY<l.bottom+10)){for(let c=r.target;c;c=c.parentNode)if(c.nodeType==1&&c.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),s.state.field(Oh)&&s.dispatch({effects:ga.of(null)})}};window.addEventListener("mousemove",n)}function rf(s,e,n){function r(){let d=s.elementAtHeight(e.getBoundingClientRect().top+5-s.documentTop);s.coordsAtPos(d.from)&&s.dispatch({effects:ga.of({pos:d.from,above:!1,create(){return{dom:vh(s,n),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,sf(s,e)}let{hoverTime:l}=s.state.facet(el),c=setTimeout(r,l);e.onmouseout=()=>{clearTimeout(c),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(c),c=setTimeout(r,l)}}function of(s,e){let n=Object.create(null);for(let l of e){let c=s.lineAt(l.from);(n[c.from]||(n[c.from]=[])).push(l)}let r=[];for(let l in n)r.push(new nf(n[l]).range(+l));return L.Xs.of(r,!0)}const lf=(0,W.v5)({class:"cm-gutter-lint",markers:s=>s.state.field(Dh)}),Dh=L.QQ.define({create(){return L.Xs.empty},update(s,e){s=s.map(e.changes);let n=e.state.facet(el).markerFilter;for(let r of e.effects)if(r.is(Yo)){let l=r.value;n&&(l=n(l||[],e.state)),s=of(e.state.doc,l.slice(0))}return s}}),ga=L.Py.define(),Oh=L.QQ.define({create(){return null},update(s,e){return s&&e.docChanged&&(s=bh(e,s)?null:Object.assign(Object.assign({},s),{pos:e.changes.mapPos(s.pos)})),e.effects.reduce((n,r)=>r.is(ga)?r.value:n,s)},provide:s=>W.hJ.from(s)}),af=W.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Qo('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Qo('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Qo('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Bh=[Bt,W.tk.decorations.compute([Bt],s=>{let{selected:e,panel:n}=s.field(Bt);return!e||!n||e.from==e.to?W.p.none:W.p.set([Xc.range(e.from,e.to)])}),(0,W.bF)(Yc,{hideOn:bh}),tf],el=L.r$.define({combine(s){return(0,L.BO)(s,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function Ff(s={}){return[el.of(s),Dh,lf,af,Oh]}function Hf(s,e){let n=s.field(Bt,!1);if(n&&n.diagnostics.size)for(let r=RangeSet.iter([n.diagnostics]);r.value;r.next())e(r.value.spec.diagnostic,r.from,r.to)}var Ph=function(e){e===void 0&&(e={});var{crosshairCursor:n=!1}=e,r=[];e.closeBracketsKeymap!==!1&&(r=r.concat(Wc)),e.defaultKeymap!==!1&&(r=r.concat(ea)),e.searchKeymap!==!1&&(r=r.concat(_h)),e.historyKeymap!==!1&&(r=r.concat(Nl)),e.foldKeymap!==!1&&(r=r.concat(Ir)),e.completionKeymap!==!1&&(r=r.concat(gh)),e.lintKeymap!==!1&&(r=r.concat(Zc));var l=[];return e.lineNumbers!==!1&&l.push((0,W.Eu)()),e.highlightActiveLineGutter!==!1&&l.push((0,W.HQ)()),e.highlightSpecialChars!==!1&&l.push((0,W.AE)()),e.history!==!1&&l.push(Bl()),e.foldGutter!==!1&&l.push(Yn()),e.drawSelection!==!1&&l.push((0,W.Uw)()),e.dropCursor!==!1&&l.push((0,W.qr)()),e.allowMultipleSelections!==!1&&l.push(L.yy.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&l.push(bn()),e.syntaxHighlighting!==!1&&l.push(jr(gl,{fallback:!0})),e.bracketMatching!==!1&&l.push(Kr()),e.closeBrackets!==!1&&l.push(Nc()),e.autocompletion!==!1&&l.push(Uc()),e.rectangularSelection!==!1&&l.push((0,W.Zs)()),n!==!1&&l.push((0,W.S2)()),e.highlightActiveLine!==!1&&l.push((0,W.ZO)()),e.highlightSelectionMatches!==!1&&l.push(y()),e.tabSize&&typeof e.tabSize=="number"&&l.push(K.of(" ".repeat(e.tabSize))),l.concat([W.$f.of(r.flat())]).filter(Boolean)},Wf=function(e){e===void 0&&(e={});var n=[];e.defaultKeymap!==!1&&(n=n.concat(defaultKeymap)),e.historyKeymap!==!1&&(n=n.concat(historyKeymap));var r=[];return e.highlightSpecialChars!==!1&&r.push(highlightSpecialChars()),e.history!==!1&&r.push(history()),e.drawSelection!==!1&&r.push(drawSelection()),e.syntaxHighlighting!==!1&&r.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),r.concat([keymap.of(n.flat())]).filter(Boolean)};const Lh="#e5c07b",ya="#e06c75",Eh="#56b6c2",Rh="#ffffff",Dr="#abb2bf",tl="#7d8799",Ih="#61afef",Nh="#98c379",ba="#d19a66",Fh="#c678dd",Hh="#21252b",wa="#2c313a",xa="#282c34",il="#353a42",Wh="#3E4451",va="#528bff",Vf={chalky:Lh,coral:ya,cyan:Eh,invalid:Rh,ivory:Dr,stone:tl,malibu:Ih,sage:Nh,whiskey:ba,violet:Fh,darkBackground:Hh,highlightBackground:wa,background:xa,tooltipBackground:il,selection:Wh,cursor:va},hf=W.tk.theme({"&":{color:Dr,backgroundColor:xa},".cm-content":{caretColor:va},".cm-cursor, .cm-dropCursor":{borderLeftColor:va},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Wh},".cm-panels":{backgroundColor:Hh,color:Dr},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:xa,color:tl,border:"none"},".cm-activeLineGutter":{backgroundColor:wa},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:il},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:il,borderBottomColor:il},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:wa,color:Dr}}},{dark:!0}),cf=vn.define([{tag:z.keyword,color:Fh},{tag:[z.name,z.deleted,z.character,z.propertyName,z.macroName],color:ya},{tag:[z.function(z.variableName),z.labelName],color:Ih},{tag:[z.color,z.constant(z.name),z.standard(z.name)],color:ba},{tag:[z.definition(z.name),z.separator],color:Dr},{tag:[z.typeName,z.className,z.number,z.changed,z.annotation,z.modifier,z.self,z.namespace],color:Lh},{tag:[z.operator,z.operatorKeyword,z.url,z.escape,z.regexp,z.link,z.special(z.string)],color:Eh},{tag:[z.meta,z.comment],color:tl},{tag:z.strong,fontWeight:"bold"},{tag:z.emphasis,fontStyle:"italic"},{tag:z.strikethrough,textDecoration:"line-through"},{tag:z.link,color:tl,textDecoration:"underline"},{tag:z.heading,fontWeight:"bold",color:ya},{tag:[z.atom,z.bool,z.special(z.variableName)],color:ba},{tag:[z.processingInstruction,z.string,z.inserted],color:Nh},{tag:z.invalid,color:Rh}]),ff=[hf,jr(cf)];var uf=W.tk.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),df=function(e){e===void 0&&(e={});var{indentWithTab:n=!0,editable:r=!0,readOnly:l=!1,theme:c="light",placeholder:d="",basicSetup:g=!0}=e,w=[];switch(n&&w.unshift(W.$f.of([ta])),g&&(typeof g=="boolean"?w.unshift(Ph()):w.unshift(Ph(g))),d&&w.unshift((0,W.W$)(d)),c){case"light":w.push(uf);break;case"dark":w.push(ff);break;case"none":break;default:w.push(c);break}return r===!1&&w.push(W.tk.editable.of(!1)),l&&w.push(L.yy.readOnly.of(!0)),[...w]},pf=s=>({line:s.state.doc.lineAt(s.state.selection.main.from),lineCount:s.state.doc.lines,lineBreak:s.state.lineBreak,length:s.state.doc.length,readOnly:s.state.readOnly,tabSize:s.state.tabSize,selection:s.state.selection,selectionAsSingle:s.state.selection.asSingle().main,ranges:s.state.selection.ranges,selectionCode:s.state.sliceDoc(s.state.selection.main.from,s.state.selection.main.to),selections:s.state.selection.ranges.map(e=>s.state.sliceDoc(e.from,e.to)),selectedText:s.state.selection.ranges.some(e=>!e.empty)}),Vh=L.q6.define(),mf=[];function gf(s){var{value:e,selection:n,onChange:r,onStatistics:l,onCreateEditor:c,onUpdate:d,extensions:g=mf,autoFocus:w,theme:M="light",height:T=null,minHeight:R=null,maxHeight:H=null,width:U=null,minWidth:X=null,maxWidth:se=null,placeholder:Ae="",editable:Te=!0,readOnly:he=!1,indentWithTab:xe=!0,basicSetup:qe=!0,root:re,initialState:ve}=s,[te,Ke]=(0,we.useState)(),[ae,pe]=(0,we.useState)(),[fe,ue]=(0,we.useState)(),_e=W.tk.theme({"&":{height:T,minHeight:R,maxHeight:H,width:U,minWidth:X,maxWidth:se},"& .cm-scroller":{height:"100% !important"}}),Ue=W.tk.updateListener.of(xt=>{if(xt.docChanged&&typeof r=="function"&&!xt.transactions.some(di=>di.annotation(Vh))){var Zt=xt.state.doc,$n=Zt.toString();r($n,xt)}l&&l(pf(xt))}),Pt=df({theme:M,editable:Te,readOnly:he,placeholder:Ae,indentWithTab:xe,basicSetup:qe}),Qt=[Ue,_e,...Pt];return d&&typeof d=="function"&&Qt.push(W.tk.updateListener.of(d)),Qt=Qt.concat(g),(0,we.useEffect)(()=>{if(te&&!fe){var xt={doc:e,selection:n,extensions:Qt},Zt=ve?L.yy.fromJSON(ve.json,xt,ve.fields):L.yy.create(xt);if(ue(Zt),!ae){var $n=new W.tk({state:Zt,parent:te,root:re});pe($n),c&&c($n,Zt)}}return()=>{ae&&(ue(void 0),pe(void 0))}},[te,fe]),(0,we.useEffect)(()=>Ke(s.container),[s.container]),(0,we.useEffect)(()=>()=>{ae&&(ae.destroy(),pe(void 0))},[ae]),(0,we.useEffect)(()=>{w&&ae&&ae.focus()},[w,ae]),(0,we.useEffect)(()=>{ae&&ae.dispatch({effects:L.Py.reconfigure.of(Qt)})},[M,g,T,R,H,U,X,se,Ae,Te,he,xe,qe,r,d]),(0,we.useEffect)(()=>{if(e!==void 0){var xt=ae?ae.state.doc.toString():"";ae&&e!==xt&&ae.dispatch({changes:{from:0,to:xt.length,insert:e||""},annotations:[Vh.of(!0)]})}},[e,ae]),{state:fe,setState:ue,view:ae,setView:pe,container:te,setContainer:Ke}}var yf=Mt(86074),bf=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],jh=(0,we.forwardRef)((s,e)=>{var{className:n,value:r="",selection:l,extensions:c=[],onChange:d,onStatistics:g,onCreateEditor:w,onUpdate:M,autoFocus:T,theme:R="light",height:H,minHeight:U,maxHeight:X,width:se,minWidth:Ae,maxWidth:Te,basicSetup:he,placeholder:xe,indentWithTab:qe,editable:re,readOnly:ve,root:te,initialState:Ke}=s,ae=(0,Ce.Z)(s,bf),pe=(0,we.useRef)(null),{state:fe,view:ue,container:_e}=gf({container:pe.current,root:te,value:r,autoFocus:T,theme:R,height:H,minHeight:U,maxHeight:X,width:se,minWidth:Ae,maxWidth:Te,basicSetup:he,placeholder:xe,indentWithTab:qe,editable:re,readOnly:ve,selection:l,onChange:d,onStatistics:g,onCreateEditor:w,onUpdate:M,extensions:c,initialState:Ke});if((0,we.useImperativeHandle)(e,()=>({editor:pe.current,state:fe,view:ue}),[pe,_e,fe,ue]),typeof r!="string")throw new Error("value must be typeof string but got "+typeof r);var Ue=typeof R=="string"?"cm-theme-"+R:"cm-theme";return(0,yf.jsx)("div",(0,I.Z)({ref:pe,className:""+Ue+(n?" "+n:"")},ae))});jh.displayName="CodeMirror";var wf=jh},78120:function(sl,en,Mt){Mt.d(en,{BO:function(){return Ie},D0:function(){return St},Gz:function(){return vi},IS:function(){return Gn},Py:function(){return et},QQ:function(){return Et},Wl:function(){return Wi},Xs:function(){return ot},YW:function(){return ct},as:function(){return Oe},bg:function(){return Ut},cp:function(){return oe},f_:function(){return Qe},gc:function(){return ht},gm:function(){return at},jT:function(){return ke},n0:function(){return Lt},nZ:function(){return Re},q6:function(){return It},r$:function(){return ze},uU:function(){return ft},xv:function(){return I},yy:function(){return de}});class I{lineAt(u){if(u<0||u>this.length)throw new RangeError(`Invalid position ${u} in document of length ${this.length}`);return this.lineInner(u,!1,1,0)}line(u){if(u<1||u>this.lines)throw new RangeError(`Invalid line number ${u} in ${this.lines}-line document`);return this.lineInner(u,!0,1,0)}replace(u,p,b){[u,p]=We(this,u,p);let v=[];return this.decompose(0,u,v,2),b.length&&b.decompose(0,b.length,v,3),this.decompose(p,this.length,v,1),we.from(v,this.length-(p-u)+b.length)}append(u){return this.replace(this.length,this.length,u)}slice(u,p=this.length){[u,p]=We(this,u,p);let b=[];return this.decompose(u,p,b,0),we.from(b,p-u)}eq(u){if(u==this)return!0;if(u.length!=this.length||u.lines!=this.lines)return!1;let p=this.scanIdentical(u,1),b=this.length-this.scanIdentical(u,-1),v=new Fe(this),C=new Fe(u);for(let A=p,B=p;;){if(v.next(A),C.next(A),A=0,v.lineBreak!=C.lineBreak||v.done!=C.done||v.value!=C.value)return!1;if(B+=v.value.length,v.done||B>=b)return!0}}iter(u=1){return new Fe(this,u)}iterRange(u,p=this.length){return new rt(this,u,p)}iterLines(u,p){let b;if(u==null)b=this.iter();else{p==null&&(p=this.lines+1);let v=this.line(u).from;b=this.iterRange(v,Math.max(v,p==this.lines+1?this.length:p<=1?0:this.line(p-1).to))}return new Q(b)}toString(){return this.sliceString(0)}toJSON(){let u=[];return this.flatten(u),u}constructor(){}static of(u){if(u.length==0)throw new RangeError("A document must have at least one line");return u.length==1&&!u[0]?I.empty:u.length<=32?new Ce(u):we.from(Ce.split(u,[]))}}class Ce extends I{constructor(u,p=L(u)){super(),this.text=u,this.length=p}get lines(){return this.text.length}get children(){return null}lineInner(u,p,b,v){for(let C=0;;C++){let A=this.text[C],B=v+A.length;if((p?b:B)>=u)return new He(v,B,b,A);v=B+1,b++}}decompose(u,p,b,v){let C=u<=0&&p>=this.length?this:new Ce(Ti(this.text,u,p),Math.min(p,this.length)-Math.max(0,u));if(v&1){let A=b.pop(),B=W(C.text,A.text.slice(),0,C.length);if(B.length<=32)b.push(new Ce(B,A.length+C.length));else{let E=B.length>>1;b.push(new Ce(B.slice(0,E)),new Ce(B.slice(E)))}}else b.push(C)}replace(u,p,b){if(!(b instanceof Ce))return super.replace(u,p,b);[u,p]=We(this,u,p);let v=W(this.text,W(b.text,Ti(this.text,0,u)),p),C=this.length+b.length-(p-u);return v.length<=32?new Ce(v,C):we.from(Ce.split(v,[]),C)}sliceString(u,p=this.length,b=`
`){[u,p]=We(this,u,p);let v="";for(let C=0,A=0;C<=p&&A<this.text.length;A++){let B=this.text[A],E=C+B.length;C>u&&A&&(v+=b),u<E&&p>C&&(v+=B.slice(Math.max(0,u-C),p-C)),C=E+1}return v}flatten(u){for(let p of this.text)u.push(p)}scanIdentical(){return 0}static split(u,p){let b=[],v=-1;for(let C of u)b.push(C),v+=C.length+1,b.length==32&&(p.push(new Ce(b,v)),b=[],v=-1);return v>-1&&p.push(new Ce(b,v)),p}}class we extends I{constructor(u,p){super(),this.children=u,this.length=p,this.lines=0;for(let b of u)this.lines+=b.lines}lineInner(u,p,b,v){for(let C=0;;C++){let A=this.children[C],B=v+A.length,E=b+A.lines-1;if((p?E:B)>=u)return A.lineInner(u,p,b,v);v=B+1,b=E+1}}decompose(u,p,b,v){for(let C=0,A=0;A<=p&&C<this.children.length;C++){let B=this.children[C],E=A+B.length;if(u<=E&&p>=A){let j=v&((A<=u?1:0)|(E>=p?2:0));A>=u&&E<=p&&!j?b.push(B):B.decompose(u-A,p-A,b,j)}A=E+1}}replace(u,p,b){if([u,p]=We(this,u,p),b.lines<this.lines)for(let v=0,C=0;v<this.children.length;v++){let A=this.children[v],B=C+A.length;if(u>=C&&p<=B){let E=A.replace(u-C,p-C,b),j=this.lines-A.lines+E.lines;if(E.lines<j>>5-1&&E.lines>j>>5+1){let K=this.children.slice();return K[v]=E,new we(K,this.length-(p-u)+b.length)}return super.replace(C,B,E)}C=B+1}return super.replace(u,p,b)}sliceString(u,p=this.length,b=`
`){[u,p]=We(this,u,p);let v="";for(let C=0,A=0;C<this.children.length&&A<=p;C++){let B=this.children[C],E=A+B.length;A>u&&C&&(v+=b),u<E&&p>A&&(v+=B.sliceString(u-A,p-A,b)),A=E+1}return v}flatten(u){for(let p of this.children)p.flatten(u)}scanIdentical(u,p){if(!(u instanceof we))return 0;let b=0,[v,C,A,B]=p>0?[0,0,this.children.length,u.children.length]:[this.children.length-1,u.children.length-1,-1,-1];for(;;v+=p,C+=p){if(v==A||C==B)return b;let E=this.children[v],j=u.children[C];if(E!=j)return b+E.scanIdentical(j,p);b+=E.length+1}}static from(u,p=u.reduce((b,v)=>b+v.length+1,-1)){let b=0;for(let J of u)b+=J.lines;if(b<32){let J=[];for(let Be of u)Be.flatten(J);return new Ce(J,p)}let v=Math.max(32,b>>5),C=v<<1,A=v>>1,B=[],E=0,j=-1,K=[];function G(J){let Be;if(J.lines>C&&J instanceof we)for(let Ne of J.children)G(Ne);else J.lines>A&&(E>A||!E)?(Z(),B.push(J)):J instanceof Ce&&E&&(Be=K[K.length-1])instanceof Ce&&J.lines+Be.lines<=32?(E+=J.lines,j+=J.length+1,K[K.length-1]=new Ce(Be.text.concat(J.text),Be.length+1+J.length)):(E+J.lines>v&&Z(),E+=J.lines,j+=J.length+1,K.push(J))}function Z(){E!=0&&(B.push(K.length==1?K[0]:we.from(K,j)),j=-1,E=K.length=0)}for(let J of u)G(J);return Z(),B.length==1?B[0]:new we(B,p)}}I.empty=new Ce([""],0);function L(D){let u=-1;for(let p of D)u+=p.length+1;return u}function W(D,u,p=0,b=1e9){for(let v=0,C=0,A=!0;C<D.length&&v<=b;C++){let B=D[C],E=v+B.length;E>=p&&(E>b&&(B=B.slice(0,b-v)),v<p&&(B=B.slice(p-v)),A?(u[u.length-1]+=B,A=!1):u.push(B)),v=E+1}return u}function Ti(D,u,p){return W(D,[""],u,p)}class Fe{constructor(u,p=1){this.dir=p,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[u],this.offsets=[p>0?1:(u instanceof Ce?u.text.length:u.children.length)<<1]}nextInner(u,p){for(this.done=this.lineBreak=!1;;){let b=this.nodes.length-1,v=this.nodes[b],C=this.offsets[b],A=C>>1,B=v instanceof Ce?v.text.length:v.children.length;if(A==(p>0?B:0)){if(b==0)return this.done=!0,this.value="",this;p>0&&this.offsets[b-1]++,this.nodes.pop(),this.offsets.pop()}else if((C&1)==(p>0?0:1)){if(this.offsets[b]+=p,u==0)return this.lineBreak=!0,this.value=`
`,this;u--}else if(v instanceof Ce){let E=v.text[A+(p<0?-1:0)];if(this.offsets[b]+=p,E.length>Math.max(0,u))return this.value=u==0?E:p>0?E.slice(u):E.slice(0,E.length-u),this;u-=E.length}else{let E=v.children[A+(p<0?-1:0)];u>E.length?(u-=E.length,this.offsets[b]+=p):(p<0&&this.offsets[b]--,this.nodes.push(E),this.offsets.push(p>0?1:(E instanceof Ce?E.text.length:E.children.length)<<1))}}}next(u=0){return u<0&&(this.nextInner(-u,-this.dir),u=this.value.length),this.nextInner(u,this.dir)}}class rt{constructor(u,p,b){this.value="",this.done=!1,this.cursor=new Fe(u,p>b?-1:1),this.pos=p>b?u.length:0,this.from=Math.min(p,b),this.to=Math.max(p,b)}nextInner(u,p){if(p<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;u+=Math.max(0,p<0?this.pos-this.to:this.from-this.pos);let b=p<0?this.pos-this.from:this.to-this.pos;u>b&&(u=b),b-=u;let{value:v}=this.cursor.next(u);return this.pos+=(v.length+u)*p,this.value=v.length<=b?v:p<0?v.slice(v.length-b):v.slice(0,b),this.done=!this.value,this}next(u=0){return u<0?u=Math.max(u,this.from-this.pos):u>0&&(u=Math.min(u,this.to-this.pos)),this.nextInner(u,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Q{constructor(u){this.inner=u,this.afterBreak=!0,this.value="",this.done=!1}next(u=0){let{done:p,lineBreak:b,value:v}=this.inner.next(u);return p&&this.afterBreak?(this.value="",this.afterBreak=!1):p?(this.done=!0,this.value=""):b?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=v,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(I.prototype[Symbol.iterator]=function(){return this.iter()},Fe.prototype[Symbol.iterator]=rt.prototype[Symbol.iterator]=Q.prototype[Symbol.iterator]=function(){return this});class He{constructor(u,p,b,v){this.from=u,this.to=p,this.number=b,this.text=v}get length(){return this.to-this.from}}function We(D,u,p){return u=Math.max(0,Math.min(D.length,u)),[u,Math.max(u,Math.min(D.length,p))]}let me="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(D=>D?parseInt(D,36):1);for(let D=1;D<me.length;D++)me[D]+=me[D-1];function Ee(D){for(let u=1;u<me.length;u+=2)if(me[u]>D)return me[u-1]<=D;return!1}function Se(D){return D>=127462&&D<=127487}const Xe=8205;function oe(D,u,p=!0,b=!0){return(p?De:lt)(D,u,b)}function De(D,u,p){if(u==D.length)return u;u&&st(D.charCodeAt(u))&&pi(D.charCodeAt(u-1))&&u--;let b=at(D,u);for(u+=Re(b);u<D.length;){let v=at(D,u);if(b==Xe||v==Xe||p&&Ee(v))u+=Re(v),b=v;else if(Se(v)){let C=0,A=u-2;for(;A>=0&&Se(at(D,A));)C++,A-=2;if(C%2==0)break;u+=2}else break}return u}function lt(D,u,p){for(;u>0;){let b=De(D,u-2,p);if(b<u)return b;u--}return 0}function st(D){return D>=56320&&D<57344}function pi(D){return D>=55296&&D<56320}function at(D,u){let p=D.charCodeAt(u);if(!pi(p)||u+1==D.length)return p;let b=D.charCodeAt(u+1);return st(b)?(p-55296<<10)+(b-56320)+65536:p}function Ut(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}function Re(D){return D<65536?1:2}const ei=/\r\n?|\n/;var ht=function(D){return D[D.Simple=0]="Simple",D[D.TrackDel=1]="TrackDel",D[D.TrackBefore=2]="TrackBefore",D[D.TrackAfter=3]="TrackAfter",D}(ht||(ht={}));class Lt{constructor(u){this.sections=u}get length(){let u=0;for(let p=0;p<this.sections.length;p+=2)u+=this.sections[p];return u}get newLength(){let u=0;for(let p=0;p<this.sections.length;p+=2){let b=this.sections[p+1];u+=b<0?this.sections[p]:b}return u}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(u){for(let p=0,b=0,v=0;p<this.sections.length;){let C=this.sections[p++],A=this.sections[p++];A<0?(u(b,v,C),v+=C):v+=A,b+=C}}iterChangedRanges(u,p=!1){tn(this,u,p)}get invertedDesc(){let u=[];for(let p=0;p<this.sections.length;){let b=this.sections[p++],v=this.sections[p++];v<0?u.push(b,v):u.push(v,b)}return new Lt(u)}composeDesc(u){return this.empty?u:u.empty?this:Ni(this,u)}mapDesc(u,p=!1){return u.empty?this:oi(this,u,p)}mapPos(u,p=-1,b=ht.Simple){let v=0,C=0;for(let A=0;A<this.sections.length;){let B=this.sections[A++],E=this.sections[A++],j=v+B;if(E<0){if(j>u)return C+(u-v);C+=B}else{if(b!=ht.Simple&&j>=u&&(b==ht.TrackDel&&v<u&&j>u||b==ht.TrackBefore&&v<u||b==ht.TrackAfter&&j>u))return null;if(j>u||j==u&&p<0&&!B)return u==v||p<0?C:C+E;C+=E}v=j}if(u>v)throw new RangeError(`Position ${u} is out of range for changeset of length ${v}`);return C}touchesRange(u,p=u){for(let b=0,v=0;b<this.sections.length&&v<=p;){let C=this.sections[b++],A=this.sections[b++],B=v+C;if(A>=0&&v<=p&&B>=u)return v<u&&B>p?"cover":!0;v=B}return!1}toString(){let u="";for(let p=0;p<this.sections.length;){let b=this.sections[p++],v=this.sections[p++];u+=(u?" ":"")+b+(v>=0?":"+v:"")}return u}toJSON(){return this.sections}static fromJSON(u){if(!Array.isArray(u)||u.length%2||u.some(p=>typeof p!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Lt(u)}static create(u){return new Lt(u)}}class Oe extends Lt{constructor(u,p){super(u),this.inserted=p}apply(u){if(this.length!=u.length)throw new RangeError("Applying change set to a document with the wrong length");return tn(this,(p,b,v,C,A)=>u=u.replace(v,v+(b-p),A),!1),u}mapDesc(u,p=!1){return oi(this,u,p,!0)}invert(u){let p=this.sections.slice(),b=[];for(let v=0,C=0;v<p.length;v+=2){let A=p[v],B=p[v+1];if(B>=0){p[v]=B,p[v+1]=A;let E=v>>1;for(;b.length<E;)b.push(I.empty);b.push(A?u.slice(C,C+A):I.empty)}C+=A}return new Oe(p,b)}compose(u){return this.empty?u:u.empty?this:Ni(this,u,!0)}map(u,p=!1){return u.empty?this:oi(this,u,p,!0)}iterChanges(u,p=!1){tn(this,u,p)}get desc(){return Lt.create(this.sections)}filter(u){let p=[],b=[],v=[],C=new mi(this);e:for(let A=0,B=0;;){let E=A==u.length?1e9:u[A++];for(;B<E||B==E&&C.len==0;){if(C.done)break e;let K=Math.min(C.len,E-B);Ve(v,K,-1);let G=C.ins==-1?-1:C.off==0?C.ins:0;Ve(p,K,G),G>0&&vt(b,p,C.text),C.forward(K),B+=K}let j=u[A++];for(;B<j;){if(C.done)break e;let K=Math.min(C.len,j-B);Ve(p,K,-1),Ve(v,K,C.ins==-1?-1:C.off==0?C.ins:0),C.forward(K),B+=K}}return{changes:new Oe(p,b),filtered:Lt.create(v)}}toJSON(){let u=[];for(let p=0;p<this.sections.length;p+=2){let b=this.sections[p],v=this.sections[p+1];v<0?u.push(b):v==0?u.push([b]):u.push([b].concat(this.inserted[p>>1].toJSON()))}return u}static of(u,p,b){let v=[],C=[],A=0,B=null;function E(K=!1){if(!K&&!v.length)return;A<p&&Ve(v,p-A,-1);let G=new Oe(v,C);B=B?B.compose(G.map(B)):G,v=[],C=[],A=0}function j(K){if(Array.isArray(K))for(let G of K)j(G);else if(K instanceof Oe){if(K.length!=p)throw new RangeError(`Mismatched change set length (got ${K.length}, expected ${p})`);E(),B=B?B.compose(K.map(B)):K}else{let{from:G,to:Z=G,insert:J}=K;if(G>Z||G<0||Z>p)throw new RangeError(`Invalid change range ${G} to ${Z} (in doc of length ${p})`);let Be=J?typeof J=="string"?I.of(J.split(b||ei)):J:I.empty,Ne=Be.length;if(G==Z&&Ne==0)return;G<A&&E(),G>A&&Ve(v,G-A,-1),Ve(v,Z-G,Ne),vt(C,v,Be),A=Z}}return j(u),E(!B),B}static empty(u){return new Oe(u?[u,-1]:[],[])}static fromJSON(u){if(!Array.isArray(u))throw new RangeError("Invalid JSON representation of ChangeSet");let p=[],b=[];for(let v=0;v<u.length;v++){let C=u[v];if(typeof C=="number")p.push(C,-1);else{if(!Array.isArray(C)||typeof C[0]!="number"||C.some((A,B)=>B&&typeof A!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(C.length==1)p.push(C[0],0);else{for(;b.length<v;)b.push(I.empty);b[v]=I.of(C.slice(1)),p.push(C[0],b[v].length)}}}return new Oe(p,b)}static createSet(u,p){return new Oe(u,p)}}function Ve(D,u,p,b=!1){if(u==0&&p<=0)return;let v=D.length-2;v>=0&&p<=0&&p==D[v+1]?D[v]+=u:u==0&&D[v]==0?D[v+1]+=p:b?(D[v]+=u,D[v+1]+=p):D.push(u,p)}function vt(D,u,p){if(p.length==0)return;let b=u.length-2>>1;if(b<D.length)D[D.length-1]=D[D.length-1].append(p);else{for(;D.length<b;)D.push(I.empty);D.push(p)}}function tn(D,u,p){let b=D.inserted;for(let v=0,C=0,A=0;A<D.sections.length;){let B=D.sections[A++],E=D.sections[A++];if(E<0)v+=B,C+=B;else{let j=v,K=C,G=I.empty;for(;j+=B,K+=E,E&&b&&(G=G.append(b[A-2>>1])),!(p||A==D.sections.length||D.sections[A+1]<0);)B=D.sections[A++],E=D.sections[A++];u(v,j,C,K,G),v=j,C=K}}}function oi(D,u,p,b=!1){let v=[],C=b?[]:null,A=new mi(D),B=new mi(u);for(let E=-1;;)if(A.ins==-1&&B.ins==-1){let j=Math.min(A.len,B.len);Ve(v,j,-1),A.forward(j),B.forward(j)}else if(B.ins>=0&&(A.ins<0||E==A.i||A.off==0&&(B.len<A.len||B.len==A.len&&!p))){let j=B.len;for(Ve(v,B.ins,-1);j;){let K=Math.min(A.len,j);A.ins>=0&&E<A.i&&A.len<=K&&(Ve(v,0,A.ins),C&&vt(C,v,A.text),E=A.i),A.forward(K),j-=K}B.next()}else if(A.ins>=0){let j=0,K=A.len;for(;K;)if(B.ins==-1){let G=Math.min(K,B.len);j+=G,K-=G,B.forward(G)}else if(B.ins==0&&B.len<K)K-=B.len,B.next();else break;Ve(v,j,E<A.i?A.ins:0),C&&E<A.i&&vt(C,v,A.text),E=A.i,A.forward(A.len-K)}else{if(A.done&&B.done)return C?Oe.createSet(v,C):Lt.create(v);throw new Error("Mismatched change set lengths")}}function Ni(D,u,p=!1){let b=[],v=p?[]:null,C=new mi(D),A=new mi(u);for(let B=!1;;){if(C.done&&A.done)return v?Oe.createSet(b,v):Lt.create(b);if(C.ins==0)Ve(b,C.len,0,B),C.next();else if(A.len==0&&!A.done)Ve(b,0,A.ins,B),v&&vt(v,b,A.text),A.next();else{if(C.done||A.done)throw new Error("Mismatched change set lengths");{let E=Math.min(C.len2,A.len),j=b.length;if(C.ins==-1){let K=A.ins==-1?-1:A.off?0:A.ins;Ve(b,E,K,B),v&&K&&vt(v,b,A.text)}else A.ins==-1?(Ve(b,C.off?0:C.len,E,B),v&&vt(v,b,C.textBit(E))):(Ve(b,C.off?0:C.len,A.off?0:A.ins,B),v&&!A.off&&vt(v,b,A.text));B=(C.ins>E||A.ins>=0&&A.len>E)&&(B||b.length>j),C.forward2(E),A.forward(E)}}}}class mi{constructor(u){this.set=u,this.i=0,this.next()}next(){let{sections:u}=this.set;this.i<u.length?(this.len=u[this.i++],this.ins=u[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:u}=this.set,p=this.i-2>>1;return p>=u.length?I.empty:u[p]}textBit(u){let{inserted:p}=this.set,b=this.i-2>>1;return b>=p.length&&!u?I.empty:p[b].slice(this.off,u==null?void 0:this.off+u)}forward(u){u==this.len?this.next():(this.len-=u,this.off+=u)}forward2(u){this.ins==-1?this.forward(u):u==this.ins?this.next():(this.ins-=u,this.off+=u)}}class je{constructor(u,p,b){this.from=u,this.to=p,this.flags=b}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let u=this.flags&7;return u==7?null:u}get goalColumn(){let u=this.flags>>6;return u==16777215?void 0:u}map(u,p=-1){let b,v;return this.empty?b=v=u.mapPos(this.from,p):(b=u.mapPos(this.from,1),v=u.mapPos(this.to,-1)),b==this.from&&v==this.to?this:new je(b,v,this.flags)}extend(u,p=u){if(u<=this.anchor&&p>=this.anchor)return ke.range(u,p);let b=Math.abs(u-this.anchor)>Math.abs(p-this.anchor)?u:p;return ke.range(this.anchor,b)}eq(u,p=!1){return this.anchor==u.anchor&&this.head==u.head&&(!p||!this.empty||this.assoc==u.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(u){if(!u||typeof u.anchor!="number"||typeof u.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ke.range(u.anchor,u.head)}static create(u,p,b){return new je(u,p,b)}}class ke{constructor(u,p){this.ranges=u,this.mainIndex=p}map(u,p=-1){return u.empty?this:ke.create(this.ranges.map(b=>b.map(u,p)),this.mainIndex)}eq(u,p=!1){if(this.ranges.length!=u.ranges.length||this.mainIndex!=u.mainIndex)return!1;for(let b=0;b<this.ranges.length;b++)if(!this.ranges[b].eq(u.ranges[b],p))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ke([this.main],0)}addRange(u,p=!0){return ke.create([u].concat(this.ranges),p?0:this.mainIndex+1)}replaceRange(u,p=this.mainIndex){let b=this.ranges.slice();return b[p]=u,ke.create(b,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(u=>u.toJSON()),main:this.mainIndex}}static fromJSON(u){if(!u||!Array.isArray(u.ranges)||typeof u.main!="number"||u.main>=u.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ke(u.ranges.map(p=>je.fromJSON(p)),u.main)}static single(u,p=u){return new ke([ke.range(u,p)],0)}static create(u,p=0){if(u.length==0)throw new RangeError("A selection needs at least one range");for(let b=0,v=0;v<u.length;v++){let C=u[v];if(C.empty?C.from<=b:C.from<b)return ke.normalized(u.slice(),p);b=C.to}return new ke(u,p)}static cursor(u,p=0,b,v){return je.create(u,u,(p==0?0:p<0?8:16)|(b==null?7:Math.min(6,b))|(v!=null?v:16777215)<<6)}static range(u,p,b,v){let C=(b!=null?b:16777215)<<6|(v==null?7:Math.min(6,v));return p<u?je.create(p,u,48|C):je.create(u,p,(p>u?8:0)|C)}static normalized(u,p=0){let b=u[p];u.sort((v,C)=>v.from-C.from),p=u.indexOf(b);for(let v=1;v<u.length;v++){let C=u[v],A=u[v-1];if(C.empty?C.from<=A.to:C.from<A.to){let B=A.from,E=Math.max(C.to,A.to);v<=p&&p--,u.splice(--v,2,C.anchor>C.head?ke.range(E,B):ke.range(B,E))}}return new ke(u,p)}}function Me(D,u){for(let p of D.ranges)if(p.to>u)throw new RangeError("Selection points outside of document")}let nn=0;class ze{constructor(u,p,b,v,C){this.combine=u,this.compareInput=p,this.compare=b,this.isStatic=v,this.id=nn++,this.default=u([]),this.extensions=typeof C=="function"?C(this):C}get reader(){return this}static define(u={}){return new ze(u.combine||(p=>p),u.compareInput||((p,b)=>p===b),u.compare||(u.combine?(p,b)=>p===b:Fi),!!u.static,u.enables)}of(u){return new Di([],this,0,u)}compute(u,p){if(this.isStatic)throw new Error("Can't compute a static facet");return new Di(u,this,1,p)}computeN(u,p){if(this.isStatic)throw new Error("Can't compute a static facet");return new Di(u,this,2,p)}from(u,p){return p||(p=b=>b),this.compute([u],b=>p(b.field(u)))}}function Fi(D,u){return D==u||D.length==u.length&&D.every((p,b)=>p===u[b])}class Di{constructor(u,p,b,v){this.dependencies=u,this.facet=p,this.type=b,this.value=v,this.id=nn++}dynamicSlot(u){var p;let b=this.value,v=this.facet.compareInput,C=this.id,A=u[C]>>1,B=this.type==2,E=!1,j=!1,K=[];for(let G of this.dependencies)G=="doc"?E=!0:G=="selection"?j=!0:((p=u[G.id])!==null&&p!==void 0?p:1)&1||K.push(u[G.id]);return{create(G){return G.values[A]=b(G),1},update(G,Z){if(E&&Z.docChanged||j&&(Z.docChanged||Z.selection)||gi(G,K)){let J=b(G);if(B?!kt(J,G.values[A],v):!v(J,G.values[A]))return G.values[A]=J,1}return 0},reconfigure:(G,Z)=>{let J,Be=Z.config.address[C];if(Be!=null){let Ne=Tt(Z,Be);if(this.dependencies.every(Ge=>Ge instanceof ze?Z.facet(Ge)===G.facet(Ge):Ge instanceof Et?Z.field(Ge,!1)==G.field(Ge,!1):!0)||(B?kt(J=b(G),Ne,v):v(J=b(G),Ne)))return G.values[A]=Ne,0}else J=b(G);return G.values[A]=J,1}}}}function kt(D,u,p){if(D.length!=u.length)return!1;for(let b=0;b<D.length;b++)if(!p(D[b],u[b]))return!1;return!0}function gi(D,u){let p=!1;for(let b of u)mt(D,b)&1&&(p=!0);return p}function Hi(D,u,p){let b=p.map(E=>D[E.id]),v=p.map(E=>E.type),C=b.filter(E=>!(E&1)),A=D[u.id]>>1;function B(E){let j=[];for(let K=0;K<b.length;K++){let G=Tt(E,b[K]);if(v[K]==2)for(let Z of G)j.push(Z);else j.push(G)}return u.combine(j)}return{create(E){for(let j of b)mt(E,j);return E.values[A]=B(E),1},update(E,j){if(!gi(E,C))return 0;let K=B(E);return u.compare(K,E.values[A])?0:(E.values[A]=K,1)},reconfigure(E,j){let K=gi(E,b),G=j.config.facets[u.id],Z=j.facet(u);if(G&&!K&&Fi(p,G))return E.values[A]=Z,0;let J=B(E);return u.compare(J,Z)?(E.values[A]=Z,0):(E.values[A]=J,1)}}}const sn=ze.define({static:!0});class Et{constructor(u,p,b,v,C){this.id=u,this.createF=p,this.updateF=b,this.compareF=v,this.spec=C,this.provides=void 0}static define(u){let p=new Et(nn++,u.create,u.update,u.compare||((b,v)=>b===v),u);return u.provide&&(p.provides=u.provide(p)),p}create(u){let p=u.facet(sn).find(b=>b.field==this);return((p==null?void 0:p.create)||this.createF)(u)}slot(u){let p=u[this.id]>>1;return{create:b=>(b.values[p]=this.create(b),1),update:(b,v)=>{let C=b.values[p],A=this.updateF(C,v);return this.compareF(C,A)?0:(b.values[p]=A,1)},reconfigure:(b,v)=>v.config.address[this.id]!=null?(b.values[p]=v.field(this),0):(b.values[p]=this.create(b),1)}}init(u){return[this,sn.of({field:this,create:u})]}get extension(){return this}}const zt={lowest:4,low:3,default:2,high:1,highest:0};function yi(D){return u=>new rn(u,D)}const Wi={highest:yi(zt.highest),high:yi(zt.high),default:yi(zt.default),low:yi(zt.low),lowest:yi(zt.lowest)};class rn{constructor(u,p){this.inner=u,this.prec=p}}class bi{of(u){return new Vi(this,u)}reconfigure(u){return bi.reconfigure.of({compartment:this,extension:u})}get(u){return u.config.compartments.get(this)}}class Vi{constructor(u,p){this.compartment=u,this.inner=p}}class Y{constructor(u,p,b,v,C,A){for(this.base=u,this.compartments=p,this.dynamicSlots=b,this.address=v,this.staticValues=C,this.facets=A,this.statusTemplate=[];this.statusTemplate.length<b.length;)this.statusTemplate.push(0)}staticFacet(u){let p=this.address[u.id];return p==null?u.default:this.staticValues[p>>1]}static resolve(u,p,b){let v=[],C=Object.create(null),A=new Map;for(let Z of Ds(u,p,A))Z instanceof Et?v.push(Z):(C[Z.facet.id]||(C[Z.facet.id]=[])).push(Z);let B=Object.create(null),E=[],j=[];for(let Z of v)B[Z.id]=j.length<<1,j.push(J=>Z.slot(J));let K=b==null?void 0:b.config.facets;for(let Z in C){let J=C[Z],Be=J[0].facet,Ne=K&&K[Z]||[];if(J.every(Ge=>Ge.type==0))if(B[Be.id]=E.length<<1|1,Fi(Ne,J))E.push(b.facet(Be));else{let Ge=Be.combine(J.map(gn=>gn.value));E.push(b&&Be.compare(Ge,b.facet(Be))?b.facet(Be):Ge)}else{for(let Ge of J)Ge.type==0?(B[Ge.id]=E.length<<1|1,E.push(Ge.value)):(B[Ge.id]=j.length<<1,j.push(gn=>Ge.dynamicSlot(gn)));B[Be.id]=j.length<<1,j.push(Ge=>Hi(Ge,Be,J))}}let G=j.map(Z=>Z(B));return new Y(u,A,G,B,E,C)}}function Ds(D,u,p){let b=[[],[],[],[],[]],v=new Map;function C(A,B){let E=v.get(A);if(E!=null){if(E<=B)return;let j=b[E].indexOf(A);j>-1&&b[E].splice(j,1),A instanceof Vi&&p.delete(A.compartment)}if(v.set(A,B),Array.isArray(A))for(let j of A)C(j,B);else if(A instanceof Vi){if(p.has(A.compartment))throw new RangeError("Duplicate use of compartment in extensions");let j=u.get(A.compartment)||A.inner;p.set(A.compartment,j),C(j,B)}else if(A instanceof rn)C(A.inner,A.prec);else if(A instanceof Et)b[B].push(A),A.provides&&C(A.provides,B);else if(A instanceof Di)b[B].push(A),A.facet.extensions&&C(A.facet.extensions,zt.default);else{let j=A.extension;if(!j)throw new Error(`Unrecognized extension value in extension set (${A}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);C(j,B)}}return C(D,zt.default),b.reduce((A,B)=>A.concat(B))}function mt(D,u){if(u&1)return 2;let p=u>>1,b=D.status[p];if(b==4)throw new Error("Cyclic dependency between fields and/or facets");if(b&2)return b;D.status[p]=4;let v=D.computeSlot(D,D.config.dynamicSlots[p]);return D.status[p]=2|v}function Tt(D,u){return u&1?D.config.staticValues[u>>1]:D.values[u>>1]}const Rt=ze.define(),$t=ze.define({combine:D=>D.some(u=>u),static:!0}),qt=ze.define({combine:D=>D.length?D[0]:void 0,static:!0}),on=ze.define(),ln=ze.define(),an=ze.define(),hn=ze.define({combine:D=>D.length?D[0]:!1});class It{constructor(u,p){this.type=u,this.value=p}static define(){return new cn}}class cn{of(u){return new It(this,u)}}class fn{constructor(u){this.map=u}of(u){return new et(this,u)}}class et{constructor(u,p){this.type=u,this.value=p}map(u){let p=this.type.map(this.value,u);return p===void 0?void 0:p==this.value?this:new et(this.type,p)}is(u){return this.type==u}static define(u={}){return new fn(u.map||(p=>p))}static mapEffects(u,p){if(!u.length)return u;let b=[];for(let v of u){let C=v.map(p);C&&b.push(C)}return b}}et.reconfigure=et.define(),et.appendConfig=et.define();class ct{constructor(u,p,b,v,C,A){this.startState=u,this.changes=p,this.selection=b,this.effects=v,this.annotations=C,this.scrollIntoView=A,this._doc=null,this._state=null,b&&Me(b,p.newLength),C.some(B=>B.type==ct.time)||(this.annotations=C.concat(ct.time.of(Date.now())))}static create(u,p,b,v,C,A){return new ct(u,p,b,v,C,A)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(u){for(let p of this.annotations)if(p.type==u)return p.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(u){let p=this.annotation(ct.userEvent);return!!(p&&(p==u||p.length>u.length&&p.slice(0,u.length)==u&&p[u.length]=="."))}}ct.time=It.define(),ct.userEvent=It.define(),ct.addToHistory=It.define(),ct.remote=It.define();function tt(D,u){let p=[];for(let b=0,v=0;;){let C,A;if(b<D.length&&(v==u.length||u[v]>=D[b]))C=D[b++],A=D[b++];else if(v<u.length)C=u[v++],A=u[v++];else return p;!p.length||p[p.length-1]<C?p.push(C,A):p[p.length-1]<A&&(p[p.length-1]=A)}}function Gt(D,u,p){var b;let v,C,A;return p?(v=u.changes,C=Oe.empty(u.changes.length),A=D.changes.compose(u.changes)):(v=u.changes.map(D.changes),C=D.changes.mapDesc(u.changes,!0),A=D.changes.compose(v)),{changes:A,selection:u.selection?u.selection.map(C):(b=D.selection)===null||b===void 0?void 0:b.map(v),effects:et.mapEffects(D.effects,v).concat(et.mapEffects(u.effects,C)),annotations:D.annotations.length?D.annotations.concat(u.annotations):u.annotations,scrollIntoView:D.scrollIntoView||u.scrollIntoView}}function _(D,u,p){let b=u.selection,v=Je(u.annotations);return u.userEvent&&(v=v.concat(ct.userEvent.of(u.userEvent))),{changes:u.changes instanceof Oe?u.changes:Oe.of(u.changes||[],p,D.facet(qt)),selection:b&&(b instanceof ke?b:ke.single(b.anchor,b.head)),effects:Je(u.effects),annotations:v,scrollIntoView:!!u.scrollIntoView}}function it(D,u,p){let b=_(D,u.length?u[0]:{},D.doc.length);u.length&&u[0].filter===!1&&(p=!1);for(let C=1;C<u.length;C++){u[C].filter===!1&&(p=!1);let A=!!u[C].sequential;b=Gt(b,_(D,u[C],A?b.changes.newLength:D.doc.length),A)}let v=ct.create(D,b.changes,b.selection,b.effects,b.annotations,b.scrollIntoView);return wi(p?ge(v):v)}function ge(D){let u=D.startState,p=!0;for(let v of u.facet(on)){let C=v(D);if(C===!1){p=!1;break}Array.isArray(C)&&(p=p===!0?C:tt(p,C))}if(p!==!0){let v,C;if(p===!1)C=D.changes.invertedDesc,v=Oe.empty(u.doc.length);else{let A=D.changes.filter(p);v=A.changes,C=A.filtered.mapDesc(A.changes).invertedDesc}D=ct.create(u,v,D.selection&&D.selection.map(C),et.mapEffects(D.effects,C),D.annotations,D.scrollIntoView)}let b=u.facet(ln);for(let v=b.length-1;v>=0;v--){let C=b[v](D);C instanceof ct?D=C:Array.isArray(C)&&C.length==1&&C[0]instanceof ct?D=C[0]:D=it(u,Je(C),!1)}return D}function wi(D){let u=D.startState,p=u.facet(an),b=D;for(let v=p.length-1;v>=0;v--){let C=p[v](D);C&&Object.keys(C).length&&(b=Gt(b,_(u,C,D.changes.newLength),!0))}return b==D?D:ct.create(u,D.changes,D.selection,b.effects,b.annotations,b.scrollIntoView)}const xi=[];function Je(D){return D==null?xi:Array.isArray(D)?D:[D]}var St=function(D){return D[D.Word=0]="Word",D[D.Space=1]="Space",D[D.Other=2]="Other",D}(St||(St={}));const un=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let gt;try{gt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(D){}function Nt(D){if(gt)return gt.test(D);for(let u=0;u<D.length;u++){let p=D[u];if(/\w/.test(p)||p>"\x80"&&(p.toUpperCase()!=p.toLowerCase()||un.test(p)))return!0}return!1}function Ct(D){return u=>{if(!/\S/.test(u))return St.Space;if(Nt(u))return St.Word;for(let p=0;p<D.length;p++)if(u.indexOf(D[p])>-1)return St.Word;return St.Other}}class de{constructor(u,p,b,v,C,A){this.config=u,this.doc=p,this.selection=b,this.values=v,this.status=u.statusTemplate.slice(),this.computeSlot=C,A&&(A._state=this);for(let B=0;B<this.config.dynamicSlots.length;B++)mt(this,B<<1);this.computeSlot=null}field(u,p=!0){let b=this.config.address[u.id];if(b==null){if(p)throw new RangeError("Field is not present in this state");return}return mt(this,b),Tt(this,b)}update(...u){return it(this,u,!0)}applyTransaction(u){let p=this.config,{base:b,compartments:v}=p;for(let B of u.effects)B.is(bi.reconfigure)?(p&&(v=new Map,p.compartments.forEach((E,j)=>v.set(j,E)),p=null),v.set(B.value.compartment,B.value.extension)):B.is(et.reconfigure)?(p=null,b=B.value):B.is(et.appendConfig)&&(p=null,b=Je(b).concat(B.value));let C;p?C=u.startState.values.slice():(p=Y.resolve(b,v,this),C=new de(p,this.doc,this.selection,p.dynamicSlots.map(()=>null),(E,j)=>j.reconfigure(E,this),null).values);let A=u.startState.facet($t)?u.newSelection:u.newSelection.asSingle();new de(p,u.newDoc,A,C,(B,E)=>E.update(B,u),u)}replaceSelection(u){return typeof u=="string"&&(u=this.toText(u)),this.changeByRange(p=>({changes:{from:p.from,to:p.to,insert:u},range:ke.cursor(p.from+u.length)}))}changeByRange(u){let p=this.selection,b=u(p.ranges[0]),v=this.changes(b.changes),C=[b.range],A=Je(b.effects);for(let B=1;B<p.ranges.length;B++){let E=u(p.ranges[B]),j=this.changes(E.changes),K=j.map(v);for(let Z=0;Z<B;Z++)C[Z]=C[Z].map(K);let G=v.mapDesc(j,!0);C.push(E.range.map(G)),v=v.compose(K),A=et.mapEffects(A,K).concat(et.mapEffects(Je(E.effects),G))}return{changes:v,selection:ke.create(C,p.mainIndex),effects:A}}changes(u=[]){return u instanceof Oe?u:Oe.of(u,this.doc.length,this.facet(de.lineSeparator))}toText(u){return I.of(u.split(this.facet(de.lineSeparator)||ei))}sliceDoc(u=0,p=this.doc.length){return this.doc.sliceString(u,p,this.lineBreak)}facet(u){let p=this.config.address[u.id];return p==null?u.default:(mt(this,p),Tt(this,p))}toJSON(u){let p={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(u)for(let b in u){let v=u[b];v instanceof Et&&this.config.address[v.id]!=null&&(p[b]=v.spec.toJSON(this.field(u[b]),this))}return p}static fromJSON(u,p={},b){if(!u||typeof u.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let v=[];if(b){for(let C in b)if(Object.prototype.hasOwnProperty.call(u,C)){let A=b[C],B=u[C];v.push(A.init(E=>A.spec.fromJSON(B,E)))}}return de.create({doc:u.doc,selection:ke.fromJSON(u.selection),extensions:p.extensions?v.concat([p.extensions]):v})}static create(u={}){let p=Y.resolve(u.extensions||[],new Map),b=u.doc instanceof I?u.doc:I.of((u.doc||"").split(p.staticFacet(de.lineSeparator)||ei)),v=u.selection?u.selection instanceof ke?u.selection:ke.single(u.selection.anchor,u.selection.head):ke.single(0);return Me(v,b.length),p.staticFacet($t)||(v=v.asSingle()),new de(p,b,v,p.dynamicSlots.map(()=>null),(C,A)=>A.create(C),null)}get tabSize(){return this.facet(de.tabSize)}get lineBreak(){return this.facet(de.lineSeparator)||`
`}get readOnly(){return this.facet(hn)}phrase(u,...p){for(let b of this.facet(de.phrases))if(Object.prototype.hasOwnProperty.call(b,u)){u=b[u];break}return p.length&&(u=u.replace(/\$(\$|\d*)/g,(b,v)=>{if(v=="$")return"$";let C=+(v||1);return!C||C>p.length?b:p[C-1]})),u}languageDataAt(u,p,b=-1){let v=[];for(let C of this.facet(Rt))for(let A of C(this,p,b))Object.prototype.hasOwnProperty.call(A,u)&&v.push(A[u]);return v}charCategorizer(u){return Ct(this.languageDataAt("wordChars",u).join(""))}wordAt(u){let{text:p,from:b,length:v}=this.doc.lineAt(u),C=this.charCategorizer(u),A=u-b,B=u-b;for(;A>0;){let E=oe(p,A,!1);if(C(p.slice(E,A))!=St.Word)break;A=E}for(;B<v;){let E=oe(p,B);if(C(p.slice(B,E))!=St.Word)break;B=E}return A==B?null:ke.range(A+b,B+b)}}de.allowMultipleSelections=$t,de.tabSize=ze.define({combine:D=>D.length?D[0]:4}),de.lineSeparator=qt,de.readOnly=hn,de.phrases=ze.define({compare(D,u){let p=Object.keys(D),b=Object.keys(u);return p.length==b.length&&p.every(v=>D[v]==u[v])}}),de.languageData=Rt,de.changeFilter=on,de.transactionFilter=ln,de.transactionExtender=an,bi.reconfigure=et.define();function Ie(D,u,p={}){let b={};for(let v of D)for(let C of Object.keys(v)){let A=v[C],B=b[C];if(B===void 0)b[C]=A;else if(!(B===A||A===void 0))if(Object.hasOwnProperty.call(p,C))b[C]=p[C](B,A);else throw new Error("Config merge conflict for field "+C)}for(let v in u)b[v]===void 0&&(b[v]=u[v]);return b}class ft{eq(u){return this==u}range(u,p=u){return Kt.create(u,p,this)}}ft.prototype.startSide=ft.prototype.endSide=0,ft.prototype.point=!1,ft.prototype.mapMode=ht.TrackDel;class Kt{constructor(u,p,b){this.from=u,this.to=p,this.value=b}static create(u,p,b){return new Kt(u,p,b)}}function z(D,u){return D.from-u.from||D.value.startSide-u.value.startSide}class Kn{constructor(u,p,b,v){this.from=u,this.to=p,this.value=b,this.maxPoint=v}get length(){return this.to[this.to.length-1]}findIndex(u,p,b,v=0){let C=b?this.to:this.from;for(let A=v,B=C.length;;){if(A==B)return A;let E=A+B>>1,j=C[E]-u||(b?this.value[E].endSide:this.value[E].startSide)-p;if(E==A)return j>=0?A:B;j>=0?B=E:A=E+1}}between(u,p,b,v){for(let C=this.findIndex(p,-1e9,!0),A=this.findIndex(b,1e9,!1,C);C<A;C++)if(v(this.from[C]+u,this.to[C]+u,this.value[C])===!1)return!1}map(u,p){let b=[],v=[],C=[],A=-1,B=-1;for(let E=0;E<this.value.length;E++){let j=this.value[E],K=this.from[E]+u,G=this.to[E]+u,Z,J;if(K==G){let Be=p.mapPos(K,j.startSide,j.mapMode);if(Be==null||(Z=J=Be,j.startSide!=j.endSide&&(J=p.mapPos(K,j.endSide),J<Z)))continue}else if(Z=p.mapPos(K,j.startSide),J=p.mapPos(G,j.endSide),Z>J||Z==J&&j.startSide>0&&j.endSide<=0)continue;(J-Z||j.endSide-j.startSide)<0||(A<0&&(A=Z),j.point&&(B=Math.max(B,J-Z)),b.push(j),v.push(Z-A),C.push(J-A))}return{mapped:b.length?new Kn(v,C,b,B):null,pos:A}}}class ot{constructor(u,p,b,v){this.chunkPos=u,this.chunk=p,this.nextLayer=b,this.maxPoint=v}static create(u,p,b,v){return new ot(u,p,b,v)}get length(){let u=this.chunk.length-1;return u<0?0:Math.max(this.chunkEnd(u),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let u=this.nextLayer.size;for(let p of this.chunk)u+=p.value.length;return u}chunkEnd(u){return this.chunkPos[u]+this.chunk[u].length}update(u){let{add:p=[],sort:b=!1,filterFrom:v=0,filterTo:C=this.length}=u,A=u.filter;if(p.length==0&&!A)return this;if(b&&(p=p.slice().sort(z)),this.isEmpty)return p.length?ot.of(p):this;let B=new Un(this,null,-1).goto(0),E=0,j=[],K=new Qe;for(;B.value||E<p.length;)if(E<p.length&&(B.from-p[E].from||B.startSide-p[E].value.startSide)>=0){let G=p[E++];K.addInner(G.from,G.to,G.value)||j.push(G)}else B.rangeIndex==1&&B.chunkIndex<this.chunk.length&&(E==p.length||this.chunkEnd(B.chunkIndex)<p[E].from)&&(!A||v>this.chunkEnd(B.chunkIndex)||C<this.chunkPos[B.chunkIndex])&&K.addChunk(this.chunkPos[B.chunkIndex],this.chunk[B.chunkIndex])?B.nextChunk():((!A||v>B.to||C<B.from||A(B.from,B.to,B.value))&&(K.addInner(B.from,B.to,B.value)||j.push(Kt.create(B.from,B.to,B.value))),B.next());return K.finishInner(this.nextLayer.isEmpty&&!j.length?ot.empty:this.nextLayer.update({add:j,filter:A,filterFrom:v,filterTo:C}))}map(u){if(u.empty||this.isEmpty)return this;let p=[],b=[],v=-1;for(let A=0;A<this.chunk.length;A++){let B=this.chunkPos[A],E=this.chunk[A],j=u.touchesRange(B,B+E.length);if(j===!1)v=Math.max(v,E.maxPoint),p.push(E),b.push(u.mapPos(B));else if(j===!0){let{mapped:K,pos:G}=E.map(B,u);K&&(v=Math.max(v,K.maxPoint),p.push(K),b.push(G))}}let C=this.nextLayer.map(u);return p.length==0?C:new ot(b,p,C||ot.empty,v)}between(u,p,b){if(!this.isEmpty){for(let v=0;v<this.chunk.length;v++){let C=this.chunkPos[v],A=this.chunk[v];if(p>=C&&u<=C+A.length&&A.between(C,u-C,p-C,b)===!1)return}this.nextLayer.between(u,p,b)}}iter(u=0){return $e.from([this]).goto(u)}get isEmpty(){return this.nextLayer==this}static iter(u,p=0){return $e.from(u).goto(p)}static compare(u,p,b,v,C=-1){let A=u.filter(G=>G.maxPoint>0||!G.isEmpty&&G.maxPoint>=C),B=p.filter(G=>G.maxPoint>0||!G.isEmpty&&G.maxPoint>=C),E=ji(A,B,b),j=new ye(A,E,C),K=new ye(B,E,C);b.iterGaps((G,Z,J)=>Ye(j,G,K,Z,J,v)),b.empty&&b.length==0&&Ye(j,0,K,0,0,v)}static eq(u,p,b=0,v){v==null&&(v=1e9-1);let C=u.filter(K=>!K.isEmpty&&p.indexOf(K)<0),A=p.filter(K=>!K.isEmpty&&u.indexOf(K)<0);if(C.length!=A.length)return!1;if(!C.length)return!0;let B=ji(C,A),E=new ye(C,B,0).goto(b),j=new ye(A,B,0).goto(b);for(;;){if(E.to!=j.to||!dn(E.active,j.active)||E.point&&(!j.point||!E.point.eq(j.point)))return!1;if(E.to>v)return!0;E.next(),j.next()}}static spans(u,p,b,v,C=-1){let A=new ye(u,null,C).goto(p),B=p,E=A.openStart;for(;;){let j=Math.min(A.to,b);if(A.point){let K=A.activeForPoint(A.to),G=A.pointFrom<p?K.length+1:A.point.startSide<0?K.length:Math.min(K.length,E);v.point(B,j,A.point,K,G,A.pointRank),E=Math.min(A.openEnd(j),K.length)}else j>B&&(v.span(B,j,A.active,E),E=A.openEnd(j));if(A.to>b)return E+(A.point&&A.to>b?1:0);B=A.to,A.next()}}static of(u,p=!1){let b=new Qe;for(let v of u instanceof Kt?[u]:p?Oi(u):u)b.add(v.from,v.to,v.value);return b.finish()}static join(u){if(!u.length)return ot.empty;let p=u[u.length-1];for(let b=u.length-2;b>=0;b--)for(let v=u[b];v!=ot.empty;v=v.nextLayer)p=new ot(v.chunkPos,v.chunk,p,Math.max(v.maxPoint,p.maxPoint));return p}}ot.empty=new ot([],[],null,-1);function Oi(D){if(D.length>1)for(let u=D[0],p=1;p<D.length;p++){let b=D[p];if(z(u,b)>0)return D.slice().sort(z);u=b}return D}ot.empty.nextLayer=ot.empty;class Qe{finishChunk(u){this.chunks.push(new Kn(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,u&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(u,p,b){this.addInner(u,p,b)||(this.nextLayer||(this.nextLayer=new Qe)).add(u,p,b)}addInner(u,p,b){let v=u-this.lastTo||b.startSide-this.last.endSide;if(v<=0&&(u-this.lastFrom||b.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return v<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=u),this.from.push(u-this.chunkStart),this.to.push(p-this.chunkStart),this.last=b,this.lastFrom=u,this.lastTo=p,this.value.push(b),b.point&&(this.maxPoint=Math.max(this.maxPoint,p-u)),!0)}addChunk(u,p){if((u-this.lastTo||p.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,p.maxPoint),this.chunks.push(p),this.chunkPos.push(u);let b=p.value.length-1;return this.last=p.value[b],this.lastFrom=p.from[b]+u,this.lastTo=p.to[b]+u,!0}finish(){return this.finishInner(ot.empty)}finishInner(u){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return u;let p=ot.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(u):u,this.setMaxPoint);return this.from=null,p}}function ji(D,u,p){let b=new Map;for(let C of D)for(let A=0;A<C.chunk.length;A++)C.chunk[A].maxPoint<=0&&b.set(C.chunk[A],C.chunkPos[A]);let v=new Set;for(let C of u)for(let A=0;A<C.chunk.length;A++){let B=b.get(C.chunk[A]);B!=null&&(p?p.mapPos(B):B)==C.chunkPos[A]&&!(p!=null&&p.touchesRange(B,B+C.chunk[A].length))&&v.add(C.chunk[A])}return v}class Un{constructor(u,p,b,v=0){this.layer=u,this.skip=p,this.minPoint=b,this.rank=v}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(u,p=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(u,p,!1),this}gotoInner(u,p,b){for(;this.chunkIndex<this.layer.chunk.length;){let v=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(v)||this.layer.chunkEnd(this.chunkIndex)<u||v.maxPoint<this.minPoint))break;this.chunkIndex++,b=!1}if(this.chunkIndex<this.layer.chunk.length){let v=this.layer.chunk[this.chunkIndex].findIndex(u-this.layer.chunkPos[this.chunkIndex],p,!0);(!b||this.rangeIndex<v)&&this.setRangeIndex(v)}this.next()}forward(u,p){(this.to-u||this.endSide-p)<0&&this.gotoInner(u,p,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let u=this.layer.chunkPos[this.chunkIndex],p=this.layer.chunk[this.chunkIndex],b=u+p.from[this.rangeIndex];if(this.from=b,this.to=u+p.to[this.rangeIndex],this.value=p.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(u){if(u==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=u}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(u){return this.from-u.from||this.startSide-u.startSide||this.rank-u.rank||this.to-u.to||this.endSide-u.endSide}}class $e{constructor(u){this.heap=u}static from(u,p=null,b=-1){let v=[];for(let C=0;C<u.length;C++)for(let A=u[C];!A.isEmpty;A=A.nextLayer)A.maxPoint>=b&&v.push(new Un(A,p,b,C));return v.length==1?v[0]:new $e(v)}get startSide(){return this.value?this.value.startSide:0}goto(u,p=-1e9){for(let b of this.heap)b.goto(u,p);for(let b=this.heap.length>>1;b>=0;b--)Bi(this.heap,b);return this.next(),this}forward(u,p){for(let b of this.heap)b.forward(u,p);for(let b=this.heap.length>>1;b>=0;b--)Bi(this.heap,b);(this.to-u||this.value.endSide-p)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let u=this.heap[0];this.from=u.from,this.to=u.to,this.value=u.value,this.rank=u.rank,u.value&&u.next(),Bi(this.heap,0)}}}function Bi(D,u){for(let p=D[u];;){let b=(u<<1)+1;if(b>=D.length)break;let v=D[b];if(b+1<D.length&&v.compare(D[b+1])>=0&&(v=D[b+1],b++),p.compare(v)<0)break;D[b]=p,D[u]=v,u=b}}class ye{constructor(u,p,b){this.minPoint=b,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=$e.from(u,p,b)}goto(u,p=-1e9){return this.cursor.goto(u,p),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=u,this.endSide=p,this.openStart=-1,this.next(),this}forward(u,p){for(;this.minActive>-1&&(this.activeTo[this.minActive]-u||this.active[this.minActive].endSide-p)<0;)this.removeActive(this.minActive);this.cursor.forward(u,p)}removeActive(u){pn(this.active,u),pn(this.activeTo,u),pn(this.activeRank,u),this.minActive=mn(this.active,this.activeTo)}addActive(u){let p=0,{value:b,to:v,rank:C}=this.cursor;for(;p<this.activeRank.length&&(C-this.activeRank[p]||v-this.activeTo[p])>0;)p++;Pi(this.active,p,b),Pi(this.activeTo,p,v),Pi(this.activeRank,p,C),u&&Pi(u,p,this.cursor.from),this.minActive=mn(this.active,this.activeTo)}next(){let u=this.to,p=this.point;this.point=null;let b=this.openStart<0?[]:null;for(;;){let v=this.minActive;if(v>-1&&(this.activeTo[v]-this.cursor.from||this.active[v].endSide-this.cursor.startSide)<0){if(this.activeTo[v]>u){this.to=this.activeTo[v],this.endSide=this.active[v].endSide;break}this.removeActive(v),b&&pn(b,v)}else if(this.cursor.value)if(this.cursor.from>u){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let C=this.cursor.value;if(!C.point)this.addActive(b),this.cursor.next();else if(p&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=C,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=C.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(b){this.openStart=0;for(let v=b.length-1;v>=0&&b[v]<u;v--)this.openStart++}}activeForPoint(u){if(!this.active.length)return this.active;let p=[];for(let b=this.active.length-1;b>=0&&!(this.activeRank[b]<this.pointRank);b--)(this.activeTo[b]>u||this.activeTo[b]==u&&this.active[b].endSide>=this.point.endSide)&&p.push(this.active[b]);return p.reverse()}openEnd(u){let p=0;for(let b=this.activeTo.length-1;b>=0&&this.activeTo[b]>u;b--)p++;return p}}function Ye(D,u,p,b,v,C){D.goto(u),p.goto(b);let A=b+v,B=b,E=b-u;for(;;){let j=D.to+E-p.to||D.endSide-p.endSide,K=j<0?D.to+E:p.to,G=Math.min(K,A);if(D.point||p.point?D.point&&p.point&&(D.point==p.point||D.point.eq(p.point))&&dn(D.activeForPoint(D.to),p.activeForPoint(p.to))||C.comparePoint(B,G,D.point,p.point):G>B&&!dn(D.active,p.active)&&C.compareRange(B,G,D.active,p.active),K>A)break;B=K,j<=0&&D.next(),j>=0&&p.next()}}function dn(D,u){if(D.length!=u.length)return!1;for(let p=0;p<D.length;p++)if(D[p]!=u[p]&&!D[p].eq(u[p]))return!1;return!0}function pn(D,u){for(let p=u,b=D.length-1;p<b;p++)D[p]=D[p+1];D.pop()}function Pi(D,u,p){for(let b=D.length-1;b>=u;b--)D[b+1]=D[b];D[u]=p}function mn(D,u){let p=-1,b=1e9;for(let v=0;v<u.length;v++)(u[v]-b||D[v].endSide-D[p].endSide)<0&&(p=v,b=u[v]);return p}function Gn(D,u,p=D.length){let b=0;for(let v=0;v<p;)D.charCodeAt(v)==9?(b+=u-b%u,v++):(b++,v=oe(D,v));return b}function vi(D,u,p,b){for(let v=0,C=0;;){if(C>=u)return v;if(v==D.length)break;C+=D.charCodeAt(v)==9?p-C%p:1,v=oe(D,v)}return b===!0?-1:D.length}},75533:function(sl,en,Mt){Mt.d(en,{p:function(){return ge},Nm:function(){return Ie},tk:function(){return be},SJ:function(){return hi},lg:function(){return ut},l9:function(){return _},S2:function(){return Ul},Uw:function(){return Wl},qr:function(){return Ci},Sd:function(){return Va},gB:function(){return Bo},v5:function(){return Jl},ZO:function(){return Ea},HQ:function(){return Ji},AE:function(){return Vt},bF:function(){return Oo},$f:function(){return Wt},Eu:function(){return ta},OO:function(){return Ne},W$:function(){return Na},Zs:function(){return ko},$1:function(){return bt},mH:function(){return ws},hJ:function(){return fr}});for(var I=Mt(78120),Ce=Mt(28699),we={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},L={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},W=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Ti=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Fe=0;Fe<10;Fe++)we[48+Fe]=we[96+Fe]=String(Fe);for(var Fe=1;Fe<=24;Fe++)we[Fe+111]="F"+Fe;for(var Fe=65;Fe<=90;Fe++)we[Fe]=String.fromCharCode(Fe+32),L[Fe]=String.fromCharCode(Fe);for(var rt in we)L.hasOwnProperty(rt)||(L[rt]=we[rt]);function Q(h){var t=W&&h.metaKey&&h.shiftKey&&!h.ctrlKey&&!h.altKey||Ti&&h.shiftKey&&h.key&&h.key.length==1||h.key=="Unidentified",i=!t&&h.key||(h.shiftKey?L:we)[h.keyCode]||h.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function He(h){let t;return h.nodeType==11?t=h.getSelection?h:h.ownerDocument:t=h,t.getSelection()}function We(h,t){return t?h==t||h.contains(t.nodeType!=1?t.parentNode:t):!1}function me(h){let t=h.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Ee(h,t){if(!t.anchorNode)return!1;try{return We(h,t.anchorNode)}catch(i){return!1}}function Se(h){return h.nodeType==3?Ve(h,0,h.nodeValue.length).getClientRects():h.nodeType==1?h.getClientRects():[]}function Xe(h,t,i,o){return i?De(h,t,i,o,-1)||De(h,t,i,o,1):!1}function oe(h){for(var t=0;;t++)if(h=h.previousSibling,!h)return t}function De(h,t,i,o,a){for(;;){if(h==i&&t==o)return!0;if(t==(a<0?0:lt(h))){if(h.nodeName=="DIV")return!1;let f=h.parentNode;if(!f||f.nodeType!=1)return!1;t=oe(h)+(a<0?0:1),h=f}else if(h.nodeType==1){if(h=h.childNodes[t+(a<0?-1:0)],h.nodeType==1&&h.contentEditable=="false")return!1;t=a<0?lt(h):0}else return!1}}function lt(h){return h.nodeType==3?h.nodeValue.length:h.childNodes.length}function st(h,t){let i=t?h.left:h.right;return{left:i,right:i,top:h.top,bottom:h.bottom}}function pi(h){let t=h.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:h.innerWidth,top:0,bottom:h.innerHeight}}function at(h,t){let i=t.width/h.offsetWidth,o=t.height/h.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.width-h.offsetWidth)<1)&&(i=1),(o>.995&&o<1.005||!isFinite(o)||Math.abs(t.height-h.offsetHeight)<1)&&(o=1),{scaleX:i,scaleY:o}}function Ut(h,t,i,o,a,f,m,y){let x=h.ownerDocument,S=x.defaultView||window;for(let k=h,O=!1;k&&!O;)if(k.nodeType==1){let P,N=k==x.body,F=1,$=1;if(N)P=pi(S);else{if(/^(fixed|sticky)$/.test(getComputedStyle(k).position)&&(O=!0),k.scrollHeight<=k.clientHeight&&k.scrollWidth<=k.clientWidth){k=k.assignedSlot||k.parentNode;continue}let ie=k.getBoundingClientRect();({scaleX:F,scaleY:$}=at(k,ie)),P={left:ie.left,right:ie.left+k.clientWidth*F,top:ie.top,bottom:ie.top+k.clientHeight*$}}let V=0,q=0;if(a=="nearest")t.top<P.top?(q=-(P.top-t.top+m),i>0&&t.bottom>P.bottom+q&&(q=t.bottom-P.bottom+q+m)):t.bottom>P.bottom&&(q=t.bottom-P.bottom+m,i<0&&t.top-q<P.top&&(q=-(P.top+q-t.top+m)));else{let ie=t.bottom-t.top,le=P.bottom-P.top;q=(a=="center"&&ie<=le?t.top+ie/2-le/2:a=="start"||a=="center"&&i<0?t.top-m:t.bottom-le+m)-P.top}if(o=="nearest"?t.left<P.left?(V=-(P.left-t.left+f),i>0&&t.right>P.right+V&&(V=t.right-P.right+V+f)):t.right>P.right&&(V=t.right-P.right+f,i<0&&t.left<P.left+V&&(V=-(P.left+V-t.left+f))):V=(o=="center"?t.left+(t.right-t.left)/2-(P.right-P.left)/2:o=="start"==y?t.left-f:t.right-(P.right-P.left)+f)-P.left,V||q)if(N)S.scrollBy(V,q);else{let ie=0,le=0;if(q){let ee=k.scrollTop;k.scrollTop+=q/$,le=(k.scrollTop-ee)*$}if(V){let ee=k.scrollLeft;k.scrollLeft+=V/F,ie=(k.scrollLeft-ee)*F}t={left:t.left-ie,top:t.top-le,right:t.right-ie,bottom:t.bottom-le},ie&&Math.abs(ie-V)<1&&(o="nearest"),le&&Math.abs(le-q)<1&&(a="nearest")}if(N)break;k=k.assignedSlot||k.parentNode}else if(k.nodeType==11)k=k.host;else break}function Re(h){let t=h.ownerDocument;for(let i=h.parentNode;i&&i!=t.body;)if(i.nodeType==1){if(i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)return i;i=i.assignedSlot||i.parentNode}else if(i.nodeType==11)i=i.host;else break;return null}class ei{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:i,focusNode:o}=t;this.set(i,Math.min(t.anchorOffset,i?lt(i):0),o,Math.min(t.focusOffset,o?lt(o):0))}set(t,i,o,a){this.anchorNode=t,this.anchorOffset=i,this.focusNode=o,this.focusOffset=a}}let ht=null;function Lt(h){if(h.setActive)return h.setActive();if(ht)return h.focus(ht);let t=[];for(let i=h;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(h.focus(ht==null?{get preventScroll(){return ht={preventScroll:!0},!0}}:void 0),!ht){ht=!1;for(let i=0;i<t.length;){let o=t[i++],a=t[i++],f=t[i++];o.scrollTop!=a&&(o.scrollTop=a),o.scrollLeft!=f&&(o.scrollLeft=f)}}}let Oe;function Ve(h,t,i=t){let o=Oe||(Oe=document.createRange());return o.setEnd(h,i),o.setStart(h,t),o}function vt(h,t,i,o){let a={key:t,code:t,keyCode:i,which:i,cancelable:!0};o&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=o);let f=new KeyboardEvent("keydown",a);f.synthetic=!0,h.dispatchEvent(f);let m=new KeyboardEvent("keyup",a);return m.synthetic=!0,h.dispatchEvent(m),f.defaultPrevented||m.defaultPrevented}function tn(h){for(;h;){if(h&&(h.nodeType==9||h.nodeType==11&&h.host))return h;h=h.assignedSlot||h.parentNode}return null}function oi(h){for(;h.attributes.length;)h.removeAttributeNode(h.attributes[0])}function Ni(h,t){let i=t.focusNode,o=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=o)return!1;for(o=Math.min(o,lt(i));;)if(o){if(i.nodeType!=1)return!1;let a=i.childNodes[o-1];a.contentEditable=="false"?o--:(i=a,o=lt(i))}else{if(i==h)return!0;o=oe(i),i=i.parentNode}}function mi(h){return h.scrollTop>Math.max(1,h.scrollHeight-h.clientHeight-4)}class je{constructor(t,i,o=!0){this.node=t,this.offset=i,this.precise=o}static before(t,i){return new je(t.parentNode,oe(t),i)}static after(t,i){return new je(t.parentNode,oe(t)+1,i)}}const ke=[];class Me{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let i=this.posAtStart;for(let o of this.children){if(o==t)return i;i+=o.length+o.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,i){if(this.flags&2){let o=this.dom,a=null,f;for(let m of this.children){if(m.flags&7){if(!m.dom&&(f=a?a.nextSibling:o.firstChild)){let y=Me.get(f);(!y||!y.parent&&y.canReuseDOM(m))&&m.reuseDOM(f)}m.sync(t,i),m.flags&=-8}if(f=a?a.nextSibling:o.firstChild,i&&!i.written&&i.node==o&&f!=m.dom&&(i.written=!0),m.dom.parentNode==o)for(;f&&f!=m.dom;)f=nn(f);else o.insertBefore(m.dom,f);a=m.dom}for(f=a?a.nextSibling:o.firstChild,f&&i&&i.node==o&&(i.written=!0);f;)f=nn(f)}else if(this.flags&1)for(let o of this.children)o.flags&7&&(o.sync(t,i),o.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,i){let o;if(t==this.dom)o=this.dom.childNodes[i];else{let a=lt(t)==0?0:i==0?-1:1;for(;;){let f=t.parentNode;if(f==this.dom)break;a==0&&f.firstChild!=f.lastChild&&(t==f.firstChild?a=-1:a=1),t=f}a<0?o=t:o=t.nextSibling}if(o==this.dom.firstChild)return 0;for(;o&&!Me.get(o);)o=o.nextSibling;if(!o)return this.length;for(let a=0,f=0;;a++){let m=this.children[a];if(m.dom==o)return f;f+=m.length+m.breakAfter}}domBoundsAround(t,i,o=0){let a=-1,f=-1,m=-1,y=-1;for(let x=0,S=o,k=o;x<this.children.length;x++){let O=this.children[x],P=S+O.length;if(S<t&&P>i)return O.domBoundsAround(t,i,S);if(P>=t&&a==-1&&(a=x,f=S),S>i&&O.dom.parentNode==this.dom){m=x,y=k;break}k=P,S=P+O.breakAfter}return{from:f,to:y<0?o+this.length:y,startDOM:(a?this.children[a-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:m<this.children.length&&m>=0?this.children[m].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let i=this.parent;i;i=i.parent){if(t&&(i.flags|=2),i.flags&1)return;i.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let i=t.parent;if(!i)return t;t=i}}replaceChildren(t,i,o=ke){this.markDirty();for(let a=t;a<i;a++){let f=this.children[a];f.parent==this&&o.indexOf(f)<0&&f.destroy()}this.children.splice(t,i-t,...o);for(let a=0;a<o.length;a++)o[a].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new ze(this.children,t,this.children.length)}childPos(t,i=1){return this.childCursor().findPos(t,i)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,i,o,a,f,m){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}Me.prototype.breakAfter=0;function nn(h){let t=h.nextSibling;return h.parentNode.removeChild(h),t}class ze{constructor(t,i,o){this.children=t,this.pos=i,this.i=o,this.off=0}findPos(t,i=1){for(;;){if(t>this.pos||t==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let o=this.children[--this.i];this.pos-=o.length+o.breakAfter}}}function Fi(h,t,i,o,a,f,m,y,x){let{children:S}=h,k=S.length?S[t]:null,O=f.length?f[f.length-1]:null,P=O?O.breakAfter:m;if(!(t==o&&k&&!m&&!P&&f.length<2&&k.merge(i,a,f.length?O:null,i==0,y,x))){if(o<S.length){let N=S[o];N&&(a<N.length||N.breakAfter&&(O!=null&&O.breakAfter))?(t==o&&(N=N.split(a),a=0),!P&&O&&N.merge(0,a,O,!0,0,x)?f[f.length-1]=N:((a||N.children.length&&!N.children[0].length)&&N.merge(0,a,null,!1,0,x),f.push(N))):N!=null&&N.breakAfter&&(O?O.breakAfter=1:m=1),o++}for(k&&(k.breakAfter=m,i>0&&(!m&&f.length&&k.merge(i,k.length,f[0],!1,y,0)?k.breakAfter=f.shift().breakAfter:(i<k.length||k.children.length&&k.children[k.children.length-1].length==0)&&k.merge(i,k.length,null,!1,y,0),t++));t<o&&f.length;)if(S[o-1].become(f[f.length-1]))o--,f.pop(),x=f.length?0:y;else if(S[t].become(f[0]))t++,f.shift(),y=f.length?0:x;else break;!f.length&&t&&o<S.length&&!S[t-1].breakAfter&&S[o].merge(0,0,S[t-1],!1,y,x)&&t--,(t<o||f.length)&&h.replaceChildren(t,o,f)}}function Di(h,t,i,o,a,f){let m=h.childCursor(),{i:y,off:x}=m.findPos(i,1),{i:S,off:k}=m.findPos(t,-1),O=t-i;for(let P of o)O+=P.length;h.length+=O,Fi(h,S,k,y,x,o,0,a,f)}let kt=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},gi=typeof document!="undefined"?document:{documentElement:{style:{}}};const Hi=/Edge\/(\d+)/.exec(kt.userAgent),sn=/MSIE \d/.test(kt.userAgent),Et=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(kt.userAgent),zt=!!(sn||Et||Hi),yi=!zt&&/gecko\/(\d+)/i.test(kt.userAgent),Wi=!zt&&/Chrome\/(\d+)/.exec(kt.userAgent),rn="webkitFontSmoothing"in gi.documentElement.style,bi=!zt&&/Apple Computer/.test(kt.vendor),Vi=bi&&(/Mobile\/\w+/.test(kt.userAgent)||kt.maxTouchPoints>2);var Y={mac:Vi||/Mac/.test(kt.platform),windows:/Win/.test(kt.platform),linux:/Linux|X11/.test(kt.platform),ie:zt,ie_version:sn?gi.documentMode||6:Et?+Et[1]:Hi?+Hi[1]:0,gecko:yi,gecko_version:yi?+(/Firefox\/(\d+)/.exec(kt.userAgent)||[0,0])[1]:0,chrome:!!Wi,chrome_version:Wi?+Wi[1]:0,ios:Vi,android:/Android\b/.test(kt.userAgent),webkit:rn,safari:bi,webkit_version:rn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:gi.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Ds=256;class mt extends Me{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,i,o){return this.flags&8||o&&(!(o instanceof mt)||this.length-(i-t)+o.length>Ds||o.flags&8)?!1:(this.text=this.text.slice(0,t)+(o?o.text:"")+this.text.slice(i),this.markDirty(),!0)}split(t){let i=new mt(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(t,i){return t==this.dom?i:i?this.text.length:0}domAtPos(t){return new je(this.dom,t)}domBoundsAround(t,i,o){return{from:o,to:o+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,i){return Rt(this.dom,t,i)}}class Tt extends Me{constructor(t,i=[],o=0){super(),this.mark=t,this.children=i,this.length=o;for(let a of i)a.setParent(this)}setAttrs(t){if(oi(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)t.setAttribute(i,this.mark.attrs[i]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,i)}merge(t,i,o,a,f,m){return o&&(!(o instanceof Tt&&o.mark.eq(this.mark))||t&&f<=0||i<this.length&&m<=0)?!1:(Di(this,t,i,o?o.children.slice():[],f-1,m-1),this.markDirty(),!0)}split(t){let i=[],o=0,a=-1,f=0;for(let y of this.children){let x=o+y.length;x>t&&i.push(o<t?y.split(t-o):y),a<0&&o>=t&&(a=f),o=x,f++}let m=this.length-t;return this.length=t,a>-1&&(this.children.length=a,this.markDirty()),new Tt(this.mark,i,m)}domAtPos(t){return on(this,t)}coordsAt(t,i){return an(this,t,i)}}function Rt(h,t,i){let o=h.nodeValue.length;t>o&&(t=o);let a=t,f=t,m=0;t==0&&i<0||t==o&&i>=0?Y.chrome||Y.gecko||(t?(a--,m=1):f<o&&(f++,m=-1)):i<0?a--:f<o&&f++;let y=Ve(h,a,f).getClientRects();if(!y.length)return null;let x=y[(m?m<0:i>=0)?0:y.length-1];return Y.safari&&!m&&x.width==0&&(x=Array.prototype.find.call(y,S=>S.width)||x),m?st(x,m<0):x||null}class $t extends Me{static create(t,i,o){return new $t(t,i,o)}constructor(t,i,o){super(),this.widget=t,this.length=i,this.side=o,this.prevWidget=null}split(t){let i=$t.create(this.widget,this.length-t,this.side);return this.length-=t,i}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,i,o,a,f,m){return o&&(!(o instanceof $t)||!this.widget.compare(o.widget)||t>0&&f<=0||i<this.length&&m<=0)?!1:(this.length=t+(o?o.length:0)+(this.length-i),!0)}become(t){return t instanceof $t&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return I.xv.empty;let t=this;for(;t.parent;)t=t.parent;let{view:i}=t,o=i&&i.state.doc,a=this.posAtStart;return o?o.slice(a,a+this.length):I.xv.empty}domAtPos(t){return(this.length?t==0:this.side>0)?je.before(this.dom):je.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,i){let o=this.widget.coordsAt(this.dom,t,i);if(o)return o;let a=this.dom.getClientRects(),f=null;if(!a.length)return null;let m=this.side?this.side<0:t>0;for(let y=m?a.length-1:0;f=a[y],!(t>0?y==0:y==a.length-1||f.top<f.bottom);y+=m?-1:1);return st(f,!m)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class qt extends Me{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof qt&&t.side==this.side}split(){return new qt(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?je.before(this.dom):je.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return I.xv.empty}get isHidden(){return!0}}mt.prototype.children=$t.prototype.children=qt.prototype.children=ke;function on(h,t){let i=h.dom,{children:o}=h,a=0;for(let f=0;a<o.length;a++){let m=o[a],y=f+m.length;if(!(y==f&&m.getSide()<=0)){if(t>f&&t<y&&m.dom.parentNode==i)return m.domAtPos(t-f);if(t<=f)break;f=y}}for(let f=a;f>0;f--){let m=o[f-1];if(m.dom.parentNode==i)return m.domAtPos(m.length)}for(let f=a;f<o.length;f++){let m=o[f];if(m.dom.parentNode==i)return m.domAtPos(0)}return new je(i,0)}function ln(h,t,i){let o,{children:a}=h;i>0&&t instanceof Tt&&a.length&&(o=a[a.length-1])instanceof Tt&&o.mark.eq(t.mark)?ln(o,t.children[0],i-1):(a.push(t),t.setParent(h)),h.length+=t.length}function an(h,t,i){let o=null,a=-1,f=null,m=-1;function y(S,k){for(let O=0,P=0;O<S.children.length&&P<=k;O++){let N=S.children[O],F=P+N.length;F>=k&&(N.children.length?y(N,k-P):(!f||f.isHidden&&i>0)&&(F>k||P==F&&N.getSide()>0)?(f=N,m=k-P):(P<k||P==F&&N.getSide()<0&&!N.isHidden)&&(o=N,a=k-P)),P=F}}y(h,t);let x=(i<0?o:f)||o||f;return x?x.coordsAt(Math.max(0,x==o?a:m),i):hn(h)}function hn(h){let t=h.dom.lastChild;if(!t)return h.dom.getBoundingClientRect();let i=Se(t);return i[i.length-1]||null}function It(h,t){for(let i in h)i=="class"&&t.class?t.class+=" "+h.class:i=="style"&&t.style?t.style+=";"+h.style:t[i]=h[i];return t}const cn=Object.create(null);function fn(h,t,i){if(h==t)return!0;h||(h=cn),t||(t=cn);let o=Object.keys(h),a=Object.keys(t);if(o.length-(i&&o.indexOf(i)>-1?1:0)!=a.length-(i&&a.indexOf(i)>-1?1:0))return!1;for(let f of o)if(f!=i&&(a.indexOf(f)==-1||h[f]!==t[f]))return!1;return!0}function et(h,t,i){let o=!1;if(t)for(let a in t)i&&a in i||(o=!0,a=="style"?h.style.cssText="":h.removeAttribute(a));if(i)for(let a in i)t&&t[a]==i[a]||(o=!0,a=="style"?h.style.cssText=i[a]:h.setAttribute(a,i[a]));return o}function ct(h){let t=Object.create(null);for(let i=0;i<h.attributes.length;i++){let o=h.attributes[i];t[o.name]=o.value}return t}class tt extends Me{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,i,o,a,f,m){if(o){if(!(o instanceof tt))return!1;this.dom||o.transferDOM(this)}return a&&this.setDeco(o?o.attrs:null),Di(this,t,i,o?o.children.slice():[],f,m),!0}split(t){let i=new tt;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:o,off:a}=this.childPos(t);a&&(i.append(this.children[o].split(a),0),this.children[o].merge(a,this.children[o].length,null,!1,0,0),o++);for(let f=o;f<this.children.length;f++)i.append(this.children[f],0);for(;o>0&&this.children[o-1].length==0;)this.children[--o].destroy();return this.children.length=o,this.markDirty(),this.length=t,i}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){fn(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,i){ln(this,t,i)}addLineDeco(t){let i=t.spec.attributes,o=t.spec.class;i&&(this.attrs=It(i,this.attrs||{})),o&&(this.attrs=It({class:o},this.attrs||{}))}domAtPos(t){return on(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,i){var o;this.dom?this.flags&4&&(oi(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(et(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,i);let a=this.dom.lastChild;for(;a&&Me.get(a)instanceof Tt;)a=a.lastChild;if(!a||!this.length||a.nodeName!="BR"&&((o=Me.get(a))===null||o===void 0?void 0:o.isEditable)==!1&&(!Y.ios||!this.children.some(f=>f instanceof mt))){let f=document.createElement("BR");f.cmIgnore=!0,this.dom.appendChild(f)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,i;for(let o of this.children){if(!(o instanceof mt)||/[^ -~]/.test(o.text))return null;let a=Se(o.dom);if(a.length!=1)return null;t+=a[0].width,i=a[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:i}:null}coordsAt(t,i){let o=an(this,t,i);if(!this.children.length&&o&&this.parent){let{heightOracle:a}=this.parent.view.viewState,f=o.bottom-o.top;if(Math.abs(f-a.lineHeight)<2&&a.textHeight<f){let m=(f-a.textHeight)/2;return{top:o.top+m,bottom:o.bottom-m,left:o.left,right:o.left}}}return o}become(t){return!1}covers(){return!0}static find(t,i){for(let o=0,a=0;o<t.children.length;o++){let f=t.children[o],m=a+f.length;if(m>=i){if(f instanceof tt)return f;if(m>i)break}a=m+f.breakAfter}return null}}class Gt extends Me{constructor(t,i,o){super(),this.widget=t,this.length=i,this.deco=o,this.breakAfter=0,this.prevWidget=null}merge(t,i,o,a,f,m){return o&&(!(o instanceof Gt)||!this.widget.compare(o.widget)||t>0&&f<=0||i<this.length&&m<=0)?!1:(this.length=t+(o?o.length:0)+(this.length-i),!0)}domAtPos(t){return t==0?je.before(this.dom):je.after(this.dom,t==this.length)}split(t){let i=this.length-t;this.length=t;let o=new Gt(this.widget,i,this.deco);return o.breakAfter=this.breakAfter,o}get children(){return ke}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):I.xv.empty}domBoundsAround(){return null}become(t){return t instanceof Gt&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,i){return this.widget.coordsAt(this.dom,t,i)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:i,endSide:o}=this.deco;return i==o?!1:t<0?i<0:o>0}}class _{eq(t){return!1}updateDOM(t,i){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,i,o){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var it=function(h){return h[h.Text=0]="Text",h[h.WidgetBefore=1]="WidgetBefore",h[h.WidgetAfter=2]="WidgetAfter",h[h.WidgetRange=3]="WidgetRange",h}(it||(it={}));class ge extends I.uU{constructor(t,i,o,a){super(),this.startSide=t,this.endSide=i,this.widget=o,this.spec=a}get heightRelevant(){return!1}static mark(t){return new wi(t)}static widget(t){let i=Math.max(-1e4,Math.min(1e4,t.side||0)),o=!!t.block;return i+=o&&!t.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new Je(t,i,i,o,t.widget||null,!1)}static replace(t){let i=!!t.block,o,a;if(t.isBlockGap)o=-5e8,a=4e8;else{let{start:f,end:m}=St(t,i);o=(f?i?-3e8:-1:5e8)-1,a=(m?i?2e8:1:-6e8)+1}return new Je(t,o,a,i,t.widget||null,!0)}static line(t){return new xi(t)}static set(t,i=!1){return I.Xs.of(t,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ge.none=I.Xs.empty;class wi extends ge{constructor(t){let{start:i,end:o}=St(t);super(i?-1:5e8,o?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var i,o;return this==t||t instanceof wi&&this.tagName==t.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(t.class||((o=t.attrs)===null||o===void 0?void 0:o.class))&&fn(this.attrs,t.attrs,"class")}range(t,i=t){if(t>=i)throw new RangeError("Mark decorations may not be empty");return super.range(t,i)}}wi.prototype.point=!1;class xi extends ge{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof xi&&this.spec.class==t.spec.class&&fn(this.spec.attributes,t.spec.attributes)}range(t,i=t){if(i!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,i)}}xi.prototype.mapMode=I.gc.TrackBefore,xi.prototype.point=!0;class Je extends ge{constructor(t,i,o,a,f,m){super(i,o,f,t),this.block=a,this.isReplace=m,this.mapMode=a?i<=0?I.gc.TrackBefore:I.gc.TrackAfter:I.gc.TrackDel}get type(){return this.startSide!=this.endSide?it.WidgetRange:this.startSide<=0?it.WidgetBefore:it.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Je&&un(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,i=t){if(this.isReplace&&(t>i||t==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,i)}}Je.prototype.point=!0;function St(h,t=!1){let{inclusiveStart:i,inclusiveEnd:o}=h;return i==null&&(i=h.inclusive),o==null&&(o=h.inclusive),{start:i!=null?i:t,end:o!=null?o:t}}function un(h,t){return h==t||!!(h&&t&&h.compare(t))}function gt(h,t,i,o=0){let a=i.length-1;a>=0&&i[a]+o>=h?i[a]=Math.max(i[a],t):i.push(h,t)}class Nt{constructor(t,i,o,a){this.doc=t,this.pos=i,this.end=o,this.disallowBlockEffectsFor=a,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Gt&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new tt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Ct(new qt(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof Gt)&&this.getLine()}buildText(t,i,o){for(;t>0;){if(this.textOff==this.text.length){let{value:f,lineBreak:m,done:y}=this.cursor.next(this.skip);if(this.skip=0,y)throw new Error("Ran out of text content when drawing inline views");if(m){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=f,this.textOff=0}let a=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(i.slice(i.length-o)),this.getLine().append(Ct(new mt(this.text.slice(this.textOff,this.textOff+a)),i),o),this.atCursorPos=!0,this.textOff+=a,t-=a,o=0}}span(t,i,o,a){this.buildText(i-t,o,a),this.pos=i,this.openStart<0&&(this.openStart=a)}point(t,i,o,a,f,m){if(this.disallowBlockEffectsFor[m]&&o instanceof Je){if(o.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let y=i-t;if(o instanceof Je)if(o.block)o.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Gt(o.widget||de.block,y,o));else{let x=$t.create(o.widget||de.inline,y,y?0:o.startSide),S=this.atCursorPos&&!x.isEditable&&f<=a.length&&(t<i||o.startSide>0),k=!x.isEditable&&(t<i||f>a.length||o.startSide<=0),O=this.getLine();this.pendingBuffer==2&&!S&&!x.isEditable&&(this.pendingBuffer=0),this.flushBuffer(a),S&&(O.append(Ct(new qt(1),a),f),f=a.length+Math.max(0,f-a.length)),O.append(Ct(x,a),f),this.atCursorPos=k,this.pendingBuffer=k?t<i||f>a.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=a.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(o);y&&(this.textOff+y<=this.text.length?this.textOff+=y:(this.skip+=y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=f)}static build(t,i,o,a,f){let m=new Nt(t,i,o,f);return m.openEnd=I.Xs.spans(a,i,o,m),m.openStart<0&&(m.openStart=m.openEnd),m.finish(m.openEnd),m}}function Ct(h,t){for(let i of t)h=new Tt(i,[h],h.length);return h}class de extends _{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}de.inline=new de("span"),de.block=new de("div");var Ie=function(h){return h[h.LTR=0]="LTR",h[h.RTL=1]="RTL",h}(Ie||(Ie={}));const ft=Ie.LTR,Kt=Ie.RTL;function z(h){let t=[];for(let i=0;i<h.length;i++)t.push(1<<+h[i]);return t}const Kn=z("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ot=z("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Oi=Object.create(null),Qe=[];for(let h of["()","[]","{}"]){let t=h.charCodeAt(0),i=h.charCodeAt(1);Oi[t]=i,Oi[i]=-t}function ji(h){return h<=247?Kn[h]:1424<=h&&h<=1524?2:1536<=h&&h<=1785?ot[h-1536]:1774<=h&&h<=2220?4:8192<=h&&h<=8204?256:64336<=h&&h<=65023?4:1}const Un=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class $e{get dir(){return this.level%2?Kt:ft}constructor(t,i,o){this.from=t,this.to=i,this.level=o}side(t,i){return this.dir==i==t?this.to:this.from}forward(t,i){return t==(this.dir==i)}static find(t,i,o,a){let f=-1;for(let m=0;m<t.length;m++){let y=t[m];if(y.from<=i&&y.to>=i){if(y.level==o)return m;(f<0||(a!=0?a<0?y.from<i:y.to>i:t[f].level>y.level))&&(f=m)}}if(f<0)throw new RangeError("Index out of range");return f}}function Bi(h,t){if(h.length!=t.length)return!1;for(let i=0;i<h.length;i++){let o=h[i],a=t[i];if(o.from!=a.from||o.to!=a.to||o.direction!=a.direction||!Bi(o.inner,a.inner))return!1}return!0}const ye=[];function Ye(h,t,i,o,a){for(let f=0;f<=o.length;f++){let m=f?o[f-1].to:t,y=f<o.length?o[f].from:i,x=f?256:a;for(let S=m,k=x,O=x;S<y;S++){let P=ji(h.charCodeAt(S));P==512?P=k:P==8&&O==4&&(P=16),ye[S]=P==4?2:P,P&7&&(O=P),k=P}for(let S=m,k=x,O=x;S<y;S++){let P=ye[S];if(P==128)S<y-1&&k==ye[S+1]&&k&24?P=ye[S]=k:ye[S]=256;else if(P==64){let N=S+1;for(;N<y&&ye[N]==64;)N++;let F=S&&k==8||N<i&&ye[N]==8?O==1?1:8:256;for(let $=S;$<N;$++)ye[$]=F;S=N-1}else P==8&&O==1&&(ye[S]=1);k=P,P&7&&(O=P)}}}function dn(h,t,i,o,a){let f=a==1?2:1;for(let m=0,y=0,x=0;m<=o.length;m++){let S=m?o[m-1].to:t,k=m<o.length?o[m].from:i;for(let O=S,P,N,F;O<k;O++)if(N=Oi[P=h.charCodeAt(O)])if(N<0){for(let $=y-3;$>=0;$-=3)if(Qe[$+1]==-N){let V=Qe[$+2],q=V&2?a:V&4?V&1?f:a:0;q&&(ye[O]=ye[Qe[$]]=q),y=$;break}}else{if(Qe.length==189)break;Qe[y++]=O,Qe[y++]=P,Qe[y++]=x}else if((F=ye[O])==2||F==1){let $=F==a;x=$?0:1;for(let V=y-3;V>=0;V-=3){let q=Qe[V+2];if(q&2)break;if($)Qe[V+2]|=2;else{if(q&4)break;Qe[V+2]|=4}}}}}function pn(h,t,i,o){for(let a=0,f=o;a<=i.length;a++){let m=a?i[a-1].to:h,y=a<i.length?i[a].from:t;for(let x=m;x<y;){let S=ye[x];if(S==256){let k=x+1;for(;;)if(k==y){if(a==i.length)break;k=i[a++].to,y=a<i.length?i[a].from:t}else if(ye[k]==256)k++;else break;let O=f==1,P=(k<t?ye[k]:o)==1,N=O==P?O?1:2:o;for(let F=k,$=a,V=$?i[$-1].to:h;F>x;)F==V&&(F=i[--$].from,V=$?i[$-1].to:h),ye[--F]=N;x=k}else f=S,x++}}}function Pi(h,t,i,o,a,f,m){let y=o%2?2:1;if(o%2==a%2)for(let x=t,S=0;x<i;){let k=!0,O=!1;if(S==f.length||x<f[S].from){let $=ye[x];$!=y&&(k=!1,O=$==16)}let P=!k&&y==1?[]:null,N=k?o:o+1,F=x;e:for(;;)if(S<f.length&&F==f[S].from){if(O)break e;let $=f[S];if(!k)for(let V=$.to,q=S+1;;){if(V==i)break e;if(q<f.length&&f[q].from==V)V=f[q++].to;else{if(ye[V]==y)break e;break}}if(S++,P)P.push($);else{$.from>x&&m.push(new $e(x,$.from,N));let V=$.direction==ft!=!(N%2);mn(h,V?o+1:o,a,$.inner,$.from,$.to,m),x=$.to}F=$.to}else{if(F==i||(k?ye[F]!=y:ye[F]==y))break;F++}P?Pi(h,x,F,o+1,a,P,m):x<F&&m.push(new $e(x,F,N)),x=F}else for(let x=i,S=f.length;x>t;){let k=!0,O=!1;if(!S||x>f[S-1].to){let $=ye[x-1];$!=y&&(k=!1,O=$==16)}let P=!k&&y==1?[]:null,N=k?o:o+1,F=x;e:for(;;)if(S&&F==f[S-1].to){if(O)break e;let $=f[--S];if(!k)for(let V=$.from,q=S;;){if(V==t)break e;if(q&&f[q-1].to==V)V=f[--q].from;else{if(ye[V-1]==y)break e;break}}if(P)P.push($);else{$.to<x&&m.push(new $e($.to,x,N));let V=$.direction==ft!=!(N%2);mn(h,V?o+1:o,a,$.inner,$.from,$.to,m),x=$.from}F=$.from}else{if(F==t||(k?ye[F-1]!=y:ye[F-1]==y))break;F--}P?Pi(h,F,x,o+1,a,P,m):F<x&&m.push(new $e(F,x,N)),x=F}}function mn(h,t,i,o,a,f,m){let y=t%2?2:1;Ye(h,a,f,o,y),dn(h,a,f,o,y),pn(a,f,o,y),Pi(h,a,f,t,i,o,m)}function Gn(h,t,i){if(!h)return[new $e(0,0,t==Kt?1:0)];if(t==ft&&!i.length&&!Un.test(h))return vi(h.length);if(i.length)for(;h.length>ye.length;)ye[ye.length]=256;let o=[],a=t==ft?0:1;return mn(h,a,a,i,0,h.length,o),o}function vi(h){return[new $e(0,h,0)]}let D="";function u(h,t,i,o,a){var f;let m=o.head-h.from,y=$e.find(t,m,(f=o.bidiLevel)!==null&&f!==void 0?f:-1,o.assoc),x=t[y],S=x.side(a,i);if(m==S){let P=y+=a?1:-1;if(P<0||P>=t.length)return null;x=t[y=P],m=x.side(!a,i),S=x.side(a,i)}let k=(0,I.cp)(h.text,m,x.forward(a,i));(k<x.from||k>x.to)&&(k=S),D=h.text.slice(Math.min(m,k),Math.max(m,k));let O=y==(a?t.length-1:0)?null:t[y+(a?1:-1)];return O&&k==S&&O.level+(a?0:1)<x.level?I.jT.cursor(O.side(!a,i)+h.from,O.forward(a,i)?1:-1,O.level):I.jT.cursor(k+h.from,x.forward(a,i)?-1:1,x.level)}function p(h,t,i){for(let o=t;o<i;o++){let a=ji(h.charCodeAt(o));if(a==1)return ft;if(a==2||a==4)return Kt}return ft}const b=I.r$.define(),v=I.r$.define(),C=I.r$.define(),A=I.r$.define(),B=I.r$.define(),E=I.r$.define(),j=I.r$.define(),K=I.r$.define({combine:h=>h.some(t=>t)}),G=I.r$.define({combine:h=>h.some(t=>t)}),Z=I.r$.define();class J{constructor(t,i="nearest",o="nearest",a=5,f=5,m=!1){this.range=t,this.y=i,this.x=o,this.yMargin=a,this.xMargin=f,this.isSnapshot=m}map(t){return t.empty?this:new J(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new J(I.jT.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Be=I.Py.define({map:(h,t)=>h.map(t)});function Ne(h,t,i){let o=h.facet(A);o.length?o[0](t):window.onerror?window.onerror(String(t),i,void 0,void 0,t):i?console.error(i+":",t):console.error(t)}const Ge=I.r$.define({combine:h=>h.length?h[0]:!0});let gn=0;const zi=I.r$.define();class ut{constructor(t,i,o,a,f){this.id=t,this.create=i,this.domEventHandlers=o,this.domEventObservers=a,this.extension=f(this)}static define(t,i){const{eventHandlers:o,eventObservers:a,provide:f,decorations:m}=i||{};return new ut(gn++,t,o,a,y=>{let x=[zi.of(y)];return m&&x.push(yn.of(S=>{let k=S.plugin(y);return k?m(k):ge.none})),f&&x.push(f(y)),x})}static fromClass(t,i){return ut.define(o=>new t(o),i)}}class Os{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(o){if(Ne(i.state,o,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(a){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(i){Ne(t.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(o){Ne(t.state,o,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Or=I.r$.define(),$i=I.r$.define(),yn=I.r$.define(),Br=I.r$.define(),Pr=I.r$.define(),Bs=I.r$.define();function rl(h,t){let i=h.state.facet(Bs);if(!i.length)return i;let o=i.map(f=>f instanceof Function?f(h):f),a=[];return I.Xs.spans(o,t.from,t.to,{point(){},span(f,m,y,x){let S=f-t.from,k=m-t.from,O=a;for(let P=y.length-1;P>=0;P--,x--){let N=y[P].spec.bidiIsolate,F;if(N==null&&(N=p(t.text,S,k)),x>0&&O.length&&(F=O[O.length-1]).to==S&&F.direction==N)F.to=k,O=F.inner;else{let $={from:S,to:k,direction:N,inner:[]};O.push($),O=$.inner}}}}),a}const ol=I.r$.define();function Lr(h){let t=0,i=0,o=0,a=0;for(let f of h.state.facet(ol)){let m=f(h);m&&(m.left!=null&&(t=Math.max(t,m.left)),m.right!=null&&(i=Math.max(i,m.right)),m.top!=null&&(o=Math.max(o,m.top)),m.bottom!=null&&(a=Math.max(a,m.bottom)))}return{left:t,right:i,top:o,bottom:a}}const bn=I.r$.define();class Ft{constructor(t,i,o,a){this.fromA=t,this.toA=i,this.fromB=o,this.toB=a}join(t){return new Ft(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let i=t.length,o=this;for(;i>0;i--){let a=t[i-1];if(!(a.fromA>o.toA)){if(a.toA<o.fromA)break;o=o.join(a),t.splice(i-1,1)}}return t.splice(i,0,o),t}static extendWithRanges(t,i){if(i.length==0)return t;let o=[];for(let a=0,f=0,m=0,y=0;;a++){let x=a==t.length?null:t[a],S=m-y,k=x?x.fromB:1e9;for(;f<i.length&&i[f]<k;){let O=i[f],P=i[f+1],N=Math.max(y,O),F=Math.min(k,P);if(N<=F&&new Ft(N+S,F+S,N,F).addToSet(o),P>k)break;f+=2}if(!x)return o;new Ft(x.fromA,x.toA,x.fromB,x.toB).addToSet(o),m=x.toA,y=x.toB}}}class _n{constructor(t,i,o){this.view=t,this.state=i,this.transactions=o,this.flags=0,this.startState=t.state,this.changes=I.as.empty(this.startState.doc.length);for(let f of o)this.changes=this.changes.compose(f.changes);let a=[];this.changes.iterChangedRanges((f,m,y,x)=>a.push(new Ft(f,m,y,x))),this.changedRanges=a}static create(t,i,o){return new _n(t,i,o)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class ll extends Me{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.compositionBarrier=ge.none,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new tt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ft(0,0,0,t.state.doc.length)],0,null)}update(t){var i;let o=t.changedRanges;this.minWidth>0&&o.length&&(o.every(({fromA:S,toA:k})=>k<this.minWidthFrom||S>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let a=-1;this.view.inputState.composing>=0&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?a=this.domChanged.newSel.head:!cl(t.changes,this.hasComposition)&&!t.selectionSet&&(a=t.state.selection.main.head));let f=a>-1?wn(this.view,t.changes,a):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:S,to:k}=this.hasComposition;o=new Ft(S,k,t.changes.mapPos(S,-1),t.changes.mapPos(k,1)).addToSet(o.slice())}this.hasComposition=f?{from:f.range.fromB,to:f.range.toB}:null,(Y.ie||Y.chrome)&&!f&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let m=this.decorations,y=this.updateDeco(),x=ka(m,y,t.changes);return o=Ft.extendWithRanges(o,x),!(this.flags&7)&&o.length==0?!1:(this.updateInner(o,t.startState.doc.length,f),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,i,o){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,i,o);let{observer:a}=this.view;a.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let m=Y.chrome||Y.ios?{node:a.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,m),this.flags&=-8,m&&(m.written||a.selectionRange.focusNode!=m.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(m=>m.flags&=-9);let f=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let m of this.children)m instanceof Gt&&m.widget instanceof qi&&f.push(m.dom);a.updateGaps(f)}updateChildren(t,i,o){let a=o?o.range.addToSet(t.slice()):t,f=this.childCursor(i);for(let m=a.length-1;;m--){let y=m>=0?a[m]:null;if(!y)break;let{fromA:x,toA:S,fromB:k,toB:O}=y,P,N,F,$;if(o&&o.range.fromB<O&&o.range.toB>k){let ee=Nt.build(this.view.state.doc,k,o.range.fromB,this.decorations,this.dynamicDecorationMap),ne=Nt.build(this.view.state.doc,o.range.toB,O,this.decorations,this.dynamicDecorationMap);N=ee.breakAtStart,F=ee.openStart,$=ne.openEnd;let ce=this.compositionView(o);ne.breakAtStart?ce.breakAfter=1:ne.content.length&&ce.merge(ce.length,ce.length,ne.content[0],!1,ne.openStart,0)&&(ce.breakAfter=ne.content[0].breakAfter,ne.content.shift()),ee.content.length&&ce.merge(0,0,ee.content[ee.content.length-1],!0,0,ee.openEnd)&&ee.content.pop(),P=ee.content.concat(ce).concat(ne.content)}else({content:P,breakAtStart:N,openStart:F,openEnd:$}=Nt.build(this.view.state.doc,k,O,this.decorations,this.dynamicDecorationMap));let{i:V,off:q}=f.findPos(S,1),{i:ie,off:le}=f.findPos(x,-1);Fi(this,ie,le,V,q,P,N,F,$)}o&&this.fixCompositionDOM(o)}compositionView(t){let i=new mt(t.text.nodeValue);i.flags|=8;for(let{deco:a}of t.marks)i=new Tt(a,[i],i.length);let o=new tt;return o.append(i,0),o}fixCompositionDOM(t){let i=(f,m)=>{m.flags|=8|(m.children.some(x=>x.flags&7)?1:0),this.markedForComposition.add(m);let y=Me.get(f);y&&y!=m&&(y.dom=null),m.setDOM(f)},o=this.childPos(t.range.fromB,1),a=this.children[o.i];i(t.line,a);for(let f=t.marks.length-1;f>=-1;f--)o=a.childPos(o.off,1),a=a.children[o.i],i(f>=0?t.marks[f].node:t.text,a)}updateSelection(t=!1,i=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let o=this.view.root.activeElement,a=o==this.dom,f=!a&&Ee(this.dom,this.view.observer.selectionRange)&&!(o&&this.dom.contains(o));if(!(a||i||f))return;let m=this.forceSelection;this.forceSelection=!1;let y=this.view.state.selection.main,x=this.moveToLine(this.domAtPos(y.anchor)),S=y.empty?x:this.moveToLine(this.domAtPos(y.head));if(Y.gecko&&y.empty&&!this.hasComposition&&hl(x)){let O=document.createTextNode("");this.view.observer.ignore(()=>x.node.insertBefore(O,x.node.childNodes[x.offset]||null)),x=S=new je(O,0),m=!0}let k=this.view.observer.selectionRange;(m||!k.focusNode||(!Xe(x.node,x.offset,k.anchorNode,k.anchorOffset)||!Xe(S.node,S.offset,k.focusNode,k.focusOffset))&&!this.suppressWidgetCursorChange(k,y))&&(this.view.observer.ignore(()=>{Y.android&&Y.chrome&&this.dom.contains(k.focusNode)&&xn(k.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let O=He(this.view.root);if(O)if(y.empty){if(Y.gecko){let P=Ls(x.node,x.offset);if(P&&P!=3){let N=Li(x.node,x.offset,P==1?1:-1);N&&(x=new je(N.node,N.offset))}}O.collapse(x.node,x.offset),y.bidiLevel!=null&&O.caretBidiLevel!==void 0&&(O.caretBidiLevel=y.bidiLevel)}else if(O.extend){O.collapse(x.node,x.offset);try{O.extend(S.node,S.offset)}catch(P){}}else{let P=document.createRange();y.anchor>y.head&&([x,S]=[S,x]),P.setEnd(S.node,S.offset),P.setStart(x.node,x.offset),O.removeAllRanges(),O.addRange(P)}f&&this.view.root.activeElement==this.dom&&(this.dom.blur(),o&&o.focus())}),this.view.observer.setSelectionRange(x,S)),this.impreciseAnchor=x.precise?null:new je(k.anchorNode,k.anchorOffset),this.impreciseHead=S.precise?null:new je(k.focusNode,k.focusOffset)}suppressWidgetCursorChange(t,i){return this.hasComposition&&i.empty&&!this.compositionBarrier.size&&Xe(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,i=t.state.selection.main,o=He(t.root),{anchorNode:a,anchorOffset:f}=t.observer.selectionRange;if(!o||!i.empty||!i.assoc||!o.modify)return;let m=tt.find(this,i.head);if(!m)return;let y=m.posAtStart;if(i.head==y||i.head==y+m.length)return;let x=this.coordsAt(i.head,-1),S=this.coordsAt(i.head,1);if(!x||!S||x.bottom>S.top)return;let k=this.domAtPos(i.head+i.assoc);o.collapse(k.node,k.offset),o.modify("move",i.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let O=t.observer.selectionRange;t.docView.posFromDOM(O.anchorNode,O.anchorOffset)!=i.from&&o.collapse(a,f)}moveToLine(t){let i=this.dom,o;if(t.node!=i)return t;for(let a=t.offset;!o&&a<i.childNodes.length;a++){let f=Me.get(i.childNodes[a]);f instanceof tt&&(o=f.domAtPos(0))}for(let a=t.offset-1;!o&&a>=0;a--){let f=Me.get(i.childNodes[a]);f instanceof tt&&(o=f.domAtPos(f.length))}return o?new je(o.node,o.offset,!0):t}nearest(t){for(let i=t;i;){let o=Me.get(i);if(o&&o.rootView==this)return o;i=i.parentNode}return null}posFromDOM(t,i){let o=this.nearest(t);if(!o)throw new RangeError("Trying to find position for a DOM position outside of the document");return o.localPosFromDOM(t,i)+o.posAtStart}domAtPos(t){let{i,off:o}=this.childCursor().findPos(t,-1);for(;i<this.children.length-1;){let a=this.children[i];if(o<a.length||a instanceof tt)break;i++,o=0}return this.children[i].domAtPos(o)}coordsAt(t,i){let o=null,a=0;for(let f=this.length,m=this.children.length-1;m>=0;m--){let y=this.children[m],x=f-y.breakAfter,S=x-y.length;if(x<t)break;S<=t&&(S<t||y.covers(-1))&&(x>t||y.covers(1))&&(!o||y instanceof tt&&!(o instanceof tt&&i>=0))&&(o=y,a=S),f=S}return o?o.coordsAt(t-a,i):null}coordsForChar(t){let{i,off:o}=this.childPos(t,1),a=this.children[i];if(!(a instanceof tt))return null;for(;a.children.length;){let{i:y,off:x}=a.childPos(o,1);for(;;y++){if(y==a.children.length)return null;if((a=a.children[y]).length)break}o=x}if(!(a instanceof mt))return null;let f=(0,I.cp)(a.text,o);if(f==o)return null;let m=Ve(a.dom,o,f).getClientRects();for(let y=0;y<m.length;y++){let x=m[y];if(y==m.length-1||x.top<x.bottom&&x.left<x.right)return x}return null}measureVisibleLineHeights(t){let i=[],{from:o,to:a}=t,f=this.view.contentDOM.clientWidth,m=f>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,y=-1,x=this.view.textDirection==Ie.LTR;for(let S=0,k=0;k<this.children.length;k++){let O=this.children[k],P=S+O.length;if(P>a)break;if(S>=o){let N=O.dom.getBoundingClientRect();if(i.push(N.height),m){let F=O.dom.lastChild,$=F?Se(F):[];if($.length){let V=$[$.length-1],q=x?V.right-N.left:N.right-V.left;q>y&&(y=q,this.minWidth=f,this.minWidthFrom=S,this.minWidthTo=P)}}}S=P+O.breakAfter}return i}textDirectionAt(t){let{i}=this.childPos(t,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?Ie.RTL:Ie.LTR}measureTextSize(){for(let f of this.children)if(f instanceof tt){let m=f.measureTextSize();if(m)return m}let t=document.createElement("div"),i,o,a;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let f=Se(t.firstChild)[0];i=t.getBoundingClientRect().height,o=f?f.width/27:7,a=f?f.height:i,t.remove()}),{lineHeight:i,charWidth:o,textHeight:a}}childCursor(t=this.length){let i=this.children.length;return i&&(t-=this.children[--i].length),new ze(this.children,t,i)}computeBlockGapDeco(){let t=[],i=this.view.viewState;for(let o=0,a=0;;a++){let f=a==i.viewports.length?null:i.viewports[a],m=f?f.from-1:this.length;if(m>o){let y=(i.lineBlockAt(m).bottom-i.lineBlockAt(o).top)/this.view.scaleY;t.push(ge.replace({widget:new qi(y),block:!0,inclusive:!0,isBlockGap:!0}).range(o,m))}if(!f)break;o=f.to+1}return ge.set(t)}updateDeco(){let t=1,i=this.view.state.facet(yn).map(f=>(this.dynamicDecorationMap[t++]=typeof f=="function")?f(this.view):f),o=!1,a=this.view.state.facet(Br).map((f,m)=>{let y=typeof f=="function";return y&&(o=!0),y?f(this.view):f});for(a.length&&(this.dynamicDecorationMap[t++]=o,i.push(I.Xs.join(a))),this.decorations=[this.compositionBarrier,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}maybeCreateCompositionBarrier(){let{main:{head:t,empty:i}}=this.view.state.selection;if(!i)return!1;let o=null;for(let a of this.decorations)if(a.between(t,t,(f,m,y)=>{y.point?o=!1:y.endSide<0&&f<t&&m==t&&(o=!0)}),o===!1)break;return this.compositionBarrier=o?ge.set(al.range(t)):ge.none,!!o}clearCompositionBarrier(){this.compositionBarrier=ge.none}scrollIntoView(t){if(t.isSnapshot){let S=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=S.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let S of this.view.state.facet(Z))try{if(S(this.view,t.range,t))return!0}catch(k){Ne(this.view.state,k,"scroll handler")}let{range:i}=t,o=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),a;if(!o)return;!i.empty&&(a=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(o={left:Math.min(o.left,a.left),top:Math.min(o.top,a.top),right:Math.max(o.right,a.right),bottom:Math.max(o.bottom,a.bottom)});let f=Lr(this.view),m={left:o.left-f.left,top:o.top-f.top,right:o.right+f.right,bottom:o.bottom+f.bottom},{offsetWidth:y,offsetHeight:x}=this.view.scrollDOM;Ut(this.view.scrollDOM,m,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,y),-y),Math.max(Math.min(t.yMargin,x),-x),this.view.textDirection==Ie.LTR)}}const al=ge.widget({side:-1,widget:de.inline});function hl(h){return h.node.nodeType==1&&h.node.firstChild&&(h.offset==0||h.node.childNodes[h.offset-1].contentEditable=="false")&&(h.offset==h.node.childNodes.length||h.node.childNodes[h.offset].contentEditable=="false")}class qi extends _{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Ps(h,t){let i=h.observer.selectionRange,o=i.focusNode&&Li(i.focusNode,i.focusOffset,0);if(!o)return null;let a=t-o.offset;return{from:a,to:a+o.node.nodeValue.length,node:o.node}}function wn(h,t,i){let o=Ps(h,i);if(!o)return null;let{node:a,from:f,to:m}=o,y=a.nodeValue;if(/[\n\r]/.test(y)||h.state.doc.sliceString(o.from,o.to)!=y)return null;let x=t.invertedDesc,S=new Ft(x.mapPos(f),x.mapPos(m),f,m),k=[];for(let O=a.parentNode;;O=O.parentNode){let P=Me.get(O);if(P instanceof Tt)k.push({node:O,deco:P.mark});else{if(P instanceof tt||O.nodeName=="DIV"&&O.parentNode==h.contentDOM)return{range:S,text:a,marks:k,line:O};if(O!=h.contentDOM)k.push({node:O,deco:new wi({inclusive:!0,attributes:ct(O),tagName:O.tagName.toLowerCase()})});else return null}}}function Li(h,t,i){if(i<=0)for(let o=h,a=t;;){if(o.nodeType==3)return{node:o,offset:a};if(o.nodeType==1&&a>0)o=o.childNodes[a-1],a=lt(o);else break}if(i>=0)for(let o=h,a=t;;){if(o.nodeType==3)return{node:o,offset:a};if(o.nodeType==1&&a<o.childNodes.length&&i>=0)o=o.childNodes[a],a=0;else break}return null}function Ls(h,t){return h.nodeType!=1?0:(t&&h.childNodes[t-1].contentEditable=="false"?1:0)|(t<h.childNodes.length&&h.childNodes[t].contentEditable=="false"?2:0)}let ki=class{constructor(){this.changes=[]}compareRange(t,i){gt(t,i,this.changes)}comparePoint(t,i){gt(t,i,this.changes)}};function ka(h,t,i){let o=new ki;return I.Xs.compare(h,t,i,o),o.changes}function xn(h,t){for(let i=h;i&&i!=t;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function cl(h,t){let i=!1;return t&&h.iterChangedRanges((o,a)=>{o<t.to&&a>t.from&&(i=!0)}),i}function Es(h,t,i=1){let o=h.charCategorizer(t),a=h.doc.lineAt(t),f=t-a.from;if(a.length==0)return I.jT.cursor(t);f==0?i=1:f==a.length&&(i=-1);let m=f,y=f;i<0?m=(0,I.cp)(a.text,f,!1):y=(0,I.cp)(a.text,f);let x=o(a.text.slice(m,y));for(;m>0;){let S=(0,I.cp)(a.text,m,!1);if(o(a.text.slice(S,m))!=x)break;m=S}for(;y<a.length;){let S=(0,I.cp)(a.text,y);if(o(a.text.slice(y,S))!=x)break;y=S}return I.jT.range(m+a.from,y+a.from)}function fl(h,t){return t.left>h?t.left-h:Math.max(0,h-t.right)}function ul(h,t){return t.top>h?t.top-h:Math.max(0,h-t.bottom)}function Ki(h,t){return h.top<t.bottom-1&&h.bottom>t.top+1}function Er(h,t){return t<h.top?{top:t,left:h.left,right:h.right,bottom:h.bottom}:h}function Rr(h,t){return t>h.bottom?{top:h.top,left:h.left,right:h.right,bottom:t}:h}function Rs(h,t,i){let o,a,f,m,y=!1,x,S,k,O;for(let F=h.firstChild;F;F=F.nextSibling){let $=Se(F);for(let V=0;V<$.length;V++){let q=$[V];a&&Ki(a,q)&&(q=Er(Rr(q,a.bottom),a.top));let ie=fl(t,q),le=ul(i,q);if(ie==0&&le==0)return F.nodeType==3?dl(F,t,i):Rs(F,t,i);if(!o||m>le||m==le&&f>ie){o=F,a=q,f=ie,m=le;let ee=le?i<q.top?-1:1:ie?t<q.left?-1:1:0;y=!ee||(ee>0?V<$.length-1:V>0)}ie==0?i>q.bottom&&(!k||k.bottom<q.bottom)?(x=F,k=q):i<q.top&&(!O||O.top>q.top)&&(S=F,O=q):k&&Ki(k,q)?k=Rr(k,q.bottom):O&&Ki(O,q)&&(O=Er(O,q.top))}}if(k&&k.bottom>=i?(o=x,a=k):O&&O.top<=i&&(o=S,a=O),!o)return{node:h,offset:0};let P=Math.max(a.left,Math.min(a.right,t));if(o.nodeType==3)return dl(o,P,i);if(y&&o.contentEditable!="false")return Rs(o,P,i);let N=Array.prototype.indexOf.call(h.childNodes,o)+(t>=(a.left+a.right)/2?1:0);return{node:h,offset:N}}function dl(h,t,i){let o=h.nodeValue.length,a=-1,f=1e9,m=0;for(let y=0;y<o;y++){let x=Ve(h,y,y+1).getClientRects();for(let S=0;S<x.length;S++){let k=x[S];if(k.top==k.bottom)continue;m||(m=t-k.left);let O=(k.top>i?k.top-i:i-k.bottom)-1;if(k.left-1<=t&&k.right+1>=t&&O<f){let P=t>=(k.left+k.right)/2,N=P;if((Y.chrome||Y.gecko)&&Ve(h,y).getBoundingClientRect().left==k.right&&(N=!P),O<=0)return{node:h,offset:y+(N?1:0)};a=y+(N?1:0),f=O}}}return{node:h,offset:a>-1?a:m>0?h.nodeValue.length:0}}function Ir(h,t,i,o=-1){var a,f;let m=h.contentDOM.getBoundingClientRect(),y=m.top+h.viewState.paddingTop,x,{docHeight:S}=h.viewState,{x:k,y:O}=t,P=O-y;if(P<0)return 0;if(P>S)return h.state.doc.length;for(let ee=h.viewState.heightOracle.textHeight/2,ne=!1;x=h.elementAtHeight(P),x.type!=it.Text;)for(;P=o>0?x.bottom+ee:x.top-ee,!(P>=0&&P<=S);){if(ne)return i?null:0;ne=!0,o=-o}O=y+P;let N=x.from;if(N<h.viewport.from)return h.viewport.from==0?0:i?null:Nr(h,m,x,k,O);if(N>h.viewport.to)return h.viewport.to==h.state.doc.length?h.state.doc.length:i?null:Nr(h,m,x,k,O);let F=h.dom.ownerDocument,$=h.root.elementFromPoint?h.root:F,V=$.elementFromPoint(k,O);V&&!h.contentDOM.contains(V)&&(V=null),V||(k=Math.max(m.left+1,Math.min(m.right-1,k)),V=$.elementFromPoint(k,O),V&&!h.contentDOM.contains(V)&&(V=null));let q,ie=-1;if(V&&((a=h.docView.nearest(V))===null||a===void 0?void 0:a.isEditable)!=!1){if(F.caretPositionFromPoint){let ee=F.caretPositionFromPoint(k,O);ee&&({offsetNode:q,offset:ie}=ee)}else if(F.caretRangeFromPoint){let ee=F.caretRangeFromPoint(k,O);ee&&({startContainer:q,startOffset:ie}=ee,(!h.contentDOM.contains(q)||Y.safari&&Is(q,ie,k)||Y.chrome&&Fr(q,ie,k))&&(q=void 0))}}if(!q||!h.docView.dom.contains(q)){let ee=tt.find(h.docView,N);if(!ee)return P>x.top+x.height/2?x.to:x.from;({node:q,offset:ie}=Rs(ee.dom,k,O))}let le=h.docView.nearest(q);if(!le)return null;if(le.isWidget&&((f=le.dom)===null||f===void 0?void 0:f.nodeType)==1){let ee=le.dom.getBoundingClientRect();return t.y<ee.top||t.y<=ee.bottom&&t.x<=(ee.left+ee.right)/2?le.posAtStart:le.posAtEnd}else return le.localPosFromDOM(q,ie)+le.posAtStart}function Nr(h,t,i,o,a){let f=Math.round((o-t.left)*h.defaultCharacterWidth);if(h.lineWrapping&&i.height>h.defaultLineHeight*1.5){let y=h.viewState.heightOracle.textHeight,x=Math.floor((a-i.top-(h.defaultLineHeight-y)*.5)/y);f+=x*h.viewState.heightOracle.lineLength}let m=h.state.sliceDoc(i.from,i.to);return i.from+(0,I.Gz)(m,f,h.state.tabSize)}function Is(h,t,i){let o;if(h.nodeType!=3||t!=(o=h.nodeValue.length))return!1;for(let a=h.nextSibling;a;a=a.nextSibling)if(a.nodeType!=1||a.nodeName!="BR")return!1;return Ve(h,o-1,o).getBoundingClientRect().left>i}function Fr(h,t,i){if(t!=0)return!1;for(let a=h;;){let f=a.parentNode;if(!f||f.nodeType!=1||f.firstChild!=a)return!1;if(f.classList.contains("cm-line"))break;a=f}let o=h.nodeType==1?h.getBoundingClientRect():Ve(h,0,Math.max(h.nodeValue.length,1)).getBoundingClientRect();return i-o.left>5}function Xn(h,t){let i=h.lineBlockAt(t);if(Array.isArray(i.type)){for(let o of i.type)if(o.to>t||o.to==t&&(o.to==i.to||o.type==it.Text))return o}return i}function Hr(h,t,i,o){let a=Xn(h,t.head),f=!o||a.type!=it.Text||!(h.lineWrapping||a.widgetLineBreaks)?null:h.coordsAtPos(t.assoc<0&&t.head>a.from?t.head-1:t.head);if(f){let m=h.dom.getBoundingClientRect(),y=h.textDirectionAt(a.from),x=h.posAtCoords({x:i==(y==Ie.LTR)?m.right-1:m.left+1,y:(f.top+f.bottom)/2});if(x!=null)return I.jT.cursor(x,i?-1:1)}return I.jT.cursor(i?a.to:a.from,i?-1:1)}function Wr(h,t,i,o){let a=h.state.doc.lineAt(t.head),f=h.bidiSpans(a),m=h.textDirectionAt(a.from);for(let y=t,x=null;;){let S=u(a,f,m,y,i),k=D;if(!S){if(a.number==(i?h.state.doc.lines:1))return y;k=`
`,a=h.state.doc.line(a.number+(i?1:-1)),f=h.bidiSpans(a),S=h.visualLineSide(a,!i)}if(x){if(!x(k))return y}else{if(!o)return S;x=o(k)}y=S}}function pl(h,t,i){let o=h.state.charCategorizer(t),a=o(i);return f=>{let m=o(f);return a==I.D0.Space&&(a=m),a==m}}function Ns(h,t,i,o){let a=t.head,f=i?1:-1;if(a==(i?h.state.doc.length:0))return I.jT.cursor(a,t.assoc);let m=t.goalColumn,y,x=h.contentDOM.getBoundingClientRect(),S=h.coordsAtPos(a,t.assoc||-1),k=h.documentTop;if(S)m==null&&(m=S.left-x.left),y=f<0?S.top:S.bottom;else{let N=h.viewState.lineBlockAt(a);m==null&&(m=Math.min(x.right-x.left,h.defaultCharacterWidth*(a-N.from))),y=(f<0?N.top:N.bottom)+k}let O=x.left+m,P=o!=null?o:h.viewState.heightOracle.textHeight>>1;for(let N=0;;N+=10){let F=y+(P+N)*f,$=Ir(h,{x:O,y:F},!1,f);if(F<x.top||F>x.bottom||(f<0?$<a:$>a)){let V=h.docView.coordsForChar($),q=!V||F<V.top?-1:1;return I.jT.cursor($,q,void 0,m)}}}function Yn(h,t,i){for(;;){let o=0;for(let a of h)a.between(t-1,t+1,(f,m,y)=>{if(t>f&&t<m){let x=o||i||(t-f<m-t?-1:1);t=x<0?f:m,o=x}});if(!o)return t}}function Fs(h,t,i){let o=Yn(h.state.facet(Pr).map(a=>a(h)),i.from,t.head>i.from?-1:1);return o==i.from?i:I.jT.cursor(o,o<i.from?1:-1)}class vn{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Y.safari&&t.contentDOM.addEventListener("input",()=>null),Y.gecko&&eo(t.contentDOM.ownerDocument)}handleEvent(t){!bl(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||this.runHandlers(t.type,t)}runHandlers(t,i){let o=this.handlers[t];if(o){for(let a of o.observers)a(this.view,i);for(let a of o.handlers){if(i.defaultPrevented)break;if(a(this.view,i)){i.preventDefault();break}}}}ensureHandlers(t){let i=Vr(t),o=this.handlers,a=this.view.contentDOM;for(let f in i)if(f!="scroll"){let m=!i[f].handlers.length,y=o[f];y&&m!=!y.handlers.length&&(a.removeEventListener(f,this.handleEvent),y=null),y||a.addEventListener(f,this.handleEvent,{passive:m})}for(let f in o)f!="scroll"&&!i[f]&&a.removeEventListener(f,this.handleEvent);this.handlers=i}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(t.keyCode!=27&&ml.indexOf(t.keyCode)<0&&(this.view.inputState.lastEscPress=0),Y.android&&Y.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return Y.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=kn.find(o=>o.keyCode==t.keyCode))&&!t.ctrlKey||jr.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,vt(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:Y.safari&&!Y.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Jn(h,t){return(i,o)=>{try{return t.call(h,o,i)}catch(a){Ne(i.state,a)}}}function Vr(h){let t=Object.create(null);function i(o){return t[o]||(t[o]={observers:[],handlers:[]})}for(let o of h){let a=o.spec;if(a&&a.domEventHandlers)for(let f in a.domEventHandlers){let m=a.domEventHandlers[f];m&&i(f).handlers.push(Jn(o.value,m))}if(a&&a.domEventObservers)for(let f in a.domEventObservers){let m=a.domEventObservers[f];m&&i(f).observers.push(Jn(o.value,m))}}for(let o in _t)i(o).handlers.push(_t[o]);for(let o in Xt)i(o).observers.push(Xt[o]);return t}const kn=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],jr="dthko",ml=[16,17,18,20,91,92,224,225],Qn=6;function Zn(h){return Math.max(0,h)*.7+8}function gl(h,t){return Math.max(Math.abs(h.clientX-t.clientX),Math.abs(h.clientY-t.clientY))}class yl{constructor(t,i,o,a){this.view=t,this.startEvent=i,this.style=o,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParent=Re(t.contentDOM),this.atoms=t.state.facet(Pr).map(m=>m(t));let f=t.contentDOM.ownerDocument;f.addEventListener("mousemove",this.move=this.move.bind(this)),f.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=t.state.facet(I.yy.allowMultipleSelections)&&zr(t,i),this.dragging=qr(t,i)&&Xr(i)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){var i;if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&gl(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let o=0,a=0,f=((i=this.scrollParent)===null||i===void 0?void 0:i.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},m=Lr(this.view);t.clientX-m.left<=f.left+Qn?o=-Zn(f.left-t.clientX):t.clientX+m.right>=f.right-Qn&&(o=Zn(t.clientX-f.right)),t.clientY-m.top<=f.top+Qn?a=-Zn(f.top-t.clientY):t.clientY+m.bottom>=f.bottom-Qn&&(a=Zn(t.clientY-f.bottom)),this.setScrollSpeed(o,a)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,i){this.scrollSpeed={x:t,y:i},t||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let i=null;for(let o=0;o<t.ranges.length;o++){let a=t.ranges[o],f=null;if(a.empty){let m=Yn(this.atoms,a.from,0);m!=a.from&&(f=I.jT.cursor(m,-1))}else{let m=Yn(this.atoms,a.from,-1),y=Yn(this.atoms,a.to,1);(m!=a.from||y!=a.to)&&(f=I.jT.range(a.from==a.anchor?m:y,a.from==a.head?m:y))}f&&(i||(i=t.ranges.slice()),i[o]=f)}return i?I.jT.create(i,t.mainIndex):t}select(t){let{view:i}=this,o=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!o.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:o,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function zr(h,t){let i=h.state.facet(b);return i.length?i[0](t):Y.mac?t.metaKey:t.ctrlKey}function $r(h,t){let i=h.state.facet(v);return i.length?i[0](t):Y.mac?!t.altKey:!t.ctrlKey}function qr(h,t){let{main:i}=h.state.selection;if(i.empty)return!1;let o=He(h.root);if(!o||o.rangeCount==0)return!0;let a=o.getRangeAt(0).getClientRects();for(let f=0;f<a.length;f++){let m=a[f];if(m.left<=t.clientX&&m.right>=t.clientX&&m.top<=t.clientY&&m.bottom>=t.clientY)return!0}return!1}function bl(h,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target,o;i!=h.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(o=Me.get(i))&&o.ignoreEvent(t))return!1;return!0}const _t=Object.create(null),Xt=Object.create(null),wl=Y.ie&&Y.ie_version<15||Y.ios&&Y.webkit_version<604;function xl(h){let t=h.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{h.focus(),i.remove(),Kr(h,i.value)},50)}function Kr(h,t){let{state:i}=h,o,a=1,f=i.toText(t),m=f.lines==i.selection.ranges.length;if(Vs!=null&&i.selection.ranges.every(x=>x.empty)&&Vs==f.toString()){let x=-1;o=i.changeByRange(S=>{let k=i.doc.lineAt(S.from);if(k.from==x)return{range:S};x=k.from;let O=i.toText((m?f.line(a++).text:t)+i.lineBreak);return{changes:{from:k.from,insert:O},range:I.jT.cursor(S.from+O.length)}})}else m?o=i.changeByRange(x=>{let S=f.line(a++);return{changes:{from:x.from,to:x.to,insert:S.text},range:I.jT.cursor(x.from+S.length)}}):o=i.replaceSelection(f);h.dispatch(o,{userEvent:"input.paste",scrollIntoView:!0})}Xt.scroll=h=>{h.inputState.lastScrollTop=h.scrollDOM.scrollTop,h.inputState.lastScrollLeft=h.scrollDOM.scrollLeft},_t.keydown=(h,t)=>(h.inputState.setSelectionOrigin("select"),t.keyCode==27&&(h.inputState.lastEscPress=Date.now()),!1),Xt.touchstart=(h,t)=>{h.inputState.lastTouchTime=Date.now(),h.inputState.setSelectionOrigin("select.pointer")},Xt.touchmove=h=>{h.inputState.setSelectionOrigin("select.pointer")},_t.mousedown=(h,t)=>{if(h.observer.flush(),h.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let o of h.state.facet(C))if(i=o(h,t),i)break;if(!i&&t.button==0&&(i=Yr(h,t)),i){let o=!h.hasFocus;h.inputState.startMouseSelection(new yl(h,t,i,o)),o&&h.observer.ignore(()=>Lt(h.contentDOM));let a=h.inputState.mouseSelection;if(a)return a.start(t),a.dragging===!1}return!1};function Ur(h,t,i,o){if(o==1)return I.jT.cursor(t,i);if(o==2)return Es(h.state,t,i);{let a=tt.find(h.docView,t),f=h.state.doc.lineAt(a?a.posAtEnd:t),m=a?a.posAtStart:f.from,y=a?a.posAtEnd:f.to;return y<h.state.doc.length&&y==f.to&&y++,I.jT.range(m,y)}}let es=(h,t)=>h>=t.top&&h<=t.bottom,ts=(h,t,i)=>es(t,i)&&h>=i.left&&h<=i.right;function ti(h,t,i,o){let a=tt.find(h.docView,t);if(!a)return 1;let f=t-a.posAtStart;if(f==0)return 1;if(f==a.length)return-1;let m=a.coordsAt(f,-1);if(m&&ts(i,o,m))return-1;let y=a.coordsAt(f,1);return y&&ts(i,o,y)?1:m&&es(o,m)?-1:1}function Gr(h,t){let i=h.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:ti(h,i,t.clientX,t.clientY)}}const vl=Y.ie&&Y.ie_version<=11;let Hs=null,Ws=0,_r=0;function Xr(h){if(!vl)return h.detail;let t=Hs,i=_r;return Hs=h,_r=Date.now(),Ws=!t||i>Date.now()-400&&Math.abs(t.clientX-h.clientX)<2&&Math.abs(t.clientY-h.clientY)<2?(Ws+1)%3:1}function Yr(h,t){let i=Gr(h,t),o=Xr(t),a=h.state.selection;return{update(f){f.docChanged&&(i.pos=f.changes.mapPos(i.pos),a=a.map(f.changes))},get(f,m,y){let x=Gr(h,f),S,k=Ur(h,x.pos,x.bias,o);if(i.pos!=x.pos&&!m){let O=Ur(h,i.pos,i.bias,o),P=Math.min(O.from,k.from),N=Math.max(O.to,k.to);k=P<k.from?I.jT.range(P,N):I.jT.range(N,P)}return m?a.replaceRange(a.main.extend(k.from,k.to)):y&&o==1&&a.ranges.length>1&&(S=Jr(a,x.pos))?S:y?a.addRange(k):I.jT.create([k])}}}function Jr(h,t){for(let i=0;i<h.ranges.length;i++){let{from:o,to:a}=h.ranges[i];if(o<=t&&a>=t)return I.jT.create(h.ranges.slice(0,i).concat(h.ranges.slice(i+1)),h.mainIndex==i?0:h.mainIndex-(h.mainIndex>i?1:0))}return null}_t.dragstart=(h,t)=>{let{selection:{main:i}}=h.state;if(t.target.draggable){let a=h.docView.nearest(t.target);if(a&&a.isWidget){let f=a.posAtStart,m=f+a.length;(f>=i.to||m<=i.from)&&(i=I.jT.range(f,m))}}let{inputState:o}=h;return o.mouseSelection&&(o.mouseSelection.dragging=!0),o.draggedContent=i,t.dataTransfer&&(t.dataTransfer.setData("Text",h.state.sliceDoc(i.from,i.to)),t.dataTransfer.effectAllowed="copyMove"),!1},_t.dragend=h=>(h.inputState.draggedContent=null,!1);function is(h,t,i,o){if(!i)return;let a=h.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:f}=h.inputState,m=o&&f&&$r(h,t)?{from:f.from,to:f.to}:null,y={from:a,insert:i},x=h.state.changes(m?[m,y]:y);h.focus(),h.dispatch({changes:x,selection:{anchor:x.mapPos(a,-1),head:x.mapPos(a,1)},userEvent:m?"move.drop":"input.drop"}),h.inputState.draggedContent=null}_t.drop=(h,t)=>{if(!t.dataTransfer)return!1;if(h.state.readOnly)return!0;let i=t.dataTransfer.files;if(i&&i.length){let o=Array(i.length),a=0,f=()=>{++a==i.length&&is(h,t,o.filter(m=>m!=null).join(h.state.lineBreak),!1)};for(let m=0;m<i.length;m++){let y=new FileReader;y.onerror=f,y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(y.result)||(o[m]=y.result),f()},y.readAsText(i[m])}return!0}else{let o=t.dataTransfer.getData("Text");if(o)return is(h,t,o,!0),!0}return!1},_t.paste=(h,t)=>{if(h.state.readOnly)return!0;h.observer.flush();let i=wl?null:t.clipboardData;return i?(Kr(h,i.getData("text/plain")||i.getData("text/uri-list")),!0):(xl(h),!1)};function Qr(h,t){let i=h.dom.parentNode;if(!i)return;let o=i.appendChild(document.createElement("textarea"));o.style.cssText="position: fixed; left: -10000px; top: 10px",o.value=t,o.focus(),o.selectionEnd=t.length,o.selectionStart=0,setTimeout(()=>{o.remove(),h.focus()},50)}function kl(h){let t=[],i=[],o=!1;for(let a of h.selection.ranges)a.empty||(t.push(h.sliceDoc(a.from,a.to)),i.push(a));if(!t.length){let a=-1;for(let{from:f}of h.selection.ranges){let m=h.doc.lineAt(f);m.number>a&&(t.push(m.text),i.push({from:m.from,to:Math.min(h.doc.length,m.to+1)})),a=m.number}o=!0}return{text:t.join(h.lineBreak),ranges:i,linewise:o}}let Vs=null;_t.copy=_t.cut=(h,t)=>{let{text:i,ranges:o,linewise:a}=kl(h.state);if(!i&&!a)return!1;Vs=a?i:null,t.type=="cut"&&!h.state.readOnly&&h.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"});let f=wl?null:t.clipboardData;return f?(f.clearData(),f.setData("text/plain",i),!0):(Qr(h,i),!1)};const js=I.q6.define();function ns(h,t){let i=[];for(let o of h.facet(j)){let a=o(h,t);a&&i.push(a)}return i?h.update({effects:i,annotations:js.of(!0)}):null}function Ui(h){setTimeout(()=>{let t=h.hasFocus;if(t!=h.inputState.notifiedFocused){let i=ns(h.state,t);i?h.dispatch(i):h.update([])}},10)}Xt.focus=h=>{h.inputState.lastFocusTime=Date.now(),!h.scrollDOM.scrollTop&&(h.inputState.lastScrollTop||h.inputState.lastScrollLeft)&&(h.scrollDOM.scrollTop=h.inputState.lastScrollTop,h.scrollDOM.scrollLeft=h.inputState.lastScrollLeft),Ui(h)},Xt.blur=h=>{h.observer.clearSelectionRange(),Ui(h)},Xt.compositionstart=Xt.compositionupdate=h=>{h.inputState.compositionFirstChange==null&&(h.inputState.compositionFirstChange=!0),h.inputState.composing<0&&(h.inputState.composing=0,h.docView.maybeCreateCompositionBarrier()&&(h.update([]),h.docView.clearCompositionBarrier()))},Xt.compositionend=h=>{h.inputState.composing=-1,h.inputState.compositionEndedAt=Date.now(),h.inputState.compositionPendingKey=!0,h.inputState.compositionPendingChange=h.observer.pendingRecords().length>0,h.inputState.compositionFirstChange=null,Y.chrome&&Y.android?h.observer.flushSoon():h.inputState.compositionPendingChange?Promise.resolve().then(()=>h.observer.flush()):setTimeout(()=>{h.inputState.composing<0&&h.docView.hasComposition&&h.update([])},50)},Xt.contextmenu=h=>{h.inputState.lastContextMenu=Date.now()},_t.beforeinput=(h,t)=>{var i;let o;if(Y.chrome&&Y.android&&(o=kn.find(a=>a.inputType==t.inputType))&&(h.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let a=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var f;(((f=window.visualViewport)===null||f===void 0?void 0:f.height)||0)>a+10&&h.hasFocus&&(h.contentDOM.blur(),h.focus())},100)}return Y.ios&&t.inputType=="deleteContentForward"&&h.observer.flushSoon(),!1};const Zr=new Set;function eo(h){Zr.has(h)||(Zr.add(h),h.addEventListener("copy",()=>{}),h.addEventListener("cut",()=>{}))}const zs=["pre-wrap","normal","pre-line","break-spaces"];class $s{constructor(t){this.lineWrapping=t,this.doc=I.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,i){let o=this.doc.lineAt(i).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(o+=Math.max(0,Math.ceil((i-t-o*this.lineLength*.5)/this.lineLength))),this.lineHeight*o}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return zs.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let i=!1;for(let o=0;o<t.length;o++){let a=t[o];a<0?o++:this.heightSamples[Math.floor(a*10)]||(i=!0,this.heightSamples[Math.floor(a*10)]=!0)}return i}refresh(t,i,o,a,f,m){let y=zs.indexOf(t)>-1,x=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=y;if(this.lineWrapping=y,this.lineHeight=i,this.charWidth=o,this.textHeight=a,this.lineLength=f,x){this.heightSamples={};for(let S=0;S<m.length;S++){let k=m[S];k<0?S++:this.heightSamples[Math.floor(k*10)]=!0}}return x}}class qs{constructor(t,i){this.from=t,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class ii{constructor(t,i,o,a,f){this.from=t,this.length=i,this.top=o,this.height=a,this._content=f}get type(){return typeof this._content=="number"?it.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Je?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new ii(this.from,this.length+t.length,this.top,this.height+t.height,i)}}var Pe=function(h){return h[h.ByPos=0]="ByPos",h[h.ByHeight=1]="ByHeight",h[h.ByPosNoHeight=2]="ByPosNoHeight",h}(Pe||(Pe={}));const Sn=.001;class yt{constructor(t,i,o=2){this.length=t,this.height=i,this.flags=o}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,i){this.height!=i&&(Math.abs(this.height-i)>Sn&&(t.heightChanged=!0),this.height=i)}replace(t,i,o){return yt.of(o)}decomposeLeft(t,i){i.push(this)}decomposeRight(t,i){i.push(this)}applyChanges(t,i,o,a){let f=this,m=o.doc;for(let y=a.length-1;y>=0;y--){let{fromA:x,toA:S,fromB:k,toB:O}=a[y],P=f.lineAt(x,Pe.ByPosNoHeight,o.setDoc(i),0,0),N=P.to>=S?P:f.lineAt(S,Pe.ByPosNoHeight,o,0,0);for(O+=N.to-S,S=N.to;y>0&&P.from<=a[y-1].toA;)x=a[y-1].fromA,k=a[y-1].fromB,y--,x<P.from&&(P=f.lineAt(x,Pe.ByPosNoHeight,o,0,0));k+=P.from-x,x=P.from;let F=ss.build(o.setDoc(m),t,k,O);f=f.replace(x,S,F)}return f.updateHeight(o,0)}static empty(){return new Dt(0,0)}static of(t){if(t.length==1)return t[0];let i=0,o=t.length,a=0,f=0;for(;;)if(i==o)if(a>f*2){let y=t[i-1];y.break?t.splice(--i,1,y.left,null,y.right):t.splice(--i,1,y.left,y.right),o+=1+y.break,a-=y.size}else if(f>a*2){let y=t[o];y.break?t.splice(o,1,y.left,null,y.right):t.splice(o,1,y.left,y.right),o+=2+y.break,f-=y.size}else break;else if(a<f){let y=t[i++];y&&(a+=y.size)}else{let y=t[--o];y&&(f+=y.size)}let m=0;return t[i-1]==null?(m=1,i--):t[i]==null&&(m=1,o++),new Us(yt.of(t.slice(0,i)),m,yt.of(t.slice(o)))}}yt.prototype.size=1;class Ks extends yt{constructor(t,i,o){super(t,i),this.deco=o}blockAt(t,i,o,a){return new ii(a,this.length,o,this.height,this.deco||0)}lineAt(t,i,o,a,f){return this.blockAt(0,o,a,f)}forEachLine(t,i,o,a,f,m){t<=f+this.length&&i>=f&&m(this.blockAt(0,o,a,f))}updateHeight(t,i=0,o=!1,a){return a&&a.from<=i&&a.more&&this.setHeight(t,a.heights[a.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Dt extends Ks{constructor(t,i){super(t,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,i,o,a){return new ii(a,this.length,o,this.height,this.breaks)}replace(t,i,o){let a=o[0];return o.length==1&&(a instanceof Dt||a instanceof dt&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof dt?a=new Dt(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):yt.of(o)}updateHeight(t,i=0,o=!1,a){return a&&a.from<=i&&a.more?this.setHeight(t,a.heights[a.index++]):(o||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class dt extends yt{constructor(t){super(t,0)}heightMetrics(t,i){let o=t.doc.lineAt(i).number,a=t.doc.lineAt(i+this.length).number,f=a-o+1,m,y=0;if(t.lineWrapping){let x=Math.min(this.height,t.lineHeight*f);m=x/f,this.length>f+1&&(y=(this.height-x)/(this.length-f-1))}else m=this.height/f;return{firstLine:o,lastLine:a,perLine:m,perChar:y}}blockAt(t,i,o,a){let{firstLine:f,lastLine:m,perLine:y,perChar:x}=this.heightMetrics(i,a);if(i.lineWrapping){let S=a+Math.round(Math.max(0,Math.min(1,(t-o)/this.height))*this.length),k=i.doc.lineAt(S),O=y+k.length*x,P=Math.max(o,t-O/2);return new ii(k.from,k.length,P,O,0)}else{let S=Math.max(0,Math.min(m-f,Math.floor((t-o)/y))),{from:k,length:O}=i.doc.line(f+S);return new ii(k,O,o+y*S,y,0)}}lineAt(t,i,o,a,f){if(i==Pe.ByHeight)return this.blockAt(t,o,a,f);if(i==Pe.ByPosNoHeight){let{from:N,to:F}=o.doc.lineAt(t);return new ii(N,F-N,0,0,0)}let{firstLine:m,perLine:y,perChar:x}=this.heightMetrics(o,f),S=o.doc.lineAt(t),k=y+S.length*x,O=S.number-m,P=a+y*O+x*(S.from-f-O);return new ii(S.from,S.length,Math.max(a,Math.min(P,a+this.height-k)),k,0)}forEachLine(t,i,o,a,f,m){t=Math.max(t,f),i=Math.min(i,f+this.length);let{firstLine:y,perLine:x,perChar:S}=this.heightMetrics(o,f);for(let k=t,O=a;k<=i;){let P=o.doc.lineAt(k);if(k==t){let F=P.number-y;O+=x*F+S*(t-f-F)}let N=x+S*P.length;m(new ii(P.from,P.length,O,N,0)),O+=N,k=P.to+1}}replace(t,i,o){let a=this.length-i;if(a>0){let f=o[o.length-1];f instanceof dt?o[o.length-1]=new dt(f.length+a):o.push(null,new dt(a-1))}if(t>0){let f=o[0];f instanceof dt?o[0]=new dt(t+f.length):o.unshift(new dt(t-1),null)}return yt.of(o)}decomposeLeft(t,i){i.push(new dt(t-1),null)}decomposeRight(t,i){i.push(null,new dt(this.length-t-1))}updateHeight(t,i=0,o=!1,a){let f=i+this.length;if(a&&a.from<=i+this.length&&a.more){let m=[],y=Math.max(i,a.from),x=-1;for(a.from>i&&m.push(new dt(a.from-i-1).updateHeight(t,i));y<=f&&a.more;){let k=t.doc.lineAt(y).length;m.length&&m.push(null);let O=a.heights[a.index++];x==-1?x=O:Math.abs(O-x)>=Sn&&(x=-2);let P=new Dt(k,O);P.outdated=!1,m.push(P),y+=k+1}y<=f&&m.push(null,new dt(f-y).updateHeight(t,y));let S=yt.of(m);return(x<0||Math.abs(S.height-this.height)>=Sn||Math.abs(x-this.heightMetrics(t,i).perLine)>=Sn)&&(t.heightChanged=!0),S}else(o||this.outdated)&&(this.setHeight(t,t.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Us extends yt{constructor(t,i,o){super(t.length+i+o.length,t.height+o.height,i|(t.outdated||o.outdated?2:0)),this.left=t,this.right=o,this.size=t.size+o.size}get break(){return this.flags&1}blockAt(t,i,o,a){let f=o+this.left.height;return t<f?this.left.blockAt(t,i,o,a):this.right.blockAt(t,i,f,a+this.left.length+this.break)}lineAt(t,i,o,a,f){let m=a+this.left.height,y=f+this.left.length+this.break,x=i==Pe.ByHeight?t<m:t<y,S=x?this.left.lineAt(t,i,o,a,f):this.right.lineAt(t,i,o,m,y);if(this.break||(x?S.to<y:S.from>y))return S;let k=i==Pe.ByPosNoHeight?Pe.ByPosNoHeight:Pe.ByPos;return x?S.join(this.right.lineAt(y,k,o,m,y)):this.left.lineAt(y,k,o,a,f).join(S)}forEachLine(t,i,o,a,f,m){let y=a+this.left.height,x=f+this.left.length+this.break;if(this.break)t<x&&this.left.forEachLine(t,i,o,a,f,m),i>=x&&this.right.forEachLine(t,i,o,y,x,m);else{let S=this.lineAt(x,Pe.ByPos,o,a,f);t<S.from&&this.left.forEachLine(t,S.from-1,o,a,f,m),S.to>=t&&S.from<=i&&m(S),i>S.to&&this.right.forEachLine(S.to+1,i,o,y,x,m)}}replace(t,i,o){let a=this.left.length+this.break;if(i<a)return this.balanced(this.left.replace(t,i,o),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-a,i-a,o));let f=[];t>0&&this.decomposeLeft(t,f);let m=f.length;for(let y of o)f.push(y);if(t>0&&Sl(f,m-1),i<this.length){let y=f.length;this.decomposeRight(i,f),Sl(f,y)}return yt.of(f)}decomposeLeft(t,i){let o=this.left.length;if(t<=o)return this.left.decomposeLeft(t,i);i.push(this.left),this.break&&(o++,t>=o&&i.push(null)),t>o&&this.right.decomposeLeft(t-o,i)}decomposeRight(t,i){let o=this.left.length,a=o+this.break;if(t>=a)return this.right.decomposeRight(t-a,i);t<o&&this.left.decomposeRight(t,i),this.break&&t<a&&i.push(null),i.push(this.right)}balanced(t,i){return t.size>2*i.size||i.size>2*t.size?yt.of(this.break?[t,null,i]:[t,i]):(this.left=t,this.right=i,this.height=t.height+i.height,this.outdated=t.outdated||i.outdated,this.size=t.size+i.size,this.length=t.length+this.break+i.length,this)}updateHeight(t,i=0,o=!1,a){let{left:f,right:m}=this,y=i+f.length+this.break,x=null;return a&&a.from<=i+f.length&&a.more?x=f=f.updateHeight(t,i,o,a):f.updateHeight(t,i,o),a&&a.from<=y+m.length&&a.more?x=m=m.updateHeight(t,y,o,a):m.updateHeight(t,y,o),x?this.balanced(f,m):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Sl(h,t){let i,o;h[t]==null&&(i=h[t-1])instanceof dt&&(o=h[t+1])instanceof dt&&h.splice(t-1,3,new dt(i.length+1+o.length))}const Cl=5;class ss{constructor(t,i){this.pos=t,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,i){if(this.lineStart>-1){let o=Math.min(i,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof Dt?a.length+=o-this.pos:(o>this.pos||!this.isCovered)&&this.nodes.push(new Dt(o-this.pos,-1)),this.writtenTo=o,i>o&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(t,i,o){if(t<i||o.heightRelevant){let a=o.widget?o.widget.estimatedHeight:0,f=o.widget?o.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let m=i-t;o.block?this.addBlock(new Ks(m,a,o)):(m||f||a>=Cl)&&this.addLineDeco(a,f,m)}else i>t&&this.span(t,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=i,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Dt(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,i){let o=new dt(i-t);return this.oracle.doc.lineAt(t).to==i&&(o.flags|=4),o}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Dt)return t;let i=new Dt(0,-1);return this.nodes.push(i),i}addBlock(t){this.enterLine();let i=t.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i&&i.endSide>0&&(this.covering=t)}addLineDeco(t,i,o){let a=this.ensureLine();a.length+=o,a.collapsed+=o,a.widgetHeight=Math.max(a.widgetHeight,t),a.breaks+=i,this.writtenTo=this.pos=this.pos+o}finish(t){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Dt)&&!this.isCovered?this.nodes.push(new Dt(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let o=t;for(let a of this.nodes)a instanceof Dt&&a.updateHeight(this.oracle,o),o+=a?a.length:1;return this.nodes}static build(t,i,o,a){let f=new ss(o,t);return I.Xs.spans(i,o,a,f,0),f.finish(o)}}function Al(h,t,i){let o=new Ml;return I.Xs.compare(h,t,i,o,0),o.changes}class Ml{constructor(){this.changes=[]}compareRange(){}comparePoint(t,i,o,a){(t<i||o&&o.heightRelevant||a&&a.heightRelevant)&&gt(t,i,this.changes,5)}}function Tl(h,t){let i=h.getBoundingClientRect(),o=h.ownerDocument,a=o.defaultView||window,f=Math.max(0,i.left),m=Math.min(a.innerWidth,i.right),y=Math.max(0,i.top),x=Math.min(a.innerHeight,i.bottom);for(let S=h.parentNode;S&&S!=o.body;)if(S.nodeType==1){let k=S,O=window.getComputedStyle(k);if((k.scrollHeight>k.clientHeight||k.scrollWidth>k.clientWidth)&&O.overflow!="visible"){let P=k.getBoundingClientRect();f=Math.max(f,P.left),m=Math.min(m,P.right),y=Math.max(y,P.top),x=S==h.parentNode?P.bottom:Math.min(x,P.bottom)}S=O.position=="absolute"||O.position=="fixed"?k.offsetParent:k.parentNode}else if(S.nodeType==11)S=S.host;else break;return{left:f-i.left,right:Math.max(f,m)-i.left,top:y-(i.top+t),bottom:Math.max(y,x)-(i.top+t)}}function Gs(h,t){let i=h.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class _s{constructor(t,i,o){this.from=t,this.to=i,this.size=o}static same(t,i){if(t.length!=i.length)return!1;for(let o=0;o<t.length;o++){let a=t[o],f=i[o];if(a.from!=f.from||a.to!=f.to||a.size!=f.size)return!1}return!0}draw(t,i){return ge.replace({widget:new Sa(this.size*(i?t.scaleY:t.scaleX),i)}).range(this.from,this.to)}}class Sa extends _{constructor(t,i){super(),this.size=t,this.vertical=i}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Dl{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Gi,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ie.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=t.facet($i).some(o=>typeof o!="function"&&o.class=="cm-lineWrapping");this.heightOracle=new $s(i),this.stateDeco=t.facet(yn).filter(o=>typeof o!="function"),this.heightMap=yt.empty().applyChanges(this.stateDeco,I.xv.empty,this.heightOracle.setDoc(t.doc),[new Ft(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ge.set(this.lineGaps.map(o=>o.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:i}=this.state.selection;for(let o=0;o<=1;o++){let a=o?i.head:i.anchor;if(!t.some(({from:f,to:m})=>a>=f&&a<=m)){let{from:f,to:m}=this.lineBlockAt(a);t.push(new rs(f,m))}}this.viewports=t.sort((o,a)=>o.from-a.from),this.scaler=this.heightMap.height<=7e6?Gi:new Ol(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(this.scaler.scale==1?t:Cn(t,this.scaler))})}update(t,i=null){this.state=t.state;let o=this.stateDeco;this.stateDeco=this.state.facet(yn).filter(k=>typeof k!="function");let a=t.changedRanges,f=Ft.extendWithRanges(a,Al(o,this.stateDeco,t?t.changes:I.as.empty(this.state.doc.length))),m=this.heightMap.height,y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),f),this.heightMap.height!=m&&(t.flags|=2),y?(this.scrollAnchorPos=t.changes.mapPos(y.from,-1),this.scrollAnchorHeight=y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let x=f.length?this.mapViewport(this.viewport,t.changes):this.viewport;(i&&(i.range.head<x.from||i.range.head>x.to)||!this.viewportIsAppropriate(x))&&(x=this.getViewport(0,i));let S=!t.changes.empty||t.flags&2||x.from!=this.viewport.from||x.to!=this.viewport.to;this.viewport=x,this.updateForViewport(),S&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(G)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let i=t.contentDOM,o=window.getComputedStyle(i),a=this.heightOracle,f=o.whiteSpace;this.defaultTextDirection=o.direction=="rtl"?Ie.RTL:Ie.LTR;let m=this.heightOracle.mustRefreshForWrapping(f),y=i.getBoundingClientRect(),x=m||this.mustMeasureContent||this.contentDOMHeight!=y.height;this.contentDOMHeight=y.height,this.mustMeasureContent=!1;let S=0,k=0;if(y.width&&y.height){let{scaleX:ee,scaleY:ne}=at(i,y);(ee>.005&&Math.abs(this.scaleX-ee)>.005||ne>.005&&Math.abs(this.scaleY-ne)>.005)&&(this.scaleX=ee,this.scaleY=ne,S|=8,m=x=!0)}let O=(parseInt(o.paddingTop)||0)*this.scaleY,P=(parseInt(o.paddingBottom)||0)*this.scaleY;(this.paddingTop!=O||this.paddingBottom!=P)&&(this.paddingTop=O,this.paddingBottom=P,S|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(a.lineWrapping&&(x=!0),this.editorWidth=t.scrollDOM.clientWidth,S|=8);let N=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=N&&(this.scrollAnchorHeight=-1,this.scrollTop=N),this.scrolledToBottom=mi(t.scrollDOM);let F=(this.printing?Gs:Tl)(i,this.paddingTop),$=F.top-this.pixelViewport.top,V=F.bottom-this.pixelViewport.bottom;this.pixelViewport=F;let q=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(q!=this.inView&&(this.inView=q,q&&(x=!0)),!this.inView&&!this.scrollTarget)return 0;let ie=y.width;if((this.contentDOMWidth!=ie||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=y.width,this.editorHeight=t.scrollDOM.clientHeight,S|=8),x){let ee=t.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(ee)&&(m=!0),m||a.lineWrapping&&Math.abs(ie-this.contentDOMWidth)>a.charWidth){let{lineHeight:ne,charWidth:ce,textHeight:nt}=t.docView.measureTextSize();m=ne>0&&a.refresh(f,ne,ce,nt,ie/ce,ee),m&&(t.docView.minWidth=0,S|=8)}$>0&&V>0?k=Math.max($,V):$<0&&V<0&&(k=Math.min($,V)),a.heightChanged=!1;for(let ne of this.viewports){let ce=ne.from==this.viewport.from?ee:t.docView.measureVisibleLineHeights(ne);this.heightMap=(m?yt.empty().applyChanges(this.stateDeco,I.xv.empty,this.heightOracle,[new Ft(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(a,0,m,new qs(ne.from,ce))}a.heightChanged&&(S|=2)}let le=!this.viewportIsAppropriate(this.viewport,k)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return le&&(this.viewport=this.getViewport(k,this.scrollTarget)),this.updateForViewport(),(S&2||le)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(m?[]:this.lineGaps,t)),S|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),S}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,i){let o=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),a=this.heightMap,f=this.heightOracle,{visibleTop:m,visibleBottom:y}=this,x=new rs(a.lineAt(m-o*1e3,Pe.ByHeight,f,0,0).from,a.lineAt(y+(1-o)*1e3,Pe.ByHeight,f,0,0).to);if(i){let{head:S}=i.range;if(S<x.from||S>x.to){let k=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),O=a.lineAt(S,Pe.ByPos,f,0,0),P;i.y=="center"?P=(O.top+O.bottom)/2-k/2:i.y=="start"||i.y=="nearest"&&S<x.from?P=O.top:P=O.bottom-k,x=new rs(a.lineAt(P-1e3/2,Pe.ByHeight,f,0,0).from,a.lineAt(P+k+1e3/2,Pe.ByHeight,f,0,0).to)}}return x}mapViewport(t,i){let o=i.mapPos(t.from,-1),a=i.mapPos(t.to,1);return new rs(this.heightMap.lineAt(o,Pe.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,Pe.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:i},o=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(t,Pe.ByPos,this.heightOracle,0,0),{bottom:f}=this.heightMap.lineAt(i,Pe.ByPos,this.heightOracle,0,0),{visibleTop:m,visibleBottom:y}=this;return(t==0||a<=m-Math.max(10,Math.min(-o,250)))&&(i==this.state.doc.length||f>=y+Math.max(10,Math.min(o,250)))&&a>m-2*1e3&&f<y+2*1e3}mapLineGaps(t,i){if(!t.length||i.empty)return t;let o=[];for(let a of t)i.touchesRange(a.from,a.to)||o.push(new _s(i.mapPos(a.from),i.mapPos(a.to),a.size));return o}ensureLineGaps(t,i){let o=this.heightOracle.lineWrapping,a=o?1e4:2e3,f=a>>1,m=a<<1;if(this.defaultTextDirection!=Ie.LTR&&!o)return[];let y=[],x=(S,k,O,P)=>{if(k-S<f)return;let N=this.state.selection.main,F=[N.from];N.empty||F.push(N.to);for(let V of F)if(V>S&&V<k){x(S,V-10,O,P),x(V+10,k,O,P);return}let $=Ys(t,V=>V.from>=O.from&&V.to<=O.to&&Math.abs(V.from-S)<f&&Math.abs(V.to-k)<f&&!F.some(q=>V.from<q&&V.to>q));if(!$){if(k<O.to&&i&&o&&i.visibleRanges.some(V=>V.from<=k&&V.to>=k)){let V=i.moveToLineBoundary(I.jT.cursor(k),!1,!0).head;V>S&&(k=V)}$=new _s(S,k,this.gapSize(O,S,k,P))}y.push($)};for(let S of this.viewportLines){if(S.length<m)continue;let k=Ca(S.from,S.to,this.stateDeco);if(k.total<m)continue;let O=this.scrollTarget?this.scrollTarget.range.head:null,P,N;if(o){let F=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,$,V;if(O!=null){let q=os(k,O),ie=((this.visibleBottom-this.visibleTop)/2+F)/S.height;$=q-ie,V=q+ie}else $=(this.visibleTop-S.top-F)/S.height,V=(this.visibleBottom-S.top+F)/S.height;P=Xs(k,$),N=Xs(k,V)}else{let F=k.total*this.heightOracle.charWidth,$=a*this.heightOracle.charWidth,V,q;if(O!=null){let ie=os(k,O),le=((this.pixelViewport.right-this.pixelViewport.left)/2+$)/F;V=ie-le,q=ie+le}else V=(this.pixelViewport.left-$)/F,q=(this.pixelViewport.right+$)/F;P=Xs(k,V),N=Xs(k,q)}P>S.from&&x(S.from,P,S,k),N<S.to&&x(N,S.to,S,k)}return y}gapSize(t,i,o,a){let f=os(a,o)-os(a,i);return this.heightOracle.lineWrapping?t.height*f:a.total*this.heightOracle.charWidth*f}updateLineGaps(t){_s.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=ge.set(t.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];I.Xs.spans(t,this.viewport.from,this.viewport.to,{span(a,f){i.push({from:a,to:f})},point(){}},20);let o=i.length!=this.visibleRanges.length||this.visibleRanges.some((a,f)=>a.from!=i[f].from||a.to!=i[f].to);return this.visibleRanges=i,o?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(i=>i.from<=t&&i.to>=t)||Cn(this.heightMap.lineAt(t,Pe.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return Cn(this.heightMap.lineAt(this.scaler.fromDOM(t),Pe.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let i=this.lineBlockAtHeight(t+8);return i.from>=this.viewport.from||this.viewportLines[0].top-t>200?i:this.viewportLines[0]}elementAtHeight(t){return Cn(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class rs{constructor(t,i){this.from=t,this.to=i}}function Ca(h,t,i){let o=[],a=h,f=0;return I.Xs.spans(i,h,t,{span(){},point(m,y){m>a&&(o.push({from:a,to:m}),f+=m-a),a=y}},20),a<t&&(o.push({from:a,to:t}),f+=t-a),{total:f,ranges:o}}function Xs({total:h,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let o=Math.floor(h*i);for(let a=0;;a++){let{from:f,to:m}=t[a],y=m-f;if(o<=y)return f+o;o-=y}}function os(h,t){let i=0;for(let{from:o,to:a}of h.ranges){if(t<=a){i+=t-o;break}i+=a-o}return i/h.total}function Ys(h,t){for(let i of h)if(t(i))return i}const Gi={toDOM(h){return h},fromDOM(h){return h},scale:1};class Ol{constructor(t,i,o){let a=0,f=0,m=0;this.viewports=o.map(({from:y,to:x})=>{let S=i.lineAt(y,Pe.ByPos,t,0,0).top,k=i.lineAt(x,Pe.ByPos,t,0,0).bottom;return a+=k-S,{from:y,to:x,top:S,bottom:k,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(i.height-a);for(let y of this.viewports)y.domTop=m+(y.top-f)*this.scale,m=y.domBottom=y.domTop+(y.bottom-y.top),f=y.bottom}toDOM(t){for(let i=0,o=0,a=0;;i++){let f=i<this.viewports.length?this.viewports[i]:null;if(!f||t<f.top)return a+(t-o)*this.scale;if(t<=f.bottom)return f.domTop+(t-f.top);o=f.bottom,a=f.domBottom}}fromDOM(t){for(let i=0,o=0,a=0;;i++){let f=i<this.viewports.length?this.viewports[i]:null;if(!f||t<f.domTop)return o+(t-a)/this.scale;if(t<=f.domBottom)return f.top+(t-f.domTop);o=f.bottom,a=f.domBottom}}}function Cn(h,t){if(t.scale==1)return h;let i=t.toDOM(h.top),o=t.toDOM(h.bottom);return new ii(h.from,h.length,i,o-i,Array.isArray(h._content)?h._content.map(a=>Cn(a,t)):h._content)}const An=I.r$.define({combine:h=>h.join(" ")}),Js=I.r$.define({combine:h=>h.indexOf(!0)>-1}),Mn=Ce.V.newName(),to=Ce.V.newName(),io=Ce.V.newName(),Qs={"&light":"."+to,"&dark":"."+io};function Tn(h,t,i){return new Ce.V(t,{finish(o){return/&/.test(o)?o.replace(/&\w*/,a=>{if(a=="&")return h;if(!i||!i[a])throw new RangeError(`Unsupported selector: ${a}`);return i[a]}):h+" "+o}})}const Bl=Tn("."+Mn,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Qs),ls="\uFFFF";class as{constructor(t,i){this.points=t,this.text="",this.lineSeparator=i.facet(I.yy.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=ls}readRange(t,i){if(!t)return this;let o=t.parentNode;for(let a=t;;){this.findPointBefore(o,a);let f=this.text.length;this.readNode(a);let m=a.nextSibling;if(m==i)break;let y=Me.get(a),x=Me.get(m);(y&&x?y.breakAfter:(y?y.breakAfter:hs(a))||hs(m)&&(a.nodeName!="BR"||a.cmIgnore)&&this.text.length>f)&&this.lineBreak(),a=m}return this.findPointBefore(o,i),this}readTextNode(t){let i=t.nodeValue;for(let o of this.points)o.node==t&&(o.pos=this.text.length+Math.min(o.offset,i.length));for(let o=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let f=-1,m=1,y;if(this.lineSeparator?(f=i.indexOf(this.lineSeparator,o),m=this.lineSeparator.length):(y=a.exec(i))&&(f=y.index,m=y[0].length),this.append(i.slice(o,f<0?i.length:f)),f<0)break;if(this.lineBreak(),m>1)for(let x of this.points)x.node==t&&x.pos>this.text.length&&(x.pos-=m-1);o=f+m}}readNode(t){if(t.cmIgnore)return;let i=Me.get(t),o=i&&i.overrideDOMText;if(o!=null){this.findPointInside(t,o.length);for(let a=o.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,i){for(let o of this.points)o.node==t&&t.childNodes[o.offset]==i&&(o.pos=this.text.length)}findPointInside(t,i){for(let o of this.points)(t.nodeType==3?o.node==t:t.contains(o.node))&&(o.pos=this.text.length+(no(t,o.node,o.offset)?i:0))}}function no(h,t,i){for(;;){if(!t||i<lt(t))return!1;if(t==h)return!0;i=oe(t)+1,t=t.parentNode}}function hs(h){return h.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(h.nodeName)}class so{constructor(t,i){this.node=t,this.offset=i,this.pos=-1}}class Pl{constructor(t,i,o,a){this.typeOver=a,this.bounds=null,this.text="";let{impreciseHead:f,impreciseAnchor:m}=t.docView;if(t.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=t.docView.domBoundsAround(i,o,0))){let y=f||m?[]:Ot(t),x=new as(y,t.state);x.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=x.text,this.newSel=cs(y,this.bounds.from)}else{let y=t.observer.selectionRange,x=f&&f.node==y.focusNode&&f.offset==y.focusOffset||!We(t.contentDOM,y.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(y.focusNode,y.focusOffset),S=m&&m.node==y.anchorNode&&m.offset==y.anchorOffset||!We(t.contentDOM,y.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(y.anchorNode,y.anchorOffset),k=t.viewport;if((Y.ios||Y.chrome)&&t.state.selection.main.empty&&x!=S&&(k.from>0||k.to<t.state.doc.length)){let O=Math.min(x,S),P=Math.max(x,S),N=k.from-O,F=k.to-P;(N==0||N==1||O==0)&&(F==0||F==-1||P==t.state.doc.length)&&(x=0,S=t.state.doc.length)}this.newSel=I.jT.single(S,x)}}}function Ll(h,t){let i,{newSel:o}=t,a=h.state.selection.main,f=h.inputState.lastKeyTime>Date.now()-100?h.inputState.lastKeyCode:-1;if(t.bounds){let{from:m,to:y}=t.bounds,x=a.from,S=null;(f===8||Y.android&&t.text.length<y-m)&&(x=a.to,S="end");let k=Ma(h.state.doc.sliceString(m,y,ls),t.text,x-m,S);k&&(Y.chrome&&f==13&&k.toB==k.from+2&&t.text.slice(k.from,k.toB)==ls+ls&&k.toB--,i={from:m+k.from,to:m+k.toA,insert:I.xv.of(t.text.slice(k.from,k.toB).split(ls))})}else o&&(!h.hasFocus&&h.state.facet(Ge)||o.main.eq(a))&&(o=null);if(!i&&!o)return!1;if(!i&&t.typeOver&&!a.empty&&o&&o.main.empty?i={from:a.from,to:a.to,insert:h.state.doc.slice(a.from,a.to)}:i&&i.from>=a.from&&i.to<=a.to&&(i.from!=a.from||i.to!=a.to)&&a.to-a.from-(i.to-i.from)<=4?i={from:a.from,to:a.to,insert:h.state.doc.slice(a.from,i.from).append(i.insert).append(h.state.doc.slice(i.to,a.to))}:(Y.mac||Y.android)&&i&&i.from==i.to&&i.from==a.head-1&&/^\. ?$/.test(i.insert.toString())&&h.contentDOM.getAttribute("autocorrect")=="off"?(o&&i.insert.length==2&&(o=I.jT.single(o.main.anchor-1,o.main.head-1)),i={from:a.from,to:a.to,insert:I.xv.of([" "])}):Y.chrome&&i&&i.from==i.to&&i.from==a.head&&i.insert.toString()==`
 `&&h.lineWrapping&&(o&&(o=I.jT.single(o.main.anchor-1,o.main.head-1)),i={from:a.from,to:a.to,insert:I.xv.of([" "])}),i){if(Y.ios&&h.inputState.flushIOSKey(i)||Y.android&&(i.to==a.to&&(i.from==a.from||i.from==a.from-1&&h.state.sliceDoc(i.from,a.from)==" ")&&i.insert.length==1&&i.insert.lines==2&&vt(h.contentDOM,"Enter",13)||(i.from==a.from-1&&i.to==a.to&&i.insert.length==0||f==8&&i.insert.length<i.to-i.from&&i.to>a.head)&&vt(h.contentDOM,"Backspace",8)||i.from==a.from&&i.to==a.to+1&&i.insert.length==0&&vt(h.contentDOM,"Delete",46)))return!0;let m=i.insert.toString();h.inputState.composing>=0&&h.inputState.composing++;let y,x=()=>y||(y=Aa(h,i,o));return h.state.facet(E).some(S=>S(h,i.from,i.to,m,x))||h.dispatch(x()),!0}else if(o&&!o.main.eq(a)){let m=!1,y="select";return h.inputState.lastSelectionTime>Date.now()-50&&(h.inputState.lastSelectionOrigin=="select"&&(m=!0),y=h.inputState.lastSelectionOrigin),h.dispatch({selection:o,scrollIntoView:m,userEvent:y}),!0}else return!1}function Aa(h,t,i){let o,a=h.state,f=a.selection.main;if(t.from>=f.from&&t.to<=f.to&&t.to-t.from>=(f.to-f.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&h.inputState.composing<0){let y=f.from<t.from?a.sliceDoc(f.from,t.from):"",x=f.to>t.to?a.sliceDoc(t.to,f.to):"";o=a.replaceSelection(h.state.toText(y+t.insert.sliceString(0,void 0,h.state.lineBreak)+x))}else{let y=a.changes(t),x=i&&i.main.to<=y.newLength?i.main:void 0;if(a.selection.ranges.length>1&&h.inputState.composing>=0&&t.to<=f.to&&t.to>=f.to-10){let S=h.state.sliceDoc(t.from,t.to),k,O=i&&Ps(h,i.main.head);if(O){let F=t.insert.length-(t.to-t.from);k={from:O.from,to:O.to-F}}else k=h.state.doc.lineAt(f.head);let P=f.to-t.to,N=f.to-f.from;o=a.changeByRange(F=>{if(F.from==f.from&&F.to==f.to)return{changes:y,range:x||F.map(y)};let $=F.to-P,V=$-S.length;if(F.to-F.from!=N||h.state.sliceDoc(V,$)!=S||F.to>=k.from&&F.from<=k.to)return{range:F};let q=a.changes({from:V,to:$,insert:t.insert}),ie=F.to-f.to;return{changes:q,range:x?I.jT.range(Math.max(0,x.anchor+ie),Math.max(0,x.head+ie)):F.map(q)}})}else o={changes:y,selection:x&&a.selection.replaceRange(x)}}let m="input.type";return(h.composing||h.inputState.compositionPendingChange&&h.inputState.compositionEndedAt>Date.now()-50)&&(h.inputState.compositionPendingChange=!1,m+=".compose",h.inputState.compositionFirstChange&&(m+=".start",h.inputState.compositionFirstChange=!1)),a.update(o,{userEvent:m,scrollIntoView:!0})}function Ma(h,t,i,o){let a=Math.min(h.length,t.length),f=0;for(;f<a&&h.charCodeAt(f)==t.charCodeAt(f);)f++;if(f==a&&h.length==t.length)return null;let m=h.length,y=t.length;for(;m>0&&y>0&&h.charCodeAt(m-1)==t.charCodeAt(y-1);)m--,y--;if(o=="end"){let x=Math.max(0,f-Math.min(m,y));i-=m+x-f}if(m<f&&h.length<t.length){let x=i<=f&&i>=m?f-i:0;f-=x,y=f+(y-m),m=f}else if(y<f){let x=i<=f&&i>=y?f-i:0;f-=x,m=f+(m-y),y=f}return{from:f,toA:m,toB:y}}function Ot(h){let t=[];if(h.root.activeElement!=h.contentDOM)return t;let{anchorNode:i,anchorOffset:o,focusNode:a,focusOffset:f}=h.observer.selectionRange;return i&&(t.push(new so(i,o)),(a!=i||f!=o)&&t.push(new so(a,f))),t}function cs(h,t){if(h.length==0)return null;let i=h[0].pos,o=h.length==2?h[1].pos:i;return i>-1&&o>-1?I.jT.single(i+t,o+t):null}const El={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Zs=Y.ie&&Y.ie_version<=11;class ro{constructor(t){this.view=t,this.active=!1,this.selectionRange=new ei,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(i=>{for(let o of i)this.queue.push(o);(Y.ie&&Y.ie_version<=11||Y.ios&&t.composing)&&i.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),Zs&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){t.type=="change"&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((i,o)=>i!=t[o]))){this.gapIntersection.disconnect();for(let i of t)this.gapIntersection.observe(i);this.gaps=t}}onSelectionChange(t){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:o}=this,a=this.selectionRange;if(o.state.facet(Ge)?o.root.activeElement!=this.dom:!Ee(o.dom,a))return;let f=a.anchorNode&&o.docView.nearest(a.anchorNode);if(f&&f.ignoreEvent(t)){i||(this.selectionChanged=!1);return}(Y.ie&&Y.ie_version<=11||Y.android&&Y.chrome)&&!o.state.selection.main.empty&&a.focusNode&&Xe(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,i=Y.safari&&t.root.nodeType==11&&me(this.dom.ownerDocument)==this.dom&&Rl(this.view)||He(t.root);if(!i||this.selectionRange.eq(i))return!1;let o=Ee(this.dom,i);return o&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&Ni(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),o&&(this.selectionChanged=!0),!0)}setSelectionRange(t,i){this.selectionRange.set(t.node,t.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,i=null;for(let o=this.dom;o;)if(o.nodeType==1)!i&&t<this.scrollTargets.length&&this.scrollTargets[t]==o?t++:i||(i=this.scrollTargets.slice(0,t)),i&&i.push(o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;if(t<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,t)),i){for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);for(let o of this.scrollTargets=i)o.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,El),Zs&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Zs&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,i){var o;if(!this.delayedAndroidKey){let a=()=>{let f=this.delayedAndroidKey;f&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=f.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&f.force&&vt(this.dom,f.key,f.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((o=this.delayedAndroidKey)===null||o===void 0)&&o.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let i=-1,o=-1,a=!1;for(let f of t){let m=this.readMutation(f);m&&(m.typeOver&&(a=!0),i==-1?{from:i,to:o}=m:(i=Math.min(m.from,i),o=Math.max(m.to,o)))}return{from:i,to:o,typeOver:a}}readChange(){let{from:t,to:i,typeOver:o}=this.processRecords(),a=this.selectionChanged&&Ee(this.dom,this.selectionRange);if(t<0&&!a)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let f=new Pl(this.view,t,i,o);return this.view.docView.domChanged={newSel:f.newSel?f.newSel.main:null},f}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let o=this.view.state,a=Ll(this.view,i);return this.view.state==o&&this.view.update([]),a}readMutation(t){let i=this.view.docView.nearest(t.target);if(!i||i.ignoreMutation(t))return null;if(i.markDirty(t.type=="attributes"),t.type=="attributes"&&(i.flags|=4),t.type=="childList"){let o=Ht(i,t.previousSibling||t.target.previousSibling,-1),a=Ht(i,t.nextSibling||t.target.nextSibling,1);return{from:o?i.posAfter(o):i.posAtStart,to:a?i.posBefore(a):i.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,i,o;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(o=this.resizeScroll)===null||o===void 0||o.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Ht(h,t,i){for(;t;){let o=Me.get(t);if(o&&o.parent==h)return o;let a=t.parentNode;t=a!=h.dom?a:i>0?t.nextSibling:t.previousSibling}return null}function Rl(h){let t=null;function i(x){x.preventDefault(),x.stopImmediatePropagation(),t=x.getTargetRanges()[0]}if(h.contentDOM.addEventListener("beforeinput",i,!0),h.dom.ownerDocument.execCommand("indent"),h.contentDOM.removeEventListener("beforeinput",i,!0),!t)return null;let o=t.startContainer,a=t.startOffset,f=t.endContainer,m=t.endOffset,y=h.docView.domAtPos(h.state.selection.main.anchor);return Xe(y.node,y.offset,f,m)&&([o,a,f,m]=[f,m,o,a]),{anchorNode:o,anchorOffset:a,focusNode:f,focusOffset:m}}class be{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(o=>o.forEach(a=>i(a,this)))||(o=>this.update(o)),this.dispatch=this.dispatch.bind(this),this._root=t.root||tn(t.parent)||document,this.viewState=new Dl(t.state||I.yy.create(t)),t.scrollTo&&t.scrollTo.is(Be)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(zi).map(o=>new Os(o));for(let o of this.plugins)o.update(this);this.observer=new ro(this),this.inputState=new vn(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ll(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...t){let i=t.length==1&&t[0]instanceof I.YW?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,o=!1,a,f=this.state;for(let P of t){if(P.startState!=f)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");f=P.state}if(this.destroyed){this.viewState.state=f;return}let m=this.hasFocus,y=0,x=null;t.some(P=>P.annotation(js))?(this.inputState.notifiedFocused=m,y=1):m!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=m,x=ns(f,m),x||(y=1));let S=this.observer.delayedAndroidKey,k=null;if(S?(this.observer.clearDelayedAndroidKey(),k=this.observer.readChange(),(k&&!this.state.doc.eq(f.doc)||!this.state.selection.eq(f.selection))&&(k=null)):this.observer.clear(),f.facet(I.yy.phrases)!=this.state.facet(I.yy.phrases))return this.setState(f);a=_n.create(this,f,t),a.flags|=y;let O=this.viewState.scrollTarget;try{this.updateState=2;for(let P of t){if(O&&(O=O.map(P.changes)),P.scrollIntoView){let{main:N}=P.state.selection;O=new J(N.empty?N:I.jT.cursor(N.head,N.head>N.anchor?-1:1))}for(let N of P.effects)N.is(Be)&&(O=N.value.clip(this.state))}this.viewState.update(a,O),this.bidiCache=us.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),i=this.docView.update(a),this.state.facet(bn)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some(P=>P.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(An)!=a.state.facet(An)&&(this.viewState.mustMeasureContent=!0),(i||o||O||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!a.empty)for(let P of this.state.facet(B))try{P(a)}catch(N){Ne(this.state,N,"update listener")}(x||k)&&Promise.resolve().then(()=>{x&&this.state==x.startState&&this.dispatch(x),k&&!Ll(this,k)&&S.force&&vt(this.contentDOM,S.key,S.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let i=this.hasFocus;try{for(let o of this.plugins)o.destroy(this);this.viewState=new Dl(t),this.plugins=t.facet(zi).map(o=>new Os(o)),this.pluginMap.clear();for(let o of this.plugins)o.update(this);this.docView.destroy(),this.docView=new ll(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(t){let i=t.startState.facet(zi),o=t.state.facet(zi);if(i!=o){let a=[];for(let f of o){let m=i.indexOf(f);if(m<0)a.push(new Os(f));else{let y=this.plugins[m];y.mustUpdate=t,a.push(y)}}for(let f of this.plugins)f.mustUpdate!=t&&f.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=t;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);i!=o&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let i=t.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(o){Ne(this.state,o,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let i=null,o=this.scrollDOM,a=o.scrollTop*this.scaleY,{scrollAnchorPos:f,scrollAnchorHeight:m}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(m=-1),this.viewState.scrollAnchorHeight=-1;try{for(let y=0;;y++){if(m<0)if(mi(o))f=-1,m=this.viewState.heightMap.height;else{let N=this.viewState.scrollAnchorAt(a);f=N.from,m=N.top}this.updateState=1;let x=this.viewState.measure(this);if(!x&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let S=[];x&4||([this.measureRequests,S]=[S,this.measureRequests]);let k=S.map(N=>{try{return N.read(this)}catch(F){return Ne(this.state,F),fs}}),O=_n.create(this,this.state,[]),P=!1;O.flags|=x,i?i.flags|=x:i=O,this.updateState=2,O.empty||(this.updatePlugins(O),this.inputState.update(O),this.updateAttrs(),P=this.docView.update(O),P&&this.docViewUpdate());for(let N=0;N<S.length;N++)if(k[N]!=fs)try{let F=S[N];F.write&&F.write(k[N],this)}catch(F){Ne(this.state,F)}if(P&&this.docView.updateSelection(!0),!O.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,m=-1;continue}else{let F=(f<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(f).top)-m;if(F>1||F<-1){a=a+F,o.scrollTop=a/this.scaleY,m=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let y of this.state.facet(B))y(i)}get themeClasses(){return Mn+" "+(this.state.facet(Js)?io:to)+" "+this.state.facet(An)}updateAttrs(){let t=oo(this,Or,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ge)?"true":"false",class:"cm-content",style:`${Y.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),oo(this,$i,i);let o=this.observer.ignore(()=>{let a=et(this.contentDOM,this.contentAttrs,i),f=et(this.dom,this.editorAttrs,t);return a||f});return this.editorAttrs=t,this.contentAttrs=i,o}showAnnouncements(t){let i=!0;for(let o of t)for(let a of o.effects)if(a.is(be.announce)){i&&(this.announceDOM.textContent=""),i=!1;let f=this.announceDOM.appendChild(document.createElement("div"));f.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(bn);let t=this.state.facet(be.cspNonce);Ce.V.mount(this.root,this.styleModules.concat(Bl).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===t.key){this.measureRequests[i]=t;return}}this.measureRequests.push(t)}}plugin(t){let i=this.pluginMap.get(t);return(i===void 0||i&&i.spec!=t)&&this.pluginMap.set(t,i=this.plugins.find(o=>o.spec==t)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,i,o){return Fs(this,t,Wr(this,t,i,o))}moveByGroup(t,i){return Fs(this,t,Wr(this,t,i,o=>pl(this,t.head,o)))}visualLineSide(t,i){let o=this.bidiSpans(t),a=this.textDirectionAt(t.from),f=o[i?o.length-1:0];return I.jT.cursor(f.side(i,a)+t.from,f.forward(!i,a)?1:-1)}moveToLineBoundary(t,i,o=!0){return Hr(this,t,i,o)}moveVertically(t,i,o){return Fs(this,t,Ns(this,t,i,o))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,i=0){return this.docView.posFromDOM(t,i)}posAtCoords(t,i=!0){return this.readMeasured(),Ir(this,t,i)}coordsAtPos(t,i=1){this.readMeasured();let o=this.docView.coordsAt(t,i);if(!o||o.left==o.right)return o;let a=this.state.doc.lineAt(t),f=this.bidiSpans(a),m=f[$e.find(f,t-a.from,-1,i)];return st(o,m.dir==Ie.LTR==i>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(K)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Il)return vi(t.length);let i=this.textDirectionAt(t.from),o;for(let f of this.bidiCache)if(f.from==t.from&&f.dir==i&&(f.fresh||Bi(f.isolates,o=rl(this,t))))return f.order;o||(o=rl(this,t));let a=Gn(t.text,i,o);return this.bidiCache.push(new us(t.from,t.to,i,o,!0,a)),a}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Y.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Lt(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,i={}){return Be.of(new J(typeof t=="number"?I.jT.cursor(t):t,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:i}=this.scrollDOM,o=this.viewState.scrollAnchorAt(t);return Be.of(new J(I.jT.cursor(o.from),"start","start",o.top-t,i,!0))}static domEventHandlers(t){return ut.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return ut.define(()=>({}),{eventObservers:t})}static theme(t,i){let o=Ce.V.newName(),a=[An.of(o),bn.of(Tn(`.${o}`,t))];return i&&i.dark&&a.push(Js.of(!0)),a}static baseTheme(t){return I.Wl.lowest(bn.of(Tn("."+Mn,t,Qs)))}static findFromDOM(t){var i;let o=t.querySelector(".cm-content"),a=o&&Me.get(o)||Me.get(t);return((i=a==null?void 0:a.rootView)===null||i===void 0?void 0:i.view)||null}}be.styleModule=bn,be.inputHandler=E,be.scrollHandler=Z,be.focusChangeEffect=j,be.perLineTextDirection=K,be.exceptionSink=A,be.updateListener=B,be.editable=Ge,be.mouseSelectionStyle=C,be.dragMovesSelection=v,be.clickAddsSelectionRange=b,be.decorations=yn,be.outerDecorations=Br,be.atomicRanges=Pr,be.bidiIsolatedRanges=Bs,be.scrollMargins=ol,be.darkTheme=Js,be.cspNonce=I.r$.define({combine:h=>h.length?h[0]:""}),be.contentAttributes=$i,be.editorAttributes=Or,be.lineWrapping=be.contentAttributes.of({class:"cm-lineWrapping"}),be.announce=I.Py.define();const Il=4096,fs={};class us{constructor(t,i,o,a,f,m){this.from=t,this.to=i,this.dir=o,this.isolates=a,this.fresh=f,this.order=m}static update(t,i){if(i.empty&&!t.some(f=>f.fresh))return t;let o=[],a=t.length?t[t.length-1].dir:Ie.LTR;for(let f=Math.max(0,t.length-10);f<t.length;f++){let m=t[f];m.dir==a&&!i.touchesRange(m.from,m.to)&&o.push(new us(i.mapPos(m.from,1),i.mapPos(m.to,-1),m.dir,m.isolates,!1,m.order))}return o}}function oo(h,t,i){for(let o=h.state.facet(t),a=o.length-1;a>=0;a--){let f=o[a],m=typeof f=="function"?f(h):f;m&&It(m,i)}return i}const ni=Y.mac?"mac":Y.windows?"win":Y.linux?"linux":"key";function Nl(h,t){const i=h.split(/-(?!$)/);let o=i[i.length-1];o=="Space"&&(o=" ");let a,f,m,y;for(let x=0;x<i.length-1;++x){const S=i[x];if(/^(cmd|meta|m)$/i.test(S))y=!0;else if(/^a(lt)?$/i.test(S))a=!0;else if(/^(c|ctrl|control)$/i.test(S))f=!0;else if(/^s(hift)?$/i.test(S))m=!0;else if(/^mod$/i.test(S))t=="mac"?y=!0:f=!0;else throw new Error("Unrecognized modifier name: "+S)}return a&&(o="Alt-"+o),f&&(o="Ctrl-"+o),y&&(o="Meta-"+o),m&&(o="Shift-"+o),o}function li(h,t,i){return t.altKey&&(h="Alt-"+h),t.ctrlKey&&(h="Ctrl-"+h),t.metaKey&&(h="Meta-"+h),i!==!1&&t.shiftKey&&(h="Shift-"+h),h}const si=I.Wl.default(be.domEventHandlers({keydown(h,t){return Fl(Dn(t.state),h,t,"editor")}})),Wt=I.r$.define({enables:si}),_i=new WeakMap;function Dn(h){let t=h.facet(Wt),i=_i.get(t);return i||_i.set(t,i=Ta(t.reduce((o,a)=>o.concat(a),[]))),i}function bt(h,t,i){return Fl(Dn(h.state),t,h,i)}let ai=null;const lo=4e3;function Ta(h,t=ni){let i=Object.create(null),o=Object.create(null),a=(m,y)=>{let x=o[m];if(x==null)o[m]=y;else if(x!=y)throw new Error("Key binding "+m+" is used both as a regular binding and as a multi-stroke prefix")},f=(m,y,x,S,k)=>{var O,P;let N=i[m]||(i[m]=Object.create(null)),F=y.split(/ (?!$)/).map(q=>Nl(q,t));for(let q=1;q<F.length;q++){let ie=F.slice(0,q).join(" ");a(ie,!0),N[ie]||(N[ie]={preventDefault:!0,stopPropagation:!1,run:[le=>{let ee=ai={view:le,prefix:ie,scope:m};return setTimeout(()=>{ai==ee&&(ai=null)},lo),!0}]})}let $=F.join(" ");a($,!1);let V=N[$]||(N[$]={preventDefault:!1,stopPropagation:!1,run:((P=(O=N._any)===null||O===void 0?void 0:O.run)===null||P===void 0?void 0:P.slice())||[]});x&&V.run.push(x),S&&(V.preventDefault=!0),k&&(V.stopPropagation=!0)};for(let m of h){let y=m.scope?m.scope.split(" "):["editor"];if(m.any)for(let S of y){let k=i[S]||(i[S]=Object.create(null));k._any||(k._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let O in k)k[O].run.push(m.any)}let x=m[t]||m.key;if(x)for(let S of y)f(S,x,m.run,m.preventDefault,m.stopPropagation),m.shift&&f(S,"Shift-"+x,m.shift,m.preventDefault,m.stopPropagation)}return i}function Fl(h,t,i,o){let a=Q(t),f=(0,I.gm)(a,0),m=(0,I.nZ)(f)==a.length&&a!=" ",y="",x=!1,S=!1,k=!1;ai&&ai.view==i&&ai.scope==o&&(y=ai.prefix+" ",ml.indexOf(t.keyCode)<0&&(S=!0,ai=null));let O=new Set,P=V=>{if(V){for(let q of V.run)if(!O.has(q)&&(O.add(q),q(i,t)))return V.stopPropagation&&(k=!0),!0;V.preventDefault&&(V.stopPropagation&&(k=!0),S=!0)}return!1},N=h[o],F,$;return N&&(P(N[y+li(a,t,!m)])?x=!0:m&&(t.altKey||t.metaKey||t.ctrlKey)&&!(Y.windows&&t.ctrlKey&&t.altKey)&&(F=we[t.keyCode])&&F!=a?(P(N[y+li(F,t,!0)])||t.shiftKey&&($=L[t.keyCode])!=a&&$!=F&&P(N[y+li($,t,!1)]))&&(x=!0):m&&t.shiftKey&&P(N[y+li(a,t,!0)])&&(x=!0),!x&&P(N._any)&&(x=!0)),S&&(x=!0),x&&k&&t.stopPropagation(),x}class Si{constructor(t,i,o,a,f){this.className=t,this.left=i,this.top=o,this.width=a,this.height=f}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,i){return i.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,i,o){if(o.empty){let a=t.coordsAtPos(o.head,o.assoc||1);if(!a)return[];let f=ao(t);return[new Si(i,a.left-f.left,a.top-f.top,null,a.bottom-a.top)]}else return Da(t,i,o)}}function ao(h){let t=h.scrollDOM.getBoundingClientRect();return{left:(h.textDirection==Ie.LTR?t.left:t.right-h.scrollDOM.clientWidth*h.scaleX)-h.scrollDOM.scrollLeft*h.scaleX,top:t.top-h.scrollDOM.scrollTop*h.scaleY}}function ho(h,t,i){let o=I.jT.cursor(t);return{from:Math.max(i.from,h.moveToLineBoundary(o,!1,!0).from),to:Math.min(i.to,h.moveToLineBoundary(o,!0,!0).from),type:it.Text}}function Da(h,t,i){if(i.to<=h.viewport.from||i.from>=h.viewport.to)return[];let o=Math.max(i.from,h.viewport.from),a=Math.min(i.to,h.viewport.to),f=h.textDirection==Ie.LTR,m=h.contentDOM,y=m.getBoundingClientRect(),x=ao(h),S=m.querySelector(".cm-line"),k=S&&window.getComputedStyle(S),O=y.left+(k?parseInt(k.paddingLeft)+Math.min(0,parseInt(k.textIndent)):0),P=y.right-(k?parseInt(k.paddingRight):0),N=Xn(h,o),F=Xn(h,a),$=N.type==it.Text?N:null,V=F.type==it.Text?F:null;if($&&(h.lineWrapping||N.widgetLineBreaks)&&($=ho(h,o,$)),V&&(h.lineWrapping||F.widgetLineBreaks)&&(V=ho(h,a,V)),$&&V&&$.from==V.from)return ie(le(i.from,i.to,$));{let ne=$?le(i.from,null,$):ee(N,!1),ce=V?le(null,i.to,V):ee(F,!0),nt=[];return($||N).to<(V||F).from-($&&V?1:0)||N.widgetLineBreaks>1&&ne.bottom+h.defaultLineHeight/2<ce.top?nt.push(q(O,ne.bottom,P,ce.top)):ne.bottom<ce.top&&h.elementAtHeight((ne.bottom+ce.top)/2).type==it.Text&&(ne.bottom=ce.top=(ne.bottom+ce.top)/2),ie(ne).concat(nt).concat(ie(ce))}function q(ne,ce,nt,Ze){return new Si(t,ne-x.left,ce-x.top-.01,nt-ne,Ze-ce+.01)}function ie({top:ne,bottom:ce,horizontal:nt}){let Ze=[];for(let Yt=0;Yt<nt.length;Yt+=2)Ze.push(q(nt[Yt],ne,nt[Yt+1],ce));return Ze}function le(ne,ce,nt){let Ze=1e9,Yt=-1e9,Ri=[];function Vo(ci,pt,Wn,Qi,Ii){let fi=h.coordsAtPos(ci,ci==nt.to?-2:2),ui=h.coordsAtPos(Wn,Wn==nt.from?2:-2);!fi||!ui||(Ze=Math.min(fi.top,ui.top,Ze),Yt=Math.max(fi.bottom,ui.bottom,Yt),Ii==Ie.LTR?Ri.push(f&&pt?O:fi.left,f&&Qi?P:ui.right):Ri.push(!f&&Qi?O:ui.left,!f&&pt?P:fi.right))}let ks=ne!=null?ne:nt.from,Ai=ce!=null?ce:nt.to;for(let ci of h.visibleRanges)if(ci.to>ks&&ci.from<Ai)for(let pt=Math.max(ci.from,ks),Wn=Math.min(ci.to,Ai);;){let Qi=h.state.doc.lineAt(pt);for(let Ii of h.bidiSpans(Qi)){let fi=Ii.from+Qi.from,ui=Ii.to+Qi.from;if(fi>=Wn)break;ui>pt&&Vo(Math.max(fi,pt),ne==null&&fi<=ks,Math.min(ui,Wn),ce==null&&ui>=Ai,Ii.dir)}if(pt=Qi.to+1,pt>=Wn)break}return Ri.length==0&&Vo(ks,ne==null,Ai,ce==null,h.textDirection),{top:Ze,bottom:Yt,horizontal:Ri}}function ee(ne,ce){let nt=y.top+(ce?ne.top:ne.bottom);return{top:nt,bottom:nt,horizontal:[]}}}function Oa(h,t){return h.constructor==t.constructor&&h.eq(t)}class co{constructor(t,i){this.view=t,this.layer=i,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,t)}update(t){t.startState.facet(On)!=t.state.facet(On)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let i=0,o=t.facet(On);for(;i<o.length&&o[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:i}=this.view;(t!=this.scaleX||i!=this.scaleY)&&(this.scaleX=t,this.scaleY=i,this.dom.style.transform=`scale(${1/t}, ${1/i})`)}draw(t){if(t.length!=this.drawn.length||t.some((i,o)=>!Oa(i,this.drawn[o]))){let i=this.dom.firstChild,o=0;for(let a of t)a.update&&i&&a.constructor&&this.drawn[o].constructor&&a.update(i,this.drawn[o])?(i=i.nextSibling,o++):this.dom.insertBefore(a.draw(),i);for(;i;){let a=i.nextSibling;i.remove(),i=a}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const On=I.r$.define();function er(h){return[ut.define(t=>new co(t,h)),On.of(h)]}const Hl=!Y.ios,Bn=I.r$.define({combine(h){return(0,I.BO)(h,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,i)=>Math.min(t,i),drawRangeCursor:(t,i)=>t||i})}});function Wl(h={}){return[Bn.of(h),Vl,uo,po,G.of(!0)]}function tr(h){return h.facet(Bn)}function fo(h){return h.startState.facet(Bn)!=h.state.facet(Bn)}const Vl=er({above:!0,markers(h){let{state:t}=h,i=t.facet(Bn),o=[];for(let a of t.selection.ranges){let f=a==t.selection.main;if(a.empty?!f||Hl:i.drawRangeCursor){let m=f?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",y=a.empty?a:I.jT.cursor(a.head,a.head>a.anchor?-1:1);for(let x of Si.forRange(h,m,y))o.push(x)}}return o},update(h,t){h.transactions.some(o=>o.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let i=fo(h);return i&&ir(h.state,t),h.docChanged||h.selectionSet||i},mount(h,t){ir(t.state,h)},class:"cm-cursorLayer"});function ir(h,t){t.style.animationDuration=h.facet(Bn).cursorBlinkRate+"ms"}const uo=er({above:!1,markers(h){return h.state.selection.ranges.map(t=>t.empty?[]:Si.forRange(h,"cm-selectionBackground",t)).reduce((t,i)=>t.concat(i))},update(h,t){return h.docChanged||h.selectionSet||h.viewportChanged||fo(h)},class:"cm-selectionLayer"}),ds={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Hl&&(ds[".cm-line"].caretColor="transparent !important",ds[".cm-content"]={caretColor:"transparent !important"});const po=I.Wl.highest(be.theme(ds)),nr=I.Py.define({map(h,t){return h==null?null:t.mapPos(h)}}),Xi=I.QQ.define({create(){return null},update(h,t){return h!=null&&(h=t.changes.mapPos(h)),t.effects.reduce((i,o)=>o.is(nr)?o.value:i,h)}}),sr=ut.fromClass(class{constructor(h){this.view=h,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(h){var t;let i=h.state.field(Xi);i==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(h.startState.field(Xi)!=i||h.docChanged||h.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:h}=this,t=h.state.field(Xi),i=t!=null&&h.coordsAtPos(t);if(!i)return null;let o=h.scrollDOM.getBoundingClientRect();return{left:i.left-o.left+h.scrollDOM.scrollLeft*h.scaleX,top:i.top-o.top+h.scrollDOM.scrollTop*h.scaleY,height:i.bottom-i.top}}drawCursor(h){if(this.cursor){let{scaleX:t,scaleY:i}=this.view;h?(this.cursor.style.left=h.left/t+"px",this.cursor.style.top=h.top/i+"px",this.cursor.style.height=h.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(h){this.view.state.field(Xi)!=h&&this.view.dispatch({effects:nr.of(h)})}},{eventObservers:{dragover(h){this.setDropPos(this.view.posAtCoords({x:h.clientX,y:h.clientY}))},dragleave(h){(h.target==this.view.contentDOM||!this.view.contentDOM.contains(h.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Ci(){return[Xi,sr]}function mo(h,t,i,o,a){t.lastIndex=0;for(let f=h.iterRange(i,o),m=i,y;!f.next().done;m+=f.value.length)if(!f.lineBreak)for(;y=t.exec(f.value);)a(m+y.index,y)}function jl(h,t){let i=h.visibleRanges;if(i.length==1&&i[0].from==h.viewport.from&&i[0].to==h.viewport.to)return i;let o=[];for(let{from:a,to:f}of i)a=Math.max(h.state.doc.lineAt(a).from,a-t),f=Math.min(h.state.doc.lineAt(f).to,f+t),o.length&&o[o.length-1].to>=a?o[o.length-1].to=f:o.push({from:a,to:f});return o}class rr{constructor(t){const{regexp:i,decoration:o,decorate:a,boundary:f,maxLength:m=1e3}=t;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,a)this.addMatch=(y,x,S,k)=>a(k,S,S+y[0].length,y,x);else if(typeof o=="function")this.addMatch=(y,x,S,k)=>{let O=o(y,x,S);O&&k(S,S+y[0].length,O)};else if(o)this.addMatch=(y,x,S,k)=>k(S,S+y[0].length,o);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=f,this.maxLength=m}createDeco(t){let i=new I.f_,o=i.add.bind(i);for(let{from:a,to:f}of jl(t,this.maxLength))mo(t.state.doc,this.regexp,a,f,(m,y)=>this.addMatch(y,t,m,o));return i.finish()}updateDeco(t,i){let o=1e9,a=-1;return t.docChanged&&t.changes.iterChanges((f,m,y,x)=>{x>t.view.viewport.from&&y<t.view.viewport.to&&(o=Math.min(y,o),a=Math.max(x,a))}),t.viewportChanged||a-o>1e3?this.createDeco(t.view):a>-1?this.updateRange(t.view,i.map(t.changes),o,a):i}updateRange(t,i,o,a){for(let f of t.visibleRanges){let m=Math.max(f.from,o),y=Math.min(f.to,a);if(y>m){let x=t.state.doc.lineAt(m),S=x.to<y?t.state.doc.lineAt(y):x,k=Math.max(f.from,x.from),O=Math.min(f.to,S.to);if(this.boundary){for(;m>x.from;m--)if(this.boundary.test(x.text[m-1-x.from])){k=m;break}for(;y<S.to;y++)if(this.boundary.test(S.text[y-S.from])){O=y;break}}let P=[],N,F=($,V,q)=>P.push(q.range($,V));if(x==S)for(this.regexp.lastIndex=k-x.from;(N=this.regexp.exec(x.text))&&N.index<O-x.from;)this.addMatch(N,t,N.index+x.from,F);else mo(t.state.doc,this.regexp,k,O,($,V)=>this.addMatch(V,t,$,F));i=i.update({filterFrom:k,filterTo:O,filter:($,V)=>$<k||V>O,add:P})}}return i}}const or=/x/.unicode!=null?"gu":"g",zl=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,or),$l={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ps=null;function ql(){var h;if(ps==null&&typeof document!="undefined"&&document.body){let t=document.body.style;ps=((h=t.tabSize)!==null&&h!==void 0?h:t.MozTabSize)!=null}return ps||!1}const lr=I.r$.define({combine(h){let t=(0,I.BO)(h,{render:null,specialChars:zl,addSpecialChars:null});return(t.replaceTabs=!ql())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,or)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,or)),t}});function Vt(h={}){return[lr.of(h),go()]}let Pn=null;function go(){return Pn||(Pn=ut.fromClass(class{constructor(h){this.view=h,this.decorations=ge.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(h.state.facet(lr)),this.decorations=this.decorator.createDeco(h)}makeDecorator(h){return new rr({regexp:h.specialChars,decoration:(t,i,o)=>{let{doc:a}=i.state,f=(0,I.gm)(t[0],0);if(f==9){let m=a.lineAt(o),y=i.state.tabSize,x=(0,I.IS)(m.text,y,o-m.from);return ge.replace({widget:new ms((y-x%y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[f]||(this.decorationCache[f]=ge.replace({widget:new Pa(h,f)}))},boundary:h.replaceTabs?void 0:/[^]/})}update(h){let t=h.state.facet(lr);h.startState.facet(lr)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(h.view)):this.decorations=this.decorator.updateDeco(h,this.decorations)}},{decorations:h=>h.decorations}))}const yo="\u2022";function Ba(h){return h>=32?yo:h==10?"\u2424":String.fromCharCode(9216+h)}class Pa extends _{constructor(t,i){super(),this.options=t,this.code=i}eq(t){return t.code==this.code}toDOM(t){let i=Ba(this.code),o=t.state.phrase("Control character")+" "+($l[this.code]||"0x"+this.code.toString(16)),a=this.options.render&&this.options.render(this.code,o,i);if(a)return a;let f=document.createElement("span");return f.textContent=i,f.title=o,f.setAttribute("aria-label",o),f.className="cm-specialChar",f}ignoreEvent(){return!1}}class ms extends _{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}const bo=null;function La(){return[bo,$i.of(h=>{var t;return((t=h.plugin(bo))===null||t===void 0?void 0:t.attrs)||null})]}function Ea(){return wo}const Ra=ge.line({class:"cm-activeLine"}),wo=ut.fromClass(class{constructor(h){this.decorations=this.getDeco(h)}update(h){(h.docChanged||h.selectionSet)&&(this.decorations=this.getDeco(h.view))}getDeco(h){let t=-1,i=[];for(let o of h.state.selection.ranges){let a=h.lineBlockAt(o.head);a.from>t&&(i.push(Ra.range(a.from)),t=a.from)}return ge.set(i)}},{decorations:h=>h.decorations});class Ia extends _{constructor(t){super(),this.content=t}toDOM(){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(t){let i=t.firstChild?Se(t.firstChild):[];if(!i.length)return null;let o=window.getComputedStyle(t.parentNode),a=st(i[0],o.direction!="rtl"),f=parseInt(o.lineHeight);return a.bottom-a.top>f*1.5?{left:a.left,right:a.right,top:a.top,bottom:a.top+f}:a}ignoreEvent(){return!1}}function Na(h){return ut.fromClass(class{constructor(t){this.view=t,this.placeholder=h?ge.set([ge.widget({widget:new Ia(h),side:1}).range(0)]):ge.none}get decorations(){return this.view.state.doc.length?ge.none:this.placeholder}},{decorations:t=>t.decorations})}const ar=2e3;function Kl(h,t,i){let o=Math.min(t.line,i.line),a=Math.max(t.line,i.line),f=[];if(t.off>ar||i.off>ar||t.col<0||i.col<0){let m=Math.min(t.off,i.off),y=Math.max(t.off,i.off);for(let x=o;x<=a;x++){let S=h.doc.line(x);S.length<=y&&f.push(I.jT.range(S.from+m,S.to+y))}}else{let m=Math.min(t.col,i.col),y=Math.max(t.col,i.col);for(let x=o;x<=a;x++){let S=h.doc.line(x),k=(0,I.Gz)(S.text,m,h.tabSize,!0);if(k<0)f.push(I.jT.cursor(S.to));else{let O=(0,I.Gz)(S.text,y,h.tabSize);f.push(I.jT.range(S.from+k,S.from+O))}}}return f}function xo(h,t){let i=h.coordsAtPos(h.viewport.from);return i?Math.round(Math.abs((i.left-t)/h.defaultCharacterWidth)):-1}function hr(h,t){let i=h.posAtCoords({x:t.clientX,y:t.clientY},!1),o=h.state.doc.lineAt(i),a=i-o.from,f=a>ar?-1:a==o.length?xo(h,t.clientX):(0,I.IS)(o.text,h.state.tabSize,i-o.from);return{line:o.number,col:f,off:a}}function vo(h,t){let i=hr(h,t),o=h.state.selection;return i?{update(a){if(a.docChanged){let f=a.changes.mapPos(a.startState.doc.line(i.line).from),m=a.state.doc.lineAt(f);i={line:m.number,col:i.col,off:Math.min(i.off,m.length)},o=o.map(a.changes)}},get(a,f,m){let y=hr(h,a);if(!y)return o;let x=Kl(h.state,i,y);return x.length?m?I.jT.create(x.concat(o.ranges)):I.jT.create(x):o}}:null}function ko(h){let t=(h==null?void 0:h.eventFilter)||(i=>i.altKey&&i.button==0);return be.mouseSelectionStyle.of((i,o)=>t(o)?vo(i,o):null)}const So={Alt:[18,h=>!!h.altKey],Control:[17,h=>!!h.ctrlKey],Shift:[16,h=>!!h.shiftKey],Meta:[91,h=>!!h.metaKey]},Co={style:"cursor: crosshair"};function Ul(h={}){let[t,i]=So[h.key||"Alt"],o=ut.fromClass(class{constructor(a){this.view=a,this.isDown=!1}set(a){this.isDown!=a&&(this.isDown=a,this.view.update([]))}},{eventObservers:{keydown(a){this.set(a.keyCode==t||i(a))},keyup(a){(a.keyCode==t||!i(a))&&this.set(!1)},mousemove(a){this.set(i(a))}}});return[o,be.contentAttributes.of(a=>{var f;return!((f=a.plugin(o))===null||f===void 0)&&f.isDown?Co:null})]}const Ln="-10000px";class Ao{constructor(t,i,o,a){this.facet=i,this.createTooltipView=o,this.removeTooltipView=a,this.input=t.state.facet(i),this.tooltips=this.input.filter(m=>m);let f=null;this.tooltipViews=this.tooltips.map(m=>f=o(m,f))}update(t,i){var o;let a=t.state.facet(this.facet),f=a.filter(x=>x);if(a===this.input){for(let x of this.tooltipViews)x.update&&x.update(t);return!1}let m=[],y=i?[]:null;for(let x=0;x<f.length;x++){let S=f[x],k=-1;if(S){for(let O=0;O<this.tooltips.length;O++){let P=this.tooltips[O];P&&P.create==S.create&&(k=O)}if(k<0)m[x]=this.createTooltipView(S,x?m[x-1]:null),y&&(y[x]=!!S.above);else{let O=m[x]=this.tooltipViews[k];y&&(y[x]=i[k]),O.update&&O.update(t)}}}for(let x of this.tooltipViews)m.indexOf(x)<0&&(this.removeTooltipView(x),(o=x.destroy)===null||o===void 0||o.call(x));return i&&(y.forEach((x,S)=>i[S]=x),i.length=y.length),this.input=a,this.tooltips=f,this.tooltipViews=m,!0}}function Fa(h={}){return gs.of(h)}function Gl(h){let{win:t}=h;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const gs=I.r$.define({combine:h=>{var t,i,o;return{position:Y.ios?"absolute":((t=h.find(a=>a.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((i=h.find(a=>a.parent))===null||i===void 0?void 0:i.parent)||null,tooltipSpace:((o=h.find(a=>a.tooltipSpace))===null||o===void 0?void 0:o.tooltipSpace)||Gl}}}),cr=new WeakMap,En=ut.fromClass(class{constructor(h){this.view=h,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=h.state.facet(gs);this.position=t.position,this.parent=t.parent,this.classes=h.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Ao(h,fr,(i,o)=>this.createTooltip(i,o),i=>{this.resizeObserver&&this.resizeObserver.unobserve(i.dom),i.dom.remove()}),this.above=this.manager.tooltips.map(i=>!!i.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),h.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let h of this.manager.tooltipViews)this.intersectionObserver.observe(h.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(h){h.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(h,this.above);t&&this.observeIntersection();let i=t||h.geometryChanged,o=h.state.facet(gs);if(o.position!=this.position&&!this.madeAbsolute){this.position=o.position;for(let a of this.manager.tooltipViews)a.dom.style.position=this.position;i=!0}if(o.parent!=this.parent){this.parent&&this.container.remove(),this.parent=o.parent,this.createContainer();for(let a of this.manager.tooltipViews)this.container.appendChild(a.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(h,t){let i=h.create(this.view),o=t?t.dom:null;if(i.dom.classList.add("cm-tooltip"),h.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let a=document.createElement("div");a.className="cm-tooltip-arrow",i.dom.insertBefore(a,o)}return i.dom.style.position=this.position,i.dom.style.top=Ln,i.dom.style.left="0px",this.container.insertBefore(i.dom,o),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var h,t,i;this.view.win.removeEventListener("resize",this.measureSoon);for(let o of this.manager.tooltipViews)o.dom.remove(),(h=o.destroy)===null||h===void 0||h.call(o);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(i=this.intersectionObserver)===null||i===void 0||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let h=this.view.dom.getBoundingClientRect(),t=1,i=1,o=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(Y.gecko)o=a.offsetParent!=this.container.ownerDocument.body;else if(a.style.top==Ln&&a.style.left=="0px"){let f=a.getBoundingClientRect();o=Math.abs(f.top+1e4)>1||Math.abs(f.left)>1}}if(o||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(t=a.width/this.parent.offsetWidth,i=a.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:i}=this.view.viewState);return{editor:h,parent:this.parent?this.container.getBoundingClientRect():h,pos:this.manager.tooltips.map((a,f)=>{let m=this.manager.tooltipViews[f];return m.getCoords?m.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(gs).tooltipSpace(this.view),scaleX:t,scaleY:i,makeAbsolute:o}}writeMeasure(h){var t;if(h.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let y of this.manager.tooltipViews)y.dom.style.position="absolute"}let{editor:i,space:o,scaleX:a,scaleY:f}=h,m=[];for(let y=0;y<this.manager.tooltips.length;y++){let x=this.manager.tooltips[y],S=this.manager.tooltipViews[y],{dom:k}=S,O=h.pos[y],P=h.size[y];if(!O||O.bottom<=Math.max(i.top,o.top)||O.top>=Math.min(i.bottom,o.bottom)||O.right<Math.max(i.left,o.left)-.1||O.left>Math.min(i.right,o.right)+.1){k.style.top=Ln;continue}let N=x.arrow?S.dom.querySelector(".cm-tooltip-arrow"):null,F=N?7:0,$=P.right-P.left,V=(t=cr.get(S))!==null&&t!==void 0?t:P.bottom-P.top,q=S.offset||To,ie=this.view.textDirection==Ie.LTR,le=P.width>o.right-o.left?ie?o.left:o.right-P.width:ie?Math.min(O.left-(N?14:0)+q.x,o.right-$):Math.max(o.left,O.left-$+(N?14:0)-q.x),ee=this.above[y];!x.strictSide&&(ee?O.top-(P.bottom-P.top)-q.y<o.top:O.bottom+(P.bottom-P.top)+q.y>o.bottom)&&ee==o.bottom-O.bottom>O.top-o.top&&(ee=this.above[y]=!ee);let ne=(ee?O.top-o.top:o.bottom-O.bottom)-F;if(ne<V&&S.resize!==!1){if(ne<this.view.defaultLineHeight){k.style.top=Ln;continue}cr.set(S,V),k.style.height=(V=ne)/f+"px"}else k.style.height&&(k.style.height="");let ce=ee?O.top-V-F-q.y:O.bottom+F+q.y,nt=le+$;if(S.overlap!==!0)for(let Ze of m)Ze.left<nt&&Ze.right>le&&Ze.top<ce+V&&Ze.bottom>ce&&(ce=ee?Ze.top-V-2-F:Ze.bottom+F+2);if(this.position=="absolute"?(k.style.top=(ce-h.parent.top)/f+"px",k.style.left=(le-h.parent.left)/a+"px"):(k.style.top=ce/f+"px",k.style.left=le/a+"px"),N){let Ze=O.left+(ie?q.x:-q.x)-(le+14-7);N.style.left=Ze/a+"px"}S.overlap!==!0&&m.push({left:le,top:ce,right:nt,bottom:ce+V}),k.classList.toggle("cm-tooltip-above",ee),k.classList.toggle("cm-tooltip-below",!ee),S.positioned&&S.positioned(h.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let h of this.manager.tooltipViews)h.dom.style.top=Ln}},{eventObservers:{scroll(){this.maybeMeasure()}}}),Mo=be.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),To={x:0,y:0},fr=I.r$.define({enables:[En,Mo]}),Rn=I.r$.define({combine:h=>h.reduce((t,i)=>t.concat(i),[])});class ys{static create(t){return new ys(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Ao(t,Rn,(i,o)=>this.createHostedView(i,o),i=>i.dom.remove())}createHostedView(t,i){let o=t.create(this.view);return o.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(o.dom,i?i.dom.nextSibling:this.dom.firstChild),this.mounted&&o.mount&&o.mount(this.view),o}mount(t){for(let i of this.manager.tooltipViews)i.mount&&i.mount(t);this.mounted=!0}positioned(t){for(let i of this.manager.tooltipViews)i.positioned&&i.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let i of this.manager.tooltipViews)(t=i.destroy)===null||t===void 0||t.call(i)}passProp(t){let i;for(let o of this.manager.tooltipViews){let a=o[t];if(a!==void 0){if(i===void 0)i=a;else if(i!==a)return}}return i}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const _l=fr.compute([Rn],h=>{let t=h.facet(Rn);return t.length===0?null:{pos:Math.min(...t.map(i=>i.pos)),end:Math.max(...t.map(i=>{var o;return(o=i.end)!==null&&o!==void 0?o:i.pos})),create:ys.create,above:t[0].above,arrow:t.some(i=>i.arrow)}});class Yi{constructor(t,i,o,a,f){this.view=t,this.source=i,this.field=o,this.setHover=a,this.hoverTime=f,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:i}=this,o=t.docView.nearest(i.target);if(!o)return;let a,f=1;if(o instanceof $t)a=o.posAtStart;else{if(a=t.posAtCoords(i),a==null)return;let y=t.coordsAtPos(a);if(!y||i.y<y.top||i.y>y.bottom||i.x<y.left-t.defaultCharacterWidth||i.x>y.right+t.defaultCharacterWidth)return;let x=t.bidiSpans(t.state.doc.lineAt(a)).find(k=>k.from<=a&&k.to>=a),S=x&&x.dir==Ie.RTL?-1:1;f=i.x<y.left?-S:S}let m=this.source(t,a,f);if(m!=null&&m.then){let y=this.pending={pos:a};m.then(x=>{this.pending==y&&(this.pending=null,x&&!(Array.isArray(x)&&!x.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(x)?x:[x])}))},x=>Ne(t.state,x,"hover tooltip"))}else m&&!(Array.isArray(m)&&!m.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(m)?m:[m])})}get tooltip(){let t=this.view.plugin(En),i=t?t.manager.tooltips.findIndex(o=>o.create==ys.create):-1;return i>-1?t.manager.tooltipViews[i]:null}mousemove(t){var i,o;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:a,tooltip:f}=this;if(a.length&&f&&!Do(f.dom,t)||this.pending){let{pos:m}=a[0]||this.pending,y=(o=(i=a[0])===null||i===void 0?void 0:i.end)!==null&&o!==void 0?o:m;(m==y?this.view.posAtCoords(this.lastMove)!=m:!ur(this.view,m,y,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:i}=this;if(i.length){let{tooltip:o}=this;o&&o.dom.contains(t.relatedTarget)?this.watchTooltipLeave(o.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let i=o=>{t.removeEventListener("mouseleave",i),this.active.length&&!this.view.dom.contains(o.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",i)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Ei=4;function Do(h,t){let i=h.getBoundingClientRect();return t.clientX>=i.left-Ei&&t.clientX<=i.right+Ei&&t.clientY>=i.top-Ei&&t.clientY<=i.bottom+Ei}function ur(h,t,i,o,a,f){let m=h.scrollDOM.getBoundingClientRect(),y=h.documentTop+h.documentPadding.top+h.contentHeight;if(m.left>o||m.right<o||m.top>a||Math.min(m.bottom,y)<a)return!1;let x=h.posAtCoords({x:o,y:a},!1);return x>=t&&x<=i}function Oo(h,t={}){let i=I.Py.define(),o=I.QQ.define({create(){return[]},update(a,f){if(a.length&&(t.hideOnChange&&(f.docChanged||f.selection)?a=[]:t.hideOn&&(a=a.filter(m=>!t.hideOn(f,m))),f.docChanged)){let m=[];for(let y of a){let x=f.changes.mapPos(y.pos,-1,I.gc.TrackDel);if(x!=null){let S=Object.assign(Object.create(null),y);S.pos=x,S.end!=null&&(S.end=f.changes.mapPos(S.end)),m.push(S)}}a=m}for(let m of f.effects)m.is(i)&&(a=m.value),m.is(Yl)&&(a=[]);return a},provide:a=>Rn.from(a)});return[o,ut.define(a=>new Yi(a,h,o,i,t.hoverTime||300)),_l]}function Bo(h,t){let i=h.plugin(En);if(!i)return null;let o=i.manager.tooltips.indexOf(t);return o<0?null:i.manager.tooltipViews[o]}function Xl(h){return h.facet(Rn).some(t=>t)}const Yl=I.Py.define(),Ha=null;function $h(h){let t=h.plugin(En);t&&t.maybeMeasure()}const dr=I.r$.define({combine(h){let t,i;for(let o of h)t=t||o.topContainer,i=i||o.bottomContainer;return{topContainer:t,bottomContainer:i}}});function Wa(h){return h?[dr.of(h)]:[]}function Va(h,t){let i=h.plugin(Po),o=i?i.specs.indexOf(t):-1;return o>-1?i.panels[o]:null}const Po=ut.fromClass(class{constructor(h){this.input=h.state.facet(ws),this.specs=this.input.filter(i=>i),this.panels=this.specs.map(i=>i(h));let t=h.state.facet(dr);this.top=new bs(h,!0,t.topContainer),this.bottom=new bs(h,!1,t.bottomContainer),this.top.sync(this.panels.filter(i=>i.top)),this.bottom.sync(this.panels.filter(i=>!i.top));for(let i of this.panels)i.dom.classList.add("cm-panel"),i.mount&&i.mount()}update(h){let t=h.state.facet(dr);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new bs(h.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new bs(h.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=h.state.facet(ws);if(i!=this.input){let o=i.filter(x=>x),a=[],f=[],m=[],y=[];for(let x of o){let S=this.specs.indexOf(x),k;S<0?(k=x(h.view),y.push(k)):(k=this.panels[S],k.update&&k.update(h)),a.push(k),(k.top?f:m).push(k)}this.specs=o,this.panels=a,this.top.sync(f),this.bottom.sync(m);for(let x of y)x.dom.classList.add("cm-panel"),x.mount&&x.mount()}else for(let o of this.panels)o.update&&o.update(h)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:h=>be.scrollMargins.of(t=>{let i=t.plugin(h);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}})});class bs{constructor(t,i,o){this.view=t,this.top=i,this.container=o,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let i of this.panels)i.destroy&&t.indexOf(i)<0&&i.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let i=this.container||this.view.dom;i.insertBefore(this.dom,this.top?i.firstChild:null)}let t=this.dom.firstChild;for(let i of this.panels)if(i.dom.parentNode==this.dom){for(;t!=i.dom;)t=In(t);t=t.nextSibling}else this.dom.insertBefore(i.dom,t);for(;t;)t=In(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function In(h){let t=h.nextSibling;return h.remove(),t}const ws=I.r$.define({enables:Po});class hi extends I.uU{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}hi.prototype.elementClass="",hi.prototype.toDOM=void 0,hi.prototype.mapMode=I.gc.TrackBefore,hi.prototype.startSide=hi.prototype.endSide=-1,hi.prototype.point=!0;const xs=I.r$.define(),Lo={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>I.Xs.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Nn=I.r$.define();function Jl(h){return[Ql(),Nn.of(Object.assign(Object.assign({},Lo),h))]}const pr=I.r$.define({combine:h=>h.some(t=>t)});function Ql(h){let t=[Zl];return h&&h.fixed===!1&&t.push(pr.of(!0)),t}const Zl=ut.fromClass(class{constructor(h){this.view=h,this.prevViewport=h.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=h.state.facet(Nn).map(t=>new vs(h,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!h.state.facet(pr),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),h.scrollDOM.insertBefore(this.dom,h.contentDOM)}update(h){if(this.updateGutters(h)){let t=this.prevViewport,i=h.view.viewport,o=Math.min(t.to,i.to)-Math.max(t.from,i.from);this.syncGutters(o<(i.to-i.from)*.8)}h.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(pr)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=h.view.viewport}syncGutters(h){let t=this.dom.nextSibling;h&&this.dom.remove();let i=I.Xs.iter(this.view.state.facet(xs),this.view.viewport.from),o=[],a=this.gutters.map(f=>new Ro(f,this.view.viewport,-this.view.documentPadding.top));for(let f of this.view.viewportLineBlocks)if(o.length&&(o=[]),Array.isArray(f.type)){let m=!0;for(let y of f.type)if(y.type==it.Text&&m){mr(i,o,y.from);for(let x of a)x.line(this.view,y,o);m=!1}else if(y.widget)for(let x of a)x.widget(this.view,y)}else if(f.type==it.Text){mr(i,o,f.from);for(let m of a)m.line(this.view,f,o)}else if(f.widget)for(let m of a)m.widget(this.view,f);for(let f of a)f.finish();h&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(h){let t=h.startState.facet(Nn),i=h.state.facet(Nn),o=h.docChanged||h.heightChanged||h.viewportChanged||!I.Xs.eq(h.startState.facet(xs),h.state.facet(xs),h.view.viewport.from,h.view.viewport.to);if(t==i)for(let a of this.gutters)a.update(h)&&(o=!0);else{o=!0;let a=[];for(let f of i){let m=t.indexOf(f);m<0?a.push(new vs(this.view,f)):(this.gutters[m].update(h),a.push(this.gutters[m]))}for(let f of this.gutters)f.dom.remove(),a.indexOf(f)<0&&f.destroy();for(let f of a)this.dom.appendChild(f.dom);this.gutters=a}return o}destroy(){for(let h of this.gutters)h.destroy();this.dom.remove()}},{provide:h=>be.scrollMargins.of(t=>{let i=t.plugin(h);return!i||i.gutters.length==0||!i.fixed?null:t.textDirection==Ie.LTR?{left:i.dom.offsetWidth*t.scaleX}:{right:i.dom.offsetWidth*t.scaleX}})});function Eo(h){return Array.isArray(h)?h:[h]}function mr(h,t,i){for(;h.value&&h.from<=i;)h.from==i&&t.push(h.value),h.next()}class Ro{constructor(t,i,o){this.gutter=t,this.height=o,this.i=0,this.cursor=I.Xs.iter(t.markers,i.from)}addElement(t,i,o){let{gutter:a}=this,f=(i.top-this.height)/t.scaleY,m=i.height/t.scaleY;if(this.i==a.elements.length){let y=new Io(t,m,f,o);a.elements.push(y),a.dom.appendChild(y.dom)}else a.elements[this.i].update(t,m,f,o);this.height=i.bottom,this.i++}line(t,i,o){let a=[];mr(this.cursor,a,i.from),o.length&&(a=a.concat(o));let f=this.gutter.config.lineMarker(t,i,a);f&&a.unshift(f);let m=this.gutter;a.length==0&&!m.config.renderEmptyElements||this.addElement(t,i,a)}widget(t,i){let o=this.gutter.config.widgetMarker(t,i.widget,i);o&&this.addElement(t,i,[o])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let i=t.elements.pop();t.dom.removeChild(i.dom),i.destroy()}}}class vs{constructor(t,i){this.view=t,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let o in i.domEventHandlers)this.dom.addEventListener(o,a=>{let f=a.target,m;if(f!=this.dom&&this.dom.contains(f)){for(;f.parentNode!=this.dom;)f=f.parentNode;let x=f.getBoundingClientRect();m=(x.top+x.bottom)/2}else m=a.clientY;let y=t.lineBlockAtHeight(m-t.documentTop);i.domEventHandlers[o](t,y,a)&&a.preventDefault()});this.markers=Eo(i.markers(t)),i.initialSpacer&&(this.spacer=new Io(t,0,0,[i.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let i=this.markers;if(this.markers=Eo(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let a=this.config.updateSpacer(this.spacer.markers[0],t);a!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[a])}let o=t.view.viewport;return!I.Xs.eq(this.markers,i,o.from,o.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class Io{constructor(t,i,o,a){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,i,o,a)}update(t,i,o,a){this.height!=i&&(this.height=i,this.dom.style.height=i+"px"),this.above!=o&&(this.dom.style.marginTop=(this.above=o)?o+"px":""),gr(this.markers,a)||this.setMarkers(t,a)}setMarkers(t,i){let o="cm-gutterElement",a=this.dom.firstChild;for(let f=0,m=0;;){let y=m,x=f<i.length?i[f++]:null,S=!1;if(x){let k=x.elementClass;k&&(o+=" "+k);for(let O=m;O<this.markers.length;O++)if(this.markers[O].compare(x)){y=O,S=!0;break}}else y=this.markers.length;for(;m<y;){let k=this.markers[m++];if(k.toDOM){k.destroy(a);let O=a.nextSibling;a.remove(),a=O}}if(!x)break;x.toDOM&&(S?a=a.nextSibling:this.dom.insertBefore(x.toDOM(t),a)),S&&m++}this.dom.className=o,this.markers=i}destroy(){this.setMarkers(null,[])}}function gr(h,t){if(h.length!=t.length)return!1;for(let i=0;i<h.length;i++)if(!h[i].compare(t[i]))return!1;return!0}const No=I.r$.define(),Fn=I.r$.define({combine(h){return(0,I.BO)(h,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,i){let o=Object.assign({},t);for(let a in i){let f=o[a],m=i[a];o[a]=f?(y,x,S)=>f(y,x,S)||m(y,x,S):m}return o}})}});class yr extends hi{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function br(h,t){return h.state.facet(Fn).formatNumber(t,h.state)}const ea=Nn.compute([Fn],h=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(No)},lineMarker(t,i,o){return o.some(a=>a.toDOM)?null:new yr(br(t,t.state.doc.lineAt(i.from).number))},widgetMarker:()=>null,lineMarkerChange:t=>t.startState.facet(Fn)!=t.state.facet(Fn),initialSpacer(t){return new yr(br(t,Le(t.state.doc.lines)))},updateSpacer(t,i){let o=br(i.view,Le(i.view.state.doc.lines));return o==t.number?t:new yr(o)},domEventHandlers:h.facet(Fn).domEventHandlers}));function ta(h={}){return[Fn.of(h),Ql(),ea]}function Le(h){let t=9;for(;t<h;)t=t*10+9;return t}const Fo=new class extends hi{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Ho=xs.compute(["selection"],h=>{let t=[],i=-1;for(let o of h.selection.ranges){let a=h.doc.lineAt(o.head).from;a>i&&(i=a,t.push(Fo.range(a)))}return I.Xs.of(t)});function Ji(){return Ho}const wr=new Map;function xr(h){let t=wr.get(h);return t||wr.set(h,t=ge.mark({attributes:h==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":h.replace(/ /g,"\xB7")}})),t}function vr(h){return ut.define(t=>({decorations:h.createDeco(t),update(i){this.decorations=h.updateDeco(i,this.decorations)}}),{decorations:t=>t.decorations})}const kr=vr(new rr({regexp:/\t| +/g,decoration:h=>xr(h[0]),boundary:/\S/}));function Hn(){return kr}const Wo=vr(new rr({regexp:/\s+$/g,decoration:ge.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function ja(){return Wo}const Sr={HeightMap:yt,HeightOracle:$s,MeasuredHeights:qs,QueryType:Pe,ChangedRange:Ft,computeOrder:Gn,moveVisually:u}},28699:function(sl,en,Mt){Mt.d(en,{V:function(){return W}});const I="\u037C",Ce=typeof Symbol=="undefined"?"__"+I:Symbol.for(I),we=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),L=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class W{constructor(Q,He){this.rules=[];let{finish:We}=He||{};function me(Se){return/^@/.test(Se)?[Se]:Se.split(/,\s*/)}function Ee(Se,Xe,oe,De){let lt=[],st=/^@(\w+)\b/.exec(Se[0]),pi=st&&st[1]=="keyframes";if(st&&Xe==null)return oe.push(Se[0]+";");for(let at in Xe){let Ut=Xe[at];if(/&/.test(at))Ee(at.split(/,\s*/).map(Re=>Se.map(ei=>Re.replace(/&/,ei))).reduce((Re,ei)=>Re.concat(ei)),Ut,oe);else if(Ut&&typeof Ut=="object"){if(!st)throw new RangeError("The value of a property ("+at+") should be a primitive value.");Ee(me(at),Ut,lt,pi)}else Ut!=null&&lt.push(at.replace(/_.*/,"").replace(/[A-Z]/g,Re=>"-"+Re.toLowerCase())+": "+Ut+";")}(lt.length||pi)&&oe.push((We&&!st&&!De?Se.map(We):Se).join(", ")+" {"+lt.join(" ")+"}")}for(let Se in Q)Ee(me(Se),Q[Se],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let Q=L[Ce]||1;return L[Ce]=Q+1,I+Q.toString(36)}static mount(Q,He,We){let me=Q[we],Ee=We&&We.nonce;me?Ee&&me.setNonce(Ee):me=new Fe(Q,Ee),me.mount(Array.isArray(He)?He:[He],Q)}}let Ti=new Map;class Fe{constructor(Q,He){let We=Q.ownerDocument||Q,me=We.defaultView;if(!Q.head&&Q.adoptedStyleSheets&&me.CSSStyleSheet){let Ee=Ti.get(We);if(Ee)return Q[we]=Ee;this.sheet=new me.CSSStyleSheet,Ti.set(We,this)}else this.styleTag=We.createElement("style"),He&&this.styleTag.setAttribute("nonce",He);this.modules=[],Q[we]=this}mount(Q,He){let We=this.sheet,me=0,Ee=0;for(let Se=0;Se<Q.length;Se++){let Xe=Q[Se],oe=this.modules.indexOf(Xe);if(oe<Ee&&oe>-1&&(this.modules.splice(oe,1),Ee--,oe=-1),oe==-1){if(this.modules.splice(Ee++,0,Xe),We)for(let De=0;De<Xe.rules.length;De++)We.insertRule(Xe.rules[De],me++)}else{for(;Ee<oe;)me+=this.modules[Ee++].rules.length;me+=Xe.rules.length,Ee++}}if(We)He.adoptedStyleSheets.indexOf(this.sheet)<0&&(He.adoptedStyleSheets=[this.sheet,...He.adoptedStyleSheets]);else{let Se="";for(let oe=0;oe<this.modules.length;oe++)Se+=this.modules[oe].getRules()+`
`;this.styleTag.textContent=Se;let Xe=He.head||He;this.styleTag.parentNode!=Xe&&Xe.insertBefore(this.styleTag,Xe.firstChild)}}setNonce(Q){this.styleTag&&this.styleTag.getAttribute("nonce")!=Q&&this.styleTag.setAttribute("nonce",Q)}}}}]);
