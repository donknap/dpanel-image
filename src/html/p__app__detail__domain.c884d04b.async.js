"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3146],{80821:function(k,T,u){u.d(T,{Z:function(){return P}});var $=u(5574),m=u.n($),O=u(93246),C=u(54006),M=u(31418),b=u(86738),x=u(14726),W=u(83062),Z=u(62435),p=u(86074);function P(t){var I=(0,Z.useState)(!1),N=m()(I,2),j=N[0],S=N[1],y=M.Z.useApp(),L=(0,C.useIntl)(),K=function(){S(!0),t.action().then(function(R){if(S(!1),typeof t.onSuccess=="function"&&t.onSuccess(R),t.messageSuccess){var F="";t.messageSuccess.indexOf(".")>-1?F=L.formatMessage({id:t.messageSuccess}):F=t.messageSuccess,t.asynced?(0,O.Rk)(y,F):(0,O.$h)(y,F)}}).catch(function(R){S(!1),typeof t.onError=="function"&&t.onError(R)})};return t.confirm?(0,p.jsx)(b.Z,{style:{width:500},title:"\u63D0\u793A",description:t.confirm,onConfirm:K,okText:"Yes",cancelText:"No",children:(0,p.jsx)(x.ZP,{disabled:t.disabled,icon:t.icon,loading:j,danger:t.danger,type:t.type,children:t.children})}):(0,p.jsx)(W.Z,{title:t.tips,children:(0,p.jsx)(x.ZP,{disabled:t.disabled,icon:t.icon,loading:j,onClick:K,danger:t.danger,type:t.type,children:t.children})})}},44613:function(k,T,u){u.r(T),u.d(T,{default:function(){return se}});var $=u(15009),m=u.n($),O=u(99289),C=u.n(O),M=u(5574),b=u.n(M),x=u(54006);function W(s){return Z.apply(this,arguments)}function Z(){return Z=C()(m()().mark(function s(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/site/get-domain-list",{method:"POST",data:d}));case 1:case"end":return n.stop()}},s)})),Z.apply(this,arguments)}function p(s){return P.apply(this,arguments)}function P(){return P=C()(m()().mark(function s(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/site/create-domain",{method:"POST",data:d}));case 1:case"end":return n.stop()}},s)})),P.apply(this,arguments)}function t(s){return I.apply(this,arguments)}function I(){return I=C()(m()().mark(function s(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/site/delete-domain",{method:"POST",data:d}));case 1:case"end":return n.stop()}},s)})),I.apply(this,arguments)}function N(s){return j.apply(this,arguments)}function j(){return j=C()(m()().mark(function s(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/app/site/get-domain-detail",{method:"POST",data:d}));case 1:case"end":return n.stop()}},s)})),j.apply(this,arguments)}var S=u(184),y=u(62370),L=u(5966),K=u(31199),U=u(97462),R=u(90672),F=u(52688),H=u(20713),J=u(14726),q=u(92398),w=u(78957),G=u(34041),Q=u(71230),V=u(15746),A=u(62435),e=u(86074),_=(0,A.forwardRef)(function(s,d){(0,A.useImperativeHandle)(d,function(){return{showEdit:function(r){N({id:r.id}).then(function(o){var v;(v=c.current)===null||v===void 0||v.setFieldsValue({containerId:s.containerId,schema:r.schema,serverName:r.serverName,port:r.port,enableBlockCommonExploits:!1,enableAssetCache:!1,enableWs:!1,extraNginx:"",sslCrt:o.data.sslCert,sslKey:o.data.sslKey,vhost:o.data.vhost}),B(r.id),a(!0)})}}});var D=(0,A.useState)(!1),n=b()(D,2),h=n[0],a=n[1],c=(0,A.useRef)(),l=(0,A.useState)(0),i=b()(l,2),E=i[0],B=i[1];return(0,e.jsx)(S.a,{drawerProps:{forceRender:!0},open:h,onOpenChange:function(r){a(r)},title:"\u57DF\u540D\u7BA1\u7406",trigger:(0,e.jsx)(J.ZP,{onClick:function(){var r;B(0),(r=c.current)===null||r===void 0||r.resetFields()},type:"primary",children:"\u6DFB\u52A0\u57DF\u540D"}),formRef:c,onFinish:function(){var f=C()(m()().mark(function r(o){var v,z,Y,le;return m()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(E>0)){g.next=3;break}return g.next=3,t({id:[E]});case 3:return B(0),g.next=6,p({schema:o.schema,serverName:o.serverName,port:o.port,enableBlockCommonExploits:o.enableBlockCommonExploits,enableAssetCache:o.enableAssetCache,enableWs:o.enableWs,extraNginx:o.extraNginx,containerId:s.containerId,sslCrt:(v=o.sslCrt)!==null&&v!==void 0?v:"",sslKey:(z=o.sslKey)!==null&&z!==void 0?z:""});case 6:return le=g.sent,(Y=c.current)===null||Y===void 0||Y.resetFields(),s.onFinish(),g.abrupt("return",!0);case 10:case"end":return g.stop()}},r)}));return function(r){return f.apply(this,arguments)}}(),children:(0,e.jsx)(q.Z,{items:[{key:"1",label:"\u914D\u7F6E\u57DF\u540D",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(w.Z.Compact,{children:[(0,e.jsx)(y.Z,{label:"\u534F\u8BAE",tooltip:"\u9009\u62E9Https\u65F6\u4F1A\u81EA\u52A8\u7ED1\u5B9A\u8BC1\u4E66",required:!0,name:"schema",initialValue:"http",children:(0,e.jsxs)(G.Z,{defaultValue:"http",style:{width:"100px"},children:[(0,e.jsx)(G.Z.Option,{value:"http",children:"http"}),(0,e.jsx)(G.Z.Option,{value:"https",children:"https"})]})}),(0,e.jsx)(L.Z,{width:"lg",label:"\u57DF\u540D",tooltip:"\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D,\u5E76\u5C06\u8BE5\u57DF\u540D\u89E3\u6790\u5230\u5F53\u524D\u670D\u52A1\u5668",name:"serverName",placeholder:"\u8BF7\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D\uFF0C\u4F8B\u5982 www.explame.com, test.explame.com",rules:[{required:!0}]})]}),(0,e.jsx)(K.Z,{label:"\u7AEF\u53E3",name:"port",placeholder:"\u8F6C\u53D1\u5230\u76EE\u6807\u5BB9\u5668\u4E2D\u7684\u7AEF\u53E3\uFF0C\u4E00\u822C\u4E3A80",required:!0,rules:[{required:!0}]}),(0,e.jsx)(U.Z,{name:["schema"],children:function(r){var o=r.schema;if(o=="https")return[(0,e.jsx)(R.Z,{label:"\u8BC1\u4E66\u5185\u5BB9",name:"sslCrt",tooltip:"1.\u901A\u5E38\u8BC1\u4E66\u662F\u4EE5 .crt \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u8BC1\u4E66\u6587\u4EF6\u3002 2.\u8BC1\u4E66\u683C\u5F0F\u4EE5\u201C-----BEGIN CERTIFICATE-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END CERTIFICATE-----\u201D\u7ED3\u5C3E\u3002 3.\u8BC1\u4E66\u5185\u5BB9\u8BF7\u5305\u542B\u5B8C\u6574\u7684\u8BC1\u4E66\u94FE\u3002",placeholder:"-----BEGIN CERTIFICATE-----"},"sslCrt"),(0,e.jsx)(R.Z,{label:"\u79C1\u94A5\u5185\u5BB9",name:"sslKey",tooltip:"1.\u901A\u5E38\u79C1\u94A5\u662F\u4EE5 .key \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u79C1\u94A5\u6587\u4EF6\u3002 2.\u79C1\u94A5\u683C\u5F0F\u4EE5\u201C-----BEGIN PRIVATE KEY-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END PRIVATE KEY-----\u201D\u7ED3\u5C3E\u3002",placeholder:"-----BEGIN PRIVATE KEY-----"},"sslKey")]}}),(0,e.jsx)(y.Z,{name:"extraNginx",label:"\u81EA\u5B9A\u4E49\u914D\u7F6E",tooltip:"\u6269\u5C55\u7F51\u7AD9\u914D\u7F6E\u5185\u5BB9",children:(0,e.jsx)(H.ZP,{height:"300px",theme:"dark",style:{backgroundColor:"#282c34"}})}),(0,e.jsx)(F.Z,{label:"\u6269\u5C55Nginx\u914D\u7F6E",name:"enableExtraNginx"}),(0,e.jsx)(U.Z,{name:["enableExtraNginx"],children:function(r){var o=r.enableExtraNginx;if(o)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Q.Z,{children:[(0,e.jsx)(V.Z,{span:12,children:(0,e.jsx)(F.Z,{label:"\u963B\u6B62\u5E38\u89C1\u6F0F\u6D1E\u5229\u7528",name:"enableBlockCommonExploits"})}),(0,e.jsx)(V.Z,{children:(0,e.jsx)(F.Z,{width:"md",label:"\u9759\u6001\u8D44\u6E90\u7F13\u5B58",name:"enableAssetCache"})})]}),(0,e.jsx)(Q.Z,{children:(0,e.jsx)(V.Z,{span:12,children:(0,e.jsx)(F.Z,{label:"\u652F\u6301 Websocket",name:"enableWs"})})})]})}})]})},{key:"2",label:"vhost.conf",children:(0,e.jsx)(y.Z,{name:"vhost",label:" ",children:(0,e.jsx)(H.ZP,{height:"300px",theme:"dark",readOnly:!0,style:{backgroundColor:"#282c34"}})})}]})})}),ee=_,ue=u(80821),ne=u(43425),te=u(12010),X=u(66309),re=u(96074),ae=u(83062);function se(){var s=(0,x.useParams)(),d=(0,A.useRef)(),D=(0,A.useRef)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(te.Z,{rowKey:"id",actionRef:d,columns:[{title:"\u57DF\u540D",dataIndex:"serverName",render:function(h,a,c,l,i){var E;return(0,e.jsx)("a",{href:"".concat((E=a.schema)!==null&&E!==void 0?E:"http","://").concat(a.serverName),target:"_blank",children:a.serverName})}},{title:"\u7AEF\u53E3",dataIndex:"port"},{title:"SSL",search:!1,render:function(h,a,c,l,i){return a.schema=="http"?(0,e.jsx)(X.Z,{children:"\u5426"}):(0,e.jsx)(X.Z,{color:"red",children:"\u662F"})}},{title:"\u521B\u5EFA\u65F6\u95F4",search:!1,width:180,ellipsis:!0,dataIndex:"createdAt",render:function(h,a,c,l,i){return new Date(a.createdAt).toLocaleString()}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,render:function(h,a,c,l){return(0,e.jsx)(w.Z,{split:(0,e.jsx)(re.Z,{type:"vertical"}),children:(0,e.jsx)(J.ZP,{onClick:function(){var E;return(E=D.current)===null||E===void 0||E.showEdit(a),!0},type:"link",children:(0,e.jsx)(ae.Z,{title:"\u7BA1\u7406\u57DF\u540D",children:(0,e.jsx)(ne.Z,{})})})})}}],request:function(){var n=C()(m()().mark(function h(a,c,l){var i,E,B,f,r;return m()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,W({containerId:(i=(E=s.id)!==null&&E!==void 0?E:"")!==null&&i!==void 0?i:"",pageSize:(B=a.pageSize)!==null&&B!==void 0?B:10,page:(f=a.current)!==null&&f!==void 0?f:1,serverName:a.serverName,port:a.port});case 2:return r=v.sent,v.abrupt("return",{data:r.data.list,success:!0,total:r.data.list.length});case 4:case"end":return v.stop()}},h)}));return function(h,a,c){return n.apply(this,arguments)}}(),toolBarRender:function(){var h;return[(0,e.jsx)(ee,{ref:D,containerId:(h=s.id)!==null&&h!==void 0?h:"",onFinish:function(){var c,l;!((c=d.current)===null||c===void 0)&&c.reloadAndRest&&((l=d.current)===null||l===void 0||l.reloadAndRest())}})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(h){var a=h.selectedRowKeys;return(0,e.jsx)(w.Z,{size:16,children:(0,e.jsx)(ue.Z,{danger:!0,type:"primary",action:function(){return t({id:a})},onSuccess:function(){var l,i;return!((l=d.current)===null||l===void 0)&&l.reloadAndRest&&((i=d.current)===null||i===void 0||i.reloadAndRest()),!0},onError:function(){var l,i;return!((l=d.current)===null||l===void 0)&&l.reset&&((i=d.current)===null||i===void 0||i.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})},pagination:{pageSize:10}})})}}}]);
