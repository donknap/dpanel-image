"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3357],{80821:function(L,b,n){n.d(b,{Z:function(){return I}});var R=n(5574),s=n.n(R),D=n(93246),_=n(54006),a=n(31418),O=n(86738),f=n(14726),C=n(62435),P=n(86074);function I(u){var j=(0,C.useState)(!1),T=s()(j,2),v=T[0],g=T[1],c=a.Z.useApp(),i=(0,_.useIntl)(),B=function(){g(!0),u.action().then(function(A){if(g(!1),typeof u.onSuccess=="function"&&u.onSuccess(A),u.messageSuccess){var y="";u.messageSuccess.indexOf(".")>-1?y=i.formatMessage({id:u.messageSuccess}):y=u.messageSuccess,u.asynced?(0,D.Rk)(c,y):(0,D.$h)(c,y)}}).catch(function(A){g(!1),typeof u.onError=="function"&&u.onError(A)})};return u.confirm?(0,P.jsx)(O.Z,{style:{width:500},title:"\u63D0\u793A",description:u.confirm,onConfirm:B,okText:"Yes",cancelText:"No",children:(0,P.jsx)(f.ZP,{disabled:u.disabled,icon:u.icon,loading:v,danger:u.danger,type:u.type,children:u.children})}):(0,P.jsx)(f.ZP,{disabled:u.disabled,icon:u.icon,loading:v,onClick:B,danger:u.danger,type:u.type,children:u.children})}},70977:function(L,b,n){n.r(b),n.d(b,{default:function(){return q}});var R=n(5574),s=n.n(R),D=n(3393),_=n(43425),a=n(58638),O=n(1912),f=n(87784),C=n(40666),P=n(77171),I=n(48689),u=n(45742),j=n(38345),T=n(7529),v=n(97269),g=n(62370),c=n(5966),i=n(54006),B=n(31418),l=n(78957),A=n(66309),y=n(75891),S=n(34041),h=n(26412),o=n(63490),E=n(62435),p=n(93246),r=n(80821),k=n(5251),$=n(93162),ie=n.n($),J=n(18148),Q=n(75870),t=n(86074);function q(){var Z,ee=(0,E.useState)(),G=s()(ee,2),e=G[0],ne=G[1],w=(0,i.useParams)(),Y=B.Z.useApp(),z=(0,i.useIntl)(),H=(0,E.useRef)(),te=(0,E.useState)(0),N=s()(te,2),x=N[0],K=N[1],re=(0,i.useNavigate)(),ae=(0,E.useState)([]),V=s()(ae,2),se=V[0],ue=V[1];return(0,E.useEffect)(function(){w.id&&(0,D.YU)({md5:w.id}).then(function(d){ne(d.data)}),(0,Q.Ot)().then(function(d){if(d){var m=[];d.data.list.map(function(M){M.username!="anonymous"&&m.push({value:M.serverAddress,label:M.title+"("+M.serverAddress+")"})}),ue(m)}})},[x]),(0,t.jsx)("div",{children:(0,t.jsxs)(j.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsx)(j.Z,{title:(0,t.jsx)(_.Z,{}),subTitle:"\u5E38\u7528\u64CD\u4F5C",headerBordered:!0,bordered:!0,children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(r.Z,{icon:(0,t.jsx)(a.Z,{}),action:function(){var m;return(0,D.Rb)({md5:(m=e==null?void 0:e.info.Id)!==null&&m!==void 0?m:""})},onSuccess:function(m){var M=new Blob([m],{type:"application/tar"});(0,$.saveAs)(M,(e==null?void 0:e.info.Id)+".tar")},messageSuccess:"\u5BFC\u51FA\u6210\u529F",children:"\u5BFC\u51FA"}),(0,t.jsxs)(r.Z,{action:function(){var m;return(0,D.Gb)({tag:(m=e==null?void 0:e.info.RepoTags[0])!==null&&m!==void 0?m:"",type:"push",asLatest:!0})},type:"primary",messageSuccess:"image.pushed",onSuccess:function(){K(x+1)},children:[(0,t.jsx)(O.Z,{})," Push As Latest"]}),(0,t.jsx)(r.Z,{icon:(0,t.jsx)(f.Z,{}),danger:!0,type:"primary",action:function(){var m;return(0,J.ao)({md5:[(m=e==null?void 0:e.info.Id)!==null&&m!==void 0?m:""],force:!0})},onSuccess:function(){re("/image/list")},confirm:"\u662F\u5426\u8981\u505C\u6B62\u8BE5\u955C\u50CF\u4E0B\u7684\u5BB9\u5668\u5E76\u5F3A\u5236\u5220\u9664\uFF1F",messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u5F3A\u5236\u5220\u9664"})]})}),(0,t.jsx)(j.Z,{bordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"Tag \u5217\u8868",children:(0,t.jsx)(T.Rs,{grid:{gutter:80,column:2},headerTitle:!1,metas:{content:{render:function(m,M,W){return(0,t.jsx)(A.Z,{color:"blue",children:(0,t.jsx)(y.Z.Text,{copyable:!0,children:M})},W)}},title:{render:function(m,M,W){return(0,t.jsxs)(l.Z,{children:[(0,t.jsxs)(r.Z,{action:function(){return(0,D.Gb)({tag:M,type:"push"})},messageSuccess:"image.pushed",children:[(0,t.jsx)(O.Z,{})," Push"]}),(0,t.jsxs)(r.Z,{action:function(){return(0,D.Gb)({tag:M,type:"pull"})},messageSuccess:"image.pulling",asynced:!0,children:[(0,t.jsx)(P.Z,{})," Pull"]}),(0,t.jsx)(r.Z,{action:function(){return(0,D.Pn)({tag:M})},onSuccess:function(X){return K(x+1),!0},messageSuccess:"tag.delete",confirm:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6807\u7B7E",children:(0,t.jsx)(I.Z,{})})]},W)}}},dataSource:e==null?void 0:e.info.RepoTags})}),(0,t.jsx)(j.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"\u65B0\u589E Tag",children:(0,t.jsxs)(v.A,{formRef:H,onFinish:function(m){return new Promise(function(M,W){var U;return(!e||!(e!=null&&e.info))&&((0,p.YZ)(Y,z.formatMessage({id:"image.notFound"})),W(!0)),(0,D._U)({md5:(U=e==null?void 0:e.info.Id)!==null&&U!==void 0?U:"",tag:(m.imageRespo?m.imageRespo+"/":"")+m.imageTag}).then(function(X){var F;(0,p.$h)(Y,z.formatMessage({id:"tag.add"}),X.data.tag),K(x+1),(F=H.current)===null||F===void 0||F.resetFields(),M(!0)})})},children:[(0,t.jsx)(g.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,t.jsxs)(t.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,t.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,t.jsx)(S.Z,{placeholder:"\u9009\u62E9\u60F3\u8981\u63A8\u9001\u5230\u7684\u4ED3\u5E93\uFF0C\u672C\u5730\u4F7F\u7528\u7559\u7A7A\u5373\u53EF",options:se})}),(0,t.jsx)(c.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CF\u540D\u79F0",name:"imageTag",tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag"})]})}),(0,t.jsx)(j.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(u.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,t.jsxs)(h.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(h.Z.Item,{label:"ID",children:e==null?void 0:e.info.Id}),(0,t.jsx)(h.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,t.jsx)(h.Z.Item,{label:"Size",children:(0,k.FI)((Z=e==null?void 0:e.info.Size)!==null&&Z!==void 0?Z:0)}),(0,t.jsx)(h.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,t.jsxs)(h.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,t.jsx)(h.Z.Item,{label:"Labels",children:(0,t.jsx)(h.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(d){return(0,t.jsx)(h.Z.Item,{label:d,children:(0,t.jsx)(y.Z.Text,{style:{width:"400px"},ellipsis:{tooltip:e==null?void 0:e.info.Config.Labels[d]},children:e==null?void 0:e.info.Config.Labels[d]})},d)})})})]})}),(0,t.jsx)(j.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(u.Z,{}),subTitle:"Dockerfile \u8BE6\u60C5",children:(0,t.jsxs)(h.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(h.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,t.jsx)(h.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,t.jsx)(h.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(d){return(0,t.jsx)(A.Z,{color:"gray",children:d},d)})}),(0,t.jsx)(h.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(d){return(0,t.jsx)(A.Z,{color:"gray",children:d},d)})}),(0,t.jsx)(h.Z.Item,{label:"Env",children:(0,t.jsx)(h.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(d,m){var M=d.split("=");return(0,t.jsx)(h.Z.Item,{label:M[0],children:M[1]},m)}))})})]})}),(0,t.jsxs)(j.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(u.Z,{}),subTitle:"Layers",children:[(0,t.jsx)(o.Z,{rowKey:"CreatedBy",dataSource:e==null?void 0:e.layer.reverse(),columns:[{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy"}]}),";"]})]})})}},3393:function(L,b,n){n.d(b,{Gb:function(){return C},Pn:function(){return j},Rb:function(){return v},YU:function(){return O},_U:function(){return I}});var R=n(15009),s=n.n(R),D=n(99289),_=n.n(D),a=n(54006);function O(c){return f.apply(this,arguments)}function f(){return f=_()(s()().mark(function c(i){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/get-detail",{method:"POST",data:i}));case 1:case"end":return l.stop()}},c)})),f.apply(this,arguments)}function C(c){return P.apply(this,arguments)}function P(){return P=_()(s()().mark(function c(i){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-remote",{method:"POST",data:i}));case 1:case"end":return l.stop()}},c)})),P.apply(this,arguments)}function I(c){return u.apply(this,arguments)}function u(){return u=_()(s()().mark(function c(i){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-add",{method:"POST",data:i}));case 1:case"end":return l.stop()}},c)})),u.apply(this,arguments)}function j(c){return T.apply(this,arguments)}function T(){return T=_()(s()().mark(function c(i){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-delete",{method:"POST",data:i}));case 1:case"end":return l.stop()}},c)})),T.apply(this,arguments)}function v(c){return g.apply(this,arguments)}function g(){return g=_()(s()().mark(function c(i){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/export",{method:"POST",data:i,responseType:"blob"}));case 1:case"end":return l.stop()}},c)})),g.apply(this,arguments)}},18148:function(L,b,n){n.d(b,{$q:function(){return v},Fj:function(){return S},KG:function(){return O},T8:function(){return j},Xn:function(){return I},ao:function(){return c},c5:function(){return A},c7:function(){return B}});var R=n(15009),s=n.n(R),D=n(99289),_=n.n(D),a=n(54006);function O(o){return f.apply(this,arguments)}function f(){return f=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/image/get-list",{method:"POST",data:E}));case 1:case"end":return r.stop()}},o)})),f.apply(this,arguments)}function C(o){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function o(E){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,request("/api/app/log/image-build",{method:"POST",data:E});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)})),P.apply(this,arguments)}function I(o){return u.apply(this,arguments)}function u(){return u=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/image/get-list-build",{method:"POST",data:E}));case 1:case"end":return r.stop()}},o)})),u.apply(this,arguments)}function j(o){return T.apply(this,arguments)}function T(){return T=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/image/get-build-task",{method:"POST",data:E});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)})),T.apply(this,arguments)}function v(o){return g.apply(this,arguments)}function g(){return g=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/image/delete-build-task",{method:"POST",data:E});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)})),g.apply(this,arguments)}function c(o){return i.apply(this,arguments)}function i(){return i=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/image/image-delete",{method:"POST",data:E});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)})),i.apply(this,arguments)}function B(){return l.apply(this,arguments)}function l(){return l=_()(s()().mark(function o(){return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,a.request)("/api/app/image/image-prune",{method:"POST"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},o)})),l.apply(this,arguments)}function A(){return y.apply(this,arguments)}function y(){return y=_()(s()().mark(function o(){return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,a.request)("/api/app/image/build-prune",{method:"POST"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},o)})),y.apply(this,arguments)}function S(o){return h.apply(this,arguments)}function h(){return h=_()(s()().mark(function o(E){return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/image/update-title",{method:"POST",data:E});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},o)})),h.apply(this,arguments)}},75870:function(L,b,n){n.d(b,{Ot:function(){return O},ZH:function(){return C},ix:function(){return I},t1:function(){return j}});var R=n(15009),s=n.n(R),D=n(99289),_=n.n(D),a=n(54006);function O(v){return f.apply(this,arguments)}function f(){return f=_()(s()().mark(function v(g){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,a.request)("/api/common/registry/get-list",{method:"POST",data:g}));case 1:case"end":return i.stop()}},v)})),f.apply(this,arguments)}function C(v){return P.apply(this,arguments)}function P(){return P=_()(s()().mark(function v(g){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,a.request)("/api/common/registry/create",{method:"POST",data:g}));case 1:case"end":return i.stop()}},v)})),P.apply(this,arguments)}function I(v){return u.apply(this,arguments)}function u(){return u=_()(s()().mark(function v(g){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,a.request)("/api/common/registry/delete",{method:"POST",data:g}));case 1:case"end":return i.stop()}},v)})),u.apply(this,arguments)}function j(v){return T.apply(this,arguments)}function T(){return T=_()(s()().mark(function v(g){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,a.request)("/api/common/registry/get-detail",{method:"POST",data:g}));case 1:case"end":return i.stop()}},v)})),T.apply(this,arguments)}},5251:function(L,b,n){n.d(b,{FI:function(){return s},ZM:function(){return D}});function R(_){return _.trim()}function s(_){var a="";_<.1*1024?a=_.toFixed(2)+"B":_<.1*1024*1024?a=(_/1024).toFixed(2)+"KB":_<1*1024*1024*1024?a=(_/(1024*1024)).toFixed(2)+"MB":a=(_/(1024*1024*1024)).toFixed(2)+"GB";var O=a+"",f=O.indexOf("."),C=O.substr(f+1,2);return C=="00"?O.substring(0,f)+O.substr(f+3,2):a}function D(_){if(_){var a=new Date(_),O=a.getFullYear()+"-",f=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",C=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",P=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",I=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",u=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return O+f+C+P+I+u}}}}]);
