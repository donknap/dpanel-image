"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8022],{95556:function(U,p,e){var y=e(87462),a=e(62435),j=e(3803),f=e(84089),_=function(T,h){return a.createElement(f.Z,(0,y.Z)({},T,{ref:h,icon:j.Z}))},D=a.forwardRef(_);p.Z=D},80821:function(U,p,e){e.d(p,{Z:function(){return W}});var y=e(5574),a=e.n(y),j=e(93246),f=e(54006),_=e(31418),D=e(86738),g=e(14726),T=e(62435),h=e(86074);function W(t){var A=(0,T.useState)(!1),E=a()(A,2),x=E[0],C=E[1],s=_.Z.useApp(),l=(0,f.useIntl)(),R=function(){C(!0),t.action().then(function(M){if(C(!1),typeof t.onSuccess=="function"&&t.onSuccess(M),t.messageSuccess){var B="";t.messageSuccess.indexOf(".")>-1?B=l.formatMessage({id:t.messageSuccess}):B=t.messageSuccess,t.asynced?(0,j.Rk)(s,B):(0,j.$h)(s,B)}}).catch(function(M){C(!1),typeof t.onError=="function"&&t.onError(M)})};return t.confirm?(0,h.jsx)(D.Z,{style:{width:500},title:"\u63D0\u793A",description:t.confirm,onConfirm:R,okText:"Yes",cancelText:"No",children:(0,h.jsx)(g.ZP,{disabled:t.disabled,icon:t.icon,loading:x,danger:t.danger,type:t.type,children:t.children})}):(0,h.jsx)(g.ZP,{disabled:t.disabled,icon:t.icon,loading:x,onClick:R,danger:t.danger,type:t.type,children:t.children})}},96781:function(U,p,e){var y=e(62435),a=(0,y.createContext)({});p.Z=a},26060:function(U,p,e){e.r(p),e.d(p,{default:function(){return Q}});var y=e(15009),a=e.n(y),j=e(99289),f=e.n(j),_=e(80821),D=e(24910),g=e(43425),T=e(57132),h=e(95556),W=e(6110),t=e(12010),A=e(54006),E=e(78957),x=e(96074),C=e(83062),s=e(75891),l=e(62435),R=e(96781),n=e(5574),M=e.n(n),B=e(184),Y=e(5966),w=e(62370),z=e(20713),G=e(14726),V=e(91845),r=e(86074),H=(0,l.forwardRef)(function(K,b){var $=(0,l.useState)(0),F=M()($,2),O=F[0],v=F[1],P=(0,l.useState)(!1),i=M()(P,2),c=i[0],S=i[1],u=(0,l.useRef)(),X=(0,l.useContext)(R.Z),N=X.listTableRef;return(0,l.useImperativeHandle)(b,function(){return{showEdit:function(o){var m,d;(m=u.current)===null||m===void 0||m.resetFields(),(d=u.current)===null||d===void 0||d.setFieldsValue({siteTitle:o.title,yaml:o.yaml,siteName:o.name}),v(o.id),S(!0)},showCopy:function(o){var m,d;(m=u.current)===null||m===void 0||m.resetFields(),(d=u.current)===null||d===void 0||d.setFieldsValue({yaml:o.yaml}),S(!0)}}}),(0,r.jsxs)(B.a,{open:c,onOpenChange:function(o){S(o)},drawerProps:{forceRender:!0},formRef:u,title:"\u521B\u5EFACompose\u914D\u7F6E",trigger:(0,r.jsx)(G.ZP,{type:"primary",onClick:function(){var o;v(0),(o=u.current)===null||o===void 0||o.resetFields()},children:"\u521B\u5EFA\u7AD9\u70B9"}),onFinish:function(){var I=f()(a()().mark(function o(m){var d,L,k;return a()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,D.im)({id:O,title:m.siteTitle,yaml:m.yaml,name:m.siteName});case 2:return k=Z.sent,!((d=N.current)===null||d===void 0)&&d.reloadAndRest&&((L=N.current)===null||L===void 0||L.reloadAndRest()),Z.abrupt("return",!0);case 5:case"end":return Z.stop()}},o)}));return function(o){return I.apply(this,arguments)}}(),children:[(0,r.jsx)(Y.Z,{label:"\u7AD9\u70B9\u540D\u79F0",name:"siteTitle",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(o){var m="";if(o.target.value&&!O){var d,L=(0,V.N9)(o.target.value.trim(),{toneType:"none",type:"array"});m=L.join(""),(d=u.current)===null||d===void 0||d.setFieldValue("siteName",m)}}}}),(0,r.jsx)(Y.Z,{label:"\u7AD9\u70B9\u6807\u8BC6",name:"siteName",required:!0,rules:[{required:!0}],disabled:O>0,placeholder:"\u6807\u8BC6Compose\u521B\u5EFA\u7684\u5BB9\u5668\uFF0C\u53EA\u5141\u8BB8\u4E3A\u82F1\u6587\u6216\u662F\u6570\u5B57"}),(0,r.jsx)(w.Z,{label:"Docker Compose Yaml",name:"yaml",children:(0,r.jsx)(z.ZP,{theme:"dark",height:"550px"})})]},"create")}),J=H;function Q(){var K=(0,l.useContext)(R.Z),b=K.createYamlFormRef,$=K.listTableRef;return(0,r.jsx)(W._z,{header:{extra:[(0,r.jsx)(J,{ref:b},"createYamlButton")]},children:(0,r.jsx)(t.Z,{request:function(){var F=f()(a()().mark(function O(v){var P,i,c;return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,D.pm)({title:v.title,pageSize:(P=v.pageSize)!==null&&P!==void 0?P:10,page:(i=v.current)!==null&&i!==void 0?i:1});case 2:return c=u.sent,u.abrupt("return",{data:c.data.list,success:!0,total:c.data.total});case 4:case"end":return u.stop()}},O)}));return function(O){return F.apply(this,arguments)}}(),rowKey:"id",columns:[{title:"\u6807\u8BC6",dataIndex:"name"},{title:"\u540D\u79F0",dataIndex:"title"},{title:"\u64CD\u4F5C",width:100,valueType:"option",key:"option",render:function(O,v,P,i,c){return(0,r.jsxs)(E.Z,{split:(0,r.jsx)(x.Z,{type:"vertical"}),children:[(0,r.jsx)(A.Link,{to:"#",onClick:function(){var u;(u=b.current)===null||u===void 0||u.showEdit(v)},children:(0,r.jsx)(C.Z,{title:"\u7BA1\u7406",children:(0,r.jsx)(g.Z,{})})},"1"),(0,r.jsx)(A.Link,{to:"#",onClick:function(){var u;(u=b.current)===null||u===void 0||u.showCopy(v)},children:(0,r.jsx)(C.Z,{title:"\u590D\u5236",children:(0,r.jsx)(T.Z,{})})},"2"),(0,r.jsx)(A.Link,{to:"/compose/deploy/"+v.id,children:(0,r.jsx)(h.Z,{})},"3")]})}}],pagination:{pageSize:10},search:{collapsed:!1},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:$,tableAlertOptionRender:function(O){var v=O.selectedRowKeys;return(0,r.jsx)(E.Z,{size:16,children:(0,r.jsx)(_.Z,{danger:!0,type:"primary",action:function(){return deleteImage({md5:v,force:deleteOption.force})},onSuccess:function(){var i,c;return!((i=tableRef.current)===null||i===void 0)&&i.reloadAndRest&&((c=tableRef.current)===null||c===void 0||c.reloadAndRest()),!0},onError:function(){var i,c;return!((i=tableRef.current)===null||i===void 0)&&i.reset&&((c=tableRef.current)===null||c===void 0||c.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",confirm:(0,r.jsx)(E.Z,{style:{width:280},direction:"vertical",children:(0,r.jsx)(s.Z.Text,{children:"\u5220\u9664\u955C\u50CF\u540E\u65E0\u6CD5\u6062\u590D,\u786E\u8BA4\u5417\uFF1F"})}),children:"\u6279\u91CF\u5220\u9664"})})}})})}},24910:function(U,p,e){e.d(p,{Am:function(){return W},YZ:function(){return x},cO:function(){return A},im:function(){return D},pm:function(){return T}});var y=e(15009),a=e.n(y),j=e(99289),f=e.n(j),_=e(54006);function D(s){return g.apply(this,arguments)}function g(){return g=f()(a()().mark(function s(l){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.request)("/api/app/compose/create",{method:"POST",data:l}));case 1:case"end":return n.stop()}},s)})),g.apply(this,arguments)}function T(s){return h.apply(this,arguments)}function h(){return h=f()(a()().mark(function s(l){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.request)("/api/app/compose/get-list",{method:"POST",data:l}));case 1:case"end":return n.stop()}},s)})),h.apply(this,arguments)}function W(s){return t.apply(this,arguments)}function t(){return t=f()(a()().mark(function s(l){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.request)("/api/app/compose/deploy",{method:"POST",data:l}));case 1:case"end":return n.stop()}},s)})),t.apply(this,arguments)}function A(s){return E.apply(this,arguments)}function E(){return E=f()(a()().mark(function s(l){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.request)("/api/app/compose/uninstall",{method:"POST",data:l}));case 1:case"end":return n.stop()}},s)})),E.apply(this,arguments)}function x(s){return C.apply(this,arguments)}function C(){return C=f()(a()().mark(function s(l){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,_.request)("/api/app/compose/get-detail",{method:"POST",data:l}));case 1:case"end":return n.stop()}},s)})),C.apply(this,arguments)}}}]);
