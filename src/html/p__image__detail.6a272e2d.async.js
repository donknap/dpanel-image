"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3357],{80821:function(U,I,n){n.d(I,{Z:function(){return h}});var y=n(5574),s=n.n(y),P=n(93246),i=n(54006),r=n(31418),O=n(86738),m=n(14726),C=n(83062),M=n(62435),j=n(86074);function h(_){var E=(0,M.useState)(!1),p=s()(E,2),D=p[0],d=p[1],u=r.Z.useApp(),B=(0,i.useIntl)(),l=function(){d(!0),_.action().then(function(R){if(d(!1),typeof _.onSuccess=="function"&&_.onSuccess(R),_.messageSuccess){var g="";_.messageSuccess.indexOf(".")>-1?g=B.formatMessage({id:_.messageSuccess}):g=_.messageSuccess,_.asynced?(0,P.Rk)(u,g):(0,P.$h)(u,g)}}).catch(function(R){d(!1),typeof _.onError=="function"&&_.onError(R)})};return _.confirm?(0,j.jsx)(O.Z,{style:{width:500},title:"\u63D0\u793A",description:_.confirm,onConfirm:l,okText:"Yes",cancelText:"No",children:(0,j.jsx)(m.ZP,{disabled:_.disabled,icon:_.icon,loading:D,danger:_.danger,type:_.type,children:_.children})}):(0,j.jsx)(C.Z,{title:_.tips,children:(0,j.jsx)(m.ZP,{disabled:_.disabled,icon:_.icon,loading:D,onClick:l,danger:_.danger,type:_.type,children:_.children})})}},96042:function(U,I,n){n.d(I,{Z:function(){return m}});var y=n(5574),s=n.n(y),P=n(75870),i=n(34041),r=n(62435),O=n(86074);function m(C){var M=(0,r.useState)([]),j=s()(M,2),h=j[0],_=j[1];return(0,r.useEffect)(function(){(0,P.Ot)().then(function(E){E&&_(E.data.list)})},[]),(0,O.jsx)(i.Z,{onChange:function(p){C.onChange&&C.onChange(h[p])},placeholder:"\u9009\u62E9\u955C\u50CF\u4ED3\u5E93\uFF0C\u672C\u5730\u4F7F\u7528\u7559\u7A7A\u5373\u53EF",options:h.map(function(E,p){return{value:p,label:E.title+"("+E.serverAddress+")"}})})}},70977:function(U,I,n){n.r(I),n.d(I,{default:function(){return ee}});var y=n(5574),s=n.n(y),P=n(3393),i=n(43425),r=n(58638),O=n(1912),m=n(87784),C=n(40666),M=n(77171),j=n(48689),h=n(45742),_=n(38345),E=n(7529),p=n(97269),D=n(62370),d=n(5966),u=n(54006),B=n(31418),l=n(78957),W=n(66309),R=n(75891),g=n(26412),K=n(63490),A=n(62435),S=n(93246),o=n(80821),T=n(5251),f=n(93162),a=n.n(f),Q=n(18148),k=n(75870),q=n(96042),t=n(86074);function ee(){var F,ne=(0,A.useState)(),w=s()(ne,2),e=w[0],te=w[1],Y=(0,u.useParams)(),z=B.Z.useApp(),H=(0,u.useIntl)(),N=(0,A.useRef)(),re=(0,A.useState)(0),X=s()(re,2),Z=X[0],$=X[1],ae=(0,u.useNavigate)(),se=(0,A.useState)([]),V=s()(se,2),ue=V[0],ie=V[1];return(0,A.useEffect)(function(){Y.id&&(0,P.YU)({md5:Y.id}).then(function(c){te(c.data)}),(0,k.Ot)().then(function(c){c&&ie(c.data.list)})},[Z]),(0,t.jsx)("div",{children:(0,t.jsxs)(_.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsx)(_.Z,{title:(0,t.jsx)(i.Z,{}),subTitle:"\u5E38\u7528\u64CD\u4F5C",headerBordered:!0,bordered:!0,children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(o.Z,{icon:(0,t.jsx)(r.Z,{}),action:function(){var v;return(0,P.Rb)({md5:(v=e==null?void 0:e.info.Id)!==null&&v!==void 0?v:""})},onSuccess:function(v){var b=new Blob([v],{type:"application/tar"});(0,f.saveAs)(b,(e==null?void 0:e.info.Id)+".tar")},messageSuccess:"\u5BFC\u51FA\u6210\u529F",children:"\u5BFC\u51FA"}),(0,t.jsxs)(o.Z,{action:function(){var v;return(0,P.Gb)({tag:(v=e==null?void 0:e.info.RepoTags[0])!==null&&v!==void 0?v:"",type:"push",asLatest:!0})},type:"primary",messageSuccess:"image.pushed",onSuccess:function(){$(Z+1)},children:[(0,t.jsx)(O.Z,{})," Push As Latest"]}),(0,t.jsx)(o.Z,{icon:(0,t.jsx)(m.Z,{}),danger:!0,type:"primary",action:function(){var v;return(0,Q.ao)({md5:[(v=e==null?void 0:e.info.Id)!==null&&v!==void 0?v:""],force:!0})},onSuccess:function(){ae("/image/list")},confirm:"\u662F\u5426\u8981\u505C\u6B62\u8BE5\u955C\u50CF\u4E0B\u7684\u5BB9\u5668\u5E76\u5F3A\u5236\u5220\u9664\uFF1F",messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u5F3A\u5236\u5220\u9664"})]})}),(0,t.jsx)(_.Z,{bordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"Tag \u5217\u8868",children:(0,t.jsx)(E.Rs,{grid:{gutter:80,column:2},headerTitle:!1,metas:{content:{render:function(v,b,x){return(0,t.jsx)(W.Z,{color:"blue",children:(0,t.jsx)(R.Z.Text,{copyable:!0,children:b})},x)}},title:{render:function(v,b,x){return(0,t.jsxs)(l.Z,{children:[(0,t.jsxs)(o.Z,{action:function(){return(0,P.Gb)({tag:b,type:"push"})},messageSuccess:"image.pushed",children:[(0,t.jsx)(O.Z,{})," Push"]}),(0,t.jsxs)(o.Z,{action:function(){return(0,P.Gb)({tag:b,type:"pull"})},messageSuccess:"image.pulling",asynced:!0,children:[(0,t.jsx)(M.Z,{})," Pull"]}),(0,t.jsx)(o.Z,{action:function(){return(0,P.Pn)({tag:b})},onSuccess:function(J){return $(Z+1),!0},messageSuccess:"tag.delete",confirm:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6807\u7B7E",children:(0,t.jsx)(j.Z,{})})]},x)}}},dataSource:e==null?void 0:e.info.RepoTags})}),(0,t.jsx)(_.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(C.Z,{}),subTitle:"\u65B0\u589E Tag",children:(0,t.jsxs)(p.A,{formRef:N,onFinish:function(v){return new Promise(function(b,x){var L;return(!e||!(e!=null&&e.info))&&((0,S.YZ)(z,H.formatMessage({id:"image.notFound"})),x(!0)),(0,P._U)({md5:(L=e==null?void 0:e.info.Id)!==null&&L!==void 0?L:"",tag:(v.imageRespo?ue[v.imageRespo].serverAddress+"/":"")+v.imageTag}).then(function(J){var G;(0,S.$h)(z,H.formatMessage({id:"tag.add"}),J.data.tag),$(Z+1),(G=N.current)===null||G===void 0||G.resetFields(),b(!0)})})},children:[(0,t.jsx)(D.Z,{label:"\u955C\u50CF\u4ED3\u5E93",name:"imageRespo",tooltip:(0,t.jsxs)(t.Fragment,{children:["\u63A8\u9001\u524D\u8BF7\u4FDD\u8BC1\u4ED3\u5E93\u4E2D\u6709\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4, \u5982\u6CA1\u6709\u8BF7\u5148 ",(0,t.jsx)("a",{href:"",target:"_blank",children:"\u6DFB\u52A0\u4ED3\u5E93"})]}),children:(0,t.jsx)(q.Z,{})}),(0,t.jsx)(d.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],required:!0,placeholder:"\u53EA\u80FD\u4F7F\u7528\u5C0F\u5199\u82F1\u6587\u5B57\u7B26\u3001\u6570\u5B57\u3001_\u3001-\u3001",label:"\u955C\u50CF\u540D\u79F0",name:"imageTag",tooltip:"\u4F8B\u5982: name:tag\u3001namespace/name:tag\u3001registry/namespace/name:tag"})]})}),(0,t.jsx)(_.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(h.Z,{}),subTitle:"\u955C\u50CF\u8BE6\u60C5",children:(0,t.jsxs)(g.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(g.Z.Item,{label:"ID",children:e==null?void 0:e.info.Id}),(0,t.jsx)(g.Z.Item,{label:"Parent",children:e==null?void 0:e.info.Parent}),(0,t.jsx)(g.Z.Item,{label:"Size",children:(0,T.FI)((F=e==null?void 0:e.info.Size)!==null&&F!==void 0?F:0)}),(0,t.jsx)(g.Z.Item,{label:"Created",children:e==null?void 0:e.info.Created}),(0,t.jsxs)(g.Z.Item,{label:"Build",children:["Docker ",e==null?void 0:e.info.DockerVersion," ",e==null?void 0:e.info.Os," ",e==null?void 0:e.info.Architecture]}),(0,t.jsx)(g.Z.Item,{label:"Labels",children:(0,t.jsx)(g.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Labels)&&Object.keys(e==null?void 0:e.info.Config.Labels).map(function(c){return(0,t.jsx)(g.Z.Item,{label:c,children:(0,t.jsx)(R.Z.Text,{style:{width:"400px"},ellipsis:{tooltip:e==null?void 0:e.info.Config.Labels[c]},children:e==null?void 0:e.info.Config.Labels[c]})},c)})})})]})}),(0,t.jsx)(_.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(h.Z,{}),subTitle:"Dockerfile \u8BE6\u60C5",children:(0,t.jsxs)(g.Z,{labelStyle:{width:"200px"},column:1,bordered:!0,children:[(0,t.jsx)(g.Z.Item,{label:"CMD",children:e==null?void 0:e.info.Config.Cmd}),(0,t.jsx)(g.Z.Item,{label:"ENTRYPOINT",children:e==null?void 0:e.info.Config.Entrypoint}),(0,t.jsx)(g.Z.Item,{label:"EXPOSE",children:(e==null?void 0:e.info.Config.ExposedPorts)&&Object.keys(e==null?void 0:e.info.Config.ExposedPorts).map(function(c){return(0,t.jsx)(W.Z,{color:"gray",children:c},c)})}),(0,t.jsx)(g.Z.Item,{label:"VOLUME",children:(e==null?void 0:e.info.Config.Volumes)&&Object.keys(e==null?void 0:e.info.Config.Volumes).map(function(c){return(0,t.jsx)(W.Z,{color:"gray",children:c},c)})}),(0,t.jsx)(g.Z.Item,{label:"Env",children:(0,t.jsx)(g.Z,{column:1,bordered:!0,children:(e==null?void 0:e.info.Config.Env)&&(e==null?void 0:e.info.Config.Env.map(function(c,v){var b=c.split("=");return(0,t.jsx)(g.Z.Item,{label:b[0],children:b[1]},v)}))})})]})}),(0,t.jsxs)(_.Z,{bordered:!0,headerBordered:!0,title:(0,t.jsx)(h.Z,{}),subTitle:"Layers",children:[(0,t.jsx)(K.Z,{rowKey:"CreatedBy",dataSource:e==null?void 0:e.layer.reverse(),columns:[{title:"Layer",dataIndex:"CreatedBy",key:"CreatedBy"}]}),";"]})]})})}},3393:function(U,I,n){n.d(I,{Gb:function(){return C},Pn:function(){return _},Rb:function(){return p},YU:function(){return O},_U:function(){return j}});var y=n(15009),s=n.n(y),P=n(99289),i=n.n(P),r=n(54006);function O(d){return m.apply(this,arguments)}function m(){return m=i()(s()().mark(function d(u){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/get-detail",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),m.apply(this,arguments)}function C(d){return M.apply(this,arguments)}function M(){return M=i()(s()().mark(function d(u){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-remote",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),M.apply(this,arguments)}function j(d){return h.apply(this,arguments)}function h(){return h=i()(s()().mark(function d(u){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-add",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),h.apply(this,arguments)}function _(d){return E.apply(this,arguments)}function E(){return E=i()(s()().mark(function d(u){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/tag-delete",{method:"POST",data:u}));case 1:case"end":return l.stop()}},d)})),E.apply(this,arguments)}function p(d){return D.apply(this,arguments)}function D(){return D=i()(s()().mark(function d(u){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,r.request)("/api/app/image/export",{method:"POST",data:u,responseType:"blob"}));case 1:case"end":return l.stop()}},d)})),D.apply(this,arguments)}},18148:function(U,I,n){n.d(I,{$q:function(){return p},Fj:function(){return g},KG:function(){return O},KX:function(){return A},T8:function(){return _},Xn:function(){return j},ao:function(){return d},c5:function(){return W},c7:function(){return B}});var y=n(15009),s=n.n(y),P=n(99289),i=n.n(P),r=n(54006);function O(o){return m.apply(this,arguments)}function m(){return m=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,r.request)("/api/app/image/get-list",{method:"POST",data:T}));case 1:case"end":return a.stop()}},o)})),m.apply(this,arguments)}function C(o){return M.apply(this,arguments)}function M(){return M=_asyncToGenerator(_regeneratorRuntime().mark(function o(T){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,request("/api/app/log/image-build",{method:"POST",data:T});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),M.apply(this,arguments)}function j(o){return h.apply(this,arguments)}function h(){return h=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,r.request)("/api/app/image/get-list-build",{method:"POST",data:T}));case 1:case"end":return a.stop()}},o)})),h.apply(this,arguments)}function _(o){return E.apply(this,arguments)}function E(){return E=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,r.request)("/api/app/image/get-build-task",{method:"POST",data:T});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),E.apply(this,arguments)}function p(o){return D.apply(this,arguments)}function D(){return D=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,r.request)("/api/app/image/delete-build-task",{method:"POST",data:T});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),D.apply(this,arguments)}function d(o){return u.apply(this,arguments)}function u(){return u=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,r.request)("/api/app/image/image-delete",{method:"POST",data:T});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),u.apply(this,arguments)}function B(){return l.apply(this,arguments)}function l(){return l=i()(s()().mark(function o(){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,r.request)("/api/app/image/image-prune",{method:"POST"});case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},o)})),l.apply(this,arguments)}function W(){return R.apply(this,arguments)}function R(){return R=i()(s()().mark(function o(){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,r.request)("/api/app/image/build-prune",{method:"POST"});case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},o)})),R.apply(this,arguments)}function g(o){return K.apply(this,arguments)}function K(){return K=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,r.request)("/api/app/image/update-title",{method:"POST",data:T});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},o)})),K.apply(this,arguments)}function A(o){return S.apply(this,arguments)}function S(){return S=i()(s()().mark(function o(T){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,r.request)("/api/app/image/tag-sync",{method:"POST",data:T}));case 1:case"end":return a.stop()}},o)})),S.apply(this,arguments)}},75870:function(U,I,n){n.d(I,{Ot:function(){return O},ZH:function(){return C},ix:function(){return j},t1:function(){return _}});var y=n(15009),s=n.n(y),P=n(99289),i=n.n(P),r=n(54006);function O(p){return m.apply(this,arguments)}function m(){return m=i()(s()().mark(function p(D){return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/get-list",{method:"POST",data:D}));case 1:case"end":return u.stop()}},p)})),m.apply(this,arguments)}function C(p){return M.apply(this,arguments)}function M(){return M=i()(s()().mark(function p(D){return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/create",{method:"POST",data:D}));case 1:case"end":return u.stop()}},p)})),M.apply(this,arguments)}function j(p){return h.apply(this,arguments)}function h(){return h=i()(s()().mark(function p(D){return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/delete",{method:"POST",data:D}));case 1:case"end":return u.stop()}},p)})),h.apply(this,arguments)}function _(p){return E.apply(this,arguments)}function E(){return E=i()(s()().mark(function p(D){return s()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,r.request)("/api/common/registry/get-detail",{method:"POST",data:D}));case 1:case"end":return u.stop()}},p)})),E.apply(this,arguments)}},5251:function(U,I,n){n.d(I,{FI:function(){return s},ZM:function(){return P}});function y(i){return i.trim()}function s(i){var r="";i<.1*1024?r=i.toFixed(2)+"B":i<.1*1024*1024?r=(i/1024).toFixed(2)+"KB":i<1*1024*1024*1024?r=(i/(1024*1024)).toFixed(2)+"MB":r=(i/(1024*1024*1024)).toFixed(2)+"GB";var O=r+"",m=O.indexOf("."),C=O.substr(m+1,2);return C=="00"?O.substring(0,m)+O.substr(m+3,2):r}function P(i){if(i){var r=new Date(i),O=r.getFullYear()+"-",m=(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"-",C=(r.getDate()<10?"0"+r.getDate():r.getDate())+" ",M=(r.getHours()<10?"0"+r.getHours():r.getHours())+":",j=(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())+":",h=r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds();return O+m+C+M+j+h}}}}]);
