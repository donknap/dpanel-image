"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7745],{16664:function(L,_,e){e.d(_,{Z:function(){return y}});var M=e(87462),d=e(62435),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},s=j,t=e(84089),c=function(f,i){return d.createElement(t.Z,(0,M.Z)({},f,{ref:i,icon:s}))},p=d.forwardRef(c),y=p},51400:function(L,_,e){e.r(_),e.d(_,{default:function(){return q}});var M=e(15009),d=e.n(M),j=e(99289),s=e.n(j),t=e(5574),c=e.n(t),p=e(19632),y=e.n(p),F=e(97857),f=e.n(F),i=e(62435),z=e(48031),v=function(){return v=Object.assign||function(o){for(var m,b=1,x=arguments.length;b<x;b++){m=arguments[b];for(var r in m)Object.prototype.hasOwnProperty.call(m,r)&&(o[r]=m[r])}return o},v.apply(this,arguments)},H=function(o){return i.createElement(z.P,v({},o,{chartType:"Area"}))},G=H,n=e(86074);function w(o){var m={theme:"academy",xField:o.xField,yField:o.yField,height:200,axis:{y:{line:!0,grid:{visable:!0}},x:{line:!0,grid:{visable:!0}}},data:o.data};return o.yDomain&&(m.scale={y:{domain:o.yDomain}}),o.colorField&&(m.colorField=o.colorField),(0,n.jsx)(G,f()({},m))}function Y(o){var m=o.reqFunction,b=o.interval,x=o.maxPolling,r=o.pollingStatus,C=(0,i.useRef)(null),k=0,U=function Z(){C.current=window.setTimeout(s()(d()().mark(function K(){var A;return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(k++>=x)){l.next=3;break}return P(),l.abrupt("return");case 3:return l.prev=3,l.next=6,m();case 6:A=l.sent,Z(),l.next=14;break;case 10:l.prev=10,l.t0=l.catch(3),P(),console.error("\u8F6E\u8BE2\u53D1\u751F\u9519\u8BEF\uFF1A",l.t0);case 14:case"end":return l.stop()}},K,null,[[3,10]])})),b)},P=function(){console.log("end polling"),C.current&&window.clearTimeout(C.current)};return(0,i.useEffect)(function(){return console.log((r?"start":"waiting")+" polling, max "+x),r&&U(),P},[b,x,r]),{endPolling:P}}var N=Y,W=e(84410),D=e(5251),R=e(12122),J=e(16664),O=e(38345),Q=e(54006),V=e(63490),I=new Date().toLocaleTimeString(),X={total:0,memory:[{date:I,usage:0,source:{usage:0,limit:0}}],cpu:[{date:I,usage:0}],network:[{usage:0,type:"rx",date:I,source:{usage:0}},{usage:0,type:"tx",date:I,source:{usage:0}}],io:[{usage:0,type:"read",date:I,source:{usage:0}},{usage:0,type:"write",date:I,source:{usage:0}}]};function q(){var o=function(h,a){switch(a.type){case"update":var g=new Date(a.payload.read).toLocaleTimeString(),u=a.payload.cpu_stats.cpu_usage.total_usage-a.payload.precpu_stats.cpu_usage.total_usage,$=a.payload.cpu_stats.system_cpu_usage-a.payload.precpu_stats.system_cpu_usage,T=0,ee=0;return a.payload.blkio_stats.io_service_bytes_recursive||(a.payload.blkio_stats.io_service_bytes_recursive=[{value:0,op:"read",major:0,minor:0},{value:0,op:"write",major:0,minor:0}]),a.payload.blkio_stats.io_service_bytes_recursive.map(function(B){B.op=="read"&&(T=B.value),B.op=="write"&&(ee=B.value)}),{total:h.total+1,memory:[].concat(y()(h.memory),[{date:g,usage:Math.round(a.payload.memory_stats.usage/1024/1024),source:{usage:a.payload.memory_stats.usage,limit:a.payload.memory_stats.limit}}]),cpu:[].concat(y()(h.cpu),[{date:g,usage:u/$*a.payload.cpu_stats.online_cpus*100}]),io:[].concat(y()(h.io),[{date:g,usage:parseFloat((a.payload.blkio_stats.io_service_bytes_recursive[0].value/1024/1024).toFixed(2)),type:a.payload.blkio_stats.io_service_bytes_recursive[0].op,source:{usage:a.payload.blkio_stats.io_service_bytes_recursive[0].value}},{date:g,usage:parseFloat((a.payload.blkio_stats.io_service_bytes_recursive[1].value/1024/1024).toFixed(2)),type:a.payload.blkio_stats.io_service_bytes_recursive[1].op,source:{usage:a.payload.blkio_stats.io_service_bytes_recursive[1].value}}]),network:[].concat(y()(h.network),[{date:g,usage:parseFloat((a.payload.networks.eth0.rx_bytes/1024).toFixed(2)),type:"rx",source:{usage:a.payload.networks.eth0.rx_bytes}},{date:g,usage:parseFloat((a.payload.networks.eth0.tx_bytes/1024).toFixed(2)),type:"tx",source:{usage:a.payload.networks.eth0.tx_bytes}}])}}},m=(0,Q.useParams)(),b=(0,i.useReducer)(o,X),x=c()(b,2),r=x[0],C=x[1],k=(0,i.useState)([]),U=c()(k,2),P=U[0],Z=U[1],K=(0,i.useState)(),A=c()(K,2),S=A[0],l=A[1],te=N({reqFunction:function(){var E=s()(d()().mark(function a(){var g,u;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,W.i)({id:(g=m.id)!==null&&g!==void 0?g:""});case 2:u=T.sent,C({type:"update",payload:u});case 4:case"end":return T.stop()}},a)}));function h(){return E.apply(this,arguments)}return h}(),interval:3e3,maxPolling:999,pollingStatus:P.length!=0});return(0,i.useEffect)(function(){var E,h;(0,W.i)({id:(E=m.id)!==null&&E!==void 0?E:""}).then(function(a){return Z([0,Math.round(a.memory_stats.limit/1024/1024)]),!0}),(0,W.a)({id:(h=m.id)!==null&&h!==void 0?h:""}).then(function(a){var g={columns:[],data:[]};a.data.list.Titles.map(function(u){g.columns.push({title:u,label:u,dataIndex:u})}),a.data.list.Processes.map(function(u,$){g.data.push({UID:u[0],PID:u[1],PPID:u[2],C:u[3],STIME:u[4],TTY:u[5],TIME:u[6],CMD:u[7]})}),l(g)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(O.Z,{direction:"row",wrap:!0,gutter:[20,20],children:[(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Memory usage: ".concat((0,D.FI)(r.memory[r.memory.length-1].source.usage)," / ").concat((0,D.FI)(r.memory[r.memory.length-1].source.limit)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(w,{yField:"usage",xField:"date",data:r.memory,yDomain:P})}),(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Cpu usage: ".concat(r.cpu[r.cpu.length-1].usage.toFixed(2),"%"),headerBordered:!0,bordered:!0,children:(0,n.jsx)(w,{yField:"usage",xField:"date",data:r.cpu})}),(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"I/O: ".concat((0,D.FI)(r.io[r.io.length-1].source.usage)," / ").concat((0,D.FI)(r.io[r.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(w,{yField:"usage",xField:"date",colorField:"type",data:r.io})}),(0,n.jsx)(O.Z,{colSpan:12,title:(0,n.jsx)(R.Z,{}),subTitle:"Network: ".concat((0,D.FI)(r.network[r.io.length-1].source.usage)," / ").concat((0,D.FI)(r.network[r.io.length-2].source.usage)),headerBordered:!0,bordered:!0,children:(0,n.jsx)(w,{yField:"usage",xField:"date",colorField:"type",data:r.network})})]}),(0,n.jsx)(O.Z,{title:(0,n.jsx)(J.Z,{}),subTitle:"Progress",children:(0,n.jsx)(V.Z,{rowKey:"PID",columns:S==null?void 0:S.columns,dataSource:S==null?void 0:S.data,pagination:{pageSize:10}})})]})}},84410:function(L,_,e){e.d(_,{a:function(){return y},i:function(){return c}});var M=e(15009),d=e.n(M),j=e(99289),s=e.n(j),t=e(54006);function c(f){return p.apply(this,arguments)}function p(){return p=s()(d()().mark(function f(i){return d()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,t.request)("/api/app/container/get-stat-info",{method:"POST",data:i}));case 1:case"end":return v.stop()}},f)})),p.apply(this,arguments)}function y(f){return F.apply(this,arguments)}function F(){return F=s()(d()().mark(function f(i){return d()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,t.request)("/api/app/container/get-process-info",{method:"POST",data:i}));case 1:case"end":return v.stop()}},f)})),F.apply(this,arguments)}},5251:function(L,_,e){e.d(_,{FI:function(){return d},ZM:function(){return j}});function M(s){return s.trim()}function d(s){var t="";s<.1*1024?t=s.toFixed(2)+"B":s<.1*1024*1024?t=(s/1024).toFixed(2)+"KB":s<1*1024*1024*1024?t=(s/(1024*1024)).toFixed(2)+"MB":t=(s/(1024*1024*1024)).toFixed(2)+"GB";var c=t+"",p=c.indexOf("."),y=c.substr(p+1,2);return y=="00"?c.substring(0,p)+c.substr(p+3,2):t}function j(s){if(s){var t=new Date(s),c=t.getFullYear()+"-",p=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",y=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",F=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",f=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",i=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return c+p+y+F+f+i}}}}]);
