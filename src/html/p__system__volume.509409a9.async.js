"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1192],{80821:function(H,Z,e){e.d(Z,{Z:function(){return N}});var I=e(5574),c=e.n(I),U=e(93246),y=e(54006),b=e(31418),w=e(86738),E=e(14726),R=e(83062),W=e(62435),O=e(86074);function N(u){var z=(0,W.useState)(!1),S=c()(z,2),L=S[0],A=S[1],V=b.Z.useApp(),$=(0,y.useIntl)(),K=function(){A(!0),u.action().then(function(v){if(A(!1),typeof u.onSuccess=="function"&&u.onSuccess(v),u.messageSuccess){var D="";typeof u.messageSuccess=="function"?D=u.messageSuccess(v):D=u.messageSuccess,D.indexOf(".")>-1&&(D=$.formatMessage({id:D})),u.asynced?(0,U.Rk)(V,D):(0,U.$h)(V,D)}}).catch(function(v){A(!1),typeof u.onError=="function"&&u.onError(v)})};return u.confirm?(0,O.jsx)(w.Z,{style:{width:500},title:"\u63D0\u793A",description:u.confirm,onConfirm:K,okText:"Yes",cancelText:"No",children:(0,O.jsx)(E.ZP,{disabled:u.disabled,icon:u.icon,loading:L,danger:u.danger,type:u.type,children:u.children})}):(0,O.jsx)(R.Z,{title:u.tips,children:(0,O.jsx)(E.ZP,{disabled:u.disabled,icon:u.icon,loading:L,onClick:K,danger:u.danger,type:u.type,children:u.children})})}},30707:function(H,Z,e){e.r(Z),e.d(Z,{default:function(){return pe}});var I=e(15009),c=e.n(I),U=e(99289),y=e.n(U),b=e(80821),w=e(5574),E=e.n(w),R=e(54006);function W(a){return O.apply(this,arguments)}function O(){return O=y()(c()().mark(function a(m){return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,R.request)("/api/app/volume/get-list",{method:"POST",data:m}));case 1:case"end":return t.stop()}},a)})),O.apply(this,arguments)}function N(a){return u.apply(this,arguments)}function u(){return u=y()(c()().mark(function a(m){return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,R.request)("/api/app/volume/create",{method:"POST",data:m}));case 1:case"end":return t.stop()}},a)})),u.apply(this,arguments)}function z(){return S.apply(this,arguments)}function S(){return S=y()(c()().mark(function a(){return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,R.request)("/api/app/volume/prune",{method:"POST"});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},a)})),S.apply(this,arguments)}function L(a){return A.apply(this,arguments)}function A(){return A=y()(c()().mark(function a(m){return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,R.request)("/api/app/volume/delete",{method:"POST",data:m});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)})),A.apply(this,arguments)}function V(a){return $.apply(this,arguments)}function $(){return $=y()(c()().mark(function a(m){return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,R.request)("/api/app/volume/get-detail",{method:"POST",data:m}));case 1:case"end":return t.stop()}},a)})),$.apply(this,arguments)}var K=e(93246),Y=e(184),v=e(5966),D=e(62370),q=e(86615),_=e(97462),ee=e(17186),ne=e(24739),te=e(31418),re=e(14726),J=e(34041),x=e(62435),n=e(86074),ae=(0,x.forwardRef)(function(a,m){var s=(0,x.useState)(!1),t=E()(s,2),l=t[0],i=t[1],f=te.Z.useApp(),o=(0,x.useRef)();return(0,x.useImperativeHandle)(m,function(){return{}}),(0,n.jsxs)(Y.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",open:l,onOpenChange:function(r){i(r)},formRef:o,trigger:(0,n.jsx)(re.ZP,{type:"primary",children:"\u6DFB\u52A0"}),onFinish:function(){var h=y()(c()().mark(function r(d){var j,P,C,T,p,B;return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return T=[],d.otherOptions&&d.otherOptions.map(function(k){T.push(k.name+`
`+k.value)}),g.next=4,N({name:d.name,driver:"local",type:d.type,nfsUrl:(j=d.nfsUrl)!==null&&j!==void 0?j:"",nfsMountPoint:(P=d.nfsMountPoint)!==null&&P!==void 0?P:"",nfsOptions:(C=d.nfsOptions)!==null&&C!==void 0?C:"",tmpfsOptions:d.tmpfsOptions,otherOptions:T});case 4:if(p=g.sent,!(p&&p.data&&p.data.info.Name!="")){g.next=10;break}return(0,K.$h)(f,"\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),a.onFinish&&a.onFinish(),(B=o.current)===null||B===void 0||B.resetFields(),g.abrupt("return",!0);case 10:case"end":return g.stop()}},r)}));return function(r){return h.apply(this,arguments)}}(),children:[(0,n.jsx)(v.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,n.jsx)(D.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,n.jsx)(J.Z,{defaultValue:"local",children:(0,n.jsx)(J.Z.Option,{value:"local",children:"local"})})}),(0,n.jsx)(q.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,n.jsx)(_.Z,{name:["type"],children:function(r){var d=r.type;if(d=="other")return(0,n.jsx)(ee.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,n.jsxs)(ne.UW,{children:[(0,n.jsx)(v.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,n.jsx)(v.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(d=="nfs"||d=="nfs4")return[(0,n.jsx)(v.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,n.jsx)(v.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,n.jsx)(v.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(d=="tmpfs")return[(0,n.jsx)(v.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),ue=ae,Q=e(38345),le=e(45360),se=e(85576),F=e(26412),ie=e(63490),G=e(66309),oe=(0,x.forwardRef)(function(a,m){var s;(0,x.useImperativeHandle)(m,function(){return{showDetail:function(B){C.open({type:"loading",content:"\u6B63\u5728\u83B7\u53D6\u5B58\u50A8\u5377\u8BE6\u60C5",duration:0});var M=V({name:B}).then(function(g){d(g.data),f(!0)}).finally(function(){C.destroy()})}}});var t=(0,x.useState)(!1),l=E()(t,2),i=l[0],f=l[1],o=(0,x.useState)(),h=E()(o,2),r=h[0],d=h[1],j=le.ZP.useMessage(),P=E()(j,2),C=P[0],T=P[1];return(0,n.jsxs)(n.Fragment,{children:[T,(0,n.jsxs)(se.Z,{width:800,open:i,footer:!1,onCancel:function(){return f(!1)},children:[(0,n.jsx)(Q.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,n.jsxs)(F.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,n.jsx)(F.Z.Item,{label:"\u540D\u79F0",children:r==null?void 0:r.info.Name}),(0,n.jsx)(F.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((s=r==null?void 0:r.info.CreatedAt)!==null&&s!==void 0?s:"").toLocaleString()}),(0,n.jsx)(F.Z.Item,{label:"\u6302\u8F7D\u70B9",children:r==null?void 0:r.info.Mountpoint}),(0,n.jsx)(F.Z.Item,{label:"\u7C7B\u578B",children:r==null?void 0:r.info.Driver}),(r==null?void 0:r.info.Labels)&&(0,n.jsx)(F.Z.Item,{label:"Lables",children:(0,n.jsx)(F.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(r==null?void 0:r.info.Labels)&&Object.keys(r==null?void 0:r.info.Labels).map(function(p){return(0,n.jsx)(F.Z.Item,{label:p,children:r.info.Labels[p]})})})})]})}),(0,n.jsx)(Q.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,n.jsx)(ie.Z,{rowKey:"Id",columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(B,M,g){return(0,n.jsx)(R.Link,{target:"_blank",to:"/app/detail/edit/".concat(M.Id),children:M.Name})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(B,M,g){return M.RW?(0,n.jsx)(G.Z,{children:"\u8BFB\u5199"}):(0,n.jsx)(G.Z,{children:"\u53EA\u8BFB"})}}],dataSource:r==null?void 0:r.inUseContainer,pagination:!1})})]})]})}),de=oe,ce=e(6409),fe=e(43425),me=e(90639),X=e(78957),ve=e(96074),he=e(83062);function pe(){var a=(0,x.useRef)(),m=(0,x.useRef)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(de,{ref:m}),(0,n.jsx)(me.Z,{rowKey:"Name",pagination:(0,ce.O)(),columns:[{title:"\u540D\u79F0",ellipsis:!0,dataIndex:"Name",width:250},{title:"\u72B6\u6001",ellipsis:!0,search:!1,render:function(t,l,i,f,o){return l.InUse?(0,n.jsx)(G.Z,{color:"cyan",children:"In Use"}):(0,n.jsx)(n.Fragment,{})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",ellipsis:!0,search:!1,dataIndex:"Mountpoint"},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(t,l,i,f,o){return new Date(l.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(t,l,i,f,o){return(0,n.jsx)(X.Z,{split:(0,n.jsx)(ve.Z,{type:"vertical"}),children:(0,n.jsx)(R.Link,{to:"##",onClick:function(){var r;(r=m.current)===null||r===void 0||r.showDetail(l.Name)},children:(0,n.jsx)(he.Z,{title:"\u7BA1\u7406",children:(0,n.jsx)(fe.Z,{})})})})}}],request:function(){var s=y()(c()().mark(function t(l,i,f){var o,h;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,W({name:l.name});case 2:return o=d.sent,h=[],o.data.inUse?h=o.data.list.map(function(j){return o.data.inUse.indexOf(j.Name)!=-1?j.InUse=!0:j.InUse=!1,j}):h=o.data.list,d.abrupt("return",{data:h,success:!0,total:o.data.list.length});case 6:case"end":return d.stop()}},t)}));return function(t,l,i){return s.apply(this,arguments)}}(),toolBarRender:function(){return[(0,n.jsx)(ue,{onFinish:function(){var l,i;!((l=a.current)===null||l===void 0)&&l.reloadAndRest&&((i=a.current)===null||i===void 0||i.reloadAndRest())}}),(0,n.jsx)(b.Z,{action:function(){return z()},onSuccess:function(){var l,i;return!((l=a.current)===null||l===void 0)&&l.reloadAndRest&&((i=a.current)===null||i===void 0||i.reloadAndRest()),!0},onError:function(){var l,i;return!((l=a.current)===null||l===void 0)&&l.reset&&((i=a.current)===null||i===void 0||i.reset()),!0},messageSuccess:"\u6E05\u9664\u6210\u529F",confirm:"\u662F\u5426\u6E05\u7406\u672A\u4F7F\u7528\u7684\u533F\u540D\u5B58\u50A8\uFF1F",children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:a,tableAlertOptionRender:function(t){var l=t.selectedRowKeys;return(0,n.jsx)(X.Z,{size:16,children:(0,n.jsx)(b.Z,{danger:!0,type:"primary",action:function(){return L({name:l})},onSuccess:function(){var f,o;return!((f=a.current)===null||f===void 0)&&f.reloadAndRest&&((o=a.current)===null||o===void 0||o.reloadAndRest()),!0},onError:function(){var f,o;return!((f=a.current)===null||f===void 0)&&f.reset&&((o=a.current)===null||o===void 0||o.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})}})]})}},6409:function(H,Z,e){e.d(Z,{O:function(){return I}});function I(){return{showSizeChanger:!0,defaultPageSize:20}}}}]);
