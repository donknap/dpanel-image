"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{44771:function(ee,G,t){t.d(G,{Z:function(){return s}});var H=t(34041),n=t(25449),z=t(62435),l=t(86074);function s(j){return(0,l.jsx)(n.Z,{name:"restart",initialValue:j.defaultValue?j.defaultValue:"on-failure",children:(0,l.jsx)(H.Z,{options:[{value:"no",label:"\u4E0D\u91CD\u542F"},{value:"on-failure",label:"\u975E\u6B63\u5E38\u9000\u51FA\u65F6,\u6700\u591A5\u6B21 - on failure"},{value:"unless-stopped",label:"\u9000\u51FA\u540E\u91CD\u542F\uFF0C\u4E0D\u5305\u62EC\u624B\u52A8\u505C\u6B62\u7684 - unless stopped"},{value:"always",label:"\u603B\u662F\u9000\u51FA\u540E\u91CD\u542F - always"}]})})}},80821:function(ee,G,t){t.d(G,{Z:function(){return D}});var H=t(5574),n=t.n(H),z=t(93246),l=t(54006),s=t(31418),j=t(86738),p=t(14726),Y=t(62435),U=t(86074);function D(h){var d=(0,Y.useState)(!1),K=n()(d,2),X=K[0],W=K[1],m=s.Z.useApp(),E=(0,l.useIntl)(),v=function(){W(!0),h.action().then(function(Q){if(W(!1),typeof h.onSuccess=="function"&&h.onSuccess(Q),h.messageSuccess){var c="";h.messageSuccess.indexOf(".")>-1?c=E.formatMessage({id:h.messageSuccess}):c=h.messageSuccess,h.asynced?(0,z.Rk)(m,c):(0,z.$h)(m,c)}}).catch(function(Q){W(!1),typeof h.onError=="function"&&h.onError(Q)})};return h.confirm?(0,U.jsx)(j.Z,{style:{width:500},title:"\u63D0\u793A",description:h.confirm,onConfirm:v,okText:"Yes",cancelText:"No",children:(0,U.jsx)(p.ZP,{disabled:h.disabled,icon:h.icon,loading:X,danger:h.danger,type:h.type,children:h.children})}):(0,U.jsx)(p.ZP,{disabled:h.disabled,icon:h.icon,loading:X,onClick:v,danger:h.danger,type:h.type,children:h.children})}},35880:function(ee,G,t){var H=t(62435),n=(0,H.createContext)({});G.Z=n},4619:function(ee,G,t){t.r(G),t.d(G,{default:function(){return Je}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(5574),j=t.n(s),p=t(38345),Y=t(97269),U=t(2236),D=t(5966),h=t(92398),d=t(62435),K=t(35880),X=t(62370),W=t(12010),m=t(78957),E=t(14726),v=t(85576),r=t(75891),Q=t(96074),c=t(83062),Z=t(3393),J=t(18148),$=t(5251),_=t(64789),ve=t(75162),_e=t(85265),ge=t(38703),Ee=t(80821),se=t(54006),e=t(86074),je=(0,d.forwardRef)(function(P,L){var T=(0,d.useState)(!1),w=j()(T,2),O=w[0],b=w[1],B=(0,d.useState)(),M=j()(B,2),S=M[0],x=M[1],g=(0,se.useModel)("subscriber"),i=(0,d.useRef)();return g.addDataHandler("imageDownload",function(){var f=g.getDataByType("imageDownload"),o=f.pop();o&&x(o.data)}),(0,d.useImperativeHandle)(L,function(){return{upgradeImage:function(o){var u;return b(!0),(u=i.current)===null||u===void 0||u.setFieldValue("imageUrl",o),(0,Z.Gb)({tag:o,type:"pull"})},setImageName:function(o){var u;console.log(o),b(!0),(u=i.current)===null||u===void 0||u.setFieldValue("imageUrl",o)}}}),[(0,e.jsx)(E.ZP,{type:"primary",danger:!0,onClick:function(){var o;b(!0),(o=i.current)===null||o===void 0||o.resetFields(),x({start:{downloading:0,extracting:0}})},children:"\u4E0B\u8F7D\u65B0\u955C\u50CF"},"remoteBtn"),(0,e.jsxs)(_e.Z,{forceRender:!0,open:O,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return b(!1)},footer:!1,children:[(0,e.jsx)(p.Z,{children:(0,e.jsxs)(m.Z,{direction:"vertical",size:"middle",children:[(0,e.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,e.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,e.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,e.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,e.jsx)("a",{href:"/image/registry",target:"_blank",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,e.jsx)("div",{children:"3\u3001\u65E0\u7528\u7684\u955C\u50CF\u53CA\u7F13\u5B58\u6587\u4EF6\u53EF\u4EE5\u5728\u955C\u50CF\u7BA1\u7406\u4E2D\u8FDB\u884C\u5220\u9664\u548C\u6E05\u7406"})]})}),(0,e.jsx)(p.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,e.jsxs)(Y.A,{submitter:!1,formRef:i,children:[(0,e.jsxs)(m.Z.Compact,{children:[(0,e.jsx)(D.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,e.jsx)(Ee.Z,{action:function(){var o,u,a=(o=(u=i.current)===null||u===void 0?void 0:u.getFieldValue("imageUrl"))!==null&&o!==void 0?o:"";return(0,Z.Gb)({tag:a,type:"pull"})},onSuccess:function(){var o,u,a,C;x({finish:{downloading:100,extracting:100}}),b(!1);var k=(o=(u=i.current)===null||u===void 0?void 0:u.getFieldValue("imageUrl"))!==null&&o!==void 0?o:"";(a=P.imageTableSearchFormRef.current)===null||a===void 0||a.setFieldValue("tag",k),(C=P.imageTableSearchFormRef.current)===null||C===void 0||C.submit()},messageSuccess:"\u4E0B\u8F7D\u5B8C\u6210",children:"\u4E0B\u8F7D\u955C\u50CF"})]}),(0,e.jsx)(X.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:S&&Object.keys(S).map(function(f){return(0,e.jsx)(ge.Z,{percent:S[f].downloading,success:{percent:S[f].extracting}},f)})})]})})]},"remoteDrawer")]}),Ce=je;function Fe(P){var L=(0,d.useState)(!1),T=j()(L,2),w=T[0],O=T[1],b=(0,d.useRef)(),B=(0,d.useContext)(K.Z),M=B.createFormRef,S=B.volumeListRef,x=B.createEnvRef,g=B.domainRef,i=(0,d.useRef)(),f=function(){var o=l()(n()().mark(function u(a){var C,k,I,y,V,A,F,R,N,q,le;return n()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return O(!1),re.next=3,(0,Z.YU)({md5:a});case 3:y=re.sent,P.redeploy||(R=(V=M.current)===null||V===void 0?void 0:V.getFieldsValue(),(A=M.current)===null||A===void 0||A.resetFields(),(F=M.current)===null||F===void 0||F.setFieldsValue({siteName:R.siteName,siteTitle:R.siteTitle})),y.data.info.Config.Env&&y.data.info.Config.Env.map(function(oe){var ue,he=oe.split("=");(ue=x.current)===null||ue===void 0||ue.addEnvItem(he[0],he[1])}),(C=M.current)===null||C===void 0||C.setFieldValue("imageName",y.data.info.RepoTags[0]),(k=M.current)===null||k===void 0||k.setFieldValue("workDir",y.data.info.Config.WorkingDir),(I=g.current)===null||I===void 0||I.setExposePort(y.data.info.Config.ExposedPorts),y.data.info.Config.Volumes?(q=[],Object.keys(y.data.info.Config.Volumes).map(function(oe,ue){q.push(oe)}),(N=S.current)===null||N===void 0||N.setDefaultDestPath(q)):(le=S.current)===null||le===void 0||le.setDefaultDestPath([]);case 10:case"end":return re.stop()}},u)}));return function(a){return o.apply(this,arguments)}}();return(0,d.useEffect)(function(){P.fromImageId&&f(P.fromImageId)},[P.fromImageId]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(m.Z.Compact,{children:[(0,e.jsx)(D.Z,{label:"\u955C\u50CF",tooltip:P.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",width:"lg",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0}),(0,e.jsx)(X.Z,{label:" ",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.ZP,{type:"primary",onClick:function(){return O(!0)},children:P.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(v.Z,{open:w,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return O(!1)},children:(0,e.jsx)(W.Z,{columns:[{title:"Id",dataIndex:"Id",ellipsis:!0,search:!1,width:150},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",render:function(u,a,C,k){return(0,e.jsx)(r.Z.Text,{code:!0,copyable:!0,children:a.RepoTags[0]},a.RepoTags[0])}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(u,a,C,k){return(0,e.jsx)("div",{children:(0,$.ZM)(a.Created*1e3)},a.Id)},sorter:function(u,a){return u.Created-a.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:"100px",render:function(u,a,C,k){return(0,e.jsxs)(m.Z,{split:(0,e.jsx)(Q.Z,{type:"vertical"}),children:[(0,e.jsx)(E.ZP,{size:"small",onClick:l()(n()().mark(function I(){return n()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",f(a.Id));case 1:case"end":return V.stop()}},I)})),type:"link",icon:(0,e.jsx)(c.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(_.Z,{})})},"addImage"),(0,e.jsx)(E.ZP,{size:"small",onClick:l()(n()().mark(function I(){var y;return n()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:a.RepoTags[0]&&((y=i.current)===null||y===void 0||y.setImageName(a.RepoTags[0]));case 1:case"end":return A.stop()}},I)})),type:"link",icon:(0,e.jsx)(c.Z,{title:"\u66F4\u65B0\u7248\u672C",children:(0,e.jsx)(ve.Z,{})})},"updateImage")]})}}],request:function(){var o=l()(n()().mark(function u(a,C,k){var I,y,V,A;return n()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return P.redeploy&&(y=(I=M.current)===null||I===void 0?void 0:I.getFieldValue("imageName"),a.tag=y?y.split(":")[0]:a.tag),R.next=3,(0,J.KG)({tag:a.tag});case 3:return V=R.sent,A=[],V.data.list&&(A=V.data.list.flatMap(function(N){return N.RepoTags.map(function(q){return{Id:N.Id,Created:N.Created,RepoTags:[q]}})})),R.abrupt("return",{data:A,success:!0,total:A.length});case 7:case"end":return R.stop()}},u)}));return function(u,a,C){return o.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(Ce,{ref:i,imageTableSearchFormRef:b},"remote")]},formRef:b,rowKey:"Id",pagination:{pageSize:5}})},"imageTableList")]})})]})})}var ie=t(60335),De=t(24969),Be=t(27496),ne=t(24739),Pe=t(63434),te=t(17186),xe=t(66309),ye=(0,d.forwardRef)(function(P,L){var T=(0,d.useState)(!1),w=j()(T,2),O=w[0],b=w[1],B=(0,d.useRef)(),M=function(g){var i=(0,d.useState)([]),f=j()(i,2),o=f[0],u=f[1];return(0,d.useEffect)(function(){(0,ie.jV)({md5:g.name}).then(function(a){var C;return u((C=a.data.info.Config.Env)!==null&&C!==void 0?C:[]),!0})},[]),(0,e.jsxs)(p.Z,{bordered:!0,extra:g.action,style:{marginBottom:10},children:[(0,e.jsx)(p.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(D.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Pe.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(p.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(m.Z,{direction:"vertical",children:o&&o.map(function(a,C){return(0,e.jsx)(r.Z.Text,{copyable:{icon:(0,e.jsx)(De.Z,{}),onCopy:function(){var I=a.split("=");P.onAddEnv(I[0],I[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:a},style:{width:300},children:a},C)})},"linkEnv")})]})},S=function(g){var i,f,o=!1,u=(i=(f=B.current)===null||f===void 0?void 0:f.getList())!==null&&i!==void 0?i:[];if(u.map(function(C){C.name==g.name&&(o=!0)}),!o){var a;(a=B.current)===null||a===void 0||a.add(g)}};return(0,d.useImperativeHandle)(L,function(){return{setDefaultLink:function(g){g&&g.map(function(i){i.name!=""&&S(i)})}}}),(0,e.jsxs)(p.Z,{title:"\u5173\u8054\u5BB9\u5668\u6216\u7F51\u7EDC",headerBordered:!0,children:[(0,e.jsx)(te.u,{name:"links",actionRef:B,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(g,i){return b(!0),!1}},copyIconProps:!1,min:0,itemRender:function(g,i){return(0,e.jsx)(M,{action:g.action,name:i.record.name})}}),(0,e.jsx)(v.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:O,onCancel:function(){return b(!1)},children:(0,e.jsx)(W.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(g,i,f,o){return(0,e.jsx)(m.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Names.map(function(u){return u})},i.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(g,i,f,o){return i!=null&&i.Ports?(0,e.jsx)(m.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Ports.map(function(u,a){return(0,e.jsx)(xe.Z,{color:"#2db7f5",icon:u.PublicPort?(0,e.jsx)(Be.Z,{}):"",children:"".concat(u.PublicPort?u.IP+":"+u.PublicPort+"->":"").concat(u.PrivatePort,"/").concat(u.Type)},a)})},i.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(g,i,f,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(r.Z.Text,{ellipsis:{tooltip:i.Image},children:i.Image},i.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(g,i,f,o){return[(0,e.jsx)(E.ZP,{type:"link",onClick:function(){(0,ie.jV)({md5:i.Id}).then(function(a){return S({name:a.data.info.Name,alise:a.data.info.Config.Hostname,volume:!1}),b(!1),!0})},children:(0,e.jsx)(_.Z,{})},i.Id)]}}],rowKey:"Id",request:function(){var x=l()(n()().mark(function g(i,f,o){return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(C,k){(0,ie.IE)({name:i.name}).then(function(I){var y={data:I.data.list,success:!0,total:I.data.list.length};C(y)})}));case 1:case"end":return a.stop()}},g)}));return function(g,i,f){return x.apply(this,arguments)}}(),pagination:{pageSize:5}})})]})}),Te=ye,be=t(89035),Ie=t(20713),de="docker-image",Re=(0,d.forwardRef)(function(P,L){var T=(0,d.useState)(de),w=j()(T,2),O=w[0],b=w[1],B=(0,d.useRef)(),M=(0,d.useState)(""),S=j()(M,2),x=S[0],g=S[1],i=function(){O!="code"?b("code"):b(de)};(0,d.useImperativeHandle)(L,function(){return{addEnvItem:function(a,C){var k,I=(k=B.current)===null||k===void 0?void 0:k.getList(),y=!1;if(I==null||I.map(function(A){if(A.name==a){y=!0;return}}),!y){var V;(V=B.current)===null||V===void 0||V.add({name:a,value:C})}}}});function f(u){try{for(var a,C,k=(a=(C=B.current)===null||C===void 0||(C=C.getList())===null||C===void 0?void 0:C.length)!==null&&a!==void 0?a:0,I=k;I>=0;I--){var y;(y=B.current)===null||y===void 0||y.remove(I)}var V=u.split(`
`),A=0;V.map(function(F){var R,N=F.split("=");N.length==2&&((R=B.current)===null||R===void 0||R.add({name:N[0],value:N[1]},A),A++)})}catch(F){}}function o(){if(B){var u,a=(u=B.current)===null||u===void 0?void 0:u.getList();if(a){var C=[];return a.map(function(k){C.push("".concat(k.name,"=").concat(k.value))}),C.join(`
`)}else return""}else return""}return(0,e.jsxs)(p.Z,{title:"\u73AF\u5883\u53D8\u91CF",headerBordered:!0,extra:(0,e.jsx)(c.Z,{title:"\u4EE3\u7801\u7F16\u8F91\u6A21\u5F0F",children:(0,e.jsx)(E.ZP,{icon:(0,e.jsx)(be.Z,{}),type:O=="code"?"primary":"default",onClick:i,children:"\u4EE3\u7801\u6A21\u5F0F"})}),children:[(0,e.jsx)(te.u,{name:"environment",actionRef:B,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"name",label:"\u53D8\u91CF\u540D",placeholder:""}),(0,e.jsx)(D.Z,{width:"md",name:"value",label:"\u53D8\u91CF\u503C",placeholder:""})]})}),(0,e.jsx)(v.Z,{width:"800px",open:O=="code",onCancel:function(){return b("docker-image")},onOk:function(){f(x),b("docker-image")},children:(0,e.jsx)(Ie.ZP,{onChange:function(a){return g(a)},value:o(),height:"680px",theme:"light"})})]})}),Oe=Re,Se=t(86615),Ae=t(64317),Ze=(0,d.forwardRef)(function(P,L){var T=(0,d.useRef)();return(0,d.useImperativeHandle)(L,function(){return{setDefaultDestPath:function(O){var b,B,M=(b=(B=T.current)===null||B===void 0?void 0:B.getList())!==null&&b!==void 0?b:[];O.length!=0&&O.filter(function(S){return S!=""}).map(function(S){var x=!1;if(M.map(function(i){if(i.dest==S){x=!0;return}}),!x){var g;(g=T.current)===null||g===void 0||g.add({dest:S,permission:"write",inImage:!0,edit:!1})}})}}}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.Z,{title:"\u7AD9\u70B9\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u4F1A\u5C06\u5BB9\u5668\u5185\u4F7F\u7528\u7684\u6570\u636E\u5377\u6302\u8F7D\u5230\u9ED8\u8BA4\u5B58\u50A8\u4E2D",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u7ED1\u5B9A\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:T,copyIconProps:!1,min:0,children:function(O,b,B){var M=B.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",disabled:M.inImage}),(0,e.jsx)(Se.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(p.Z,{title:"\u6302\u8F7D\u5BBF\u4E3B\u673A\u6587\u4EF6\uFF08Bind\uFF09",subTitle:"\u6302\u8F7D\u5BB9\u5668\u5185\u9700\u8981\u8BBF\u95EE\u5BBF\u4E3B\u673A\u7684\u6587\u4EF6",headerBordered:!0,direction:"column",children:(0,e.jsx)(te.u,{name:"volumes",creatorButtonProps:{creatorButtonText:"\u6302\u8F7D\u76EE\u5F55\u6216\u662F\u5176\u5B83\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsxs)(m.Z.Compact,{children:[(0,e.jsx)(D.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u6216\u76EE\u5F55",name:"host",width:"md"}),(0,e.jsx)(Ae.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md"})]})})})]})}),we=Ze,Me=t(2831),Ue=t(10418),ce=t(71338);function We(){var P=(0,d.useState)(),L=j()(P,2),T=L[0],w=L[1];return(0,d.useEffect)(function(){(0,Me.a)().then(function(O){return w(O.data.info)})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:64,children:(0,e.jsx)(Ue.Z,{addonAfter:"MB",min:64})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:.1,max:T==null?void 0:T.NCPU,marks:{0:"\u4E0D\u9650\u5236",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:256,max:Math.round((T==null?void 0:T.MemTotal)/1024/1024),marks:{0:"\u4E0D\u9650\u5236",1024:"1G",2048:"2G",3072:"3G",4096:"2G"}})})]})}function Le(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(te.u,{name:"label",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(D.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var ke=t(52688),Ke=t(97857),me=t.n(Ke),$e=t(69677);function fe(P){var L=(0,d.useState)(""),T=j()(L,2),w=T[0],O=T[1],b=(0,d.useState)("default"),B=j()(b,2),M=B[0],S=B[1],x=function(f){return(0,e.jsx)(E.ZP,{type:M==f.type?"primary":"default",onClick:function(){return g(f.type)},children:f.text})},g=function(f){S(f),f=="default"&&P.value&&O(P.value)};return(0,d.useEffect)(function(){P.value&&O(P.value)},[P.value]),P.fieldProps.children=(0,e.jsxs)(m.Z.Compact,{block:!0,children:[(0,e.jsx)(x,{text:"\u4F7F\u7528\u9ED8\u8BA4",type:"default"}),(0,e.jsx)(x,{text:"\u81EA\u5B9A\u4E49",type:"user"}),(0,e.jsx)($e.Z,{disabled:M=="default",value:w,onChange:function(f){O(f.target.value)}})]}),(0,e.jsx)(X.Z,me()(me()({},P.fieldProps),{},{name:P.name}))}fe.defaultProps={};var ae=fe,Ve=t(44771);function Ge(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ve.Z,{}),(0,e.jsx)(ke.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(ae,{fieldProps:{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55"},name:"workDir"}),(0,e.jsx)(ae,{fieldProps:{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237"},name:"user"}),(0,e.jsx)(ae,{fieldProps:{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"},name:"command"}),(0,e.jsx)(ae,{fieldProps:{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4"},name:"entrypoint"})]})}var Ne=t(91845),pe=t(62597),He=(0,d.forwardRef)(function(P,L){return(0,d.useImperativeHandle)(L,function(){return{}}),(0,e.jsx)(p.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0})}),ze=He,Ye=(0,d.forwardRef)(function(P,L){var T=(0,d.useState)(""),w=j()(T,2),O=w[0],b=w[1],B=(0,d.useRef)();return(0,d.useImperativeHandle)(L,function(){return{setExposePort:function(S){if(S){var x,g,i=(x=(g=B.current)===null||g===void 0?void 0:g.getList())!==null&&x!==void 0?x:[];Object.keys(S).map(function(f){var o=!1;if(i.map(function(a){a.dest==f&&(o=!0)}),!o){var u;(u=B.current)===null||u===void 0||u.add({type:"port",host:"",dest:f})}})}},setHostname:function(S){b(S)}}}),(0,e.jsx)(p.Z,{title:"\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"ports",actionRef:B,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u57DF\u540D\u6216\u662F\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u7ED1\u5B9A\u57DF\u540D\u8F6C\u53D1\u6216\u662F\u76F4\u63A5\u66B4\u9732\u7AEF\u53E3",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3"}),(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3"})]})})})}),Xe=Ye;function Je(){var P,L,T,w=(0,d.useContext)(K.Z),O=w.createFormRef,b=w.volumeListRef,B=w.domainRef,M=w.createEnvRef,S=w.createLinkRef,x=(0,d.useState)(!1),g=j()(x,2),i=g[0],f=g[1],o=(0,se.useSearchParams)(),u=j()(o,2),a=u[0],C=u[1],k=(0,se.useNavigate)(),I=parseInt((P=a.get("id"))!==null&&P!==void 0?P:""),y=(L=a.get("md5"))!==null&&L!==void 0?L:"",V=(T=a.get("imageId"))!==null&&T!==void 0?T:"";return(0,d.useEffect)(function(){if(y||I)(0,pe.iE)({md5:y,id:I}).then(function(F){var R;f(!0),(R=O.current)===null||R===void 0||R.setFieldsValue({siteTitle:F.data.siteTitle,siteName:F.data.siteName,imageName:F.data.env.imageName,privileged:F.data.env.privileged,workDir:F.data.env.workDir,user:F.data.env.user,command:F.data.env.command,entrypoint:F.data.env.entrypoint,shmsize:F.data.env.shmsize,cpus:F.data.env.cpus,memory:F.data.env.memory,environment:F.data.env.environment,label:F.data.env.label,volumesDefault:F.data.env.volumesDefault,volumes:F.data.env.volumes,ports:F.data.env.ports,links:F.data.env.links,restart:F.data.env.restart})});else{var A;f(!1),(A=O.current)===null||A===void 0||A.resetFields()}},[a]),(0,e.jsx)(p.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(Y.A,{submitter:{render:function(F,R){return(0,e.jsx)(U.S,{children:R})}},formRef:O,onFinish:function(){var A=l()(n()().mark(function F(R){return n()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return R.md5=y,q.next=3,(0,pe.$G)(R);case 3:return k("/app/list"),q.abrupt("return",!0);case 5:case"end":return q.stop()}},F)}));return function(F){return A.apply(this,arguments)}}(),children:[(0,e.jsxs)(p.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(D.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(F){var R="";if(F.target.value&&!i){var N,q=(0,Ne.N9)(F.target.value.trim(),{toneType:"none",type:"array"});R=q.join(""),(N=O.current)===null||N===void 0||N.setFieldValue("siteName",R)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(D.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:i,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Fe,{redeploy:i,fromImageId:V})]}),(0,e.jsx)(Xe,{ref:B}),(0,e.jsx)(Te,{onAddEnv:function(F,R){var N;(N=M.current)===null||N===void 0||N.addEnvItem(F,R)},ref:S}),(0,e.jsx)(ze,{}),(0,e.jsx)(Oe,{ref:M}),(0,e.jsx)(we,{ref:b}),(0,e.jsx)(p.Z,{title:"\u9AD8\u7EA7\u914D\u7F6E",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,e.jsx)(h.Z,{items:[{label:"\u542F\u52A8\u9879",key:"run-command",children:(0,e.jsx)(Ge,{})},{label:"\u8D44\u6E90\u914D\u7F6E",key:"runtime",children:(0,e.jsx)(We,{})},{label:"\u6807\u7B7E",key:"label",children:(0,e.jsx)(Le,{})}]})})]},"form")})}},62597:function(ee,G,t){t.d(G,{$G:function(){return j},Ct:function(){return X},Tb:function(){return D},cl:function(){return Y},iE:function(){return d},xb:function(){return m}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(54006);function j(v){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/app/site/create-by-image",{method:"POST",data:r}));case 1:case"end":return c.stop()}},v)})),p.apply(this,arguments)}function Y(v){return U.apply(this,arguments)}function U(){return U=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/app/site/get-list",{method:"POST",data:r}));case 1:case"end":return c.stop()}},v)})),U.apply(this,arguments)}function D(v){return h.apply(this,arguments)}function h(){return h=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,s.request)("/api/app/log/run",{method:"POST",data:r});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},v)})),h.apply(this,arguments)}function d(v){return K.apply(this,arguments)}function K(){return K=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,s.request)("/api/app/site/get-detail",{data:r,method:"POST"});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},v)})),K.apply(this,arguments)}function X(v){return W.apply(this,arguments)}function W(){return W=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/app/container/delete",{method:"POST",data:r}));case 1:case"end":return c.stop()}},v)})),W.apply(this,arguments)}function m(v){return E.apply(this,arguments)}function E(){return E=l()(n()().mark(function v(r){return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/app/site/delete",{method:"POST",data:r}));case 1:case"end":return c.stop()}},v)})),E.apply(this,arguments)}},2831:function(ee,G,t){t.d(G,{a:function(){return j}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(54006);function j(){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function Y(){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,s.request)("/api/common/home/info",{method:"POST"});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},Y)})),p.apply(this,arguments)}},60335:function(ee,G,t){t.d(G,{IE:function(){return Y},IW:function(){return j},KK:function(){return X},eE:function(){return d},jV:function(){return D}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(54006);function j(m){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/container/status",{method:"POST",data:E}));case 1:case"end":return r.stop()}},m)})),p.apply(this,arguments)}function Y(m){return U.apply(this,arguments)}function U(){return U=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/container/get-list",{data:E,method:"POST"}));case 1:case"end":return r.stop()}},m)})),U.apply(this,arguments)}function D(m){return h.apply(this,arguments)}function h(){return h=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/container/get-detail",{data:E,method:"POST"}));case 1:case"end":return r.stop()}},m)})),h.apply(this,arguments)}function d(m){return K.apply(this,arguments)}function K(){return K=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/container/update",{data:E,method:"POST"}));case 1:case"end":return r.stop()}},m)})),K.apply(this,arguments)}function X(){return W.apply(this,arguments)}function W(){return W=l()(n()().mark(function m(){return n()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,s.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return v.stop()}},m)})),W.apply(this,arguments)}},3393:function(ee,G,t){t.d(G,{Gb:function(){return Y},Pn:function(){return d},Rb:function(){return X},YU:function(){return j},_U:function(){return D}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(54006);function j(m){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/image/get-detail",{method:"POST",data:E}));case 1:case"end":return r.stop()}},m)})),p.apply(this,arguments)}function Y(m){return U.apply(this,arguments)}function U(){return U=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/image/tag-remote",{method:"POST",data:E}));case 1:case"end":return r.stop()}},m)})),U.apply(this,arguments)}function D(m){return h.apply(this,arguments)}function h(){return h=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/image/tag-add",{method:"POST",data:E}));case 1:case"end":return r.stop()}},m)})),h.apply(this,arguments)}function d(m){return K.apply(this,arguments)}function K(){return K=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/image/tag-delete",{method:"POST",data:E}));case 1:case"end":return r.stop()}},m)})),K.apply(this,arguments)}function X(m){return W.apply(this,arguments)}function W(){return W=l()(n()().mark(function m(E){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/app/image/export",{method:"POST",data:E,responseType:"blob"}));case 1:case"end":return r.stop()}},m)})),W.apply(this,arguments)}},18148:function(ee,G,t){t.d(G,{$q:function(){return X},KG:function(){return j},T8:function(){return d},Xn:function(){return D},ao:function(){return m},c5:function(){return Q},c7:function(){return v}});var H=t(15009),n=t.n(H),z=t(99289),l=t.n(z),s=t(54006);function j(Z){return p.apply(this,arguments)}function p(){return p=l()(n()().mark(function Z(J){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,s.request)("/api/app/image/get-list",{method:"POST",data:J}));case 1:case"end":return _.stop()}},Z)})),p.apply(this,arguments)}function Y(Z){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function Z(J){return _regeneratorRuntime().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,request("/api/app/log/image-build",{method:"POST",data:J});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},Z)})),U.apply(this,arguments)}function D(Z){return h.apply(this,arguments)}function h(){return h=l()(n()().mark(function Z(J){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,s.request)("/api/app/image/get-list-build",{method:"POST",data:J}));case 1:case"end":return _.stop()}},Z)})),h.apply(this,arguments)}function d(Z){return K.apply(this,arguments)}function K(){return K=l()(n()().mark(function Z(J){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,s.request)("/api/app/image/get-build-task",{method:"POST",data:J});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},Z)})),K.apply(this,arguments)}function X(Z){return W.apply(this,arguments)}function W(){return W=l()(n()().mark(function Z(J){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,s.request)("/api/app/image/delete-build-task",{method:"POST",data:J});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},Z)})),W.apply(this,arguments)}function m(Z){return E.apply(this,arguments)}function E(){return E=l()(n()().mark(function Z(J){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,s.request)("/api/app/image/image-delete",{method:"POST",data:J});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},Z)})),E.apply(this,arguments)}function v(){return r.apply(this,arguments)}function r(){return r=l()(n()().mark(function Z(){return n()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,s.request)("/api/app/image/image-prune",{method:"POST"});case 2:return $.abrupt("return",$.sent);case 3:case"end":return $.stop()}},Z)})),r.apply(this,arguments)}function Q(){return c.apply(this,arguments)}function c(){return c=l()(n()().mark(function Z(){return n()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,s.request)("/api/app/image/build-prune",{method:"POST"});case 2:return $.abrupt("return",$.sent);case 3:case"end":return $.stop()}},Z)})),c.apply(this,arguments)}},5251:function(ee,G,t){t.d(G,{FI:function(){return n},ZM:function(){return z}});function H(l){return l.trim()}function n(l){var s="";l<.1*1024?s=l.toFixed(2)+"B":l<.1*1024*1024?s=(l/1024).toFixed(2)+"KB":l<1*1024*1024*1024?s=(l/(1024*1024)).toFixed(2)+"MB":s=(l/(1024*1024*1024)).toFixed(2)+"GB";var j=s+"",p=j.indexOf("."),Y=j.substr(p+1,2);return Y=="00"?j.substring(0,p)+j.substr(p+3,2):s}function z(l){if(l){var s=new Date(l),j=s.getFullYear()+"-",p=(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"-",Y=(s.getDate()<10?"0"+s.getDate():s.getDate())+" ",U=(s.getHours()<10?"0"+s.getHours():s.getHours())+":",D=(s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+":",h=s.getSeconds()<10?"0"+s.getSeconds():s.getSeconds();return j+p+Y+U+D+h}}}}]);
