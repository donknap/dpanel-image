"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{44771:function(ee,N,t){t.d(N,{Z:function(){return a}});var z=t(34041),n=t(25449),Y=t(62435),d=t(86074);function a(F){return(0,d.jsx)(n.Z,{name:"restart",initialValue:F.defaultValue?F.defaultValue:"on-failure",children:(0,d.jsx)(z.Z,{options:[{value:"no",label:"\u4E0D\u91CD\u542F"},{value:"on-failure",label:"\u975E\u6B63\u5E38\u9000\u51FA\u65F6,\u6700\u591A5\u6B21 - on failure"},{value:"unless-stopped",label:"\u9000\u51FA\u540E\u91CD\u542F\uFF0C\u4E0D\u5305\u62EC\u624B\u52A8\u505C\u6B62\u7684 - unless stopped"},{value:"always",label:"\u603B\u662F\u9000\u51FA\u540E\u91CD\u542F - always"}]})})}},80821:function(ee,N,t){t.d(N,{Z:function(){return D}});var z=t(5574),n=t.n(z),Y=t(93246),d=t(54006),a=t(31418),F=t(86738),p=t(14726),J=t(62435),W=t(86074);function D(v){var c=(0,J.useState)(!1),k=n()(c,2),X=k[0],$=k[1],P=a.Z.useApp(),R=(0,d.useIntl)(),m=function(){$(!0),v.action().then(function(L){if($(!1),typeof v.onSuccess=="function"&&v.onSuccess(L),v.messageSuccess){var r="";v.messageSuccess.indexOf(".")>-1?r=R.formatMessage({id:v.messageSuccess}):r=v.messageSuccess,v.asynced?(0,Y.Rk)(P,r):(0,Y.$h)(P,r)}}).catch(function(L){$(!1),typeof v.onError=="function"&&v.onError(L)})};return v.confirm?(0,W.jsx)(F.Z,{style:{width:500},title:"\u63D0\u793A",description:v.confirm,onConfirm:m,okText:"Yes",cancelText:"No",children:(0,W.jsx)(p.ZP,{disabled:v.disabled,icon:v.icon,loading:X,danger:v.danger,type:v.type,children:v.children})}):(0,W.jsx)(p.ZP,{disabled:v.disabled,icon:v.icon,loading:X,onClick:m,danger:v.danger,type:v.type,children:v.children})}},35880:function(ee,N,t){var z=t(62435),n=(0,z.createContext)({});N.Z=n},4619:function(ee,N,t){t.r(N),t.d(N,{default:function(){return Ye}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(5574),F=t.n(a),p=t(38345),J=t(97269),W=t(2236),D=t(5966),v=t(92398),c=t(62435),k=t(35880),X=t(62370),$=t(12010),P=t(78957),R=t(14726),m=t(85576),l=t(75891),L=t(96074),r=t(83062),U=t(3393),Q=t(18148),V=t(5251),h=t(64789),ve=t(75162),he=t(85265),_e=t(38703),ge=t(80821),se=t(54006),e=t(86074),Ee=(0,c.forwardRef)(function(B,Z){var y=(0,c.useState)(!1),O=F()(y,2),T=O[0],b=O[1],g=(0,c.useState)(),A=F()(g,2),x=A[0],E=A[1],_=(0,se.useModel)("subscriber"),i=(0,c.useRef)();return _.addDataHandler("imageDownload",function(){var f=_.getDataByType("imageDownload"),o=f.pop();o&&E(o.data)}),(0,c.useImperativeHandle)(Z,function(){return{upgradeImage:function(o){var s;return b(!0),(s=i.current)===null||s===void 0||s.setFieldValue("imageUrl",o),(0,U.Gb)({tag:o,type:"pull"})},setImageName:function(o){var s;console.log(o),b(!0),(s=i.current)===null||s===void 0||s.setFieldValue("imageUrl",o)}}}),[(0,e.jsx)(R.ZP,{type:"primary",danger:!0,onClick:function(){var o;b(!0),(o=i.current)===null||o===void 0||o.resetFields(),E({start:{downloading:0,extracting:0}})},children:"\u4E0B\u8F7D\u65B0\u955C\u50CF"},"remoteBtn"),(0,e.jsxs)(he.Z,{forceRender:!0,open:T,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return b(!1)},footer:!1,children:[(0,e.jsx)(p.Z,{children:(0,e.jsxs)(P.Z,{direction:"vertical",size:"middle",children:[(0,e.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,e.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,e.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,e.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,e.jsx)("a",{href:"/image/registry",target:"_blank",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,e.jsx)("div",{children:"3\u3001\u65E0\u7528\u7684\u955C\u50CF\u53CA\u7F13\u5B58\u6587\u4EF6\u53EF\u4EE5\u5728\u955C\u50CF\u7BA1\u7406\u4E2D\u8FDB\u884C\u5220\u9664\u548C\u6E05\u7406"})]})}),(0,e.jsx)(p.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,e.jsxs)(J.A,{submitter:!1,formRef:i,children:[(0,e.jsxs)(P.Z.Compact,{children:[(0,e.jsx)(D.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,e.jsx)(ge.Z,{action:function(){var o,s,u=(o=(s=i.current)===null||s===void 0?void 0:s.getFieldValue("imageUrl"))!==null&&o!==void 0?o:"";return(0,U.Gb)({tag:u,type:"pull"})},onSuccess:function(){var o,s,u,C;E({finish:{downloading:100,extracting:100}}),b(!1);var K=(o=(s=i.current)===null||s===void 0?void 0:s.getFieldValue("imageUrl"))!==null&&o!==void 0?o:"";(u=B.imageTableSearchFormRef.current)===null||u===void 0||u.setFieldValue("tag",K),(C=B.imageTableSearchFormRef.current)===null||C===void 0||C.submit()},messageSuccess:"\u4E0B\u8F7D\u5B8C\u6210",children:"\u4E0B\u8F7D\u955C\u50CF"})]}),(0,e.jsx)(X.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:x&&Object.keys(x).map(function(f){return(0,e.jsx)(_e.Z,{percent:x[f].downloading,success:{percent:x[f].extracting}},f)})})]})})]},"remoteDrawer")]}),Fe=Ee;function Ce(B){var Z=(0,c.useState)(!1),y=F()(Z,2),O=y[0],T=y[1],b=(0,c.useRef)(),g=(0,c.useContext)(k.Z),A=g.createFormRef,x=g.volumeListRef,E=g.createEnvRef,_=g.domainRef,i=(0,c.useRef)(),f=function(){var o=d()(n()().mark(function s(u){var C,K,S,I,G,M,j,w,H,q,le;return n()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return T(!1),re.next=3,(0,U.YU)({md5:u});case 3:I=re.sent,B.redeploy||(w=(G=A.current)===null||G===void 0?void 0:G.getFieldsValue(),(M=A.current)===null||M===void 0||M.resetFields(),(j=A.current)===null||j===void 0||j.setFieldsValue({siteName:w.siteName,siteTitle:w.siteTitle})),I.data.info.Config.Env&&I.data.info.Config.Env.map(function(oe){var ae,pe=oe.split("=");(ae=E.current)===null||ae===void 0||ae.addEnvItem(pe[0],pe[1])}),(C=A.current)===null||C===void 0||C.setFieldValue("imageName",I.data.info.RepoTags[0]),(K=A.current)===null||K===void 0||K.setFieldValue("workDir",I.data.info.Config.WorkingDir),(S=_.current)===null||S===void 0||S.setExposePort(I.data.info.Config.ExposedPorts),I.data.info.Config.Volumes?(q=[],Object.keys(I.data.info.Config.Volumes).map(function(oe,ae){q.push(oe)}),(H=x.current)===null||H===void 0||H.setDefaultDestPath(q)):(le=x.current)===null||le===void 0||le.setDefaultDestPath([]);case 10:case"end":return re.stop()}},s)}));return function(u){return o.apply(this,arguments)}}();return(0,c.useEffect)(function(){B.fromImageId&&f(B.fromImageId)},[B.fromImageId]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(P.Z.Compact,{children:[(0,e.jsx)(D.Z,{label:"\u955C\u50CF",tooltip:B.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",width:"lg",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0}),(0,e.jsx)(X.Z,{label:" ",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.ZP,{type:"primary",onClick:function(){return T(!0)},children:B.redeploy?"\u66F4\u65B0\u955C\u50CF":"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(m.Z,{open:O,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return T(!1)},children:(0,e.jsx)($.Z,{columns:[{title:"Id",dataIndex:"Id",ellipsis:!0,search:!1,width:150},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",render:function(s,u,C,K){return(0,e.jsx)(l.Z.Text,{code:!0,copyable:!0,children:u.RepoTags[0]},u.RepoTags[0])}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(s,u,C,K){return(0,e.jsx)("div",{children:(0,V.ZM)(u.Created*1e3)},u.Id)},sorter:function(s,u){return s.Created-u.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:"100px",render:function(s,u,C,K){return(0,e.jsxs)(P.Z,{split:(0,e.jsx)(L.Z,{type:"vertical"}),children:[(0,e.jsx)(R.ZP,{size:"small",onClick:d()(n()().mark(function S(){return n()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.abrupt("return",f(u.Id));case 1:case"end":return G.stop()}},S)})),type:"link",icon:(0,e.jsx)(r.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(h.Z,{})})},"addImage"),(0,e.jsx)(R.ZP,{size:"small",onClick:d()(n()().mark(function S(){var I;return n()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:u.RepoTags[0]&&((I=i.current)===null||I===void 0||I.setImageName(u.RepoTags[0]));case 1:case"end":return M.stop()}},S)})),type:"link",icon:(0,e.jsx)(r.Z,{title:"\u66F4\u65B0\u7248\u672C",children:(0,e.jsx)(ve.Z,{})})},"updateImage")]})}}],request:function(){var o=d()(n()().mark(function s(u,C,K){var S,I,G,M;return n()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return B.redeploy&&(I=(S=A.current)===null||S===void 0?void 0:S.getFieldValue("imageName"),u.tag=I?I.split(":")[0]:u.tag),w.next=3,(0,Q.KG)({tag:u.tag});case 3:return G=w.sent,M=[],G.data.list&&(M=G.data.list.flatMap(function(H){return H.RepoTags.map(function(q){return{Id:H.Id,Created:H.Created,RepoTags:[q]}})})),w.abrupt("return",{data:M,success:!0,total:M.length});case 7:case"end":return w.stop()}},s)}));return function(s,u,C){return o.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(Fe,{ref:i,imageTableSearchFormRef:b},"remote")]},formRef:b,rowKey:"Id",pagination:{pageSize:5}})},"imageTableList")]})})]})})}var ie=t(60335),je=t(24969),De=t(27496),ne=t(24739),Be=t(63434),te=t(17186),xe=t(66309),Pe=(0,c.forwardRef)(function(B,Z){var y=(0,c.useState)(!1),O=F()(y,2),T=O[0],b=O[1],g=(0,c.useRef)(),A=function(_){var i=(0,c.useState)([]),f=F()(i,2),o=f[0],s=f[1];return(0,c.useEffect)(function(){(0,ie.jV)({md5:_.name}).then(function(u){var C;return s((C=u.data.info.Config.Env)!==null&&C!==void 0?C:[]),!0})},[]),(0,e.jsxs)(p.Z,{bordered:!0,extra:_.action,style:{marginBottom:10},children:[(0,e.jsx)(p.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(D.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Be.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(p.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(P.Z,{direction:"vertical",children:o&&o.map(function(u,C){return(0,e.jsx)(l.Z.Text,{copyable:{icon:(0,e.jsx)(je.Z,{}),onCopy:function(){var S=u.split("=");B.onAddEnv(S[0],S[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:u},style:{width:300},children:u},C)})},"linkEnv")})]})},x=function(_){var i,f,o=!1,s=(i=(f=g.current)===null||f===void 0?void 0:f.getList())!==null&&i!==void 0?i:[];if(s.map(function(C){C.name==_.name&&(o=!0)}),!o){var u;(u=g.current)===null||u===void 0||u.add(_)}};return(0,c.useImperativeHandle)(Z,function(){return{setDefaultLink:function(_){_&&_.map(function(i){i.name!=""&&x(i)})}}}),(0,e.jsxs)(p.Z,{title:"\u5173\u8054\u5BB9\u5668\u6216\u7F51\u7EDC",headerBordered:!0,children:[(0,e.jsx)(te.u,{name:"links",actionRef:g,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(_,i){return b(!0),!1}},copyIconProps:!1,min:0,itemRender:function(_,i){return(0,e.jsx)(A,{action:_.action,name:i.record.name})}}),(0,e.jsx)(m.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:T,onCancel:function(){return b(!1)},children:(0,e.jsx)($.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(_,i,f,o){return(0,e.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Names.map(function(s){return s})},i.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(_,i,f,o){return i!=null&&i.Ports?(0,e.jsx)(P.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Ports.map(function(s,u){return(0,e.jsx)(xe.Z,{color:"#2db7f5",icon:s.PublicPort?(0,e.jsx)(De.Z,{}):"",children:"".concat(s.PublicPort?s.IP+":"+s.PublicPort+"->":"").concat(s.PrivatePort,"/").concat(s.Type)},u)})},i.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(_,i,f,o){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(l.Z.Text,{ellipsis:{tooltip:i.Image},children:i.Image},i.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(_,i,f,o){return[(0,e.jsx)(R.ZP,{type:"link",onClick:function(){(0,ie.jV)({md5:i.Id}).then(function(u){return x({name:u.data.info.Name,alise:u.data.info.Config.Hostname,volume:!1}),b(!1),!0})},children:(0,e.jsx)(h.Z,{})},i.Id)]}}],rowKey:"Id",request:function(){var E=d()(n()().mark(function _(i,f,o){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",new Promise(function(C,K){(0,ie.IE)({tag:i.names}).then(function(S){var I={data:S.data.list,success:!0,total:S.data.list.length};C(I)})}));case 1:case"end":return u.stop()}},_)}));return function(_,i,f){return E.apply(this,arguments)}}(),pagination:{pageSize:5}})})]})}),ye=Pe,Te=t(89035),be=t(20713),de="docker-image",Re=(0,c.forwardRef)(function(B,Z){var y=(0,c.useState)(de),O=F()(y,2),T=O[0],b=O[1],g=(0,c.useRef)(),A=(0,c.useState)(""),x=F()(A,2),E=x[0],_=x[1],i=function(){T!="code"?b("code"):b(de)};(0,c.useImperativeHandle)(Z,function(){return{addEnvItem:function(u,C){var K,S=(K=g.current)===null||K===void 0?void 0:K.getList(),I=!1;if(S==null||S.map(function(M){if(M.name==u){I=!0;return}}),!I){var G;(G=g.current)===null||G===void 0||G.add({name:u,value:C})}}}});function f(s){try{for(var u,C,K=(u=(C=g.current)===null||C===void 0||(C=C.getList())===null||C===void 0?void 0:C.length)!==null&&u!==void 0?u:0,S=K;S>=0;S--){var I;(I=g.current)===null||I===void 0||I.remove(S)}var G=s.split(`
`),M=0;G.map(function(j){var w,H=j.split("=");H.length==2&&((w=g.current)===null||w===void 0||w.add({name:H[0],value:H[1]},M),M++)})}catch(j){}}function o(){if(g){var s,u=(s=g.current)===null||s===void 0?void 0:s.getList();if(u){var C=[];return u.map(function(K){C.push("".concat(K.name,"=").concat(K.value))}),C.join(`
`)}else return""}else return""}return(0,e.jsxs)(p.Z,{title:"\u73AF\u5883\u53D8\u91CF",headerBordered:!0,extra:(0,e.jsx)(r.Z,{title:"\u4EE3\u7801\u7F16\u8F91\u6A21\u5F0F",children:(0,e.jsx)(R.ZP,{icon:(0,e.jsx)(Te.Z,{}),type:T=="code"?"primary":"default",onClick:i,children:"\u4EE3\u7801\u6A21\u5F0F"})}),children:[(0,e.jsx)(te.u,{name:"environment",actionRef:g,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"name",label:"\u53D8\u91CF\u540D",placeholder:""}),(0,e.jsx)(D.Z,{width:"md",name:"value",label:"\u53D8\u91CF\u503C",placeholder:""})]})}),(0,e.jsx)(m.Z,{width:"800px",open:T=="code",onCancel:function(){return b("docker-image")},onOk:function(){f(E),b("docker-image")},children:(0,e.jsx)(be.ZP,{onChange:function(u){return _(u)},value:o(),height:"680px",theme:"light"})})]})}),Ie=Re,Oe=t(86615),Ae=t(64317),Se=(0,c.forwardRef)(function(B,Z){var y=(0,c.useRef)();return(0,c.useImperativeHandle)(Z,function(){return{setDefaultDestPath:function(T){var b,g,A=(b=(g=y.current)===null||g===void 0?void 0:g.getList())!==null&&b!==void 0?b:[];T.length!=0&&T.filter(function(x){return x!=""}).map(function(x){var E=!1;if(A.map(function(i){if(i.dest==x){E=!0;return}}),!E){var _;(_=y.current)===null||_===void 0||_.add({dest:x,permission:"write",inImage:!0,edit:!1})}})}}}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.Z,{title:"\u7AD9\u70B9\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u4F1A\u5C06\u5BB9\u5668\u5185\u4F7F\u7528\u7684\u6570\u636E\u5377\u6302\u8F7D\u5230\u9ED8\u8BA4\u5B58\u50A8\u4E2D",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u7ED1\u5B9A\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:y,copyIconProps:!1,min:0,children:function(T,b,g){var A=g.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",disabled:A.inImage}),(0,e.jsx)(Oe.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(p.Z,{title:"\u6302\u8F7D\u5BBF\u4E3B\u673A\u6587\u4EF6\uFF08Bind\uFF09",subTitle:"\u6302\u8F7D\u5BB9\u5668\u5185\u9700\u8981\u8BBF\u95EE\u5BBF\u4E3B\u673A\u7684\u6587\u4EF6",headerBordered:!0,direction:"column",children:(0,e.jsx)(te.u,{name:"volumes",creatorButtonProps:{creatorButtonText:"\u6302\u8F7D\u76EE\u5F55\u6216\u662F\u5176\u5B83\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsxs)(P.Z.Compact,{children:[(0,e.jsx)(D.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u6216\u76EE\u5F55",name:"host",width:"md"}),(0,e.jsx)(Ae.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md"})]})})})]})}),we=Se,Ze=t(2831),Me=t(10418),ce=t(71338);function Ue(){var B=(0,c.useState)(),Z=F()(B,2),y=Z[0],O=Z[1];return(0,c.useEffect)(function(){(0,Ze.a)().then(function(T){return O(T.data.info)})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(X.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:64,children:(0,e.jsx)(Me.Z,{addonAfter:"MB",min:64})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:.1,max:y==null?void 0:y.NCPU,marks:{0:"\u4E0D\u9650\u5236",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(X.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:256,max:Math.round((y==null?void 0:y.MemTotal)/1024/1024),marks:{0:"\u4E0D\u9650\u5236",1024:"1G",2048:"2G",3072:"3G",4096:"2G"}})})]})}function We(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(te.u,{name:"label",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(D.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var Le=t(52688),ke=t(69677);function me(B){var Z=(0,c.useState)(""),y=F()(Z,2),O=y[0],T=y[1],b=(0,c.useState)("default"),g=F()(b,2),A=g[0],x=g[1],E=function(f){return(0,e.jsx)(R.ZP,{type:A==f.type?"primary":"default",onClick:function(){return _(f.type)},children:f.text})},_=function(f){if(x(f),f=="default")T("");else{var o;T((o=B.value)!==null&&o!==void 0?o:"")}};return(0,c.useEffect)(function(){B.value&&(T(B.value),x("user"))},[B.value]),(0,e.jsx)(X.Z,{label:B.label,tooltip:B.tooltip,name:B.name,children:(0,e.jsxs)(P.Z.Compact,{children:[(0,e.jsx)(E,{text:"\u4F7F\u7528\u9ED8\u8BA4",type:"default"}),(0,e.jsx)(E,{text:"\u81EA\u5B9A\u4E49",type:"user"}),(0,e.jsx)(ke.Z,{disabled:A=="default",value:O,style:{width:"500px"},onChange:function(f){T(f.target.value)}})]})})}me.defaultProps={};var ue=me,$e=t(44771);function Ke(){var B,Z,y,O,T,b,g,A,x=(0,c.useContext)(k.Z),E=x.createFormRef,_=x.volumeListRef,i=x.domainRef,f=x.createEnvRef,o=x.createLinkRef;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($e.Z,{}),(0,e.jsx)(Le.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(ue,{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55",name:"workDir",value:(B=(Z=E.current)===null||Z===void 0?void 0:Z.getFieldValue("workDir"))!==null&&B!==void 0?B:""}),(0,e.jsx)(ue,{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237",name:"user",value:(y=(O=E.current)===null||O===void 0?void 0:O.getFieldValue("user"))!==null&&y!==void 0?y:""}),(0,e.jsx)(ue,{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command",value:(T=(b=E.current)===null||b===void 0?void 0:b.getFieldValue("command"))!==null&&T!==void 0?T:""}),(0,e.jsx)(ue,{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4",name:"entrypoint",value:(g=(A=E.current)===null||A===void 0?void 0:A.getFieldValue("entrypoint"))!==null&&g!==void 0?g:""})]})}var Ve=t(91845),fe=t(62597),Ge=(0,c.forwardRef)(function(B,Z){return(0,c.useImperativeHandle)(Z,function(){return{}}),(0,e.jsx)(p.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0})}),Ne=Ge,He=(0,c.forwardRef)(function(B,Z){var y=(0,c.useState)(""),O=F()(y,2),T=O[0],b=O[1],g=(0,c.useRef)();return(0,c.useImperativeHandle)(Z,function(){return{setExposePort:function(x){if(x){var E,_,i=(E=(_=g.current)===null||_===void 0?void 0:_.getList())!==null&&E!==void 0?E:[];Object.keys(x).map(function(f){var o=!1;if(i.map(function(u){u.dest==f&&(o=!0)}),!o){var s;(s=g.current)===null||s===void 0||s.add({host:"",dest:f})}})}},setHostname:function(x){b(x)}}}),(0,e.jsx)(p.Z,{title:"\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"ports",actionRef:g,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(D.Z,{width:"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u57DF\u540D\u6216\u662F\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u7ED1\u5B9A\u57DF\u540D\u8F6C\u53D1\u6216\u662F\u76F4\u63A5\u66B4\u9732\u7AEF\u53E3",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3"}),(0,e.jsx)(D.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3"})]})})})}),ze=He;function Ye(){var B,Z,y,O=(0,c.useContext)(k.Z),T=O.createFormRef,b=O.volumeListRef,g=O.domainRef,A=O.createEnvRef,x=O.createLinkRef,E=(0,c.useState)(!1),_=F()(E,2),i=_[0],f=_[1],o=(0,se.useSearchParams)(),s=F()(o,2),u=s[0],C=s[1],K=(0,se.useNavigate)(),S=parseInt((B=u.get("id"))!==null&&B!==void 0?B:""),I=(Z=u.get("md5"))!==null&&Z!==void 0?Z:"",G=(y=u.get("imageId"))!==null&&y!==void 0?y:"";return(0,c.useEffect)(function(){if(I||S)(0,fe.iE)({md5:I,id:S}).then(function(j){var w;f(!0),(w=T.current)===null||w===void 0||w.setFieldsValue({siteTitle:j.data.siteTitle,siteName:j.data.siteName,imageName:j.data.env.imageName,privileged:j.data.env.privileged,workDir:j.data.env.workDir,user:j.data.env.user,command:j.data.env.command,entrypoint:j.data.env.entrypoint,shmsize:j.data.env.shmsize,cpus:j.data.env.cpus,memory:j.data.env.memory,environment:j.data.env.environment,label:j.data.env.label,volumesDefault:j.data.env.volumesDefault,volumes:j.data.env.volumes,ports:j.data.env.ports,links:j.data.env.links,restart:j.data.env.restart})});else{var M;f(!1),(M=T.current)===null||M===void 0||M.resetFields()}},[u]),(0,e.jsx)(p.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(J.A,{submitter:{render:function(j,w){return(0,e.jsx)(W.S,{children:w})}},formRef:T,onFinish:function(){var M=d()(n()().mark(function j(w){return n()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return w.md5=I,q.next=3,(0,fe.$G)(w);case 3:return K("/app/list"),q.abrupt("return",!0);case 5:case"end":return q.stop()}},j)}));return function(j){return M.apply(this,arguments)}}(),children:[(0,e.jsxs)(p.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(D.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(j){var w="";if(j.target.value&&!i){var H,q=(0,Ve.N9)(j.target.value.trim(),{toneType:"none",type:"array"});w=q.join(""),(H=T.current)===null||H===void 0||H.setFieldValue("siteName",w)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(D.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:i,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Ce,{redeploy:i,fromImageId:G})]}),(0,e.jsx)(ze,{ref:g}),(0,e.jsx)(ye,{onAddEnv:function(j,w){var H;(H=A.current)===null||H===void 0||H.addEnvItem(j,w)},ref:x}),(0,e.jsx)(Ne,{}),(0,e.jsx)(Ie,{ref:A}),(0,e.jsx)(we,{ref:b}),(0,e.jsx)(p.Z,{title:"\u9AD8\u7EA7\u914D\u7F6E",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,e.jsx)(v.Z,{items:[{label:"\u542F\u52A8\u9879",key:"run-command",children:(0,e.jsx)(Ke,{})},{label:"\u8D44\u6E90\u914D\u7F6E",key:"runtime",children:(0,e.jsx)(Ue,{})},{label:"\u6807\u7B7E",key:"label",children:(0,e.jsx)(We,{})}]})})]},"form")})}},62597:function(ee,N,t){t.d(N,{$G:function(){return F},Ct:function(){return X},Tb:function(){return D},cl:function(){return J},iE:function(){return c},xb:function(){return P}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(54006);function F(m){return p.apply(this,arguments)}function p(){return p=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/site/create-by-image",{method:"POST",data:l}));case 1:case"end":return r.stop()}},m)})),p.apply(this,arguments)}function J(m){return W.apply(this,arguments)}function W(){return W=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/site/get-list",{method:"POST",data:l}));case 1:case"end":return r.stop()}},m)})),W.apply(this,arguments)}function D(m){return v.apply(this,arguments)}function v(){return v=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/log/run",{method:"POST",data:l});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},m)})),v.apply(this,arguments)}function c(m){return k.apply(this,arguments)}function k(){return k=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,a.request)("/api/app/site/get-detail",{data:l,method:"POST"});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},m)})),k.apply(this,arguments)}function X(m){return $.apply(this,arguments)}function $(){return $=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/delete",{method:"POST",data:l}));case 1:case"end":return r.stop()}},m)})),$.apply(this,arguments)}function P(m){return R.apply(this,arguments)}function R(){return R=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/site/delete",{method:"POST",data:l}));case 1:case"end":return r.stop()}},m)})),R.apply(this,arguments)}},2831:function(ee,N,t){t.d(N,{a:function(){return F}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(54006);function F(){return p.apply(this,arguments)}function p(){return p=d()(n()().mark(function J(){return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,a.request)("/api/common/home/info",{method:"POST"});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},J)})),p.apply(this,arguments)}},60335:function(ee,N,t){t.d(N,{IE:function(){return J},IW:function(){return F},KK:function(){return X},LJ:function(){return P},eE:function(){return c},jV:function(){return D}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(54006);function F(m){return p.apply(this,arguments)}function p(){return p=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/status",{method:"POST",data:l}));case 1:case"end":return r.stop()}},m)})),p.apply(this,arguments)}function J(m){return W.apply(this,arguments)}function W(){return W=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/get-list",{data:l,method:"POST"}));case 1:case"end":return r.stop()}},m)})),W.apply(this,arguments)}function D(m){return v.apply(this,arguments)}function v(){return v=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/get-detail",{data:l,method:"POST"}));case 1:case"end":return r.stop()}},m)})),v.apply(this,arguments)}function c(m){return k.apply(this,arguments)}function k(){return k=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/update",{data:l,method:"POST"}));case 1:case"end":return r.stop()}},m)})),k.apply(this,arguments)}function X(){return $.apply(this,arguments)}function $(){return $=d()(n()().mark(function m(){return n()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.abrupt("return",(0,a.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return L.stop()}},m)})),$.apply(this,arguments)}function P(m){return R.apply(this,arguments)}function R(){return R=d()(n()().mark(function m(l){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,a.request)("/api/app/container/export",{method:"POST",data:l,responseType:"blob"}));case 1:case"end":return r.stop()}},m)})),R.apply(this,arguments)}},3393:function(ee,N,t){t.d(N,{Gb:function(){return J},Pn:function(){return c},Rb:function(){return X},YU:function(){return F},_U:function(){return D}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(54006);function F(P){return p.apply(this,arguments)}function p(){return p=d()(n()().mark(function P(R){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/get-detail",{method:"POST",data:R}));case 1:case"end":return l.stop()}},P)})),p.apply(this,arguments)}function J(P){return W.apply(this,arguments)}function W(){return W=d()(n()().mark(function P(R){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-remote",{method:"POST",data:R}));case 1:case"end":return l.stop()}},P)})),W.apply(this,arguments)}function D(P){return v.apply(this,arguments)}function v(){return v=d()(n()().mark(function P(R){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-add",{method:"POST",data:R}));case 1:case"end":return l.stop()}},P)})),v.apply(this,arguments)}function c(P){return k.apply(this,arguments)}function k(){return k=d()(n()().mark(function P(R){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/tag-delete",{method:"POST",data:R}));case 1:case"end":return l.stop()}},P)})),k.apply(this,arguments)}function X(P){return $.apply(this,arguments)}function $(){return $=d()(n()().mark(function P(R){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,a.request)("/api/app/image/export",{method:"POST",data:R,responseType:"blob"}));case 1:case"end":return l.stop()}},P)})),$.apply(this,arguments)}},18148:function(ee,N,t){t.d(N,{$q:function(){return X},KG:function(){return F},T8:function(){return c},Xn:function(){return D},ao:function(){return P},c5:function(){return L},c7:function(){return m}});var z=t(15009),n=t.n(z),Y=t(99289),d=t.n(Y),a=t(54006);function F(U){return p.apply(this,arguments)}function p(){return p=d()(n()().mark(function U(Q){return n()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,a.request)("/api/app/image/get-list",{method:"POST",data:Q}));case 1:case"end":return h.stop()}},U)})),p.apply(this,arguments)}function J(U){return W.apply(this,arguments)}function W(){return W=_asyncToGenerator(_regeneratorRuntime().mark(function U(Q){return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,request("/api/app/log/image-build",{method:"POST",data:Q});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},U)})),W.apply(this,arguments)}function D(U){return v.apply(this,arguments)}function v(){return v=d()(n()().mark(function U(Q){return n()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,a.request)("/api/app/image/get-list-build",{method:"POST",data:Q}));case 1:case"end":return h.stop()}},U)})),v.apply(this,arguments)}function c(U){return k.apply(this,arguments)}function k(){return k=d()(n()().mark(function U(Q){return n()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,a.request)("/api/app/image/get-build-task",{method:"POST",data:Q});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},U)})),k.apply(this,arguments)}function X(U){return $.apply(this,arguments)}function $(){return $=d()(n()().mark(function U(Q){return n()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,a.request)("/api/app/image/delete-build-task",{method:"POST",data:Q});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},U)})),$.apply(this,arguments)}function P(U){return R.apply(this,arguments)}function R(){return R=d()(n()().mark(function U(Q){return n()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,a.request)("/api/app/image/image-delete",{method:"POST",data:Q});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},U)})),R.apply(this,arguments)}function m(){return l.apply(this,arguments)}function l(){return l=d()(n()().mark(function U(){return n()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,a.request)("/api/app/image/image-prune",{method:"POST"});case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},U)})),l.apply(this,arguments)}function L(){return r.apply(this,arguments)}function r(){return r=d()(n()().mark(function U(){return n()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,a.request)("/api/app/image/build-prune",{method:"POST"});case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},U)})),r.apply(this,arguments)}},5251:function(ee,N,t){t.d(N,{FI:function(){return n},ZM:function(){return Y}});function z(d){return d.trim()}function n(d){var a="";d<.1*1024?a=d.toFixed(2)+"B":d<.1*1024*1024?a=(d/1024).toFixed(2)+"KB":d<1*1024*1024*1024?a=(d/(1024*1024)).toFixed(2)+"MB":a=(d/(1024*1024*1024)).toFixed(2)+"GB";var F=a+"",p=F.indexOf("."),J=F.substr(p+1,2);return J=="00"?F.substring(0,p)+F.substr(p+3,2):a}function Y(d){if(d){var a=new Date(d),F=a.getFullYear()+"-",p=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",J=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",W=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",D=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",v=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return F+p+J+W+D+v}}}}]);
