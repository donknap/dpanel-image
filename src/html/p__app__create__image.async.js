"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3985],{44771:function(q,$,t){t.d($,{Z:function(){return s}});var N=t(34041),r=t(25449),H=t(62435),o=t(86074);function s(g){return(0,o.jsx)(r.Z,{name:"restart",initialValue:g.defaultValue?g.defaultValue:"on-failure",children:(0,o.jsx)(N.Z,{options:[{value:"no",label:"\u4E0D\u91CD\u542F"},{value:"on-failure",label:"\u975E\u6B63\u5E38\u9000\u51FA\u65F6,\u6700\u591A5\u6B21 - on failure"},{value:"unless-stopped",label:"\u9000\u51FA\u540E\u91CD\u542F\uFF0C\u4E0D\u5305\u62EC\u624B\u52A8\u505C\u6B62\u7684 - unless stopped"},{value:"always",label:"\u603B\u662F\u9000\u51FA\u540E\u91CD\u542F - always"}]})})}},80821:function(q,$,t){t.d($,{Z:function(){return F}});var N=t(5574),r=t.n(N),H=t(93246),o=t(54006),s=t(31418),g=t(86738),m=t(14726),z=t(62435),Z=t(86074);function F(p){var d=(0,z.useState)(!1),K=r()(d,2),Y=K[0],w=K[1],u=s.Z.useApp(),h=(0,o.useIntl)(),y=function(){w(!0),p.action().then(function(ee){if(w(!1),typeof p.onSuccess=="function"&&p.onSuccess(ee),p.messageSuccess){var Q="";p.messageSuccess.indexOf(".")>-1?Q=h.formatMessage({id:p.messageSuccess}):Q=p.messageSuccess,p.asynced?(0,H.Rk)(u,Q):(0,H.$h)(u,Q)}}).catch(function(ee){w(!1),typeof p.onError=="function"&&p.onError(ee)})};return p.confirm?(0,Z.jsx)(g.Z,{style:{width:500},title:"\u63D0\u793A",description:p.confirm,onConfirm:y,okText:"Yes",cancelText:"No",children:(0,Z.jsx)(m.ZP,{disabled:p.disabled,icon:p.icon,loading:Y,danger:p.danger,type:p.type,children:p.children})}):(0,Z.jsx)(m.ZP,{disabled:p.disabled,icon:p.icon,loading:Y,onClick:y,danger:p.danger,type:p.type,children:p.children})}},35880:function(q,$,t){var N=t(62435),r=(0,N.createContext)({});$.Z=r},4619:function(q,$,t){t.r($),t.d($,{default:function(){return Xe}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(5574),g=t.n(s),m=t(38345),z=t(97269),Z=t(2236),F=t(5966),p=t(92398),d=t(62435),K=t(35880),Y=t(62370),w=t(12010),u=t(78957),h=t(14726),y=t(85576),n=t(75891),ee=t(96074),Q=t(83062),S=t(3393),X=t(18148),k=t(5251),v=t(64789),ve=t(85265),_e=t(38703),ge=t(80821),se=t(54006),e=t(86074),Ee=(0,d.forwardRef)(function(B,U){var P=(0,d.useState)(!1),A=g()(P,2),b=A[0],T=A[1],C=(0,d.useState)(),M=g()(C,2),I=M[0],D=M[1],_=(0,se.useModel)("subscriber"),i=(0,d.useRef)();return _.addDataHandler("imageDownload",function(){var f=_.getDataByType("imageDownload"),c=f.pop();c&&D(c.data)}),(0,d.useImperativeHandle)(U,function(){return{upgradeImage:function(c){var l;return T(!0),(l=i.current)===null||l===void 0||l.setFieldValue("imageUrl",c),(0,S.Gb)({tag:c,type:"pull"})}}}),[(0,e.jsx)(h.ZP,{type:"primary",danger:!0,onClick:function(){var c;T(!0),(c=i.current)===null||c===void 0||c.resetFields(),D({start:{downloading:0,extracting:0}})},children:"\u4E0B\u8F7D&\u66F4\u65B0\u955C\u50CF"},"remoteBtn"),(0,e.jsxs)(ve.Z,{open:b,title:"\u4E0B\u8F7D\u8FDC\u7A0B\u955C\u50CF",width:800,onClose:function(){return T(!1)},footer:!1,children:[(0,e.jsx)(m.Z,{children:(0,e.jsxs)(u.Z,{direction:"vertical",size:"middle",children:[(0,e.jsxs)("div",{children:["1\u3001\u955C\u50CF\u540D\u79F0\u4E2D\u4E0D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C \u9ED8\u8BA4\u4ECE ",(0,e.jsx)("a",{href:"https://hub.docker.com/",target:"_blank",children:"docker hub"})," \u4E2D\u4E0B\u8F7D\uFF0C \u4F60\u53EF\u4EE5\u5728\u4E0A\u9762",(0,e.jsx)("a",{href:"https://hub.docker.com/search?q=",target:"_blank",children:"\u3010\u67E5\u627E\u3011"}),"\u9700\u8981\u7684\u955C\u50CF"]}),(0,e.jsxs)("div",{children:["2\u3001\u955C\u50CF\u4E2D\u5305\u542B\u4ED3\u5E93\u5730\u5740\u65F6\uFF0C\u8BF7\u786E",(0,e.jsx)("a",{href:"/image/registry",target:"_blank",children:"\u3010\u6DFB\u52A0\u3011"}),"\u8FC7\u8BE5\u4ED3\u5E93\uFF0C\u5E76\u6709 Pull \u6743\u9650"]}),(0,e.jsx)("div",{children:"3\u3001\u65E0\u7528\u7684\u955C\u50CF\u53CA\u7F13\u5B58\u6587\u4EF6\u53EF\u4EE5\u5728\u955C\u50CF\u7BA1\u7406\u4E2D\u8FDB\u884C\u5220\u9664\u548C\u6E05\u7406"})]})}),(0,e.jsx)(m.Z,{title:"\u4E0B\u8F7D\u955C\u50CF",headerBordered:!0,children:(0,e.jsxs)(z.A,{submitter:!1,formRef:i,children:[(0,e.jsxs)(u.Z.Compact,{children:[(0,e.jsx)(F.Z,{width:400,name:"imageUrl",placeholder:"\u8BF7\u8F93\u5165\u955C\u50CF\u5730\u5740"}),(0,e.jsx)(ge.Z,{action:function(){var c,l,a=(c=(l=i.current)===null||l===void 0?void 0:l.getFieldValue("imageUrl"))!==null&&c!==void 0?c:"";return(0,S.Gb)({tag:a,type:"pull"})},onSuccess:function(){var c,l,a,E;D({finish:{downloading:100,extracting:100}}),T(!1);var W=(c=(l=i.current)===null||l===void 0?void 0:l.getFieldValue("imageUrl"))!==null&&c!==void 0?c:"";(a=B.imageTableSearchFormRef.current)===null||a===void 0||a.setFieldValue("tag",W),(E=B.imageTableSearchFormRef.current)===null||E===void 0||E.submit()},messageSuccess:"\u4E0B\u8F7D\u5B8C\u6210",children:"\u4E0B\u8F7D\u955C\u50CF"})]}),(0,e.jsx)(Y.Z,{label:"\u4E0B\u8F7D\u8FDB\u5EA6",children:I&&Object.keys(I).map(function(f){return(0,e.jsx)(_e.Z,{percent:I[f].downloading,success:{percent:I[f].extracting}},f)})})]})})]},"remoteDrawer")]}),je=Ee;function Fe(B){var U=(0,d.useState)(!1),P=g()(U,2),A=P[0],b=P[1],T=(0,d.useRef)(),C=(0,d.useContext)(K.Z),M=C.createFormRef,I=C.volumeListRef,D=C.createEnvRef,_=C.domainRef,i=(0,d.useRef)(),f=function(){var c=o()(r()().mark(function l(a){var E,W,R,O,V,L,j,x,G,J,le;return r()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return b(!1),re.next=3,(0,S.YU)({md5:a});case 3:O=re.sent,B.redeploy||(x=(V=M.current)===null||V===void 0?void 0:V.getFieldsValue(),(L=M.current)===null||L===void 0||L.resetFields(),(j=M.current)===null||j===void 0||j.setFieldsValue({siteName:x.siteName,siteTitle:x.siteTitle})),O.data.info.Config.Env&&O.data.info.Config.Env.map(function(oe){var ue,he=oe.split("=");(ue=D.current)===null||ue===void 0||ue.addEnvItem(he[0],he[1])}),(E=M.current)===null||E===void 0||E.setFieldValue("imageName",O.data.info.RepoTags[0]),(W=M.current)===null||W===void 0||W.setFieldValue("workDir",O.data.info.Config.WorkingDir),(R=_.current)===null||R===void 0||R.setExposePort(O.data.info.Config.ExposedPorts),O.data.info.Config.Volumes?(J=[],Object.keys(O.data.info.Config.Volumes).map(function(oe,ue){J.push(oe)}),(G=I.current)===null||G===void 0||G.setDefaultDestPath(J)):(le=I.current)===null||le===void 0||le.setDefaultDestPath([]);case 10:case"end":return re.stop()}},l)}));return function(a){return c.apply(this,arguments)}}();return(0,d.useEffect)(function(){B.fromImageId&&f(B.fromImageId)},[B.fromImageId]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(u.Z.Compact,{children:[(0,e.jsx)(F.Z,{label:"\u955C\u50CF",tooltip:B.redeploy?"\u66F4\u65B0\u5BB9\u5668\u65F6,\u53EA\u53EF\u4EE5\u9009\u62E9\u8BE5\u955C\u50CF\u4E0B\u7684\u4E0D\u540Ctag.\u4E5F\u53EF\u4EE5\u5F3A\u5236\u66F4\u65B0\u5DF2\u90E8\u7F72tag,\u66F4\u6B21\u90E8\u7F72":"\u65B0\u5EFA\u5BB9\u5668\u65F6,\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u955C\u50CF,\u4E5F\u53EF\u4EE5\u4E0B\u8F7D\u5168\u65B0\u7684\u955C\u50CF\u6216\u662F\u66F4\u65B0\u672C\u5730\u955C\u50CF\u7684tag",name:"imageName",width:"lg",disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u955C\u50CF\uFF0C\u5982\u679C\u662F\u8FDC\u7A0B\u955C\u50CF\u8BF7\u5148\u4E0B\u8F7D",rules:[{required:!0}],required:!0}),(0,e.jsx)(Y.Z,{label:" ",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return b(!0)},children:"\u9009\u62E9\u955C\u50CF"},"showBtn"),(0,e.jsx)(y.Z,{open:A,width:1024,title:"\u9009\u62E9\u955C\u50CF",footer:!1,onCancel:function(){return b(!1)},children:(0,e.jsx)(w.Z,{columns:[{title:"Id",dataIndex:"Id",ellipsis:!0,search:!1,width:150},{title:"\u955C\u50CF\u540D\u79F0",dataIndex:"tag",render:function(l,a,E,W){return(0,e.jsx)(n.Z.Text,{code:!0,copyable:!0,children:a.RepoTags[0]},a.RepoTags[0])}},{title:"\u521B\u5EFA\u65E5\u671F",dataIndex:"Created",ellipsis:!0,search:!1,width:"180px",render:function(l,a,E,W){return(0,e.jsx)("div",{children:(0,k.ZM)(a.Created*1e3)},a.Id)},sorter:function(l,a){return l.Created-a.Created}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:"100px",render:function(l,a,E,W){return(0,e.jsx)(u.Z,{split:(0,e.jsx)(ee.Z,{type:"vertical"}),children:(0,e.jsx)(h.ZP,{size:"small",onClick:o()(r()().mark(function R(){return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",f(a.Id));case 1:case"end":return V.stop()}},R)})),type:"link",icon:(0,e.jsx)(Q.Z,{title:"\u4F7F\u7528\u955C\u50CF",children:(0,e.jsx)(v.Z,{})})},"addImage")})}}],request:function(){var c=o()(r()().mark(function l(a,E,W){var R,O,V,L;return r()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return B.redeploy&&(O=(R=M.current)===null||R===void 0?void 0:R.getFieldValue("imageName"),a.tag=O?O.split(":")[0]:a.tag),x.next=3,(0,X.KG)({tag:a.tag});case 3:return V=x.sent,L=[],V.data.list&&(L=V.data.list.flatMap(function(G){return G.RepoTags.map(function(J){return{Id:G.Id,Created:G.Created,RepoTags:[J]}})})),x.abrupt("return",{data:L,success:!0,total:L.length});case 7:case"end":return x.stop()}},l)}));return function(l,a,E){return c.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(je,{ref:i,imageTableSearchFormRef:T},"remote")]},formRef:T,rowKey:"Id",pagination:{pageSize:5}})},"imageTableList")]})})]})})}var ie=t(60335),Ce=t(24969),De=t(27496),ne=t(24739),Be=t(63434),te=t(17186),Pe=t(66309),xe=(0,d.forwardRef)(function(B,U){var P=(0,d.useState)(!1),A=g()(P,2),b=A[0],T=A[1],C=(0,d.useRef)(),M=function(_){var i=(0,d.useState)([]),f=g()(i,2),c=f[0],l=f[1];return(0,d.useEffect)(function(){(0,ie.jV)({md5:_.name}).then(function(a){var E;return l((E=a.data.info.Config.Env)!==null&&E!==void 0?E:[]),!0})},[]),(0,e.jsxs)(m.Z,{bordered:!0,extra:_.action,style:{marginBottom:10},children:[(0,e.jsx)(m.Z,{title:"\u5173\u8054\u4FE1\u606F",children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(F.Z,{label:"\u5BB9\u5668\u540D\u79F0",name:"name",width:"md",readonly:!0}),(0,e.jsx)(F.Z,{label:"\u8BBF\u95EEHostName",name:"alise",width:"md",tooltip:"\u901A\u8FC7\u914D\u7F6E\u6B64\u540D\u79F0\uFF0C\u5728\u5BB9\u5668\u5185\u90E8\u8FDB\u884C\u8BF7\u6C42\u8BBF\u95EE"}),(0,e.jsx)(Be.Z,{label:"\u5173\u8054\u5B58\u50A8",name:"volume"})]})}),(0,e.jsx)(m.Z,{title:"\u73AF\u5883\u53D8\u91CF",children:(0,e.jsx)(u.Z,{direction:"vertical",children:c&&c.map(function(a,E){return(0,e.jsx)(n.Z.Text,{copyable:{icon:(0,e.jsx)(Ce.Z,{}),onCopy:function(){var R=a.split("=");B.onAddEnv(R[0],R[1])},tooltips:["add env","success"]},code:!0,ellipsis:{tooltip:a},style:{width:300},children:a},E)})},"linkEnv")})]})},I=function(_){var i,f,c=!1,l=(i=(f=C.current)===null||f===void 0?void 0:f.getList())!==null&&i!==void 0?i:[];if(l.map(function(E){E.name==_.name&&(c=!0)}),!c){var a;(a=C.current)===null||a===void 0||a.add(_)}};return(0,d.useImperativeHandle)(U,function(){return{setDefaultLink:function(_){_&&_.map(function(i){i.name!=""&&I(i)})}}}),(0,e.jsxs)(m.Z,{title:"\u5173\u8054\u5BB9\u5668\u6216\u7F51\u7EDC",headerBordered:!0,children:[(0,e.jsx)(te.u,{name:"links",actionRef:C,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5173\u8054"},actionGuard:{beforeAddRow:function(_,i){return T(!0),!1}},copyIconProps:!1,min:0,itemRender:function(_,i){return(0,e.jsx)(M,{action:_.action,name:i.record.name})}}),(0,e.jsx)(y.Z,{title:"\u9009\u62E9\u5BB9\u5668",width:1024,footer:!1,open:b,onCancel:function(){return T(!1)},children:(0,e.jsx)(w.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"names",render:function(_,i,f,c){return(0,e.jsx)(u.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Names.map(function(l){return l})},i.Id)}},{title:"\u7AEF\u53E3",dataIndex:"ports",search:!1,render:function(_,i,f,c){return i!=null&&i.Ports?(0,e.jsx)(u.Z,{direction:"vertical",style:{textAlign:"left"},children:i==null?void 0:i.Ports.map(function(l,a){return(0,e.jsx)(Pe.Z,{color:"#2db7f5",icon:l.PublicPort?(0,e.jsx)(De.Z,{}):"",children:"".concat(l.PublicPort?l.IP+":"+l.PublicPort+"->":"").concat(l.PrivatePort,"/").concat(l.Type)},a)})},i.Id):(0,e.jsx)(e.Fragment,{})}},{title:"\u8FD0\u884C\u5BB9\u5668",search:!1,render:function(_,i,f,c){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(n.Z.Text,{ellipsis:{tooltip:i.Image},children:i.Image},i.Id)})}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",ellipsis:!0,width:100,render:function(_,i,f,c){return[(0,e.jsx)(h.ZP,{type:"link",onClick:function(){(0,ie.jV)({md5:i.Id}).then(function(a){return I({name:a.data.info.Name,alise:a.data.info.Config.Hostname,volume:!1}),T(!1),!0})},children:(0,e.jsx)(v.Z,{})},i.Id)]}}],rowKey:"Id",request:function(){var D=o()(r()().mark(function _(i,f,c){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(E,W){(0,ie.IE)({name:i.name}).then(function(R){var O={data:R.data.list,success:!0,total:R.data.list.length};E(O)})}));case 1:case"end":return a.stop()}},_)}));return function(_,i,f){return D.apply(this,arguments)}}(),pagination:{pageSize:5}})})]})}),ye=xe,be=t(89035),Te=t(20713),de="docker-image",Ie=(0,d.forwardRef)(function(B,U){var P=(0,d.useState)(de),A=g()(P,2),b=A[0],T=A[1],C=(0,d.useRef)(),M=(0,d.useState)(""),I=g()(M,2),D=I[0],_=I[1],i=function(){b!="code"?T("code"):T(de)};(0,d.useImperativeHandle)(U,function(){return{addEnvItem:function(a,E){var W,R=(W=C.current)===null||W===void 0?void 0:W.getList(),O=!1;if(R==null||R.map(function(L){if(L.name==a){O=!0;return}}),!O){var V;(V=C.current)===null||V===void 0||V.add({name:a,value:E})}}}});function f(l){try{for(var a,E,W=(a=(E=C.current)===null||E===void 0||(E=E.getList())===null||E===void 0?void 0:E.length)!==null&&a!==void 0?a:0,R=W;R>=0;R--){var O;(O=C.current)===null||O===void 0||O.remove(R)}var V=l.split(`
`),L=0;V.map(function(j){var x,G=j.split("=");G.length==2&&((x=C.current)===null||x===void 0||x.add({name:G[0],value:G[1]},L),L++)})}catch(j){}}function c(){if(C){var l,a=(l=C.current)===null||l===void 0?void 0:l.getList();if(a){var E=[];return a.map(function(W){E.push("".concat(W.name,"=").concat(W.value))}),E.join(`
`)}else return""}else return""}return(0,e.jsxs)(m.Z,{title:"\u73AF\u5883\u53D8\u91CF",headerBordered:!0,extra:(0,e.jsx)(Q.Z,{title:"\u4EE3\u7801\u7F16\u8F91\u6A21\u5F0F",children:(0,e.jsx)(h.ZP,{icon:(0,e.jsx)(be.Z,{}),type:b=="code"?"primary":"default",onClick:i,children:"\u4EE3\u7801\u6A21\u5F0F"})}),children:[(0,e.jsx)(te.u,{name:"environment",actionRef:C,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u73AF\u5883\u53D8\u91CF"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(F.Z,{width:"md",name:"name",label:"\u53D8\u91CF\u540D",placeholder:""}),(0,e.jsx)(F.Z,{width:"md",name:"value",label:"\u53D8\u91CF\u503C",placeholder:""})]})}),(0,e.jsx)(y.Z,{width:"800px",open:b=="code",onCancel:function(){return T("docker-image")},onOk:function(){f(D),T("docker-image")},children:(0,e.jsx)(Te.ZP,{onChange:function(a){return _(a)},value:c(),height:"680px",theme:"light"})})]})}),Re=Ie,Oe=t(86615),Se=t(64317),Ae=(0,d.forwardRef)(function(B,U){var P=(0,d.useRef)();return(0,d.useImperativeHandle)(U,function(){return{setDefaultDestPath:function(b){var T,C,M=(T=(C=P.current)===null||C===void 0?void 0:C.getList())!==null&&T!==void 0?T:[];b.length!=0&&b.filter(function(I){return I!=""}).map(function(I){var D=!1;if(M.map(function(i){if(i.dest==I){D=!0;return}}),!D){var _;(_=P.current)===null||_===void 0||_.add({dest:I,permission:"write",inImage:!0,edit:!1})}})}}}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z,{title:"\u7AD9\u70B9\u5B58\u50A8\uFF08Volume\uFF09",subTitle:"\u9ED8\u8BA4\u4F1A\u5C06\u5BB9\u5668\u5185\u4F7F\u7528\u7684\u6570\u636E\u5377\u6302\u8F7D\u5230\u9ED8\u8BA4\u5B58\u50A8\u4E2D",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"volumesDefault",creatorButtonProps:{creatorButtonText:"\u7ED1\u5B9A\u76EE\u5F55\u5230\u9ED8\u8BA4\u5B58\u50A8"},actionRef:P,copyIconProps:!1,min:0,children:function(b,T,C){var M=C.getCurrentRowData();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{width:"lg",name:"dest",label:"\u5BB9\u5668\u5185\u8DEF\u5F84",disabled:M.inImage}),(0,e.jsx)(Oe.Z.Group,{hidden:!0,name:"inImage",label:"\u955C\u50CF\u5185\u6302\u8F7D",valueEnum:{1:"\u662F",0:"\u5426"}})]})}})}),(0,e.jsx)(m.Z,{title:"\u6302\u8F7D\u5BBF\u4E3B\u673A\u6587\u4EF6\uFF08Bind\uFF09",subTitle:"\u6302\u8F7D\u5BB9\u5668\u5185\u9700\u8981\u8BBF\u95EE\u5BBF\u4E3B\u673A\u7684\u6587\u4EF6",headerBordered:!0,direction:"column",children:(0,e.jsx)(te.u,{name:"volumes",creatorButtonProps:{creatorButtonText:"\u6302\u8F7D\u76EE\u5F55\u6216\u662F\u5176\u5B83\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsxs)(u.Z.Compact,{children:[(0,e.jsx)(F.Z,{label:"\u5BBF\u4E3B\u673A\u6587\u4EF6\u6216\u76EE\u5F55",name:"host",width:"md"}),(0,e.jsx)(Se.Z,{label:" ",valueEnum:{write:"\u8BFB\u5199",readonly:"\u53EA\u8BFB"},initialValue:"write",name:"permission"})]}),(0,e.jsx)(F.Z,{label:"\u5BB9\u5668\u5185\u8DEF\u5F84",name:"dest",width:"md"})]})})})]})}),Me=Ae,Ze=t(2831),we=t(10418),ce=t(71338);function Ue(){var B=(0,d.useState)(),U=g()(B,2),P=U[0],A=U[1];return(0,d.useEffect)(function(){(0,Ze.a)().then(function(b){return A(b.data.info)})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Y.Z,{label:"\u5171\u4EAB\u5185\u5B58\u5927\u5C0F - /dev/shm",name:"shmsize",initialValue:64,children:(0,e.jsx)(we.Z,{addonAfter:"MB",min:64})}),(0,e.jsx)(Y.Z,{label:"\u6700\u5927Cpu\u914D\u989D",name:"cpus",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:.1,max:P==null?void 0:P.NCPU,marks:{0:"\u4E0D\u9650\u5236",.5:"0.5\u6838",1:"1\u6838",1.5:"1.5\u6838",2:"2\u6838",4:"4\u6838",6:"6\u6838",8:"8\u6838"}})}),(0,e.jsx)(Y.Z,{label:"\u6700\u5927\u5185\u5B58\u914D\u989D",name:"memory",tooltip:"0 \u4E3A\u4E0D\u9650\u5236",children:(0,e.jsx)(ce.Z,{step:256,max:Math.round((P==null?void 0:P.MemTotal)/1024/1024),marks:{0:"\u4E0D\u9650\u5236",1024:"1G",2048:"2G",3072:"3G",4096:"2G"}})})]})}function We(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(te.u,{name:"label",creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BB9\u5668\u6807\u7B7E"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(F.Z,{width:"md",name:"name",label:"\u540D\u79F0",placeholder:""}),(0,e.jsx)(F.Z,{width:"md",name:"value",label:"\u503C",placeholder:""})]})})})}var Le=t(52688),Ke=t(97857),me=t.n(Ke),ke=t(69677);function fe(B){var U=(0,d.useState)(""),P=g()(U,2),A=P[0],b=P[1],T=(0,d.useState)("default"),C=g()(T,2),M=C[0],I=C[1],D=function(f){return(0,e.jsx)(h.ZP,{type:M==f.type?"primary":"default",onClick:function(){return _(f.type)},children:f.text})},_=function(f){I(f),f=="default"&&B.value&&b(B.value)};return(0,d.useEffect)(function(){B.value&&b(B.value)},[B.value]),B.fieldProps.children=(0,e.jsxs)(u.Z.Compact,{block:!0,children:[(0,e.jsx)(D,{text:"\u4F7F\u7528\u9ED8\u8BA4",type:"default"}),(0,e.jsx)(D,{text:"\u81EA\u5B9A\u4E49",type:"user"}),(0,e.jsx)(ke.Z,{disabled:M=="default",value:A,onChange:function(f){b(f.target.value)}})]}),(0,e.jsx)(Y.Z,me()(me()({},B.fieldProps),{},{name:B.name}))}fe.defaultProps={};var ae=fe,$e=t(44771);function Ve(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($e.Z,{}),(0,e.jsx)(Le.Z,{name:"privileged",label:"\u8D4B\u4E88\u5BB9\u5668Root\u6743\u9650",initialValue:!1}),(0,e.jsx)(ae,{fieldProps:{label:"\u5DE5\u4F5C\u76EE\u5F55",tooltip:"\u9ED8\u8BA4\u4F7F\u7528\u955C\u50CF\u4E2D\u6307\u5B9A\u7684\u5DE5\u4F5C\u76EE\u5F55"},name:"workDir"}),(0,e.jsx)(ae,{fieldProps:{label:"User",tooltip:"\u5728\u5BB9\u5668\u4E2D\u8FD0\u884C\u547D\u4EE4\u7684\u7528\u6237"},name:"user"}),(0,e.jsx)(ae,{fieldProps:{label:"Command",tooltip:"\u542F\u52A8\u5BB9\u5668\u65F6\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u4EE5\u7A7A\u683C\u5206\u9694",name:"command"},name:"command"}),(0,e.jsx)(ae,{fieldProps:{label:"Entrypoint",tooltip:"\u65E0\u6CD5\u8986\u76D6\u955C\u50CF\u4E2D\u5DF2\u7ECF\u6307\u5B9A\u7684 Entrypoint \u547D\u4EE4"},name:"entrypoint"})]})}var Ge=t(91845),pe=t(62597),Ne=(0,d.forwardRef)(function(B,U){return(0,d.useImperativeHandle)(U,function(){return{}}),(0,e.jsx)(m.Z,{title:"\u5173\u8054\u7F51\u7EDC",headerBordered:!0})}),He=Ne,ze=(0,d.forwardRef)(function(B,U){var P=(0,d.useState)(""),A=g()(P,2),b=A[0],T=A[1],C=(0,d.useRef)();return(0,d.useImperativeHandle)(U,function(){return{setExposePort:function(I){if(I){var D,_,i=(D=(_=C.current)===null||_===void 0?void 0:_.getList())!==null&&D!==void 0?D:[];Object.keys(I).map(function(f){var c=!1;if(i.map(function(a){a.dest==f&&(c=!0)}),!c){var l;(l=C.current)===null||l===void 0||l.add({type:"port",host:"",dest:f})}})}},setHostname:function(I){T(I)}}}),(0,e.jsx)(m.Z,{title:"\u66B4\u9732\u7AEF\u53E3",headerBordered:!0,children:(0,e.jsx)(te.u,{name:"ports",actionRef:C,creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u5BF9\u5916\u90E8\u8BBF\u95EE"},min:0,copyIconProps:!1,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(F.Z,{width:"md",name:"host",label:"\u5916\u90E8\u8BBF\u95EE\u57DF\u540D\u6216\u662F\u7AEF\u53E3",tooltip:"\u5BF9\u5916\u8BBF\u95EE\u53EF\u4EE5\u901A\u8FC7\u7ED1\u5B9A\u57DF\u540D\u8F6C\u53D1\u6216\u662F\u76F4\u63A5\u66B4\u9732\u7AEF\u53E3",placeholder:"\u7559\u7A7A\u5C06\u4F7F\u7528\u968F\u673A\u7AEF\u53E3"}),(0,e.jsx)(F.Z,{label:"\u5BB9\u5668\u5185\u7AEF\u53E3",width:"md",name:"dest",placeholder:"\u6784\u5EFA\u65F6 Expose \u6307\u5B9A\u7684\u7AEF\u53E3"})]})})})}),Ye=ze;function Xe(){var B,U,P,A=(0,d.useContext)(K.Z),b=A.createFormRef,T=A.volumeListRef,C=A.domainRef,M=A.createEnvRef,I=A.createLinkRef,D=(0,d.useState)(!1),_=g()(D,2),i=_[0],f=_[1],c=(0,se.useSearchParams)(),l=g()(c,2),a=l[0],E=l[1],W=(0,se.useNavigate)(),R=parseInt((B=a.get("id"))!==null&&B!==void 0?B:""),O=(U=a.get("md5"))!==null&&U!==void 0?U:"",V=(P=a.get("imageId"))!==null&&P!==void 0?P:"";return(0,d.useEffect)(function(){if(O||R)(0,pe.iE)({md5:O,id:R}).then(function(j){var x;f(!0),(x=b.current)===null||x===void 0||x.setFieldsValue({siteTitle:j.data.siteTitle,siteName:j.data.siteName,imageName:j.data.env.imageName,privileged:j.data.env.privileged,workDir:j.data.env.workDir,user:j.data.env.user,command:j.data.env.command,entrypoint:j.data.env.entrypoint,shmsize:j.data.env.shmsize,cpus:j.data.env.cpus,memory:j.data.env.memory,environment:j.data.env.environment,label:j.data.env.label,volumesDefault:j.data.env.volumesDefault,volumes:j.data.env.volumes,ports:j.data.env.ports,links:j.data.env.links,restart:j.data.env.restart})});else{var L;f(!1),(L=b.current)===null||L===void 0||L.resetFields()}},[a]),(0,e.jsx)(m.Z,{direction:"column",gutter:[0,10],children:(0,e.jsxs)(z.A,{submitter:{render:function(j,x){return(0,e.jsx)(Z.S,{children:x})}},formRef:b,onFinish:function(){var L=o()(r()().mark(function j(x){return r()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return x.md5=O,J.next=3,(0,pe.$G)(x);case 3:return W("/app/list"),J.abrupt("return",!0);case 5:case"end":return J.stop()}},j)}));return function(j){return L.apply(this,arguments)}}(),children:[(0,e.jsxs)(m.Z,{title:"\u57FA\u7840\u4FE1\u606F",headerBordered:!0,children:[(0,e.jsx)(F.Z,{name:"siteTitle",label:"\u7AD9\u70B9\u540D\u79F0",required:!0,rules:[{required:!0}],fieldProps:{onChange:function(j){var x="";if(j.target.value&&!i){var G,J=(0,Ge.N9)(j.target.value.trim(),{toneType:"none",type:"array"});x=J.join(""),(G=b.current)===null||G===void 0||G.setFieldValue("siteName",x)}}},placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(F.Z,{name:"siteName",label:"\u7AD9\u70B9\u6807\u8BC6",tooltip:"\u7AD9\u70B9\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u6807\u8BC6\u7AD9\u70B9\u548C\u5185\u90E8\u8BBF\u95EE",required:!0,disabled:i,rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u7AD9\u70B9\u540D\u79F0"}),(0,e.jsx)(Fe,{redeploy:i,fromImageId:V})]}),(0,e.jsx)(Ye,{ref:C}),(0,e.jsx)(ye,{onAddEnv:function(j,x){var G;(G=M.current)===null||G===void 0||G.addEnvItem(j,x)},ref:I}),(0,e.jsx)(He,{}),(0,e.jsx)(Re,{ref:M}),(0,e.jsx)(Me,{ref:T}),(0,e.jsx)(m.Z,{title:"\u9AD8\u7EA7\u914D\u7F6E",headerBordered:!0,collapsible:!0,defaultCollapsed:!0,children:(0,e.jsx)(p.Z,{items:[{label:"\u542F\u52A8\u9879",key:"run-command",children:(0,e.jsx)(Ve,{})},{label:"\u8D44\u6E90\u914D\u7F6E",key:"runtime",children:(0,e.jsx)(Ue,{})},{label:"\u6807\u7B7E",key:"label",children:(0,e.jsx)(We,{})}]})})]},"form")})}},62597:function(q,$,t){t.d($,{$G:function(){return g},Tb:function(){return F},cl:function(){return z},iE:function(){return d},xb:function(){return Y}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(54006);function g(u){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/site/create-by-image",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function z(u){return Z.apply(this,arguments)}function Z(){return Z=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/site/get-list",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),Z.apply(this,arguments)}function F(u){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,s.request)("/api/app/log/run",{method:"POST",data:h});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function d(u){return K.apply(this,arguments)}function K(){return K=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,s.request)("/api/app/site/get-detail",{data:h,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},u)})),K.apply(this,arguments)}function Y(u){return w.apply(this,arguments)}function w(){return w=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/site/delete",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),w.apply(this,arguments)}},2831:function(q,$,t){t.d($,{a:function(){return g}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(54006);function g(){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function z(){return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,s.request)("/api/common/home/info",{method:"POST"});case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},z)})),m.apply(this,arguments)}},60335:function(q,$,t){t.d($,{IE:function(){return z},IW:function(){return g},KK:function(){return Y},eE:function(){return d},jV:function(){return F}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(54006);function g(u){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/container/status",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function z(u){return Z.apply(this,arguments)}function Z(){return Z=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/container/get-list",{data:h,method:"POST"}));case 1:case"end":return n.stop()}},u)})),Z.apply(this,arguments)}function F(u){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/container/get-detail",{data:h,method:"POST"}));case 1:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function d(u){return K.apply(this,arguments)}function K(){return K=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/container/update",{data:h,method:"POST"}));case 1:case"end":return n.stop()}},u)})),K.apply(this,arguments)}function Y(){return w.apply(this,arguments)}function w(){return w=o()(r()().mark(function u(){return r()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,s.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return y.stop()}},u)})),w.apply(this,arguments)}},3393:function(q,$,t){t.d($,{Gb:function(){return z},Pn:function(){return d},Rb:function(){return Y},YU:function(){return g},_U:function(){return F}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(54006);function g(u){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/image/get-detail",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function z(u){return Z.apply(this,arguments)}function Z(){return Z=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/image/tag-remote",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),Z.apply(this,arguments)}function F(u){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/image/tag-add",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function d(u){return K.apply(this,arguments)}function K(){return K=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/image/tag-delete",{method:"POST",data:h}));case 1:case"end":return n.stop()}},u)})),K.apply(this,arguments)}function Y(u){return w.apply(this,arguments)}function w(){return w=o()(r()().mark(function u(h){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/app/image/export",{method:"POST",data:h,responseType:"blob"}));case 1:case"end":return n.stop()}},u)})),w.apply(this,arguments)}},18148:function(q,$,t){t.d($,{$q:function(){return Y},KG:function(){return g},T8:function(){return d},Xn:function(){return F},ao:function(){return u},c5:function(){return ee},c7:function(){return y}});var N=t(15009),r=t.n(N),H=t(99289),o=t.n(H),s=t(54006);function g(S){return m.apply(this,arguments)}function m(){return m=o()(r()().mark(function S(X){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,s.request)("/api/app/image/get-list",{method:"POST",data:X}));case 1:case"end":return v.stop()}},S)})),m.apply(this,arguments)}function z(S){return Z.apply(this,arguments)}function Z(){return Z=_asyncToGenerator(_regeneratorRuntime().mark(function S(X){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,request("/api/app/log/image-build",{method:"POST",data:X});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},S)})),Z.apply(this,arguments)}function F(S){return p.apply(this,arguments)}function p(){return p=o()(r()().mark(function S(X){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,s.request)("/api/app/image/get-list-build",{method:"POST",data:X}));case 1:case"end":return v.stop()}},S)})),p.apply(this,arguments)}function d(S){return K.apply(this,arguments)}function K(){return K=o()(r()().mark(function S(X){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,s.request)("/api/app/image/get-build-task",{method:"POST",data:X});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},S)})),K.apply(this,arguments)}function Y(S){return w.apply(this,arguments)}function w(){return w=o()(r()().mark(function S(X){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,s.request)("/api/app/image/delete-build-task",{method:"POST",data:X});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},S)})),w.apply(this,arguments)}function u(S){return h.apply(this,arguments)}function h(){return h=o()(r()().mark(function S(X){return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,s.request)("/api/app/image/image-delete",{method:"POST",data:X});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},S)})),h.apply(this,arguments)}function y(){return n.apply(this,arguments)}function n(){return n=o()(r()().mark(function S(){return r()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,(0,s.request)("/api/app/image/image-prune",{method:"POST"});case 2:return k.abrupt("return",k.sent);case 3:case"end":return k.stop()}},S)})),n.apply(this,arguments)}function ee(){return Q.apply(this,arguments)}function Q(){return Q=o()(r()().mark(function S(){return r()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,(0,s.request)("/api/app/image/build-prune",{method:"POST"});case 2:return k.abrupt("return",k.sent);case 3:case"end":return k.stop()}},S)})),Q.apply(this,arguments)}},5251:function(q,$,t){t.d($,{FI:function(){return r},ZM:function(){return H}});function N(o){return o.trim()}function r(o){var s="";o<.1*1024?s=o.toFixed(2)+"B":o<.1*1024*1024?s=(o/1024).toFixed(2)+"KB":o<1*1024*1024*1024?s=(o/(1024*1024)).toFixed(2)+"MB":s=(o/(1024*1024*1024)).toFixed(2)+"GB";var g=s+"",m=g.indexOf("."),z=g.substr(m+1,2);return z=="00"?g.substring(0,m)+g.substr(m+3,2):s}function H(o){if(o){var s=new Date(o),g=s.getFullYear()+"-",m=(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"-",z=(s.getDate()<10?"0"+s.getDate():s.getDate())+" ",Z=(s.getHours()<10?"0"+s.getHours():s.getHours())+":",F=(s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+":",p=s.getSeconds()<10?"0"+s.getSeconds():s.getSeconds();return g+m+z+Z+F+p}}}}]);
