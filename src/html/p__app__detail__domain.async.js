"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3146],{80821:function(Y,I,e){e.d(I,{Z:function(){return W}});var $=e(5574),s=e.n($),S=e(93246),E=e(54006),j=e(31418),T=e(86738),g=e(14726),M=e(62435),D=e(86074);function W(r){var Z=(0,M.useState)(!1),A=s()(Z,2),K=A[0],F=A[1],N=j.Z.useApp(),y=(0,E.useIntl)(),o=function(){F(!0),r.action().then(function(f){if(F(!1),typeof r.onSuccess=="function"&&r.onSuccess(f),r.messageSuccess){var t="";r.messageSuccess.indexOf(".")>-1?t=y.formatMessage({id:r.messageSuccess}):t=r.messageSuccess,r.asynced?(0,S.Rk)(N,t):(0,S.$h)(N,t)}}).catch(function(f){F(!1),typeof r.onError=="function"&&r.onError(f)})};return r.confirm?(0,D.jsx)(T.Z,{style:{width:500},title:"\u63D0\u793A",description:r.confirm,onConfirm:o,okText:"Yes",cancelText:"No",children:(0,D.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:K,danger:r.danger,type:r.type,children:r.children})}):(0,D.jsx)(g.ZP,{disabled:r.disabled,icon:r.icon,loading:K,onClick:o,danger:r.danger,type:r.type,children:r.children})}},44613:function(Y,I,e){e.r(I),e.d(I,{default:function(){return ie}});var $=e(15009),s=e.n($),S=e(99289),E=e.n(S),j=e(5574),T=e.n(j),g=e(54006);function M(d){return D.apply(this,arguments)}function D(){return D=E()(s()().mark(function d(m){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/site/get-domain-list",{method:"POST",data:m}));case 1:case"end":return l.stop()}},d)})),D.apply(this,arguments)}function W(d){return r.apply(this,arguments)}function r(){return r=E()(s()().mark(function d(m){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/site/create-domain",{method:"POST",data:m}));case 1:case"end":return l.stop()}},d)})),r.apply(this,arguments)}function Z(d){return A.apply(this,arguments)}function A(){return A=E()(s()().mark(function d(m){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/site/delete-domain",{method:"POST",data:m}));case 1:case"end":return l.stop()}},d)})),A.apply(this,arguments)}function K(d){return F.apply(this,arguments)}function F(){return F=E()(s()().mark(function d(m){return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/site/get-domain-detail",{method:"POST",data:m}));case 1:case"end":return l.stop()}},d)})),F.apply(this,arguments)}var N=e(184),y=e(62370),o=e(5966),v=e(31199),f=e(97462),t=e(90672),L=e(52688),H=e(20713),J=e(14726),q=e(92398),V=e(78957),z=e(34041),Q=e(71230),k=e(15746),B=e(62435),n=e(86074),ee=(0,B.forwardRef)(function(d,m){(0,B.useImperativeHandle)(m,function(){return{showEdit:function(u){K({id:u.id}).then(function(a){var x;(x=w.current)===null||x===void 0||x.setFieldsValue({containerId:d.containerId,schema:u.schema,serverName:u.serverName,port:u.port,enableBlockCommonExploits:!1,enableAssetCache:!1,enableWs:!1,extraNginx:"",sslCrt:a.data.sslCert,sslKey:a.data.sslKey,vhost:a.data.vhost}),p(u.id),R(!0)})}}});var P=(0,B.useState)(!1),l=T()(P,2),U=l[0],R=l[1],w=(0,B.useRef)(),C=(0,B.useState)(0),h=T()(C,2),c=h[0],p=h[1];return(0,n.jsx)(N.a,{drawerProps:{forceRender:!0},open:U,onOpenChange:function(u){R(u)},title:"\u57DF\u540D\u7BA1\u7406",trigger:(0,n.jsx)(J.ZP,{onClick:function(){p(0)},type:"primary",children:"\u6DFB\u52A0\u57DF\u540D"}),formRef:w,onFinish:function(){var i=E()(s()().mark(function u(a){var x,b,G,O;return s()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(c>0)){_.next=3;break}return _.next=3,Z({id:[c]});case 3:return p(0),_.next=6,W({schema:a.schema,serverName:a.serverName,port:a.port,enableBlockCommonExploits:a.enableBlockCommonExploits,enableAssetCache:a.enableAssetCache,enableWs:a.enableWs,extraNginx:a.extraNginx,containerId:d.containerId,sslCrt:(x=a.sslCrt)!==null&&x!==void 0?x:"",sslKey:(b=a.sslKey)!==null&&b!==void 0?b:""});case 6:return O=_.sent,(G=w.current)===null||G===void 0||G.resetFields(),d.onFinish(),_.abrupt("return",!0);case 10:case"end":return _.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),children:(0,n.jsx)(q.Z,{items:[{key:"1",label:"\u914D\u7F6E\u57DF\u540D",children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Compact,{children:[(0,n.jsx)(y.Z,{label:"\u534F\u8BAE",tooltip:"\u9009\u62E9Https\u65F6\u4F1A\u81EA\u52A8\u7ED1\u5B9A\u8BC1\u4E66",required:!0,name:"schema",initialValue:"http",children:(0,n.jsxs)(z.Z,{defaultValue:"http",style:{width:"100px"},children:[(0,n.jsx)(z.Z.Option,{value:"http",children:"http"}),(0,n.jsx)(z.Z.Option,{value:"https",children:"https"})]})}),(0,n.jsx)(o.Z,{width:"lg",label:"\u57DF\u540D",tooltip:"\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D,\u5E76\u5C06\u8BE5\u57DF\u540D\u89E3\u6790\u5230\u5F53\u524D\u670D\u52A1\u5668",name:"serverName",placeholder:"\u8BF7\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D\uFF0C\u4F8B\u5982 www.explame.com, test.explame.com",rules:[{required:!0}]})]}),(0,n.jsx)(v.Z,{label:"\u7AEF\u53E3",name:"port",placeholder:"\u8F6C\u53D1\u5230\u76EE\u6807\u5BB9\u5668\u4E2D\u7684\u7AEF\u53E3\uFF0C\u4E00\u822C\u4E3A80",required:!0,rules:[{required:!0}]}),(0,n.jsx)(f.Z,{name:["schema"],children:function(u){var a=u.schema;if(a=="https")return[(0,n.jsx)(t.Z,{label:"\u8BC1\u4E66\u5185\u5BB9",name:"sslCrt",tooltip:"1.\u901A\u5E38\u8BC1\u4E66\u662F\u4EE5 .crt \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u8BC1\u4E66\u6587\u4EF6\u3002 2.\u8BC1\u4E66\u683C\u5F0F\u4EE5\u201C-----BEGIN CERTIFICATE-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END CERTIFICATE-----\u201D\u7ED3\u5C3E\u3002 3.\u8BC1\u4E66\u5185\u5BB9\u8BF7\u5305\u542B\u5B8C\u6574\u7684\u8BC1\u4E66\u94FE\u3002",placeholder:"-----BEGIN CERTIFICATE-----"},"sslCrt"),(0,n.jsx)(t.Z,{label:"\u79C1\u94A5\u5185\u5BB9",name:"sslKey",tooltip:"1.\u901A\u5E38\u79C1\u94A5\u662F\u4EE5 .key \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u79C1\u94A5\u6587\u4EF6\u3002 2.\u79C1\u94A5\u683C\u5F0F\u4EE5\u201C-----BEGIN PRIVATE KEY-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END PRIVATE KEY-----\u201D\u7ED3\u5C3E\u3002",placeholder:"-----BEGIN PRIVATE KEY-----"},"sslKey")]}}),(0,n.jsx)(y.Z,{name:"extraNginx",label:"\u81EA\u5B9A\u4E49\u914D\u7F6E",tooltip:"\u6269\u5C55\u7F51\u7AD9\u914D\u7F6E\u5185\u5BB9",children:(0,n.jsx)(H.ZP,{height:"300px",theme:"dark",style:{backgroundColor:"#282c34"}})}),(0,n.jsx)(L.Z,{label:"\u6269\u5C55Nginx\u914D\u7F6E",name:"enableExtraNginx"}),(0,n.jsx)(f.Z,{name:["enableExtraNginx"],children:function(u){var a=u.enableExtraNginx;if(a)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z,{children:[(0,n.jsx)(k.Z,{span:12,children:(0,n.jsx)(L.Z,{label:"\u963B\u6B62\u5E38\u89C1\u6F0F\u6D1E\u5229\u7528",name:"enableBlockCommonExploits"})}),(0,n.jsx)(k.Z,{children:(0,n.jsx)(L.Z,{width:"md",label:"\u9759\u6001\u8D44\u6E90\u7F13\u5B58",name:"enableAssetCache"})})]}),(0,n.jsx)(Q.Z,{children:(0,n.jsx)(k.Z,{span:12,children:(0,n.jsx)(L.Z,{label:"\u652F\u6301 Websocket",name:"enableWs"})})})]})}})]})},{key:"2",label:"vhost.conf",children:(0,n.jsx)(y.Z,{name:"vhost",label:" ",children:(0,n.jsx)(H.ZP,{height:"300px",theme:"dark",readOnly:!0,style:{backgroundColor:"#282c34"}})})}]})})}),ne=ee,te=e(80821),re=e(60335),ue=e(43425),ae=e(12010),X=e(66309),se=e(96074),le=e(83062);function ie(){var d=(0,g.useParams)(),m=(0,B.useRef)(),P=(0,B.useRef)(),l=(0,B.useState)(),U=T()(l,2),R=U[0],w=U[1];return(0,B.useEffect)(function(){var C;(0,re.jV)({md5:(C=d.id)!==null&&C!==void 0?C:""}).then(function(h){w(h.data.info)})},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ae.Z,{rowKey:"id",actionRef:m,columns:[{title:"\u57DF\u540D",dataIndex:"serverName",render:function(h,c,p,i,u){var a;return(0,n.jsx)("a",{href:"".concat((a=c.schema)!==null&&a!==void 0?a:"http","://").concat(c.serverName),target:"_blank",children:c.serverName})}},{title:"\u7AEF\u53E3",dataIndex:"port"},{title:"SSL",search:!1,render:function(h,c,p,i,u){return c.schema=="http"?(0,n.jsx)(X.Z,{children:"\u5426"}):(0,n.jsx)(X.Z,{color:"red",children:"\u662F"})}},{title:"\u521B\u5EFA\u65F6\u95F4",search:!1,width:180,ellipsis:!0,dataIndex:"createdAt",render:function(h,c,p,i,u){return new Date(c.createdAt).toLocaleString()}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,render:function(h,c,p,i){return(0,n.jsx)(V.Z,{split:(0,n.jsx)(se.Z,{type:"vertical"}),children:(0,n.jsx)(J.ZP,{onClick:function(){var a;return(a=P.current)===null||a===void 0||a.showEdit(c),!0},type:"link",children:(0,n.jsx)(le.Z,{title:"\u7BA1\u7406\u57DF\u540D",children:(0,n.jsx)(ue.Z,{})})})})}}],request:function(){var C=E()(s()().mark(function h(c,p,i){var u,a,x,b;return s()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,M({containerId:(u=R==null?void 0:R.Name)!==null&&u!==void 0?u:"",pageSize:(a=c.pageSize)!==null&&a!==void 0?a:10,page:(x=c.current)!==null&&x!==void 0?x:1,serverName:c.serverName,port:c.port});case 2:return b=O.sent,O.abrupt("return",{data:b.data.list,success:!0,total:b.data.list.length});case 4:case"end":return O.stop()}},h)}));return function(h,c,p){return C.apply(this,arguments)}}(),toolBarRender:function(){var h;return[(0,n.jsx)(ne,{ref:P,containerId:(h=R==null?void 0:R.Name)!==null&&h!==void 0?h:"",onFinish:function(){var p,i;!((p=m.current)===null||p===void 0)&&p.reloadAndRest&&((i=m.current)===null||i===void 0||i.reloadAndRest())}})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(h){var c=h.selectedRowKeys;return(0,n.jsx)(V.Z,{size:16,children:(0,n.jsx)(te.Z,{danger:!0,type:"primary",action:function(){return Z({id:c})},onSuccess:function(){var i,u;return!((i=m.current)===null||i===void 0)&&i.reloadAndRest&&((u=m.current)===null||u===void 0||u.reloadAndRest()),!0},onError:function(){var i,u;return!((i=m.current)===null||i===void 0)&&i.reset&&((u=m.current)===null||u===void 0||u.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})},pagination:{pageSize:10}})})}},60335:function(Y,I,e){e.d(I,{IE:function(){return M},IW:function(){return T},KK:function(){return K},LJ:function(){return N},eE:function(){return Z},jV:function(){return W}});var $=e(15009),s=e.n($),S=e(99289),E=e.n(S),j=e(54006);function T(o){return g.apply(this,arguments)}function g(){return g=E()(s()().mark(function o(v){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/container/status",{method:"POST",data:v}));case 1:case"end":return t.stop()}},o)})),g.apply(this,arguments)}function M(o){return D.apply(this,arguments)}function D(){return D=E()(s()().mark(function o(v){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/container/get-list",{data:v,method:"POST"}));case 1:case"end":return t.stop()}},o)})),D.apply(this,arguments)}function W(o){return r.apply(this,arguments)}function r(){return r=E()(s()().mark(function o(v){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/container/get-detail",{data:v,method:"POST"}));case 1:case"end":return t.stop()}},o)})),r.apply(this,arguments)}function Z(o){return A.apply(this,arguments)}function A(){return A=E()(s()().mark(function o(v){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/container/update",{data:v,method:"POST"}));case 1:case"end":return t.stop()}},o)})),A.apply(this,arguments)}function K(){return F.apply(this,arguments)}function F(){return F=E()(s()().mark(function o(){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,j.request)("/api/app/container/prune",{method:"POST"}));case 1:case"end":return f.stop()}},o)})),F.apply(this,arguments)}function N(o){return y.apply(this,arguments)}function y(){return y=E()(s()().mark(function o(v){return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,j.request)("/api/app/container/export",{method:"POST",data:v,responseType:"blob"}));case 1:case"end":return t.stop()}},o)})),y.apply(this,arguments)}}}]);
