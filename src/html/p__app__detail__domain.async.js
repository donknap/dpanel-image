"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3146],{80821:function(k,P,u){u.d(P,{Z:function(){return L}});var $=u(5574),m=u.n($),I=u(93246),F=u(54006),M=u(31418),S=u(86738),C=u(14726),W=u(62435),D=u(86074);function L(t){var T=(0,W.useState)(!1),j=m()(T,2),O=j[0],g=j[1],b=M.Z.useApp(),Z=(0,F.useIntl)(),N=function(){g(!0),t.action().then(function(y){if(g(!1),typeof t.onSuccess=="function"&&t.onSuccess(y),t.messageSuccess){var p="";t.messageSuccess.indexOf(".")>-1?p=Z.formatMessage({id:t.messageSuccess}):p=t.messageSuccess,t.asynced?(0,I.Rk)(b,p):(0,I.$h)(b,p)}}).catch(function(y){g(!1),typeof t.onError=="function"&&t.onError(y)})};return t.confirm?(0,D.jsx)(S.Z,{style:{width:500},title:"\u63D0\u793A",description:t.confirm,onConfirm:N,okText:"Yes",cancelText:"No",children:(0,D.jsx)(C.ZP,{disabled:t.disabled,icon:t.icon,loading:O,danger:t.danger,type:t.type,children:t.children})}):(0,D.jsx)(C.ZP,{disabled:t.disabled,icon:t.icon,loading:O,onClick:N,danger:t.danger,type:t.type,children:t.children})}},44613:function(k,P,u){u.r(P),u.d(P,{default:function(){return se}});var $=u(15009),m=u.n($),I=u(99289),F=u.n(I),M=u(5574),S=u.n(M),C=u(54006);function W(o){return D.apply(this,arguments)}function D(){return D=F()(m()().mark(function o(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.request)("/api/app/site/get-domain-list",{method:"POST",data:d}));case 1:case"end":return n.stop()}},o)})),D.apply(this,arguments)}function L(o){return t.apply(this,arguments)}function t(){return t=F()(m()().mark(function o(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.request)("/api/app/site/create-domain",{method:"POST",data:d}));case 1:case"end":return n.stop()}},o)})),t.apply(this,arguments)}function T(o){return j.apply(this,arguments)}function j(){return j=F()(m()().mark(function o(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.request)("/api/app/site/delete-domain",{method:"POST",data:d}));case 1:case"end":return n.stop()}},o)})),j.apply(this,arguments)}function O(o){return g.apply(this,arguments)}function g(){return g=F()(m()().mark(function o(d){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,C.request)("/api/app/site/get-domain-detail",{method:"POST",data:d}));case 1:case"end":return n.stop()}},o)})),g.apply(this,arguments)}var b=u(184),Z=u(62370),N=u(5966),Y=u(31199),y=u(97462),p=u(90672),K=u(52688),H=u(20713),J=u(14726),q=u(92398),w=u(78957),U=u(34041),Q=u(71230),G=u(15746),A=u(62435),e=u(86074),_=(0,A.forwardRef)(function(o,d){(0,A.useImperativeHandle)(d,function(){return{showEdit:function(a){O({id:a.id}).then(function(i){var v;(v=c.current)===null||v===void 0||v.setFieldsValue({containerId:a.containerId,schema:a.schema,serverName:a.serverName,port:a.port,enableBlockCommonExploits:!1,enableAssetCache:!1,enableWs:!1,extraNginx:"",sslCrt:i.data.sslCert,sslKey:i.data.sslKey,vhost:i.data.vhost}),B(a.id),r(!0)})}}});var x=(0,A.useState)(!1),n=S()(x,2),h=n[0],r=n[1],c=(0,A.useRef)(),s=(0,A.useState)(0),l=S()(s,2),E=l[0],B=l[1];return(0,e.jsx)(b.a,{drawerProps:{forceRender:!0},open:h,onOpenChange:function(a){r(a)},title:"\u57DF\u540D\u7BA1\u7406",trigger:(0,e.jsx)(J.ZP,{onClick:function(){B(0)},type:"primary",children:"\u6DFB\u52A0\u57DF\u540D"}),formRef:c,onFinish:function(){var f=F()(m()().mark(function a(i){var v,V,z,le;return m()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,L({schema:i.schema,serverName:i.serverName,port:i.port,enableBlockCommonExploits:i.enableBlockCommonExploits,enableAssetCache:i.enableAssetCache,enableWs:i.enableWs,extraNginx:i.extraNginx,containerId:o.containerId,sslCrt:(v=i.sslCrt)!==null&&v!==void 0?v:"",sslKey:(V=i.sslKey)!==null&&V!==void 0?V:""});case 2:return le=R.sent,E>0&&T({id:[E]}),B(0),(z=c.current)===null||z===void 0||z.resetFields(),o.onFinish(),R.abrupt("return",!0);case 8:case"end":return R.stop()}},a)}));return function(a){return f.apply(this,arguments)}}(),children:(0,e.jsx)(q.Z,{items:[{key:"1",label:"\u914D\u7F6E\u57DF\u540D",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(w.Z.Compact,{children:[(0,e.jsx)(Z.Z,{label:"\u534F\u8BAE",tooltip:"\u9009\u62E9Https\u65F6\u4F1A\u81EA\u52A8\u7ED1\u5B9A\u8BC1\u4E66",required:!0,name:"schema",initialValue:"http",children:(0,e.jsxs)(U.Z,{defaultValue:"http",style:{width:"100px"},children:[(0,e.jsx)(U.Z.Option,{value:"http",children:"http"}),(0,e.jsx)(U.Z.Option,{value:"https",children:"https"})]})}),(0,e.jsx)(N.Z,{width:"lg",label:"\u57DF\u540D",tooltip:"\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D,\u5E76\u5C06\u8BE5\u57DF\u540D\u89E3\u6790\u5230\u5F53\u524D\u670D\u52A1\u5668",name:"serverName",placeholder:"\u8BF7\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D\uFF0C\u4F8B\u5982 www.explame.com, test.explame.com",rules:[{required:!0}]})]}),(0,e.jsx)(Y.Z,{label:"\u7AEF\u53E3",name:"port",placeholder:"\u8F6C\u53D1\u5230\u76EE\u6807\u5BB9\u5668\u4E2D\u7684\u7AEF\u53E3\uFF0C\u4E00\u822C\u4E3A80",required:!0,rules:[{required:!0}]}),(0,e.jsx)(y.Z,{name:["schema"],children:function(a){var i=a.schema;if(i=="https")return[(0,e.jsx)(p.Z,{label:"\u8BC1\u4E66\u5185\u5BB9",name:"sslCrt",tooltip:"1.\u901A\u5E38\u8BC1\u4E66\u662F\u4EE5 .crt \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u8BC1\u4E66\u6587\u4EF6\u3002 2.\u8BC1\u4E66\u683C\u5F0F\u4EE5\u201C-----BEGIN CERTIFICATE-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END CERTIFICATE-----\u201D\u7ED3\u5C3E\u3002 3.\u8BC1\u4E66\u5185\u5BB9\u8BF7\u5305\u542B\u5B8C\u6574\u7684\u8BC1\u4E66\u94FE\u3002",placeholder:"-----BEGIN CERTIFICATE-----"},"sslCrt"),(0,e.jsx)(p.Z,{label:"\u79C1\u94A5\u5185\u5BB9",name:"sslKey",tooltip:"1.\u901A\u5E38\u79C1\u94A5\u662F\u4EE5 .key \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u79C1\u94A5\u6587\u4EF6\u3002 2.\u79C1\u94A5\u683C\u5F0F\u4EE5\u201C-----BEGIN PRIVATE KEY-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END PRIVATE KEY-----\u201D\u7ED3\u5C3E\u3002",placeholder:"-----BEGIN PRIVATE KEY-----"},"sslKey")]}}),(0,e.jsx)(Z.Z,{name:"extraNginx",label:"\u81EA\u5B9A\u4E49\u914D\u7F6E",tooltip:"\u6269\u5C55\u7F51\u7AD9\u914D\u7F6E\u5185\u5BB9",children:(0,e.jsx)(H.ZP,{height:"300px",theme:"dark",style:{backgroundColor:"#282c34"}})}),(0,e.jsx)(K.Z,{label:"\u6269\u5C55Nginx\u914D\u7F6E",name:"enableExtraNginx"}),(0,e.jsx)(y.Z,{name:["enableExtraNginx"],children:function(a){var i=a.enableExtraNginx;if(i)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Q.Z,{children:[(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(K.Z,{label:"\u963B\u6B62\u5E38\u89C1\u6F0F\u6D1E\u5229\u7528",name:"enableBlockCommonExploits"})}),(0,e.jsx)(G.Z,{children:(0,e.jsx)(K.Z,{width:"md",label:"\u9759\u6001\u8D44\u6E90\u7F13\u5B58",name:"enableAssetCache"})})]}),(0,e.jsx)(Q.Z,{children:(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(K.Z,{label:"\u652F\u6301 Websocket",name:"enableWs"})})})]})}})]})},{key:"2",label:"vhost.conf",children:(0,e.jsx)(Z.Z,{name:"vhost",label:" ",children:(0,e.jsx)(H.ZP,{height:"300px",theme:"dark",readOnly:!0,style:{backgroundColor:"#282c34"}})})}]})})}),ee=_,ue=u(80821),ne=u(43425),te=u(12010),X=u(66309),re=u(96074),ae=u(83062);function se(){var o=(0,C.useParams)(),d=(0,A.useRef)(),x=(0,A.useRef)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(te.Z,{rowKey:"id",actionRef:d,columns:[{title:"\u57DF\u540D",dataIndex:"serverName",render:function(h,r,c,s,l){var E;return(0,e.jsx)("a",{href:"".concat((E=r.schema)!==null&&E!==void 0?E:"http","://").concat(r.serverName),target:"_blank",children:r.serverName})}},{title:"\u7AEF\u53E3",dataIndex:"port"},{title:"SSL",search:!1,render:function(h,r,c,s,l){return r.schema=="http"?(0,e.jsx)(X.Z,{children:"\u5426"}):(0,e.jsx)(X.Z,{color:"red",children:"\u662F"})}},{title:"\u521B\u5EFA\u65F6\u95F4",search:!1,width:180,ellipsis:!0,dataIndex:"createdAt",render:function(h,r,c,s,l){return new Date(r.createdAt).toLocaleString()}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,render:function(h,r,c,s){return(0,e.jsx)(w.Z,{split:(0,e.jsx)(re.Z,{type:"vertical"}),children:(0,e.jsx)(J.ZP,{onClick:function(){var E;return(E=x.current)===null||E===void 0||E.showEdit(r),!0},type:"link",children:(0,e.jsx)(ae.Z,{title:"\u7BA1\u7406\u57DF\u540D",children:(0,e.jsx)(ne.Z,{})})})})}}],request:function(){var n=F()(m()().mark(function h(r,c,s){var l,E,B,f,a;return m()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,W({containerId:(l=(E=o.id)!==null&&E!==void 0?E:"")!==null&&l!==void 0?l:"",pageSize:(B=r.pageSize)!==null&&B!==void 0?B:10,page:(f=r.current)!==null&&f!==void 0?f:1,serverName:r.serverName,port:r.port});case 2:return a=v.sent,v.abrupt("return",{data:a.data.list,success:!0,total:a.data.list.length});case 4:case"end":return v.stop()}},h)}));return function(h,r,c){return n.apply(this,arguments)}}(),toolBarRender:function(){var h;return[(0,e.jsx)(ee,{ref:x,containerId:(h=o.id)!==null&&h!==void 0?h:"",onFinish:function(){var c,s;!((c=d.current)===null||c===void 0)&&c.reloadAndRest&&((s=d.current)===null||s===void 0||s.reloadAndRest())}})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(h){var r=h.selectedRowKeys;return(0,e.jsx)(w.Z,{size:16,children:(0,e.jsx)(ue.Z,{danger:!0,type:"primary",action:function(){return T({id:r})},onSuccess:function(){var s,l;return!((s=d.current)===null||s===void 0)&&s.reloadAndRest&&((l=d.current)===null||l===void 0||l.reloadAndRest()),!0},onError:function(){var s,l;return!((s=d.current)===null||s===void 0)&&s.reset&&((l=d.current)===null||l===void 0||l.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})},pagination:{pageSize:10}})})}}}]);
