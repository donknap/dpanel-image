"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1192],{80821:function(k,M,n){n.d(M,{Z:function(){return W}});var V=n(5574),f=n.n(V),T=n(93246),x=n(54006),K=n(31418),Z=n(86738),S=n(14726),g=n(83062),N=n(62435),y=n(86074);function W(u){var w=(0,N.useState)(!1),D=f()(w,2),$=D[0],E=D[1],U=K.Z.useApp(),P=(0,x.useIntl)(),b=function(){E(!0),u.action().then(function(p){if(E(!1),typeof u.onSuccess=="function"&&u.onSuccess(p),u.messageSuccess){var A="";u.messageSuccess.indexOf(".")>-1?A=P.formatMessage({id:u.messageSuccess}):A=u.messageSuccess,u.asynced?(0,T.Rk)(U,A):(0,T.$h)(U,A)}}).catch(function(p){E(!1),typeof u.onError=="function"&&u.onError(p)})};return u.confirm?(0,y.jsx)(Z.Z,{style:{width:500},title:"\u63D0\u793A",description:u.confirm,onConfirm:b,okText:"Yes",cancelText:"No",children:(0,y.jsx)(S.ZP,{disabled:u.disabled,icon:u.icon,loading:$,danger:u.danger,type:u.type,children:u.children})}):(0,y.jsx)(g.Z,{title:u.tips,children:(0,y.jsx)(S.ZP,{disabled:u.disabled,icon:u.icon,loading:$,onClick:b,danger:u.danger,type:u.type,children:u.children})})}},32010:function(k,M,n){n.r(M),n.d(M,{default:function(){return ce}});var V=n(15009),f=n.n(V),T=n(99289),x=n.n(T),K=n(5574),Z=n.n(K),S=n(80821),g=n(54006);function N(d){return y.apply(this,arguments)}function y(){return y=x()(f()().mark(function d(i){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/volume/get-list",{method:"POST",data:i}));case 1:case"end":return l.stop()}},d)})),y.apply(this,arguments)}function W(d){return u.apply(this,arguments)}function u(){return u=x()(f()().mark(function d(i){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/volume/create",{method:"POST",data:i}));case 1:case"end":return l.stop()}},d)})),u.apply(this,arguments)}function w(){return D.apply(this,arguments)}function D(){return D=x()(f()().mark(function d(){return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,g.request)("/api/app/volume/prune",{method:"POST"});case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},d)})),D.apply(this,arguments)}function $(d){return E.apply(this,arguments)}function E(){return E=x()(f()().mark(function d(i){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,g.request)("/api/app/volume/delete",{method:"POST",data:i});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},d)})),E.apply(this,arguments)}function U(d){return P.apply(this,arguments)}function P(){return P=x()(f()().mark(function d(i){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,g.request)("/api/app/volume/get-detail",{method:"POST",data:i}));case 1:case"end":return l.stop()}},d)})),P.apply(this,arguments)}var b=n(93246),H=n(184),p=n(5966),A=n(62370),q=n(86615),_=n(97462),ee=n(17186),ne=n(24739),te=n(31418),Y=n(14726),J=n(34041),R=n(62435),e=n(86074),re=(0,R.forwardRef)(function(d,i){var v=(0,R.useState)(!1),l=Z()(v,2),C=l[0],L=l[1],G=te.Z.useApp(),I=(0,R.useRef)();return(0,R.useImperativeHandle)(i,function(){return{}}),(0,e.jsxs)(H.a,{name:"create",title:"\u6DFB\u52A0\u5B58\u50A8\u5377",open:C,onOpenChange:function(F){L(F)},formRef:I,trigger:(0,e.jsx)(Y.ZP,{type:"primary",children:"\u6DFB\u52A0"}),onFinish:function(){var s=x()(f()().mark(function F(a){var c,t,r,m,o,j;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return m=[],a.otherOptions&&a.otherOptions.map(function(B){m.push(B.name+`
`+B.value)}),h.next=4,W({name:a.name,driver:"local",type:a.type,nfsUrl:(c=a.nfsUrl)!==null&&c!==void 0?c:"",nfsMountPoint:(t=a.nfsMountPoint)!==null&&t!==void 0?t:"",nfsOptions:(r=a.nfsOptions)!==null&&r!==void 0?r:"",tmpfsOptions:a.tmpfsOptions,otherOptions:m});case 4:if(o=h.sent,!(o&&o.data&&o.data.info.Name!="")){h.next=10;break}return(0,b.$h)(G,"\u6DFB\u52A0\u5B58\u50A8\u5377\u6210\u529F"),d.onFinish&&d.onFinish(),(j=I.current)===null||j===void 0||j.resetFields(),h.abrupt("return",!0);case 10:case"end":return h.stop()}},F)}));return function(F){return s.apply(this,arguments)}}(),children:[(0,e.jsx)(p.Z,{label:"\u540D\u79F0",name:"name",placeholder:"\u6307\u5B9A\u552F\u4E00\u5B58\u50A8\u5377\u540D\u79F0"}),(0,e.jsx)(A.Z,{label:"\u7C7B\u578B",name:"driver",children:(0,e.jsx)(J.Z,{defaultValue:"local",children:(0,e.jsx)(J.Z.Option,{value:"local",children:"local"})})}),(0,e.jsx)(q.Z.Group,{name:"type",label:"\u5B58\u50A8\u7C7B\u578B",valueEnum:{default:"\u9ED8\u8BA4",tmpfs:"tmpfs",nfs:"Nfs",nfs4:"Nfs4",other:"\u81EA\u5B9A\u4E49"},initialValue:"default"}),(0,e.jsx)(_.Z,{name:["type"],children:function(F){var a=F.type;if(a=="other")return(0,e.jsx)(ee.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:"\u5B58\u50A8"},copyIconProps:!1,min:0,children:(0,e.jsxs)(ne.UW,{children:[(0,e.jsx)(p.Z,{name:"name",label:"\u540D\u79F0",placeholder:"\u4F8B\u5982:mountpoint"}),(0,e.jsx)(p.Z,{name:"value",label:"\u503C",placeholder:"\u4F8B\u5982:/etc/path"})]})});if(a=="nfs"||a=="nfs4")return[(0,e.jsx)(p.Z,{label:"\u5730\u5740",name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:"\u914D\u7F6ENfs\u670D\u52A1\u5730\u5740,\u4F8B\u5982 my.nfs.com \u6216\u662F 172.16.1.13 "},"nfsUrl"),(0,e.jsx)(p.Z,{label:"\u6302\u8F7D\u70B9",name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"\u4F8B\u5982, /export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,e.jsx)(p.Z,{label:"\u914D\u7F6E",name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(a=="tmpfs")return[(0,e.jsx)(p.Z,{label:"\u914D\u7F6E",name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),ae=re,ue=n(43425),le=n(90639),Q=n(38345),z=n(66309),X=n(78957),se=n(96074),ie=n(83062),oe=n(85576),O=n(26412),de=n(63490);function ce(){var d,i=(0,R.useRef)(),v=(0,R.useState)(""),l=Z()(v,2),C=l[0],L=l[1],G=(0,R.useState)(),I=Z()(G,2),s=I[0],F=I[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(le.Z,{rowKey:"Name",pagination:{pageSize:10},columns:[{title:"\u540D\u79F0",ellipsis:!0,dataIndex:"Name",width:250},{title:"\u72B6\u6001",ellipsis:!0,search:!1,render:function(c,t,r,m,o){return t.InUse?(0,e.jsx)(z.Z,{color:"cyan",children:"In Use"}):(0,e.jsx)(e.Fragment,{})}},{title:"\u7C7B\u578B",ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:"\u6302\u8F7D\u70B9",ellipsis:!0,search:!1,dataIndex:"Mountpoint"},{title:"\u521B\u5EFA\u65F6\u95F4",ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(c,t,r,m,o){return new Date(t.CreatedAt).toLocaleString()}},{title:"\u64CD\u4F5C",width:100,search:!1,render:function(c,t,r,m,o){return(0,e.jsx)(X.Z,{split:(0,e.jsx)(se.Z,{type:"vertical"}),children:(0,e.jsx)(Y.ZP,{type:"link",onClick:function(){L(t.Name)},children:(0,e.jsx)(ie.Z,{title:"\u7BA1\u7406",children:(0,e.jsx)(ue.Z,{})})})})}}],request:function(){var a=x()(f()().mark(function c(t,r,m){var o,j;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,N({name:t.name});case 2:return o=h.sent,j=[],o.data.inUse?j=o.data.list.map(function(B){return o.data.inUse.indexOf(B.Name)!=-1?B.InUse=!0:B.InUse=!1,B}):j=o.data.list,h.abrupt("return",{data:j,success:!0,total:o.data.list.length});case 6:case"end":return h.stop()}},c)}));return function(c,t,r){return a.apply(this,arguments)}}(),toolBarRender:function(){return[(0,e.jsx)(ae,{onFinish:function(){var t,r;!((t=i.current)===null||t===void 0)&&t.reloadAndRest&&((r=i.current)===null||r===void 0||r.reloadAndRest())}}),(0,e.jsx)(S.Z,{action:function(){return w()},onSuccess:function(){var t,r;return!((t=i.current)===null||t===void 0)&&t.reloadAndRest&&((r=i.current)===null||r===void 0||r.reloadAndRest()),!0},onError:function(){var t,r;return!((t=i.current)===null||t===void 0)&&t.reset&&((r=i.current)===null||r===void 0||r.reset()),!0},messageSuccess:"\u6E05\u9664\u6210\u529F",confirm:"\u662F\u5426\u6E05\u7406\u672A\u4F7F\u7528\u7684\u533F\u540D\u5B58\u50A8\uFF1F",children:"\u6E05\u7406\u672A\u4F7F\u7528\u5B58\u50A8"})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actionRef:i,tableAlertOptionRender:function(c){var t=c.selectedRowKeys;return(0,e.jsx)(X.Z,{size:16,children:(0,e.jsx)(S.Z,{danger:!0,type:"primary",action:function(){return $({name:t})},onSuccess:function(){var m,o;return!((m=i.current)===null||m===void 0)&&m.reloadAndRest&&((o=i.current)===null||o===void 0||o.reloadAndRest()),!0},onError:function(){var m,o;return!((m=i.current)===null||m===void 0)&&m.reset&&((o=i.current)===null||o===void 0||o.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})}}),(0,e.jsxs)(oe.Z,{width:800,open:C!="",afterOpenChange:x()(f()().mark(function a(){var c;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!C){r.next=5;break}return r.next=3,U({name:C});case 3:c=r.sent,F(c.data);case 5:case"end":return r.stop()}},a)})),footer:!1,onCancel:function(){return L("")},children:[(0,e.jsx)(Q.Z,{title:"\u5B58\u50A8\u8BE6\u60C5",ghost:!0,children:(0,e.jsxs)(O.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:[(0,e.jsx)(O.Z.Item,{label:"\u540D\u79F0",children:s==null?void 0:s.info.Name}),(0,e.jsx)(O.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:new Date((d=s==null?void 0:s.info.CreatedAt)!==null&&d!==void 0?d:"").toLocaleString()}),(0,e.jsx)(O.Z.Item,{label:"\u6302\u8F7D\u70B9",children:s==null?void 0:s.info.Mountpoint}),(0,e.jsx)(O.Z.Item,{label:"\u7C7B\u578B",children:s==null?void 0:s.info.Driver}),(0,e.jsx)(O.Z.Item,{label:"Lables",children:(0,e.jsx)(O.Z,{labelStyle:{width:"150px"},column:1,bordered:!0,children:(s==null?void 0:s.info.Labels)&&Object.keys(s==null?void 0:s.info.Labels).map(function(a){return(0,e.jsx)(O.Z.Item,{label:a,children:s.info.Labels[a]})})})})]})}),(0,e.jsx)(Q.Z,{title:"\u4F7F\u7528\u5BB9\u5668",ghost:!0,children:(0,e.jsx)(de.Z,{columns:[{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"Name",render:function(c,t,r){return(0,e.jsx)(g.Link,{target:"_blank",to:"/app/detail/edit/".concat(t.Id),children:t.Name})}},{title:"\u5BB9\u5668\u5185\u8DEF\u5F84",dataIndex:"Mount"},{title:"\u6743\u9650",render:function(c,t,r){return t.RW?(0,e.jsx)(z.Z,{children:"\u8BFB\u5199"}):(0,e.jsx)(z.Z,{children:"\u53EA\u8BFB"})}}],dataSource:s==null?void 0:s.inUseContainer,pagination:!1})})]})]})}}}]);
