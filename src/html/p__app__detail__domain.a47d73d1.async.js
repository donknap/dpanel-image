"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3146],{80821:function(Q,$,u){u.d($,{Z:function(){return O}});var W=u(5574),h=u.n(W),w=u(93246),x=u(54006),U=u(31418),S=u(86738),A=u(14726),V=u(83062),T=u(62435),R=u(86074);function O(s){var K=(0,T.useState)(!1),L=h()(K,2),Z=L[0],b=L[1],j=U.Z.useApp(),M=(0,x.useIntl)(),y=function(){b(!0),s.action().then(function(P){if(b(!1),typeof s.onSuccess=="function"&&s.onSuccess(P),s.messageSuccess){var p="";s.messageSuccess.indexOf(".")>-1?p=M.formatMessage({id:s.messageSuccess}):p=s.messageSuccess,s.asynced?(0,w.Rk)(j,p):(0,w.$h)(j,p)}}).catch(function(P){b(!1),typeof s.onError=="function"&&s.onError(P)})};return s.confirm?(0,R.jsx)(S.Z,{style:{width:500},title:"\u63D0\u793A",description:s.confirm,onConfirm:y,okText:"Yes",cancelText:"No",children:(0,R.jsx)(A.ZP,{disabled:s.disabled,icon:s.icon,loading:Z,danger:s.danger,type:s.type,children:s.children})}):(0,R.jsx)(V.Z,{title:s.tips,children:(0,R.jsx)(A.ZP,{disabled:s.disabled,icon:s.icon,loading:Z,onClick:y,danger:s.danger,type:s.type,children:s.children})})}},71457:function(Q,$,u){u.r($),u.d($,{default:function(){return oe}});var W=u(15009),h=u.n(W),w=u(99289),x=u.n(w),U=u(5574),S=u.n(U),A=u(54006);function V(d){return T.apply(this,arguments)}function T(){return T=x()(h()().mark(function d(c){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.request)("/api/app/site/get-domain-list",{method:"POST",data:c}));case 1:case"end":return r.stop()}},d)})),T.apply(this,arguments)}function R(d){return O.apply(this,arguments)}function O(){return O=x()(h()().mark(function d(c){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.request)("/api/app/site/create-domain",{method:"POST",data:c}));case 1:case"end":return r.stop()}},d)})),O.apply(this,arguments)}function s(d){return K.apply(this,arguments)}function K(){return K=x()(h()().mark(function d(c){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.request)("/api/app/site/delete-domain",{method:"POST",data:c}));case 1:case"end":return r.stop()}},d)})),K.apply(this,arguments)}function L(d){return Z.apply(this,arguments)}function Z(){return Z=x()(h()().mark(function d(c){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.request)("/api/app/site/get-domain-detail",{method:"POST",data:c}));case 1:case"end":return r.stop()}},d)})),Z.apply(this,arguments)}var b=u(184),j=u(90672),M=u(5966),y=u(62370),N=u(52688),P=u(92398),p=u(34041),C=u(62435),e=u(86074),X=(0,C.forwardRef)(function(d,c){var g=(0,C.useState)(!1),r=S()(g,2),D=r[0],i=r[1],a=(0,C.useRef)(),v=(0,C.useState)(),o=S()(v,2),n=o[0],E=o[1];return(0,C.useImperativeHandle)(c,function(){return{showEdit:function(t){var l;(l=a.current)===null||l===void 0||l.setFieldsValue({sslCrt:t.setting.sslCrt,sslKey:t.setting.sslKey}),E(t),i(!0)}}}),(0,e.jsx)(b.a,{drawerProps:{forceRender:!0},formRef:a,onFinish:function(){var F=x()(h()().mark(function t(l){var B,f,I,z;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(n){m.next=2;break}return m.abrupt("return",!0);case 2:return m.next=4,s({id:[n.id]});case 4:return m.next=6,R({schema:"https",serverName:n.serverName,port:n.setting.port,enableBlockCommonExploits:n.setting.enableBlockCommonExploits,enableAssetCache:n.setting.enableAssetCache,enableWs:n.setting.enableWs,extraNginx:n.setting.extraNginx,containerId:n.containerId,sslCrt:(B=l.sslCrt)!==null&&B!==void 0?B:"",sslKey:(f=l.sslKey)!==null&&f!==void 0?f:""});case 6:return z=m.sent,(I=a.current)===null||I===void 0||I.resetFields(),d.onFinish&&d.onFinish(),m.abrupt("return",!0);case 10:case"end":return m.stop()}},t)}));return function(t){return F.apply(this,arguments)}}(),onOpenChange:function(t){i(t)},open:D,children:(0,e.jsx)(P.Z,{items:[{key:"1",label:"\u5F53\u524D\u8BC1\u4E66",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(j.Z,{fieldProps:{autoSize:{minRows:12}},label:"\u8BC1\u4E66\u5185\u5BB9 .crt ",name:"sslCrt",tooltip:"1.\u901A\u5E38\u8BC1\u4E66\u662F\u4EE5 .crt \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u8BC1\u4E66\u6587\u4EF6\u3002 2.\u8BC1\u4E66\u683C\u5F0F\u4EE5\u201C-----BEGIN CERTIFICATE-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END CERTIFICATE-----\u201D\u7ED3\u5C3E\u3002 3.\u8BC1\u4E66\u5185\u5BB9\u8BF7\u5305\u542B\u5B8C\u6574\u7684\u8BC1\u4E66\u94FE\u3002",placeholder:"-----BEGIN CERTIFICATE-----"},"sslCrt"),(0,e.jsx)(j.Z,{fieldProps:{autoSize:{minRows:12}},label:"\u79C1\u94A5\u5185\u5BB9 .key ",name:"sslKey",tooltip:"1.\u901A\u5E38\u79C1\u94A5\u662F\u4EE5 .key \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u79C1\u94A5\u6587\u4EF6\u3002 2.\u79C1\u94A5\u683C\u5F0F\u4EE5\u201C-----BEGIN PRIVATE KEY-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END PRIVATE KEY-----\u201D\u7ED3\u5C3E\u3002",placeholder:"-----BEGIN PRIVATE KEY-----"},"sslKey")]})},{key:"2",label:"\u81EA\u52A9\u7533\u8BF7",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(M.Z,{label:"\u90AE\u7BB1",name:"email",placeholder:"\u8BF7\u8F93\u5165\u7533\u8BF7\u7684\u90AE\u7BB1"}),(0,e.jsx)(y.Z,{label:"\u7B7E\u53D1\u670D\u52A1",name:"server",initialValue:"zerossl",children:(0,e.jsx)(p.Z,{options:[{value:"zerossl",label:"ZeroSSL"}]})}),(0,e.jsx)(N.Z,{label:"\u81EA\u52A8\u7EED\u7B7E",name:"autoUpgrade",initialValue:!0})]})}]})})}),q=X,_=u(31199),ee=u(97462),Y=u(20713),ue=u(14726),k=u(78957),H=u(71230),G=u(15746),te=(0,C.forwardRef)(function(d,c){(0,C.useImperativeHandle)(c,function(){return{showEdit:function(t){L({id:t.id}).then(function(l){var B;(B=a.current)===null||B===void 0||B.setFieldsValue({containerId:d.containerId,serverName:t.serverName,port:t.setting.port,enableBlockCommonExploits:t.setting.enableBlockCommonExploits,enableAssetCache:t.setting.enableAssetCache,enableWs:t.setting.enableWs,extraNginx:t.setting.extraNginx,sslCrt:t.setting.sslCrt,sslKey:t.setting.sslKey,vhost:l.data.vhost}),E(t.id),i(!0)})}}});var g=(0,C.useState)(!1),r=S()(g,2),D=r[0],i=r[1],a=(0,C.useRef)(),v=(0,C.useState)(0),o=S()(v,2),n=o[0],E=o[1];return(0,e.jsx)(b.a,{drawerProps:{forceRender:!0},open:D,onOpenChange:function(t){i(t)},title:"\u57DF\u540D\u7BA1\u7406",trigger:(0,e.jsx)(ue.ZP,{onClick:function(){var t;E(0),(t=a.current)===null||t===void 0||t.resetFields()},type:"primary",children:"\u7ED1\u5B9A\u57DF\u540D"}),formRef:a,onFinish:function(){var F=x()(h()().mark(function t(l){var B,f,I,z;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(n>0)){m.next=3;break}return m.next=3,s({id:[n]});case 3:return E(0),m.next=6,R({schema:l.schema,serverName:l.serverName,port:l.port,enableBlockCommonExploits:l.enableBlockCommonExploits,enableAssetCache:l.enableAssetCache,enableWs:l.enableWs,extraNginx:l.extraNginx,containerId:d.containerId,sslCrt:(B=l.sslCrt)!==null&&B!==void 0?B:"",sslKey:(f=l.sslKey)!==null&&f!==void 0?f:""});case 6:return z=m.sent,(I=a.current)===null||I===void 0||I.resetFields(),d.onFinish(),m.abrupt("return",!0);case 10:case"end":return m.stop()}},t)}));return function(t){return F.apply(this,arguments)}}(),children:(0,e.jsx)(P.Z,{items:[{key:"1",label:"\u914D\u7F6E\u57DF\u540D",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(k.Z.Compact,{children:[(0,e.jsx)(y.Z,{label:"\u534F\u8BAE",tooltip:"\u9009\u62E9Https\u65F6\u4F1A\u81EA\u52A8\u7ED1\u5B9A\u8BC1\u4E66",required:!0,name:"schema",initialValue:"http",hidden:!0,children:(0,e.jsxs)(p.Z,{defaultValue:"http",style:{width:"100px"},children:[(0,e.jsx)(p.Z.Option,{value:"http",children:"http"}),(0,e.jsx)(p.Z.Option,{value:"https",children:"https"})]})}),(0,e.jsx)(M.Z,{width:"lg",label:"\u57DF\u540D",tooltip:"\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D,\u5E76\u5C06\u8BE5\u57DF\u540D\u89E3\u6790\u5230\u5F53\u524D\u670D\u52A1\u5668",name:"serverName",placeholder:"\u8BF7\u6307\u5B9A\u8981\u7ED1\u5B9A\u7684\u57DF\u540D\uFF0C\u4F8B\u5982 www.explame.com, test.explame.com",rules:[{required:!0}]})]}),(0,e.jsx)(_.Z,{label:"\u7AEF\u53E3",name:"port",placeholder:"\u8F6C\u53D1\u5230\u76EE\u6807\u5BB9\u5668\u4E2D\u7684\u7AEF\u53E3\uFF0C\u4E00\u822C\u4E3A80",required:!0,rules:[{required:!0}]}),(0,e.jsx)(ee.Z,{name:["schema"],children:function(t){var l=t.schema;if(l=="https")return[(0,e.jsx)(j.Z,{label:"\u8BC1\u4E66\u5185\u5BB9",name:"sslCrt",tooltip:"1.\u901A\u5E38\u8BC1\u4E66\u662F\u4EE5 .crt \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u8BC1\u4E66\u6587\u4EF6\u3002 2.\u8BC1\u4E66\u683C\u5F0F\u4EE5\u201C-----BEGIN CERTIFICATE-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END CERTIFICATE-----\u201D\u7ED3\u5C3E\u3002 3.\u8BC1\u4E66\u5185\u5BB9\u8BF7\u5305\u542B\u5B8C\u6574\u7684\u8BC1\u4E66\u94FE\u3002",placeholder:"-----BEGIN CERTIFICATE-----"},"sslCrt"),(0,e.jsx)(j.Z,{label:"\u79C1\u94A5\u5185\u5BB9",name:"sslKey",tooltip:"1.\u901A\u5E38\u79C1\u94A5\u662F\u4EE5 .key \u6216 .pem \u7B49\u4E3A\u6269\u5C55\u540D\u7684\u6587\u4EF6\uFF0C\u8BF7\u4F7F\u7528\u76F8\u5E94\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u79C1\u94A5\u6587\u4EF6\u3002 2.\u79C1\u94A5\u683C\u5F0F\u4EE5\u201C-----BEGIN PRIVATE KEY-----\u201D\u5F00\u5934\uFF0C\u4EE5\u201C-----END PRIVATE KEY-----\u201D\u7ED3\u5C3E\u3002",placeholder:"-----BEGIN PRIVATE KEY-----"},"sslKey")]}}),(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(N.Z,{label:"\u963B\u6B62\u5E38\u89C1\u6F0F\u6D1E\u5229\u7528",name:"enableBlockCommonExploits"})}),(0,e.jsx)(G.Z,{children:(0,e.jsx)(N.Z,{width:"md",label:"\u9759\u6001\u8D44\u6E90\u7F13\u5B58",name:"enableAssetCache"})})]}),(0,e.jsx)(H.Z,{children:(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(N.Z,{label:"\u652F\u6301 Websocket",name:"enableWs"})})}),(0,e.jsx)(y.Z,{name:"extraNginx",label:"\u81EA\u5B9A\u4E49\u6269\u5C55\u914D\u7F6E",tooltip:"\u81EA\u5B9A\u4E49\u6269\u5C55\u7F51\u7AD9 Vhost \u914D\u7F6E\u5185\u5BB9",children:(0,e.jsx)(Y.ZP,{height:"300px",theme:"dark",style:{backgroundColor:"#282c34"}})})]})},{key:"2",label:"\u67E5\u770B vhost \u914D\u7F6E",children:(0,e.jsx)(y.Z,{name:"vhost",label:" ",children:(0,e.jsx)(Y.ZP,{height:"600px",theme:"dark",readOnly:!0,style:{backgroundColor:"#282c34"}})})}]})})}),ne=te,re=u(80821),ae=u(43425),se=u(12010),J=u(66309),le=u(96074),ie=u(83062);function oe(){var d=(0,A.useParams)(),c=(0,C.useRef)(),g=(0,C.useRef)(),r=(0,C.useRef)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(q,{ref:r,onFinish:function(){var i;!((i=c.current)===null||i===void 0)&&i.reloadAndRest&&c.current.reloadAndRest()}}),(0,e.jsx)(se.Z,{rowKey:"id",actionRef:c,columns:[{title:"\u57DF\u540D",dataIndex:"serverName",render:function(i,a,v,o,n){var E;return(0,e.jsx)("a",{href:"".concat((E=a.setting.enableSSL)!==null&&E!==void 0?E:"http","://").concat(a.serverName),target:"_blank",children:a.serverName})}},{title:"\u5BB9\u5668\u5185\u7AEF\u53E3",dataIndex:["setting","port"],search:!1},{title:"SSL\u8BC1\u4E66",search:!1,render:function(i,a,v,o,n){return a.setting.enableSSL?(0,e.jsx)(J.Z,{color:"red",children:"\u662F"}):(0,e.jsx)(J.Z,{children:"\u5426"})}},{title:"\u521B\u5EFA\u65F6\u95F4",search:!1,width:180,ellipsis:!0,dataIndex:"createdAt",render:function(i,a,v,o,n){return new Date(a.createdAt).toLocaleString()}},{title:"\u64CD\u4F5C",valueType:"option",key:"option",width:100,render:function(i,a,v,o){return(0,e.jsxs)(k.Z,{split:(0,e.jsx)(le.Z,{type:"vertical"}),children:[(0,e.jsx)(A.Link,{to:"#",onClick:function(){var E;return(E=g.current)===null||E===void 0||E.showEdit(a),!0},children:(0,e.jsx)(ie.Z,{title:"\u7BA1\u7406\u57DF\u540D",children:(0,e.jsx)(ae.Z,{})})}),(0,e.jsx)(A.Link,{to:"#",onClick:function(){var E;(E=r.current)===null||E===void 0||E.showEdit(a)},children:"SSL"})]})}}],request:function(){var D=x()(h()().mark(function i(a,v,o){var n,E,F,t,l;return h()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,V({containerId:(n=(E=d.id)!==null&&E!==void 0?E:"")!==null&&n!==void 0?n:"",pageSize:(F=a.pageSize)!==null&&F!==void 0?F:10,page:(t=a.current)!==null&&t!==void 0?t:1,serverName:a.serverName,port:a.port});case 2:return l=f.sent,f.abrupt("return",{data:l.data.list,success:!0,total:l.data.list.length});case 4:case"end":return f.stop()}},i)}));return function(i,a,v){return D.apply(this,arguments)}}(),toolBarRender:function(){var i;return[(0,e.jsx)(ne,{ref:g,containerId:(i=d.id)!==null&&i!==void 0?i:"",onFinish:function(){var v,o;!((v=c.current)===null||v===void 0)&&v.reloadAndRest&&((o=c.current)===null||o===void 0||o.reloadAndRest())}})]},rowSelection:{defaultSelectedRowKeys:[],alwaysShowAlert:!0},tableAlertOptionRender:function(i){var a=i.selectedRowKeys;return(0,e.jsx)(k.Z,{size:16,children:(0,e.jsx)(re.Z,{danger:!0,type:"primary",action:function(){return s({id:a})},onSuccess:function(){var o,n;return!((o=c.current)===null||o===void 0)&&o.reloadAndRest&&((n=c.current)===null||n===void 0||n.reloadAndRest()),!0},onError:function(){var o,n;return!((o=c.current)===null||o===void 0)&&o.reset&&((n=c.current)===null||n===void 0||n.reset()),!0},messageSuccess:"\u5220\u9664\u6210\u529F",children:"\u6279\u91CF\u5220\u9664"})})},pagination:{pageSize:10}})]})}}}]);
