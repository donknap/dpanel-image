"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7861],{88484:function(G,T,e){e.d(T,{Z:function(){return $}});var p=e(87462),l=e(62435),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},c=O,F=e(84089),I=function(y,A){return l.createElement(F.Z,(0,p.Z)({},y,{ref:A,icon:c}))},t=l.forwardRef(I),$=t},86615:function(G,T,e){var p=e(1413),l=e(45987),O=e(22270),c=e(78045),F=e(62435),I=e(83607),t=e(33468),$=e(86074),S=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],y=F.forwardRef(function(v,h){var L=v.fieldProps,z=v.options,d=v.radioType,H=v.layout,B=v.proFieldProps,W=v.valueEnum,P=(0,l.Z)(v,S);return(0,$.jsx)(t.Z,(0,p.Z)((0,p.Z)({valueType:d==="button"?"radioButton":"radio",ref:h,valueEnum:(0,O.h)(W,void 0)},P),{},{fieldProps:(0,p.Z)({options:z,layout:H},L),proFieldProps:B,filedConfig:{customLightMode:!0}}))}),A=F.forwardRef(function(v,h){var L=v.fieldProps,z=v.children;return(0,$.jsx)(c.ZP,(0,p.Z)((0,p.Z)({},L),{},{ref:h,children:z}))}),D=(0,I.G)(A,{valuePropName:"checked",ignoreWidth:!0}),M=D;M.Group=y,M.Button=c.ZP.Button,M.displayName="ProFormComponent",T.Z=M},184:function(G,T,e){e.d(T,{a:function(){return g}});var p=e(4942),l=e(74165),O=e(15861),c=e(1413),F=e(97685),I=e(45987),t=e(51812),$=e(48171),S=e(73177),y=e(28459),A=e(85265),D=e(93967),M=e.n(D),v=e(72378),h=e.n(v),L=e(21770),z=e(80334),d=e(62435),H=e(61254),B=e(89671),W=e(98082),P=function(m){return(0,p.Z)({},m.componentCls,{"&-sidebar-dragger":{width:"5px",cursor:"ew-resize",padding:"4px 0 0",borderTop:"1px solid transparent",position:"absolute",top:0,left:0,bottom:0,zIndex:100,backgroundColor:"transparent","&-min-disabled":{cursor:"w-resize"},"&-max-disabled":{cursor:"e-resize"}}})};function x(s){return(0,W.Xj)("DrawerForm",function(m){var f=(0,c.Z)((0,c.Z)({},m),{},{componentCls:".".concat(s)});return[P(f)]})}var R=e(86074),j=["children","trigger","onVisibleChange","drawerProps","onFinish","submitTimeout","title","width","resize","onOpenChange","visible","open"];function g(s){var m,f,w=s.children,V=s.trigger,K=s.onVisibleChange,a=s.drawerProps,k=s.onFinish,X=s.submitTimeout,Ce=s.title,q=s.width,Z=s.resize,ee=s.onOpenChange,ne=s.visible,ce=s.open,C=(0,I.Z)(s,j);(0,z.ET)(!C.footer||!(a!=null&&a.footer),"DrawerForm \u662F\u4E00\u4E2A ProForm \u7684\u7279\u6B8A\u5E03\u5C40\uFF0C\u5982\u679C\u60F3\u81EA\u5B9A\u4E49\u6309\u94AE\uFF0C\u8BF7\u4F7F\u7528 submit.render \u81EA\u5B9A\u4E49\u3002");var u=d.useMemo(function(){var i,n,r,o={onResize:function(){},maxWidth:window.innerWidth*.8,minWidth:300};return typeof Z=="boolean"?Z?o:{}:(0,t.Y)({onResize:(i=Z==null?void 0:Z.onResize)!==null&&i!==void 0?i:o.onResize,maxWidth:(n=Z==null?void 0:Z.maxWidth)!==null&&n!==void 0?n:o.maxWidth,minWidth:(r=Z==null?void 0:Z.minWidth)!==null&&r!==void 0?r:o.minWidth})},[Z]),Y=(0,d.useContext)(y.ZP.ConfigContext),me=Y.getPrefixCls("pro-form-drawer"),ve=x(me),xe=ve.wrapSSR,fe=ve.hashId,oe=function(n){return"".concat(me,"-").concat(n," ").concat(fe)},Pe=(0,d.useState)([]),Re=(0,F.Z)(Pe,2),je=Re[1],De=(0,d.useState)(!1),pe=(0,F.Z)(De,2),ae=pe[0],ue=pe[1],Ze=(0,d.useState)(!1),he=(0,F.Z)(Ze,2),ie=he[0],le=he[1],Oe=(0,d.useState)(q||(Z?u==null?void 0:u.minWidth:800)),ge=(0,F.Z)(Oe,2),se=ge[0],re=ge[1],ye=(0,L.Z)(!!ne,{value:ce||ne,onChange:ee||K}),Ee=(0,F.Z)(ye,2),J=Ee[0],N=Ee[1],te=(0,d.useRef)(null),Me=(0,d.useCallback)(function(i){te.current===null&&i&&je([]),te.current=i},[]),Q=(0,d.useRef)(),We=(0,d.useCallback)(function(){var i,n,r,o=(i=(n=(r=C.formRef)===null||r===void 0?void 0:r.current)!==null&&n!==void 0?n:C.form)!==null&&i!==void 0?i:Q.current;o&&a!==null&&a!==void 0&&a.destroyOnClose&&o.resetFields()},[a==null?void 0:a.destroyOnClose,C.form,C.formRef]);(0,d.useEffect)(function(){J&&(ce||ne)&&(ee==null||ee(!0),K==null||K(!0)),ie&&re(u==null?void 0:u.minWidth)},[ne,J,ie]),(0,d.useImperativeHandle)(C.formRef,function(){return Q.current},[Q.current]);var be=(0,d.useMemo)(function(){return V?d.cloneElement(V,(0,c.Z)((0,c.Z)({key:"trigger"},V.props),{},{onClick:function(){var i=(0,O.Z)((0,l.Z)().mark(function r(o){var b,E;return(0,l.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:N(!J),le(!Object.keys(u)),(b=V.props)===null||b===void 0||(E=b.onClick)===null||E===void 0||E.call(b,o);case 3:case"end":return U.stop()}},r)}));function n(r){return i.apply(this,arguments)}return n}()})):null},[N,V,J,le,ie]),Te=(0,d.useMemo)(function(){var i,n,r,o;return C.submitter===!1?!1:h()({searchConfig:{submitText:(i=(n=Y.locale)===null||n===void 0||(n=n.Modal)===null||n===void 0?void 0:n.okText)!==null&&i!==void 0?i:"\u786E\u8BA4",resetText:(r=(o=Y.locale)===null||o===void 0||(o=o.Modal)===null||o===void 0?void 0:o.cancelText)!==null&&r!==void 0?r:"\u53D6\u6D88"},resetButtonProps:{preventDefault:!0,disabled:X?ae:void 0,onClick:function(E){var _;N(!1),a==null||(_=a.onClose)===null||_===void 0||_.call(a,E)}}},C.submitter)},[C.submitter,(m=Y.locale)===null||m===void 0||(m=m.Modal)===null||m===void 0?void 0:m.okText,(f=Y.locale)===null||f===void 0||(f=f.Modal)===null||f===void 0?void 0:f.cancelText,X,ae,N,a]),Ie=(0,d.useCallback)(function(i,n){return(0,R.jsxs)(R.Fragment,{children:[i,te.current&&n?(0,R.jsx)(d.Fragment,{children:(0,H.createPortal)(n,te.current)},"submitter"):n]})},[]),Be=(0,$.J)(function(){var i=(0,O.Z)((0,l.Z)().mark(function n(r){var o,b,E;return(0,l.Z)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return o=k==null?void 0:k(r),X&&o instanceof Promise&&(ue(!0),b=setTimeout(function(){return ue(!1)},X),o.finally(function(){clearTimeout(b),ue(!1)})),U.next=4,o;case 4:return E=U.sent,E&&N(!1),U.abrupt("return",E);case 7:case"end":return U.stop()}},n)}));return function(n){return i.apply(this,arguments)}}()),Ae=(0,S.X)(J,K),de=(0,d.useCallback)(function(i){var n,r,o=(document.body.offsetWidth||1e3)-(i.clientX-document.body.offsetLeft),b=(n=u==null?void 0:u.minWidth)!==null&&n!==void 0?n:q||800,E=(r=u==null?void 0:u.maxWidth)!==null&&r!==void 0?r:window.innerWidth*.8;if(o<b){re(b);return}if(o>E){re(E);return}re(o)},[u==null?void 0:u.maxWidth,u==null?void 0:u.minWidth,q]),Fe=(0,d.useCallback)(function(){document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",Fe)},[de]);return xe((0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(A.Z,(0,c.Z)((0,c.Z)((0,c.Z)({title:Ce,width:se},a),Ae),{},{afterOpenChange:function(n){var r;n||We(),a==null||(r=a.afterOpenChange)===null||r===void 0||r.call(a,n)},onClose:function(n){var r;X&&ae||(N(!1),a==null||(r=a.onClose)===null||r===void 0||r.call(a,n))},footer:C.submitter!==!1&&(0,R.jsx)("div",{ref:Me,style:{display:"flex",justifyContent:"flex-end"}}),children:[Z?(0,R.jsx)("div",{className:M()(oe("sidebar-dragger"),fe,(0,p.Z)((0,p.Z)({},oe("sidebar-dragger-min-disabled"),se===(u==null?void 0:u.minWidth)),oe("sidebar-dragger-max-disabled"),se===(u==null?void 0:u.maxWidth))),onMouseDown:function(n){var r;u==null||(r=u.onResize)===null||r===void 0||r.call(u),n.stopPropagation(),n.preventDefault(),document.addEventListener("mousemove",de),document.addEventListener("mouseup",Fe),le(!0)}}):null,(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(B.I,(0,c.Z)((0,c.Z)({formComponentType:"DrawerForm",layout:"vertical"},C),{},{formRef:Q,onInit:function(n,r){var o;C.formRef&&(C.formRef.current=r),C==null||(o=C.onInit)===null||o===void 0||o.call(C,n,r),Q.current=r},submitter:Te,onFinish:function(){var i=(0,O.Z)((0,l.Z)().mark(function n(r){var o;return(0,l.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,Be(r);case 2:return o=E.sent,E.abrupt("return",o);case 4:case"end":return E.stop()}},n)}));return function(n){return i.apply(this,arguments)}}(),contentRender:Ie,children:w}))})]})),be]}))}},71566:function(G,T,e){e.d(T,{Z:function(){return H}});var p=e(62435),l=e(93246),O=e(88484),c=e(31418),F=e(72723),I=e(14726),t=e(86074);function $(B){var W=(0,p.useRef)(null),P=c.Z.useApp(),x=function(){W.current&&(W.current.click(),W.current.onchange=function(j){if(!j||!j.target)return"";var g=new FileReader;g.onload=function(m){var f,w=(f=m.target)===null||f===void 0?void 0:f.result;if(w.indexOf("FROM ")<0){(0,l.YZ)(P,"\u5BFC\u5165Dockerfile\u6587\u4EF6\u9519\u8BEF");return}typeof B.onImport=="function"&&B.onImport(w)};var s=j.target;if(s.files)try{g.readAsText(s.files[0])}catch(m){(0,l.YZ)(P,"\u5BFC\u5165\u6587\u4EF6\u5FC5\u987B\u662F\u6587\u672C\u7C7B\u578B")}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Z.Item,{name:"importFile",label:"Dockerfile",children:(0,t.jsx)(I.ZP,{icon:(0,t.jsx)(O.Z,{}),block:!0,onClick:x,children:"\u5BFC\u5165\u672C\u5730Dockerfile\u6587\u4EF6"})}),(0,t.jsx)("input",{style:{display:"none"},type:"file",ref:W,name:"importFileInput"})]})}var S=e(20713),y=e(62370),A=e(5574),D=e.n(A),M=e(184),v=e(86615),h=e(97462),L=e(97961),z=e(34041);function d(B){var W=(0,p.useState)([]),P=D()(W,2),x=P[0],R=P[1];return(0,p.useEffect)(function(){(0,L.MF)().then(function(j){var g=Object.keys(j.data).map(function(s){return j.data[s]});R(g)})},[]),(0,t.jsx)(y.Z,{children:(0,t.jsxs)(M.a,{trigger:(0,t.jsx)(I.ZP,{block:!0,children:"\u4F7F\u7528\u6A21\u677F\u751F\u6210"}),onFinish:function(g){return new Promise(function(s,m){var f=g[g.language+"EnvVersion"].split("|"),w=D()(f,2),V=w[0],K=w[1],a="FROM ".concat(V,`
# \u7F51\u7AD9\u76EE\u5F55\u4F4D\u4E8E /home/wwwroot 
# \u53EF\u901A\u7BA1\u5BB9\u5668 - \u6587\u4EF6\u7BA1\u7406, \u4E0A\u4F20\u4EE3\u7801\u81F3\u6B64\u76EE\u5F55\u5E76\u4FEE\u6539\u6743\u9650

WORKDIR /home/wwwroot
VOLUME [ "/home/wwwroot" ]
EXPOSE 80

# \u81EA\u5B9A\u4E49\u5B89\u88C5\u7EC4\u4EF6\u3001\u6269\u5C55\u6216\u662F\u5E93, \u4F8B\u5982:
# RUN apk add --no-cache --update vim
`);switch(g.language){case"php":a+=`
# nginx \u914D\u7F6E\u4F4D\u4E8E /home/nginx/ \u53EF\u4FEE\u6539\u589E\u52A0\u81EA\u5B9A\u4E49\u914D\u7F6E

`,g.language=="php"&&g.phpExt&&(a+="RUN apk add --no-cache --update ",g.phpExt.map(function(k){a+="php".concat(K,"-").concat(k," ")}));break;case"golang":a+=`
# \u53EF\u4EE5\u4FEE\u6539 RUN_COMMAND \u73AF\u5883\u53D8\u91CF, \u66F4\u6539\u542F\u52A8\u6267\u884C\u547D\u4EE4
ENV RUN_COMMAND=""`;break;default:break}B.onFinish(a),s(!0)})},children:[(0,t.jsx)(v.Z.Group,{radioType:"button",name:"language",label:"\u7A0B\u5E8F\u8BED\u8A00",options:x.map(function(j){return{label:j.name,value:j.name}}),required:!0}),(0,t.jsx)(h.Z,{name:["language"],children:function(g){var s=g.language;return s?(0,t.jsx)(t.Fragment,{children:x.map(function(m){if(m.name==s)return(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Z,{name:"".concat(m.name,"EnvVersion"),label:"\u73AF\u5883\u7248\u672C",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7A0B\u5E8F\u8FD0\u884C\u7684\u73AF\u5883"}],children:(0,t.jsx)(z.Z,{options:m.env.map(function(f){return{label:f.name,value:f.baseImage}}),placeholder:"\u8BF7\u9009\u62E9\u5177\u4F53\u7684\u73AF\u5883\u7248\u672C"},"".concat(m.name,"Select"))},m.name),m.name=="php"&&(0,t.jsx)(y.Z,{label:"php\u6269\u5C55",name:"phpExt",children:(0,t.jsx)(z.Z,{options:m.ext.map(function(f){return{label:f,value:f}}),mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u8981\u5B89\u88C5\u7684php\u6269\u5C55"},"phpExtSelect")},"phpExt")]},"envSelect")})}):(0,t.jsx)(t.Fragment,{})}})]})})}function H(B){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($,{onImport:function(P){var x;return(x=B.createFormRef.current)===null||x===void 0||x.setFieldValue("buildDockerfile",P),!0}}),(0,t.jsx)(d,{onFinish:function(P){var x;(x=B.createFormRef.current)===null||x===void 0||x.setFieldValue("buildDockerfile",P)}}),(0,t.jsx)(y.Z,{shouldUpdate:!0,children:function(P){var x=P.getFieldValue;return(0,t.jsx)(y.Z,{name:"buildDockerfile",children:(0,t.jsx)(S.ZP,{value:x("buildDockerfile"),onChange:function(j){var g;(g=B.createFormRef.current)===null||g===void 0||g.setFieldValue("buildDockerfile",j)},height:"1000px",theme:"light",style:{marginBottom:"20px"}})})}})]})}},70345:function(G,T,e){e.r(T),e.d(T,{default:function(){return I}});var p=e(71566),l=e(86074);function O(){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(p.Z,{showImportButton:!0,defaultShow:!0})})}var c=e(38345),F=e(62435);function I(){return(0,l.jsx)("div",{children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(O,{})})})}},97961:function(G,T,e){e.d(T,{MF:function(){return y},_2:function(){return $},fN:function(){return I}});var p=e(15009),l=e.n(p),O=e(99289),c=e.n(O),F=e(54006);function I(D){return t.apply(this,arguments)}function t(){return t=c()(l()().mark(function D(M){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,F.request)("/api/app/image/create-by-dockerfile",{method:"POST",data:M}));case 1:case"end":return h.stop()}},D)})),t.apply(this,arguments)}function $(D){return S.apply(this,arguments)}function S(){return S=c()(l()().mark(function D(M){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,F.request)("/api/common/attach/delete",{method:"POST",data:M});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},D)})),S.apply(this,arguments)}function y(){return A.apply(this,arguments)}function A(){return A=c()(l()().mark(function D(){return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.request)("/api/app/image/get-template-list",{method:"POST"}));case 1:case"end":return v.stop()}},D)})),A.apply(this,arguments)}}}]);
